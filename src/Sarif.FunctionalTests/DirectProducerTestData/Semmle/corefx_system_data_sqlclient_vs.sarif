{
  "$schema": "http://json.schemastore.org/sarif-1.0.0",
  "version": "1.0.0",
  "runs": [
    {
      "tool": {
        "name": "Semmle",
        "version": "1.15.2"
      },
      "files": {
        "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/StressTest.config": {
          "mimeType": "text/xml",
          "contents": "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiID8+DQo8Y29uZmlndXJhdGlvbj4NCiAgPGRhdGFTdHJlc3NTZXR0aW5ncz4NCiAgICA8c291cmNlcz4NCiAgICAgIDxzb3VyY2UNCiAgICAgICAgbmFtZT0iTG9jYWxTcWxTZXJ2ZXIiDQogICAgICAgIHR5cGU9IlNxbFNlcnZlciINCiAgICAgICAgaXNEZWZhdWx0PSJ0cnVlIg0KICAgICAgICBkYXRhU291cmNlPSIobG9jYWwpIg0KICAgICAgICBkYXRhYmFzZT0ic3RyZXNzIg0KICAgICAgICB1c2VyPSJzdHJlc3MiDQogICAgICAgIHBhc3N3b3JkPSIiDQogICAgICAgIHN1cHBvcnRzV2luZG93c0F1dGhlbnRpY2F0aW9uPSJmYWxzZSINCiAgICAgICAgaXNsb2NhbD0ndHJ1ZScNCiAgICAgICAgZGlzYWJsZU11bHRpU3VibmV0RmFpbG92ZXIgPSAndHJ1ZScNCiAgICAgICAgZGlzYWJsZU5hbWVkUGlwZXMgPSAndHJ1ZSc+IA0KICAgICAgPC9zb3VyY2U+DQogICAgPC9zb3VyY2VzPg0KICA8L2RhdGFTdHJlc3NTZXR0aW5ncz4NCjwvY29uZmlndXJhdGlvbj4="
        },
        "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljOw0KdXNpbmcgU3lzdGVtLlhtbDsNCnVzaW5nIFN5c3RlbS5EYXRhOw0KdXNpbmcgU3lzdGVtLkRhdGEuQ29tbW9uOw0KdXNpbmcgU3lzdGVtLkRhdGEuU3FsQ2xpZW50Ow0KdXNpbmcgU3lzdGVtLkRhdGEuU3FsVHlwZXM7DQp1c2luZyBTeXN0ZW0uSU87DQp1c2luZyBTeXN0ZW0uVGhyZWFkaW5nOw0KdXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsNCg0KbmFtZXNwYWNlIFN0cmVzcy5EYXRhDQp7DQogICAgcHVibGljIGNsYXNzIERhdGFTdHJlc3NSZWFkZXIgOiBJRGlzcG9zYWJsZQ0KICAgIHsNCiAgICAgICAgI3JlZ2lvbiBUeXBlIG1ldGhvZCBtYXBwaW5nDQoNCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgRGljdGlvbmFyeTxUeXBlLCBGdW5jPERhdGFTdHJlc3NSZWFkZXIsIGludCwgQ2FuY2VsbGF0aW9uVG9rZW4sIFJhbmRvbSwgVGFzazxvYmplY3Q+Pj4gc19zcWxUeXBlczsNCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgRGljdGlvbmFyeTxUeXBlLCBGdW5jPERhdGFTdHJlc3NSZWFkZXIsIGludCwgQ2FuY2VsbGF0aW9uVG9rZW4sIFJhbmRvbSwgVGFzazxvYmplY3Q+Pj4gc19jbHJUeXBlczsNCg0KICAgICAgICBzdGF0aWMgRGF0YVN0cmVzc1JlYWRlcigpDQogICAgICAgIHsNCiAgICAgICAgICAgIEluaXRTcWxUeXBlcygpOw0KICAgICAgICAgICAgSW5pdENsclR5cGVzKCk7DQogICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIHN0YXRpYyB2b2lkIEluaXRTcWxUeXBlcygpDQogICAgICAgIHsNCiAgICAgICAgICAgIHNfc3FsVHlwZXMgPSBuZXcgRGljdGlvbmFyeTxUeXBlLCBGdW5jPERhdGFTdHJlc3NSZWFkZXIsIGludCwgQ2FuY2VsbGF0aW9uVG9rZW4sIFJhbmRvbSwgVGFzazxvYmplY3Q+Pj4oKTsNCg0KICAgICAgICAgICAgc19zcWxUeXBlcy5BZGQodHlwZW9mKFNxbEJpbmFyeSksIChyZWFkZXIsIG9yZGluYWwsIHRva2VuLCBybmQpID0+IHJlYWRlci5HZXRGaWVsZFZhbHVlU3luY09yQXN5bmM8U3FsQmluYXJ5PihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX3NxbFR5cGVzLkFkZCh0eXBlb2YoU3FsQm9vbGVhbiksIChyZWFkZXIsIG9yZGluYWwsIHRva2VuLCBybmQpID0+IHJlYWRlci5HZXRGaWVsZFZhbHVlU3luY09yQXN5bmM8U3FsQm9vbGVhbj4ob3JkaW5hbCwgdG9rZW4sIHJuZCkpOw0KICAgICAgICAgICAgc19zcWxUeXBlcy5BZGQodHlwZW9mKFNxbEJ5dGUpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPFNxbEJ5dGU+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfc3FsVHlwZXMuQWRkKHR5cGVvZihTcWxCeXRlcyksIChyZWFkZXIsIG9yZGluYWwsIHRva2VuLCBybmQpID0+IHJlYWRlci5HZXRGaWVsZFZhbHVlU3luY09yQXN5bmM8U3FsQnl0ZXM+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfc3FsVHlwZXMuQWRkKHR5cGVvZihTcWxDaGFycyksIChyZWFkZXIsIG9yZGluYWwsIHRva2VuLCBybmQpID0+IHJlYWRlci5HZXRGaWVsZFZhbHVlU3luY09yQXN5bmM8U3FsQ2hhcnM+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfc3FsVHlwZXMuQWRkKHR5cGVvZihTcWxEYXRlVGltZSksIChyZWFkZXIsIG9yZGluYWwsIHRva2VuLCBybmQpID0+IHJlYWRlci5HZXRGaWVsZFZhbHVlU3luY09yQXN5bmM8U3FsRGF0ZVRpbWU+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfc3FsVHlwZXMuQWRkKHR5cGVvZihTcWxEZWNpbWFsKSwgKHJlYWRlciwgb3JkaW5hbCwgdG9rZW4sIHJuZCkgPT4gcmVhZGVyLkdldEZpZWxkVmFsdWVTeW5jT3JBc3luYzxTcWxEZWNpbWFsPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX3NxbFR5cGVzLkFkZCh0eXBlb2YoU3FsRG91YmxlKSwgKHJlYWRlciwgb3JkaW5hbCwgdG9rZW4sIHJuZCkgPT4gcmVhZGVyLkdldEZpZWxkVmFsdWVTeW5jT3JBc3luYzxTcWxEb3VibGU+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfc3FsVHlwZXMuQWRkKHR5cGVvZihTcWxHdWlkKSwgKHJlYWRlciwgb3JkaW5hbCwgdG9rZW4sIHJuZCkgPT4gcmVhZGVyLkdldEZpZWxkVmFsdWVTeW5jT3JBc3luYzxTcWxHdWlkPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX3NxbFR5cGVzLkFkZCh0eXBlb2YoU3FsSW50MTYpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPFNxbEludDE2PihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX3NxbFR5cGVzLkFkZCh0eXBlb2YoU3FsSW50MzIpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPFNxbEludDMyPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX3NxbFR5cGVzLkFkZCh0eXBlb2YoU3FsSW50NjQpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPFNxbEludDY0PihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX3NxbFR5cGVzLkFkZCh0eXBlb2YoU3FsTW9uZXkpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPFNxbE1vbmV5PihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX3NxbFR5cGVzLkFkZCh0eXBlb2YoU3FsU2luZ2xlKSwgKHJlYWRlciwgb3JkaW5hbCwgdG9rZW4sIHJuZCkgPT4gcmVhZGVyLkdldEZpZWxkVmFsdWVTeW5jT3JBc3luYzxTcWxTaW5nbGU+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfc3FsVHlwZXMuQWRkKHR5cGVvZihTcWxTdHJpbmcpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPFNxbFN0cmluZz4ob3JkaW5hbCwgdG9rZW4sIHJuZCkpOw0KICAgICAgICAgICAgc19zcWxUeXBlcy5BZGQodHlwZW9mKFNxbFhtbCksIChyZWFkZXIsIG9yZGluYWwsIHRva2VuLCBybmQpID0+IHJlYWRlci5HZXRGaWVsZFZhbHVlU3luY09yQXN5bmM8U3FsWG1sPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIHN0YXRpYyB2b2lkIEluaXRDbHJUeXBlcygpDQogICAgICAgIHsNCiAgICAgICAgICAgIHNfY2xyVHlwZXMgPSBuZXcgRGljdGlvbmFyeTxUeXBlLCBGdW5jPERhdGFTdHJlc3NSZWFkZXIsIGludCwgQ2FuY2VsbGF0aW9uVG9rZW4sIFJhbmRvbSwgVGFzazxvYmplY3Q+Pj4oKTsNCg0KICAgICAgICAgICAgc19jbHJUeXBlcy5BZGQodHlwZW9mKEJvb2xlYW4pLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPEJvb2xlYW4+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfY2xyVHlwZXMuQWRkKHR5cGVvZihCeXRlKSwgKHJlYWRlciwgb3JkaW5hbCwgdG9rZW4sIHJuZCkgPT4gcmVhZGVyLkdldEZpZWxkVmFsdWVTeW5jT3JBc3luYzxCeXRlPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX2NsclR5cGVzLkFkZCh0eXBlb2YoSW50MTYpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPEludDE2PihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX2NsclR5cGVzLkFkZCh0eXBlb2YoSW50MzIpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPEludDMyPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX2NsclR5cGVzLkFkZCh0eXBlb2YoSW50NjQpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPEludDY0PihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX2NsclR5cGVzLkFkZCh0eXBlb2YoU2luZ2xlKSwgKHJlYWRlciwgb3JkaW5hbCwgdG9rZW4sIHJuZCkgPT4gcmVhZGVyLkdldEZpZWxkVmFsdWVTeW5jT3JBc3luYzxTaW5nbGU+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfY2xyVHlwZXMuQWRkKHR5cGVvZihEb3VibGUpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPERvdWJsZT4ob3JkaW5hbCwgdG9rZW4sIHJuZCkpOw0KICAgICAgICAgICAgc19jbHJUeXBlcy5BZGQodHlwZW9mKFN0cmluZyksIChyZWFkZXIsIG9yZGluYWwsIHRva2VuLCBybmQpID0+IHJlYWRlci5HZXRGaWVsZFZhbHVlU3luY09yQXN5bmM8U3RyaW5nPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX2NsclR5cGVzLkFkZCh0eXBlb2YoQ2hhciksIChyZWFkZXIsIG9yZGluYWwsIHRva2VuLCBybmQpID0+IHJlYWRlci5HZXRGaWVsZFZhbHVlU3luY09yQXN5bmM8Q2hhcj4ob3JkaW5hbCwgdG9rZW4sIHJuZCkpOw0KICAgICAgICAgICAgc19jbHJUeXBlcy5BZGQodHlwZW9mKERlY2ltYWwpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPERlY2ltYWw+KG9yZGluYWwsIHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIHNfY2xyVHlwZXMuQWRkKHR5cGVvZihHdWlkKSwgKHJlYWRlciwgb3JkaW5hbCwgdG9rZW4sIHJuZCkgPT4gcmVhZGVyLkdldEZpZWxkVmFsdWVTeW5jT3JBc3luYzxHdWlkPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX2NsclR5cGVzLkFkZCh0eXBlb2YoRGF0ZVRpbWUpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPERhdGVUaW1lPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX2NsclR5cGVzLkFkZCh0eXBlb2YoVGltZVNwYW4pLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPFRpbWVTcGFuPihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgICAgICBzX2NsclR5cGVzLkFkZCh0eXBlb2YoRGF0ZVRpbWVPZmZzZXQpLCAocmVhZGVyLCBvcmRpbmFsLCB0b2tlbiwgcm5kKSA9PiByZWFkZXIuR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPERhdGVUaW1lT2Zmc2V0PihvcmRpbmFsLCB0b2tlbiwgcm5kKSk7DQogICAgICAgIH0NCg0KICAgICAgICAjZW5kcmVnaW9uDQoNCiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBEYkRhdGFSZWFkZXIgX3JlYWRlcjsNCiAgICAgICAgcHJpdmF0ZSBTZW1hcGhvcmVTbGltIF9jbG9zZUFzeW5jU2VtYXBob3JlOw0KDQogICAgICAgIHB1YmxpYyBEYXRhU3RyZXNzUmVhZGVyKERiRGF0YVJlYWRlciBpbnRlcm5hbFJlYWRlcikNCiAgICAgICAgew0KICAgICAgICAgICAgX3JlYWRlciA9IGludGVybmFsUmVhZGVyOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQgQ2xvc2UoKQ0KICAgICAgICB7DQogICAgICAgICAgICBfcmVhZGVyLkRpc3Bvc2UoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyB2b2lkIERpc3Bvc2UoKQ0KICAgICAgICB7DQogICAgICAgICAgICBfcmVhZGVyLkRpc3Bvc2UoKTsNCiAgICAgICAgICAgIGlmIChfY2xvc2VBc3luY1NlbWFwaG9yZSAhPSBudWxsKSBfY2xvc2VBc3luY1NlbWFwaG9yZS5EaXNwb3NlKCk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgVGFzayBDbG9zZUFzeW5jKCkNCiAgICAgICAgew0KICAgICAgICAgICAgX2Nsb3NlQXN5bmNTZW1hcGhvcmUgPSBuZXcgU2VtYXBob3JlU2xpbSgxKTsNCiAgICAgICAgICAgIHJldHVybiBUYXNrLlJ1bigoKSA9PiBFeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoQ2xvc2UpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIEV4ZWN1dGVzIHRoZSBhY3Rpb24gd2hpbGUgaG9sZGluZyB0aGUgQ2xvc2VBc3luYyBTZW1hcGhvcmUuIA0KICAgICAgICAvLy8gVGhpcyBNVVNUIGJlIHVzZWQgZm9yIHJlYWRlci5DbG9zZSgpIGFuZCBhbGwgbWV0aG9kcyB0aGF0IGFyZSBub3Qgc2FmZSB0byBjYWxsIGF0IHRoZSBzYW1lIHRpbWUgYXMgcmVhZGVyLkNsb3NlKCksIGkuZS4gYWxsIHN5bmMgbWV0aG9kcy4NCiAgICAgICAgLy8vIE90aGVyd2lzZSB3ZSB3aWxsIHNlZSBBVidzLg0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBwdWJsaWMgdm9pZCBFeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoQWN0aW9uIGEpDQogICAgICAgIHsNCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChfY2xvc2VBc3luY1NlbWFwaG9yZSAhPSBudWxsKSBfY2xvc2VBc3luY1NlbWFwaG9yZS5XYWl0KCk7DQogICAgICAgICAgICAgICAgYSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZmluYWxseQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChfY2xvc2VBc3luY1NlbWFwaG9yZSAhPSBudWxsKSBfY2xvc2VBc3luY1NlbWFwaG9yZS5SZWxlYXNlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBFeGVjdXRlcyB0aGUgYWN0aW9uIHdoaWxlIGhvbGRpbmcgdGhlIENsb3NlQXN5bmMgU2VtYXBob3JlLiANCiAgICAgICAgLy8vIFRoaXMgTVVTVCBiZSB1c2VkIGZvciByZWFkZXIuQ2xvc2UoKSBhbmQgYWxsIG1ldGhvZHMgdGhhdCBhcmUgbm90IHNhZmUgdG8gY2FsbCBhdCB0aGUgc2FtZSB0aW1lIGFzIHJlYWRlci5DbG9zZSgpLCBpLmUuIGFsbCBzeW5jIG1ldGhvZHMuDQogICAgICAgIC8vLyBPdGhlcndpc2Ugd2Ugd2lsbCBzZWUgQVYncy4NCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgcHVibGljIFQgRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlPFQ+KEZ1bmM8VD4gZikNCiAgICAgICAgew0KICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKF9jbG9zZUFzeW5jU2VtYXBob3JlICE9IG51bGwpIF9jbG9zZUFzeW5jU2VtYXBob3JlLldhaXQoKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZmluYWxseQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChfY2xvc2VBc3luY1NlbWFwaG9yZSAhPSBudWxsKSBfY2xvc2VBc3luY1NlbWFwaG9yZS5SZWxlYXNlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAjcmVnaW9uIFN5bmNPckFzeW5jIG1ldGhvZHMNCg0KICAgICAgICBwdWJsaWMgVGFzazxib29sPiBSZWFkU3luY09yQXN5bmMoQ2FuY2VsbGF0aW9uVG9rZW4gdG9rZW4sIFJhbmRvbSBybmQpDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBBc3luY1V0aWxzLlN5bmNPckFzeW5jTWV0aG9kKA0KICAgICAgICAgICAgICAgICgpID0+IEV4ZWN1dGVXaXRoQ2xvc2VBc3luY1NlbWFwaG9yZSgoKSA9PiBfcmVhZGVyLlJlYWQoKSksDQogICAgICAgICAgICAgICAgKCkgPT4gRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF9yZWFkZXIuUmVhZEFzeW5jKHRva2VuKSksDQogICAgICAgICAgICAgICAgQXN5bmNVdGlscy5DaG9vc2VTeW5jQXN5bmNNb2RlKHJuZCkNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIFRhc2s8Ym9vbD4gTmV4dFJlc3VsdFN5bmNPckFzeW5jKENhbmNlbGxhdGlvblRva2VuIHRva2VuLCBSYW5kb20gcm5kKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gQXN5bmNVdGlscy5TeW5jT3JBc3luY01ldGhvZCgNCiAgICAgICAgICAgICAgICAoKSA9PiBFeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoKCkgPT4gX3JlYWRlci5OZXh0UmVzdWx0KCkpLA0KICAgICAgICAgICAgICAgICgpID0+IEV4ZWN1dGVXaXRoQ2xvc2VBc3luY1NlbWFwaG9yZSgoKSA9PiBfcmVhZGVyLk5leHRSZXN1bHRBc3luYyh0b2tlbikpLA0KICAgICAgICAgICAgICAgIEFzeW5jVXRpbHMuQ2hvb3NlU3luY0FzeW5jTW9kZShybmQpDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBUYXNrPGJvb2w+IElzREJOdWxsU3luY09yQXN5bmMoaW50IG9yZGluYWwsIENhbmNlbGxhdGlvblRva2VuIHRva2VuLCBSYW5kb20gcm5kKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gQXN5bmNVdGlscy5TeW5jT3JBc3luY01ldGhvZCgNCiAgICAgICAgICAgICAgICAoKSA9PiBFeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoKCkgPT4gX3JlYWRlci5Jc0RCTnVsbChvcmRpbmFsKSksDQogICAgICAgICAgICAgICAgKCkgPT4gRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF9yZWFkZXIuSXNEQk51bGxBc3luYyhvcmRpbmFsLCB0b2tlbikpLA0KICAgICAgICAgICAgICAgIEFzeW5jVXRpbHMuQ2hvb3NlU3luY0FzeW5jTW9kZShybmQpDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBUYXNrPG9iamVjdD4gR2V0VmFsdWVTeW5jT3JBc3luYyhpbnQgb3JkaW5hbCwgQ2FuY2VsbGF0aW9uVG9rZW4gdG9rZW4sIFJhbmRvbSBybmQpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChybmQuTmV4dEJvb2woMC4zKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBVc2Ugc3luYy1vbmx5IEdldFZhbHVlDQogICAgICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChHZXRWYWx1ZShvcmRpbmFsKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gVXNlIEdldEZpZWxkVmFsdWUgb3IgR2V0RmllbGRWYWx1ZUFzeW5jDQogICAgICAgICAgICAgICAgRnVuYzxEYXRhU3RyZXNzUmVhZGVyLCBpbnQsIENhbmNlbGxhdGlvblRva2VuLCBSYW5kb20sIFRhc2s8b2JqZWN0Pj4gZ2V0RmllbGRWYWx1ZUZ1bmMgPSBudWxsOw0KDQogICAgICAgICAgICAgICAgaWYgKHJuZC5OZXh0Qm9vbCgpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2hvb3NlIHByb3ZpZGVyLXNwZWNpZmljIGdldHRlcg0KICAgICAgICAgICAgICAgICAgICBUeXBlIHNxbFR5cGUgPSBHZXRQcm92aWRlclNwZWNpZmljRmllbGRUeXBlKG9yZGluYWwpOw0KICAgICAgICAgICAgICAgICAgICBzX3NxbFR5cGVzLlRyeUdldFZhbHVlKHNxbFR5cGUsIG91dCBnZXRGaWVsZFZhbHVlRnVuYyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vIENob29zZSBjbHIgdHlwZSBnZXR0ZXINCiAgICAgICAgICAgICAgICAgICAgVHlwZSBjbHJUeXBlID0gR2V0RmllbGRUeXBlKG9yZGluYWwpOw0KICAgICAgICAgICAgICAgICAgICBzX2NsclR5cGVzLlRyeUdldFZhbHVlKGNsclR5cGUsIG91dCBnZXRGaWVsZFZhbHVlRnVuYyk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKGdldEZpZWxkVmFsdWVGdW5jICE9IG51bGwpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSB0eXBlLXNwZWNpZmljIGZ1bmMsIGUuZy4gR2V0RmllbGRWYWx1ZTxpbnQ+IG9yIEdldEZpZWxkVmFsdWVBc3luYzxpbnQ+DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRGaWVsZFZhbHVlRnVuYyh0aGlzLCBvcmRpbmFsLCB0b2tlbiwgcm5kKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSBHZXRGaWVsZFZhbHVlPG9iamVjdD4gb3IgR2V0RmllbGRWYWx1ZUFzeW5jPG9iamVjdD4gYXMgYSBmYWxsYmFjaw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPG9iamVjdD4ob3JkaW5hbCwgdG9rZW4sIHJuZCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSBUYXNrPG9iamVjdD4gR2V0RmllbGRWYWx1ZVN5bmNPckFzeW5jPFQ+KGludCBvcmRpbmFsLCBDYW5jZWxsYXRpb25Ub2tlbiB0b2tlbiwgUmFuZG9tIHJuZCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIEFzeW5jVXRpbHMuU3luY09yQXN5bmNNZXRob2Q8b2JqZWN0PigNCiAgICAgICAgICAgICAgICAoKSA9PiBFeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoKCkgPT4gX3JlYWRlci5HZXRGaWVsZFZhbHVlPFQ+KG9yZGluYWwpKSwNCiAgICAgICAgICAgICAgICBhc3luYyAoKSA9PiAoKG9iamVjdCkoYXdhaXQgRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF9yZWFkZXIuR2V0RmllbGRWYWx1ZUFzeW5jPFQ+KG9yZGluYWwsIHRva2VuKSkpKSwNCiAgICAgICAgICAgICAgICBBc3luY1V0aWxzLkNob29zZVN5bmNBc3luY01vZGUocm5kKQ0KICAgICAgICAgICAgICAgICk7DQogICAgICAgIH0NCg0KICAgICAgICAjZW5kcmVnaW9uDQoNCiAgICAgICAgI3JlZ2lvbiBTeW5jLW9ubHkgbWV0aG9kcw0KDQogICAgICAgIHB1YmxpYyBsb25nIEdldEJ5dGVzKGludCBvcmRpbmFsLCBsb25nIGRhdGFPZmZzZXQsIGJ5dGVbXSBidWZmZXIsIGludCBidWZmZXJPZmZzZXQsIGludCBsZW5ndGgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBFeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoKCkgPT4gX3JlYWRlci5HZXRCeXRlcyhvcmRpbmFsLCBkYXRhT2Zmc2V0LCBidWZmZXIsIGJ1ZmZlck9mZnNldCwgbGVuZ3RoKSk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgbG9uZyBHZXRDaGFycyhpbnQgb3JkaW5hbCwgbG9uZyBkYXRhT2Zmc2V0LCBjaGFyW10gYnVmZmVyLCBpbnQgYnVmZmVyT2Zmc2V0LCBpbnQgbGVuZ3RoKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF9yZWFkZXIuR2V0Q2hhcnMob3JkaW5hbCwgZGF0YU9mZnNldCwgYnVmZmVyLCBidWZmZXJPZmZzZXQsIGxlbmd0aCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIFR5cGUgR2V0RmllbGRUeXBlKGludCBvcmRpbmFsKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF9yZWFkZXIuR2V0RmllbGRUeXBlKG9yZGluYWwpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBzdHJpbmcgR2V0TmFtZShpbnQgb3JkaW5hbCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIEV4ZWN1dGVXaXRoQ2xvc2VBc3luY1NlbWFwaG9yZSgoKSA9PiBfcmVhZGVyLkdldE5hbWUob3JkaW5hbCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIFR5cGUgR2V0UHJvdmlkZXJTcGVjaWZpY0ZpZWxkVHlwZShpbnQgb3JkaW5hbCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIEV4ZWN1dGVXaXRoQ2xvc2VBc3luY1NlbWFwaG9yZSgoKSA9PiBfcmVhZGVyLkdldFByb3ZpZGVyU3BlY2lmaWNGaWVsZFR5cGUob3JkaW5hbCkpOw0KICAgICAgICB9DQoNCg0KICAgICAgICBwdWJsaWMgRGF0YVN0cmVzc1N0cmVhbSBHZXRTdHJlYW0oaW50IG9yZGluYWwpDQogICAgICAgIHsNCiAgICAgICAgICAgIFN0cmVhbSBzID0gRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF9yZWFkZXIuR2V0U3RyZWFtKG9yZGluYWwpKTsNCiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0YVN0cmVzc1N0cmVhbShzLCB0aGlzKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBEYXRhU3RyZXNzVGV4dFJlYWRlciBHZXRUZXh0UmVhZGVyKGludCBvcmRpbmFsKQ0KICAgICAgICB7DQogICAgICAgICAgICBUZXh0UmVhZGVyIHQgPSBFeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoKCkgPT4gX3JlYWRlci5HZXRUZXh0UmVhZGVyKG9yZGluYWwpKTsNCiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0YVN0cmVzc1RleHRSZWFkZXIodCwgdGhpcyk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgRGF0YVN0cmVzc1htbFJlYWRlciBHZXRYbWxSZWFkZXIoaW50IG9yZGluYWwpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbFJlYWRlciB4ID0gRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+ICgoU3FsRGF0YVJlYWRlcilfcmVhZGVyKS5HZXRYbWxSZWFkZXIob3JkaW5hbCkpOw0KICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRhU3RyZXNzWG1sUmVhZGVyKHgsIHRoaXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIG9iamVjdCBHZXRWYWx1ZShpbnQgb3JkaW5hbCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIEV4ZWN1dGVXaXRoQ2xvc2VBc3luY1NlbWFwaG9yZSgoKSA9PiBfcmVhZGVyLkdldFZhbHVlKG9yZGluYWwpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBpbnQgRmllbGRDb3VudA0KICAgICAgICB7DQogICAgICAgICAgICBnZXQgeyByZXR1cm4gRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF9yZWFkZXIuRmllbGRDb3VudCk7IH0NCiAgICAgICAgfQ0KDQogICAgICAgICNlbmRyZWdpb24NCiAgICB9DQoNCiAgICBwdWJsaWMgY2xhc3MgRGF0YVN0cmVzc1N0cmVhbSA6IElEaXNwb3NhYmxlDQogICAgew0KICAgICAgICBwcml2YXRlIFN0cmVhbSBfc3RyZWFtOw0KICAgICAgICBwcml2YXRlIERhdGFTdHJlc3NSZWFkZXIgX3JlYWRlcjsNCg0KICAgICAgICBwdWJsaWMgRGF0YVN0cmVzc1N0cmVhbShTdHJlYW0gc3RyZWFtLCBEYXRhU3RyZXNzUmVhZGVyIHJlYWRlcikNCiAgICAgICAgew0KICAgICAgICAgICAgX3N0cmVhbSA9IHN0cmVhbTsNCiAgICAgICAgICAgIF9yZWFkZXIgPSByZWFkZXI7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgdm9pZCBEaXNwb3NlKCkNCiAgICAgICAgew0KICAgICAgICAgICAgX3N0cmVhbS5EaXNwb3NlKCk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgVGFzazxpbnQ+IFJlYWRTeW5jT3JBc3luYyhieXRlW10gYnVmZmVyLCBpbnQgb2Zmc2V0LCBpbnQgY291bnQsIENhbmNlbGxhdGlvblRva2VuIHRva2VuLCBSYW5kb20gcm5kKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gQXN5bmNVdGlscy5TeW5jT3JBc3luY01ldGhvZCgNCiAgICAgICAgICAgICAgICAoKSA9PiBfcmVhZGVyLkV4ZWN1dGVXaXRoQ2xvc2VBc3luY1NlbWFwaG9yZSgoKSA9PiBfc3RyZWFtLlJlYWQoYnVmZmVyLCBvZmZzZXQsIGNvdW50KSksDQogICAgICAgICAgICAgICAgKCkgPT4gX3JlYWRlci5FeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoKCkgPT4gX3N0cmVhbS5SZWFkQXN5bmMoYnVmZmVyLCBvZmZzZXQsIGNvdW50KSksDQogICAgICAgICAgICAgICAgQXN5bmNVdGlscy5DaG9vc2VTeW5jQXN5bmNNb2RlKHJuZCkNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGNsYXNzIERhdGFTdHJlc3NUZXh0UmVhZGVyIDogSURpc3Bvc2FibGUNCiAgICB7DQogICAgICAgIHByaXZhdGUgVGV4dFJlYWRlciBfdGV4dFJlYWRlcjsNCiAgICAgICAgcHJpdmF0ZSBEYXRhU3RyZXNzUmVhZGVyIF9yZWFkZXI7DQoNCiAgICAgICAgcHVibGljIERhdGFTdHJlc3NUZXh0UmVhZGVyKFRleHRSZWFkZXIgdGV4dFJlYWRlciwgRGF0YVN0cmVzc1JlYWRlciByZWFkZXIpDQogICAgICAgIHsNCiAgICAgICAgICAgIF90ZXh0UmVhZGVyID0gdGV4dFJlYWRlcjsNCiAgICAgICAgICAgIF9yZWFkZXIgPSByZWFkZXI7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgdm9pZCBEaXNwb3NlKCkNCiAgICAgICAgew0KICAgICAgICAgICAgX3RleHRSZWFkZXIuRGlzcG9zZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIGludCBQZWVrKCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIF9yZWFkZXIuRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF90ZXh0UmVhZGVyLlBlZWsoKSk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgVGFzazxpbnQ+IFJlYWRTeW5jT3JBc3luYyhjaGFyW10gYnVmZmVyLCBpbnQgaW5kZXgsIGludCBjb3VudCwgUmFuZG9tIHJuZCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIEFzeW5jVXRpbHMuU3luY09yQXN5bmNNZXRob2QoDQogICAgICAgICAgICAgICAgKCkgPT4gX3JlYWRlci5FeGVjdXRlV2l0aENsb3NlQXN5bmNTZW1hcGhvcmUoKCkgPT4gX3RleHRSZWFkZXIuUmVhZChidWZmZXIsIGluZGV4LCBjb3VudCkpLA0KICAgICAgICAgICAgICAgICgpID0+IF9yZWFkZXIuRXhlY3V0ZVdpdGhDbG9zZUFzeW5jU2VtYXBob3JlKCgpID0+IF90ZXh0UmVhZGVyLlJlYWRBc3luYyhidWZmZXIsIGluZGV4LCBjb3VudCkpLA0KICAgICAgICAgICAgICAgIEFzeW5jVXRpbHMuQ2hvb3NlU3luY0FzeW5jTW9kZShybmQpKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBjbGFzcyBEYXRhU3RyZXNzWG1sUmVhZGVyIDogSURpc3Bvc2FibGUNCiAgICB7DQogICAgICAgIHByaXZhdGUgWG1sUmVhZGVyIF94bWxSZWFkZXI7DQogICAgICAgIHByaXZhdGUgRGF0YVN0cmVzc1JlYWRlciBfcmVhZGVyOw0KDQogICAgICAgIHB1YmxpYyBEYXRhU3RyZXNzWG1sUmVhZGVyKFhtbFJlYWRlciB4bWxSZWFkZXIsIERhdGFTdHJlc3NSZWFkZXIgcmVhZGVyKQ0KICAgICAgICB7DQogICAgICAgICAgICBfeG1sUmVhZGVyID0geG1sUmVhZGVyOw0KICAgICAgICAgICAgX3JlYWRlciA9IHJlYWRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyB2b2lkIERpc3Bvc2UoKQ0KICAgICAgICB7DQogICAgICAgICAgICBfeG1sUmVhZGVyLkRpc3Bvc2UoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyB2b2lkIFJlYWQoKQ0KICAgICAgICB7DQogICAgICAgICAgICBfcmVhZGVyLkV4ZWN1dGVXaXRoQ2xvc2VBc3luY1NlbWFwaG9yZSgoKSA9PiBfeG1sUmVhZGVyLlJlYWQoKSk7DQogICAgICAgIH0NCiAgICB9DQp9DQo="
        },
        "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljOw0KdXNpbmcgU3lzdGVtLkRhdGE7DQp1c2luZyBTeXN0ZW0uRGF0YS5Db21tb247DQp1c2luZyBTeXN0ZW0uRGF0YS5TcWxDbGllbnQ7DQp1c2luZyBTeXN0ZW0uRGF0YS5TcWxUeXBlczsNCnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljczsNCnVzaW5nIFN5c3RlbS5JTzsNCnVzaW5nIFN5c3RlbS5MaW5xOw0KdXNpbmcgU3lzdGVtLlRleHQ7DQp1c2luZyBTeXN0ZW0uVGhyZWFkaW5nOw0KdXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsNCnVzaW5nIFN5c3RlbS5YbWw7DQoNCnVzaW5nIERQU3RyZXNzSGFybmVzczsNCg0KbmFtZXNwYWNlIFN0cmVzcy5EYXRhDQp7DQogICAgLy8vIDxzdW1tYXJ5Pg0KICAgIC8vLyAgYmFzaWMgc2V0IG9mIHRlc3RzIHRvIHJ1biBvbiBlYWNoIG1hbmFnZWQgcHJvdmlkZXINCiAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgIHB1YmxpYyBhYnN0cmFjdCBjbGFzcyBEYXRhVGVzdEdyb3VwDQogICAgew0KICAgICAgICAvLyByYW5kb20gaXMgbm90IHRocmVhZC1zYWZlLCBjcmVhdGUgb25lIHBlciB0aHJlYWQgLSB1c2UgUmFuZG9tSW5zdGFuY2UgdG8gYWNjZXNzIGl0Lg0KICAgICAgICAvLyBub3RlIHRoYXQgZWFjaCB0aHJlYWQgYW5kIGVhY2ggdGVzdCBtZXRob2QgaGFzIGEgZGlmZmVyZW50IGluc3RhbmNlIG9mIHRoaXMgb2JqZWN0LCBzbyBpdA0KICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gYmUgc3luY2hyb25pc2VkIG9yIGhhdmUgW1RocmVhZFN0YXRpY10sIGV0Yw0KICAgICAgICBwcml2YXRlIFRyYWNrZWRSYW5kb20gX3JhbmRvbUluc3RhbmNlID0gbmV3IFRyYWNrZWRSYW5kb20oKTsNCiAgICAgICAgcHJvdGVjdGVkIFJhbmRvbSBSYW5kb21JbnN0YW5jZQ0KICAgICAgICB7DQogICAgICAgICAgICBnZXQNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBfcmFuZG9tSW5zdGFuY2UuTWFyaygpOw0KICAgICAgICAgICAgICAgIHJldHVybiBfcmFuZG9tSW5zdGFuY2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBUZXN0IGZhY3RvcnkgdG8gdXNlIGZvciBnZW5lcmF0aW9uIG9mIGNvbm5lY3Rpb24gc3RyaW5ncyBhbmQgb3RoZXIgdGVzdCBvYmplY3RzLiBGYWN0b3J5IGlzIGluaXRpYWxpemVkIGR1cmluZyBzZXR1cC4NCiAgICAgICAgLy8vIG51bGwgaXMgbm90IHJldHVybmVkIC0gaWYgc2V0dXAgd2FzIG5vdCBjYWxsZWQgeWV0LCBleGNlcHRpb24gaXMgcmFpc2VkDQogICAgICAgIC8vLyBUaGlzIGlzIHN0YXRpYyBzbyB0aGF0IGlzIHNoYXJlZCBhY3Jvc3MgYWxsIHRocmVhZHMgKHNpbmNlIHN0cmVzc3Rlc3Qgd2lsbCBjcmVhdGUgYSBuZXcgRGF0YVRlc3RHcm91cCBvYmplY3QgZm9yIGVhY2ggdGhyZWFkKQ0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBwcml2YXRlIHN0YXRpYyBEYXRhU3RyZXNzRmFjdG9yeSBzX2ZhY3Rvcnk7DQogICAgICAgIHB1YmxpYyBzdGF0aWMgRGF0YVN0cmVzc0ZhY3RvcnkgRmFjdG9yeQ0KICAgICAgICB7DQogICAgICAgICAgICBnZXQNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBEYXRhU3RyZXNzRXJyb3JzLkFzc2VydChzX2ZhY3RvcnkgIT0gbnVsbCwgIlRyaWVkIHRvIGFjY2VzcyBEYXRhVGVzdEdyb3VwLkZhY3RvcnkgYmVmb3JlIFNldHVwIGhhcyBiZWVuIGNhbGxlZCIpOw0KICAgICAgICAgICAgICAgIHJldHVybiBzX2ZhY3Rvcnk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBUaGlzIG1ldGhvZCBpcyBjYWxsZWQgdG8gY3JlYXRlIHRoZSBzdHJlc3MgZmFjdG9yeSB1c2VkIHRvIGNyZWF0ZSBjb25uZWN0aW9ucywgY29tbWFuZHMsIGV0Yy4uLg0KICAgICAgICAvLy8gSW1wbGVtZW50YXRpb24gc2hvdWxkIHNldCB0aGUgc291cmNlIGFuZCB0aGUgc2NlbmFyaW8gdG8gdmFsaWQgdmFsdWVzIGlmIGlucHV0cyBhcmUgbnVsbC9lbXB0eS4NCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJzY2VuYXJpbyI+U2NlbmFyaW8gc3RyaW5nIHNwZWNpZmllZCBieSB0aGUgdXNlciBvciBlbXB0eSB0byBzZXQgZGVmYXVsdDwvcGFyYW0+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0iZGF0YVNvdXJjZSI+RGF0YVNvdXJjZSBzdHJpbmcgc3BlY2lmaWVkIGJ5IHRoZSB1c2VyIG9yIGVtcHR5IHRvIHVzZSBjb25uZWN0aW9uIHN0cmluZyBhcyBpcywgdXNlZnVsIHdoZW4gZGV2ZWxvcGluZyBuZXcgdGVzdHM8L3BhcmFtPg0KICAgICAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgRGF0YVN0cmVzc0ZhY3RvcnkgQ3JlYXRlRmFjdG9yeShyZWYgc3RyaW5nIHNjZW5hcmlvLCByZWYgRGF0YVNvdXJjZSBzb3VyY2UpOw0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIHNjZW5hcmlvIHRvIHJ1biwgaW5pdGlhbGl6ZWQgaW4gc2V0dXANCiAgICAgICAgLy8vIG51bGwgaXMgbm90IHJldHVybmVkIC0gaWYgc2V0dXAgd2FzIG5vdCBjYWxsZWQgeWV0LCBleGNlcHRpb24gaXMgcmFpc2VkDQogICAgICAgIC8vLyBUaGlzIGlzIHN0YXRpYyBzbyB0aGF0IGlzIHNoYXJlZCBhY3Jvc3MgYWxsIHRocmVhZHMgKHNpbmNlIHN0cmVzc3Rlc3Qgd2lsbCBjcmVhdGUgYSBuZXcgRGF0YVRlc3RHcm91cCBvYmplY3QgZm9yIGVhY2ggdGhyZWFkKQ0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBwcml2YXRlIHN0YXRpYyBzdHJpbmcgc19zY2VuYXJpbzsNCiAgICAgICAgcHJvdGVjdGVkIHN0YXRpYyBzdHJpbmcgU2NlbmFyaW8NCiAgICAgICAgew0KICAgICAgICAgICAgZ2V0DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgRGF0YVN0cmVzc0Vycm9ycy5Bc3NlcnQoc19zY2VuYXJpbyAhPSBudWxsLCAiVHJpZWQgdG8gYWNjZXNzIERhdGFUZXN0R3JvdXAuU2NlbmFyaW8gYmVmb3JlIFNldHVwIGhhcyBiZWVuIGNhbGxlZCIpOw0KICAgICAgICAgICAgICAgIHJldHVybiBzX3NjZW5hcmlvOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gZGF0YSBzb3VyY2UgaW5mb3JtYXRpb24gdXNlZCBieSBzdHJlc3MsIGluaXRpYWxpemVkIGluIFNldHVwDQogICAgICAgIC8vLyBudWxsIGlzIG5vdCByZXR1cm5lZCAtIGlmIHNldHVwIHdhcyBub3QgY2FsbGVkIHlldCwgZXhjZXB0aW9uIGlzIHJhaXNlZA0KICAgICAgICAvLy8gVGhpcyBpcyBzdGF0aWMgc28gdGhhdCBpcyBzaGFyZWQgYWNyb3NzIGFsbCB0aHJlYWRzIChzaW5jZSBzdHJlc3N0ZXN0IHdpbGwgY3JlYXRlIGEgbmV3IERhdGFUZXN0R3JvdXAgb2JqZWN0IGZvciBlYWNoIHRocmVhZCkNCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgRGF0YVNvdXJjZSBzX3NvdXJjZTsNCiAgICAgICAgcHJvdGVjdGVkIHN0YXRpYyBEYXRhU291cmNlIFNvdXJjZQ0KICAgICAgICB7DQogICAgICAgICAgICBnZXQNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBEYXRhU3RyZXNzRXJyb3JzLkFzc2VydChzX3NvdXJjZSAhPSBudWxsLCAiVHJpZWQgdG8gYWNjZXNzIERhdGFUZXN0R3JvdXAuU291cmNlIGJlZm9yZSBTZXR1cCBoYXMgYmVlbiBjYWxsZWQiKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gc19zb3VyY2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIERvZXMgdGVzdCBzZXR1cCB0aGF0IGlzIHNoYXJlZCBhY3Jvc3MgYWxsIHRocmVhZHMuIFRoaXMgbWV0aG9kIHdpbGwgYmUgY2FsbGVkIG9ubHkgb25jZSwgYmVmb3JlDQogICAgICAgIC8vLyBhbnkgW1Rlc3RTZXR1cF0gbWV0aG9kcyBhcmUgY2FsbGVkLg0KICAgICAgICAvLy8gSWYgeW91IG92ZXJyaWRlIHRoaXMgbWV0aG9kIHlvdSBtdXN0IGNhbGwgYmFzZS5HbG9iYWxUZXN0U2V0dXAoKSBhdCB0aGUgYmVnaW5uaW5nLg0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBbR2xvYmFsVGVzdFNldHVwXQ0KICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIEdsb2JhbFRlc3RTZXR1cCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIFByZWNvbmRpdGlvbnMgLSBlbnN1cmUgdGhpcyBzZXR1cCBpcyBvbmx5IGNhbGxlZCBvbmNlDQogICAgICAgICAgICBEYXRhU3RyZXNzRXJyb3JzLkFzc2VydChzdHJpbmcuSXNOdWxsT3JFbXB0eShzX3NjZW5hcmlvKSwgIlNjZW5hcmlvIHdhcyBhbHJlYWR5IHNldCIpOw0KICAgICAgICAgICAgRGF0YVN0cmVzc0Vycm9ycy5Bc3NlcnQoc19zb3VyY2UgPT0gbnVsbCwgIlNvdXJjZSB3YXMgYWxyZWFkeSBzZXQiKTsNCiAgICAgICAgICAgIERhdGFTdHJlc3NFcnJvcnMuQXNzZXJ0KHNfZmFjdG9yeSA9PSBudWxsLCAiRmFjdG9yeSB3YXMgYWxyZWFkeSBzZXQiKTsNCg0KICAgICAgICAgICAgLy8gU2V0IG1fc2NlbmFyaW8NCiAgICAgICAgICAgIHN0cmluZyB1c2VyUHJvdmlkZWRTY2VuYXJpbzsNCiAgICAgICAgICAgIFRlc3RNZXRyaWNzLk92ZXJyaWRlcy5UcnlHZXRWYWx1ZSgic2NlbmFyaW8iLCBvdXQgdXNlclByb3ZpZGVkU2NlbmFyaW8pOw0KICAgICAgICAgICAgLy8gRW1wdHkgbWVhbnMgZGVmYXVsdCBzY2VuYXJpbyBmb3IgdGhlIHRlc3QgZ3JvdXANCiAgICAgICAgICAgIHNfc2NlbmFyaW8gPSAodXNlclByb3ZpZGVkU2NlbmFyaW8gPz8gc3RyaW5nLkVtcHR5KTsNCiAgICAgICAgICAgIHNfc2NlbmFyaW8gPSBzX3NjZW5hcmlvLlRvVXBwZXJJbnZhcmlhbnQoKTsNCg0KICAgICAgICAgICAgLy8gU2V0IG1fc291cmNlDQogICAgICAgICAgICAvLyBFbXB0eSBtZWFucyB0aGF0IHRlc3QgZ3JvdXAgd2lsbCBwZWVrIHRoZSBkZWZhdWx0IGRhdGEgc291cmNlIGZyb20gdGhlIGNvbmZpZyBmaWxlIGJhc2VkIG9uIHRoZSBzY2VuYXJpbw0KICAgICAgICAgICAgc3RyaW5nIHVzZXJQcm92aWRlZFNvdXJjZU5hbWU7DQogICAgICAgICAgICBpZiAoVGVzdE1ldHJpY3MuT3ZlcnJpZGVzLlRyeUdldFZhbHVlKCJzb3VyY2UiLCBvdXQgdXNlclByb3ZpZGVkU291cmNlTmFtZSkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc19zb3VyY2UgPSBEYXRhU3RyZXNzU2V0dGluZ3MuSW5zdGFuY2UuR2V0U291cmNlQnlOYW1lKHVzZXJQcm92aWRlZFNvdXJjZU5hbWUpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBTZXQgbV9mYWN0b3J5DQogICAgICAgICAgICBzX2ZhY3RvcnkgPSBDcmVhdGVGYWN0b3J5KHJlZiBzX3NjZW5hcmlvLCByZWYgc19zb3VyY2UpOw0KICAgICAgICAgICAgc19mYWN0b3J5LkluaXRpYWxpemVTaGFyZWREYXRhKHNfc291cmNlKTsNCg0KICAgICAgICAgICAgLy8gUG9zdGNvbmRpdGlvbnMNCiAgICAgICAgICAgIERhdGFTdHJlc3NFcnJvcnMuQXNzZXJ0KCFzdHJpbmcuSXNOdWxsT3JFbXB0eShzX3NjZW5hcmlvKSwgIlNjZW5hcmlvIHdhcyBub3Qgc2V0Iik7DQogICAgICAgICAgICBEYXRhU3RyZXNzRXJyb3JzLkFzc2VydChzX3NvdXJjZSAhPSBudWxsLCAiU291cmNlIHdhcyBub3Qgc2V0Iik7DQogICAgICAgICAgICBEYXRhU3RyZXNzRXJyb3JzLkFzc2VydChzX2ZhY3RvcnkgIT0gbnVsbCwgIkZhY3Rvcnkgd2FzIG5vdCBzZXQiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIERvZXMgdGVzdCBjbGVhbnVwIHRoYXQgaXMgc2hhcmVkIGFjcm9zcyBhbGwgdGhyZWFkcy4gVGhpcyBtZXRob2Qgd2lsbCBub3QgYmUgY2FsbGVkIHVudGlsIGFsbA0KICAgICAgICAvLy8gdGhyZWFkcyBoYXZlIGZpbmlzaGVkIGV4ZWN1dGluZyBbU3RyZXNzVGVzdF0gbWV0aG9kcy4gVGhpcyBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgb25seSBvbmNlLg0KICAgICAgICAvLy8gSWYgeW91IG92ZXJyaWRlIHRoaXMgbWV0aG9kIHlvdSBtdXN0IGNhbGwgYmFzZS5HbG9iYWxUZXN0U2V0dXAoKSBhdCB0aGUgYmVnaW5uaW5nLg0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBbR2xvYmFsVGVzdENsZWFudXBdDQogICAgICAgIHB1YmxpYyB2aXJ0dWFsIHZvaWQgR2xvYmFsVGVzdENsZWFudXAoKQ0KICAgICAgICB7DQogICAgICAgICAgICBzX2ZhY3RvcnkuQ2xlYW51cFNoYXJlZERhdGEoKTsNCiAgICAgICAgICAgIHNfc291cmNlID0gbnVsbDsNCiAgICAgICAgICAgIHNfc2NlbmFyaW8gPSBudWxsOw0KICAgICAgICAgICAgc19mYWN0b3J5LkRpc3Bvc2UoKTsNCiAgICAgICAgICAgIHNfZmFjdG9yeSA9IG51bGw7DQogICAgICAgIH0NCg0KDQogICAgICAgIHByb3RlY3RlZCBib29sIE9wZW5Db25uZWN0aW9uKERhdGFTdHJlc3NDb25uZWN0aW9uIGNvbm4pDQogICAgICAgIHsNCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGNvbm4uT3BlbigpOw0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChJc1NlcnZlck5vdEFjY2Vzc2libGVFeGNlcHRpb24oZSwgY29ubi5EYkNvbm5lY3Rpb24uQ29ubmVjdGlvblN0cmluZywgY29ubi5EYkNvbm5lY3Rpb24uRGF0YVNvdXJjZSkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgdGhpcyBleGNlcHRpb24uDQogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZXhjZXB0aW9uIHdpbGwgZmlyZSB3aGVuIHVzaW5nIG5hbWVkIHBpcGVzIHdpdGggTXVsdGlTdWJuZXRGYWlsb3ZlciBvcHRpb24gc2V0IHRvIHRydWUuDQogICAgICAgICAgICAgICAgICAgIC8vIE11bHRpU3VibmV0RmFpbG92ZXI9dHJ1ZSBvbmx5IHdvcmtzIHdpdGggVENQL0lQIHByb3RvY29sIGFuZCB3aWxsIHJlc3VsdCBpbiBleGNlcHRpb24gd2hlbiB1c2luZyB3aXRoIG5hbWVkIHBpcGVzLg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IGU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCg0KICAgICAgICBbR2xvYmFsRXhjZXB0aW9uSGFuZGxlcl0NCiAgICAgICAgcHVibGljIHZpcnR1YWwgdm9pZCBHbG9iYWxFeGNlcHRpb25IYW5kbGVyKEV4Y2VwdGlvbiBlKQ0KICAgICAgICB7DQogICAgICAgIH0NCg0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBkYXRhcmVhZGVyIHNob3VsZCBiZSBjbG9zZWQNCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgcHJvdGVjdGVkIHZpcnR1YWwgYm9vbCBTaG91bGRDbG9zZURhdGFSZWFkZXIoKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBJZ25vcmUgY29tbWFuZENhbmNlbGxlZCwgaW5zdGVhZCByYW5kb21seSBjbG9zZSBpdCA5LzEwIG9mIHRoZSB0aW1lDQogICAgICAgICAgICByZXR1cm4gUmFuZG9tSW5zdGFuY2UuTmV4dCgxMCkgIT0gMDsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgI3JlZ2lvbglDb21tYW5kRXhlY3V0ZSBhbmQgQ29uc3VtZSBtZXRob2RzDQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gVXRpbGl0eSBmdW5jdGlvbiB1c2VkIGJ5IGNvbW1hbmQgdGVzdHMNCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgcHJvdGVjdGVkIHZpcnR1YWwgdm9pZCBDb21tYW5kRXhlY3V0ZShSYW5kb20gcm5kLCBEYkNvbW1hbmQgY29tLCBib29sIHF1ZXJ5KQ0KICAgICAgICB7DQogICAgICAgICAgICBBc3luY1V0aWxzLldhaXRBbmRVbndyYXBFeGNlcHRpb24oQ29tbWFuZEV4ZWN1dGVBc3luYyhybmQsIGNvbSwgcXVlcnkpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHByb3RlY3RlZCBhc3luYyB2aXJ0dWFsIFRhc2sgQ29tbWFuZEV4ZWN1dGVBc3luYyhSYW5kb20gcm5kLCBEYkNvbW1hbmQgY29tLCBib29sIHF1ZXJ5KQ0KICAgICAgICB7DQogICAgICAgICAgICBDYW5jZWxsYXRpb25Ub2tlblNvdXJjZSBjdHMgPSBudWxsOw0KDQogICAgICAgICAgICAvLyBDYW5jZWwgMS8xMCBjb21tYW5kcw0KICAgICAgICAgICAgVGFzayBjYW5jZWxUYXNrID0gbnVsbDsNCiAgICAgICAgICAgIGJvb2wgY2FuY2VsQ29tbWFuZCA9IHJuZC5OZXh0Qm9vbCgwLjEpOw0KICAgICAgICAgICAgaWYgKGNhbmNlbENvbW1hbmQpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKHJuZC5OZXh0Qm9vbCgpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIERiQ29tbWFuZC5DYW5jZWwNCiAgICAgICAgICAgICAgICAgICAgY2FuY2VsVGFzayA9IFRhc2suUnVuKCgpID0+IENvbW1hbmRDYW5jZWwoY29tKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vIFVzZSBDYW5jZWxsYXRpb25Ub2tlblNvdXJjZQ0KICAgICAgICAgICAgICAgICAgICBpZiAoY3RzID09IG51bGwpIGN0cyA9IG5ldyBDYW5jZWxsYXRpb25Ub2tlblNvdXJjZSgpOw0KICAgICAgICAgICAgICAgICAgICBjYW5jZWxUYXNrID0gVGFzay5SdW4oKCkgPT4gY3RzLkNhbmNlbCgpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIEdldCB0aGUgQ2FuY2VsbGF0aW9uVG9rZW4NCiAgICAgICAgICAgIENhbmNlbGxhdGlvblRva2VuIHRva2VuID0gKGN0cyAhPSBudWxsKSA/IGN0cy5Ub2tlbiA6IENhbmNlbGxhdGlvblRva2VuLk5vbmU7DQoNCiAgICAgICAgICAgIERhdGFTdHJlc3NSZWFkZXIgcmVhZGVyID0gbnVsbDsNCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChxdWVyeSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIENvbW1hbmRCZWhhdmlvciBjb21tYW5kQmVoYXZpb3IgPSBDb21tYW5kQmVoYXZpb3IuRGVmYXVsdDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHJuZC5OZXh0Qm9vbCgwLjUpKSBjb21tYW5kQmVoYXZpb3IgfD0gQ29tbWFuZEJlaGF2aW9yLlNlcXVlbnRpYWxBY2Nlc3M7DQogICAgICAgICAgICAgICAgICAgIGlmIChybmQuTmV4dEJvb2woMC4yNSkpIGNvbW1hbmRCZWhhdmlvciB8PSBDb21tYW5kQmVoYXZpb3IuS2V5SW5mbzsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHJuZC5OZXh0Qm9vbCgwLjEpKSBjb21tYW5kQmVoYXZpb3IgfD0gQ29tbWFuZEJlaGF2aW9yLlNjaGVtYU9ubHk7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRoZSByZWFkZXINCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyID0gbmV3IERhdGFTdHJlc3NSZWFkZXIoYXdhaXQgY29tLkV4ZWN1dGVSZWFkZXJTeW5jT3JBc3luYyhjb21tYW5kQmVoYXZpb3IsIHRva2VuLCBybmQpKTsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBDb25zdW1lIHRoZSByZWFkZXIncyBkYXRhDQogICAgICAgICAgICAgICAgICAgIGF3YWl0IENvbnN1bWVSZWFkZXJBc3luYyhyZWFkZXIsIGNvbW1hbmRCZWhhdmlvci5IYXNGbGFnKENvbW1hbmRCZWhhdmlvci5TZXF1ZW50aWFsQWNjZXNzKSwgdG9rZW4sIHJuZCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGNvbS5FeGVjdXRlTm9uUXVlcnlTeW5jT3JBc3luYyh0b2tlbiwgcm5kKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKGNhbmNlbENvbW1hbmQgJiYgSXNDb21tYW5kQ2FuY2VsbGVkRXhjZXB0aW9uKGUpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2F0Y2ggY29tbWFuZCBjYW5jZWxlZCBleGNlcHRpb24NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZmluYWxseQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChjYW5jZWxUYXNrICE9IG51bGwpIEFzeW5jVXRpbHMuV2FpdEFuZFVud3JhcEV4Y2VwdGlvbihjYW5jZWxUYXNrKTsNCiAgICAgICAgICAgICAgICBpZiAocmVhZGVyICE9IG51bGwgJiYgU2hvdWxkQ2xvc2VEYXRhUmVhZGVyKCkpIHJlYWRlci5DbG9zZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gVXRpbGl0eSBmdW5jdGlvbiB0byBjb25zdW1lIGEgcmVhZGVyIGluIGEgcmFuZG9tIGZhc2hpb24NCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgcHJvdGVjdGVkIHZpcnR1YWwgYXN5bmMgVGFzayBDb25zdW1lUmVhZGVyQXN5bmMoRGF0YVN0cmVzc1JlYWRlciByZWFkZXIsIGJvb2wgc2VxdWVudGlhbEFjY2VzcywgQ2FuY2VsbGF0aW9uVG9rZW4gdG9rZW4sIFJhbmRvbSBybmQpDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIENsb3NlIDEvMTAgb2YgcmVhZGVycyB3aGlsZSB0aGV5IGFyZSByZWFkaW5nDQogICAgICAgICAgICBUYXNrIGNsb3NlVGFzayA9IG51bGw7DQogICAgICAgICAgICBpZiAoQWxsb3dSZWFkZXJDbG9zZUR1cmluZ1JlYWRBc3luYygpICYmIHJuZC5OZXh0Qm9vbCgwLjEpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIEJlZ2luIGNsb3Npbmcgbm93IG9uIGFub3RoZXIgdGhyZWFkDQogICAgICAgICAgICAgICAgY2xvc2VUYXNrID0gcmVhZGVyLkNsb3NlQXN5bmMoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZG8NCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHdoaWxlIChhd2FpdCByZWFkZXIuUmVhZFN5bmNPckFzeW5jKHRva2VuLCBybmQpKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBPcHRpb25hbGx5IHN0b3AgcmVhZGluZyB0aGUgY3VycmVudCByZXN1bHQgc2V0DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocm5kLk5leHRCb29sKDAuMSkpIGJyZWFrOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIHRoZSBjdXJyZW50IHJvdw0KICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgQ29uc3VtZVJvd0FzeW5jKHJlYWRlciwgc2VxdWVudGlhbEFjY2VzcywgdG9rZW4sIHJuZCk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRpbmcgTmV4dFJlc3VsdCBvbmx5IDUwJSBvZiB0aGUgdGltZQ0KICAgICAgICAgICAgICAgICAgICBpZiAocm5kLk5leHRCb29sKCkpDQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9IHdoaWxlIChhd2FpdCByZWFkZXIuTmV4dFJlc3VsdFN5bmNPckFzeW5jKHRva2VuLCBybmQpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoY2xvc2VUYXNrICE9IG51bGwgJiYgSXNSZWFkZXJDbG9zZWRFeGNlcHRpb24oZSkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBDYXRjaCByZWFkZXIgY2xvc2VkIGV4Y2VwdGlvbg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmaW5hbGx5DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKGNsb3NlVGFzayAhPSBudWxsKSBBc3luY1V0aWxzLldhaXRBbmRVbndyYXBFeGNlcHRpb24oY2xvc2VUYXNrKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIFV0aWxpdHkgZnVuY3Rpb24gdG8gY29uc3VtZSBhIHNpbmdsZSByb3cgb2YgYSByZWFkZXIgaW4gYSByYW5kb20gZmFzaGlvbiBhZnRlciBSZWFkL1JlYWRBc3luYyBoYXMgYmVlbiBpbnZva2VkLg0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBwcm90ZWN0ZWQgdmlydHVhbCBhc3luYyBUYXNrIENvbnN1bWVSb3dBc3luYyhEYXRhU3RyZXNzUmVhZGVyIHJlYWRlciwgYm9vbCBzZXF1ZW50aWFsQWNjZXNzLCBDYW5jZWxsYXRpb25Ub2tlbiB0b2tlbiwgUmFuZG9tIHJuZCkNCiAgICAgICAgew0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCByZWFkZXIuRmllbGRDb3VudDsgaSsrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChybmQuTmV4dCgxMCkgPT0gMCkgYnJlYWs7IC8vIHN0b3AgcmVhZGluZyBmcm9tIHRoaXMgcm93DQogICAgICAgICAgICAgICAgaWYgKHJuZC5OZXh0KDIpID09IDApIGNvbnRpbnVlOyAvLyBza2lwIHRoaXMgZmllbGQNCiAgICAgICAgICAgICAgICBib29sIGhhc0JlZW5SZWFkID0gZmFsc2U7DQoNCiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgZmllbGQgaXMgbm90IG51bGwsIHdlIGNhbiBvcHRpb25hbGx5IHVzZSBzdHJlYW1pbmcgQVBJDQogICAgICAgICAgICAgICAgaWYgKCghYXdhaXQgcmVhZGVyLklzREJOdWxsU3luY09yQXN5bmMoaSwgdG9rZW4sIHJuZCkpICYmIChybmQuTmV4dEJvb2woKSkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBUeXBlIHQgPSByZWFkZXIuR2V0RmllbGRUeXBlKGkpOw0KICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSB0eXBlb2YoYnl0ZVtdKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgQ29uc3VtZUJ5dGVzQXN5bmMocmVhZGVyLCBpLCB0b2tlbiwgcm5kKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhhc0JlZW5SZWFkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0ID09IHR5cGVvZihzdHJpbmcpKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBDb25zdW1lQ2hhcnNBc3luYyhyZWFkZXIsIGksIHRva2VuLCBybmQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGFzQmVlblJlYWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gSWYgdGhlIGZpZWxkIGhhcyBub3QgeWV0IGJlZW4gcmVhZCwgb3IgaWYgaXQgaXMgbm9uLXNlcXVlbnRpYWwgdGhlbiB3ZSBjYW4gcmUtcmVhZCBpdA0KICAgICAgICAgICAgICAgIGlmICgoIWhhc0JlZW5SZWFkKSB8fCAoIXNlcXVlbnRpYWxBY2Nlc3MpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFhd2FpdCByZWFkZXIuSXNEQk51bGxTeW5jT3JBc3luYyhpLCB0b2tlbiwgcm5kKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmllbGQgdmFsdWUgaXMgbm90IG51bGwsIHdlIGNhbiB1c2UgbmV3IEdldEZpZWxkVmFsdWU8VD4gbWV0aG9kcw0KICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVhZGVyLkdldFZhbHVlU3luY09yQXN5bmMoaSwgdG9rZW4sIHJuZCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBGaWVsZCB2YWx1ZSBpcyBudWxsLCB3ZSBoYXZlIHRvIHVzZSBvbGQgR2V0VmFsdWUgbWV0aG9kDQogICAgICAgICAgICAgICAgICAgICAgICByZWFkZXIuR2V0VmFsdWUoaSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBEbyBJc0RCTnVsbCBjaGVjayBhZ2FpbiB3aXRoIDUwJSBwcm9iYWJpbGl0eQ0KICAgICAgICAgICAgICAgIGlmIChybmQuTmV4dEJvb2woKSkgYXdhaXQgcmVhZGVyLklzREJOdWxsU3luY09yQXN5bmMoaSwgdG9rZW4sIHJuZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBwcm90ZWN0ZWQgdmlydHVhbCBhc3luYyBUYXNrIENvbnN1bWVCeXRlc0FzeW5jKERhdGFTdHJlc3NSZWFkZXIgcmVhZGVyLCBpbnQgaSwgQ2FuY2VsbGF0aW9uVG9rZW4gdG9rZW4sIFJhbmRvbSBybmQpDQogICAgICAgIHsNCiAgICAgICAgICAgIGJ5dGVbXSBidWZmZXIgPSBuZXcgYnl0ZVsyNTVdOw0KDQogICAgICAgICAgICBpZiAocm5kLk5leHRCb29sKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gV2UgY2FuIG9wdGlvbmFsbHkgdXNlIEdldEJ5dGVzDQogICAgICAgICAgICAgICAgcmVhZGVyLkdldEJ5dGVzKGksIHJuZC5OZXh0KDIwKSwgYnVmZmVyLCBybmQuTmV4dCgyMCksIHJuZC5OZXh0KDIwMCkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSBpZiAocmVhZGVyLkdldE5hbWUoaSkgIT0gInRpbWVzdGFtcF9GTEQiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIFRpbWVzdGFtcCBhcHBlYXJzIHRvIGJlIGJpbmFyeSwgYnV0IGNhbm5vdCBiZSByZWFkIGJ5IFN0cmVhbQ0KICAgICAgICAgICAgICAgIERhdGFTdHJlc3NTdHJlYW0gc3RyZWFtID0gcmVhZGVyLkdldFN0cmVhbShpKTsNCiAgICAgICAgICAgICAgICBhd2FpdCBzdHJlYW0uUmVhZFN5bmNPckFzeW5jKGJ1ZmZlciwgcm5kLk5leHQoMjApLCBybmQuTmV4dCgyMDApLCB0b2tlbiwgcm5kKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBJdCBpcyB0aW1lc3RhbXAgY29sdW1uLCBzbyByZWFkIGl0IGxhdGVyIHdpdGggR2V0VmFsdWVTeW5jT3JBc3luYw0KICAgICAgICAgICAgICAgIGF3YWl0IHJlYWRlci5HZXRWYWx1ZVN5bmNPckFzeW5jKGksIHRva2VuLCBybmQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcHJvdGVjdGVkIHZpcnR1YWwgYXN5bmMgVGFzayBDb25zdW1lQ2hhcnNBc3luYyhEYXRhU3RyZXNzUmVhZGVyIHJlYWRlciwgaW50IGksIENhbmNlbGxhdGlvblRva2VuIHRva2VuLCBSYW5kb20gcm5kKQ0KICAgICAgICB7DQogICAgICAgICAgICBjaGFyW10gYnVmZmVyID0gbmV3IGNoYXJbMjU1XTsNCg0KICAgICAgICAgICAgaWYgKHJuZC5OZXh0Qm9vbCgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIFJlYWQgd2l0aCBHZXRDaGFycw0KICAgICAgICAgICAgICAgIHJlYWRlci5HZXRDaGFycyhpLCBybmQuTmV4dCgyMCksIGJ1ZmZlciwgcm5kLk5leHQoMjApLCBybmQuTmV4dCgyMDApKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYgKHJlYWRlci5HZXRQcm92aWRlclNwZWNpZmljRmllbGRUeXBlKGkpID09IHR5cGVvZihTcWxYbWwpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIFNxbENsaWVudCBvbmx5OiBYbWwgaXMgcmVhZCBieSBYbWxSZWFkZXINCiAgICAgICAgICAgICAgICBEYXRhU3RyZXNzWG1sUmVhZGVyIHhtbFJlYWRlciA9IHJlYWRlci5HZXRYbWxSZWFkZXIoaSk7DQogICAgICAgICAgICAgICAgeG1sUmVhZGVyLlJlYWQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBSZWFkIHdpdGggVGV4dFJlYWRlcg0KICAgICAgICAgICAgICAgIERhdGFTdHJlc3NUZXh0UmVhZGVyIHRleHRSZWFkZXIgPSByZWFkZXIuR2V0VGV4dFJlYWRlcihpKTsNCiAgICAgICAgICAgICAgICBpZiAocm5kLk5leHRCb29sKCkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB0ZXh0UmVhZGVyLlBlZWsoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYXdhaXQgdGV4dFJlYWRlci5SZWFkU3luY09yQXN5bmMoYnVmZmVyLCBybmQuTmV4dCgyMCksIHJuZC5OZXh0KDIwMCksIHJuZCk7DQogICAgICAgICAgICAgICAgaWYgKHJuZC5OZXh0Qm9vbCgpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdGV4dFJlYWRlci5QZWVrKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBleGNlcHRpb24gaXMgZXhwZWN0ZWQgZm9yIHRoZSBjdXJyZW50IHByb3ZpZGVyIHdoZW4gYSBjb21tYW5kIGlzIGNhbmNlbGxlZCBieSBhbm90aGVyIHRocmVhZC4NCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJlIj48L3BhcmFtPg0KICAgICAgICBwcm90ZWN0ZWQgdmlydHVhbCBib29sIElzQ29tbWFuZENhbmNlbGxlZEV4Y2VwdGlvbihFeGNlcHRpb24gZSkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIGUgaXMgVGFza0NhbmNlbGVkRXhjZXB0aW9uOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBleGNlcHRpb24gaXMgZXhwZWN0ZWQgZm9yIHRoZSBjdXJyZW50IHByb3ZpZGVyIHdoZW4gdHJ5aW5nIHRvIHJlYWQgZnJvbSBhIHJlYWRlciB0aGF0IGhhcyBiZWVuIGNsb3NlZA0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICAvLy8gPHBhcmFtIG5hbWU9ImUiPjwvcGFyYW0+DQogICAgICAgIHByb3RlY3RlZCB2aXJ0dWFsIGJvb2wgSXNSZWFkZXJDbG9zZWRFeGNlcHRpb24oRXhjZXB0aW9uIGUpDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gZXhjZXB0aW9uIGlzIGV4cGVjdGVkIGZvciB0aGUgY3VycmVudCBwcm92aWRlciB3aGVuIHRyeWluZyB0byBjb25uZWN0IHRvIHVuYXZhaWxhYmxlL25vbi1leGlzdGVudCBzZXJ2ZXINCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJlIj48L3BhcmFtPg0KICAgICAgICBwcm90ZWN0ZWQgYm9vbCBJc1NlcnZlck5vdEFjY2Vzc2libGVFeGNlcHRpb24oRXhjZXB0aW9uIGUsIHN0cmluZyBjb25uU3RyaW5nLCBzdHJpbmcgZGF0YVNvdXJjZSkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgZSBpcyBBcmd1bWVudEV4Y2VwdGlvbiAmJg0KICAgICAgICAgICAgICAgIGNvbm5TdHJpbmcuQ29udGFpbnMoIk11bHRpU3VibmV0RmFpbG92ZXI9VHJ1ZSIpICYmDQogICAgICAgICAgICAgICAgZGF0YVNvdXJjZS5Db250YWlucygibnA6IikgJiYNCiAgICAgICAgICAgICAgICBlLk1lc3NhZ2UuQ29udGFpbnMoIkNvbm5lY3RpbmcgdG8gYSBTUUwgU2VydmVyIGluc3RhbmNlIHVzaW5nIHRoZSBNdWx0aVN1Ym5ldEZhaWxvdmVyIGNvbm5lY3Rpb24gb3B0aW9uIGlzIG9ubHkgc3VwcG9ydGVkIHdoZW4gdXNpbmcgdGhlIFRDUCBwcm90b2NvbC4iKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIFJldHVybnMgdHJ1ZSBpZiB0aGUgYmFja2VuZCBwcm92aWRlciBzdXBwb3J0cyBjbG9zaW5nIGEgZGF0YXJlYWRlciB3aGlsZSBhc3luY2hyb25vdXNseSByZWFkaW5nIGZyb20gaXQNCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgLy8vIDxyZXR1cm5zPjwvcmV0dXJucz4NCiAgICAgICAgcHJvdGVjdGVkIHZpcnR1YWwgYm9vbCBBbGxvd1JlYWRlckNsb3NlRHVyaW5nUmVhZEFzeW5jKCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gVGhyZWFkIENhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIGNhbmNlbHMgcXVlcmllcyB1c2luZyBEYkNvbW1hbmQuQ2FuY2VsKCkNCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJjbWQiPjwvcGFyYW0+DQogICAgICAgIHByb3RlY3RlZCB2b2lkIENvbW1hbmRDYW5jZWwob2JqZWN0IG8pDQogICAgICAgIHsNCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIERiQ29tbWFuZCBjbWQgPSAoRGJDb21tYW5kKW87DQogICAgICAgICAgICAgICAgY21kLkNhbmNlbCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBUcmFjZS5Xcml0ZUxpbmUoZXguVG9TdHJpbmcoKSwgdGhpcy5Ub1N0cmluZygpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICNlbmRyZWdpb24NCg0KICAgICAgICAjcmVnaW9uCUNvbW1hbmQgYW5kIFBhcmFtZXRlciBUZXN0cw0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIENvbW1hbmQgUmVhZGVyIFRlc3Q6IEV4ZWN1dGVzIGEgc2ltcGxlIFNFTEVDVCBzdGF0ZW1lbnQgd2l0aG91dCBwYXJhbWV0ZXJzDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIFtTdHJlc3NUZXN0KCJUZXN0Q29tbWFuZFJlYWRlciIsIFdlaWdodCA9IDEwKV0NCiAgICAgICAgcHVibGljIHZvaWQgVGVzdENvbW1hbmRSZWFkZXIoKQ0KICAgICAgICB7DQogICAgICAgICAgICBSYW5kb20gcm5kID0gUmFuZG9tSW5zdGFuY2U7DQoNCiAgICAgICAgICAgIHVzaW5nIChEYXRhU3RyZXNzQ29ubmVjdGlvbiBjb25uID0gRmFjdG9yeS5DcmVhdGVDb25uZWN0aW9uKHJuZCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKCFPcGVuQ29ubmVjdGlvbihjb25uKSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgIERhdGFTdHJlc3NGYWN0b3J5LlRhYmxlTWV0YWRhdGEgdGFibGUgPSBGYWN0b3J5LkdldFJhbmRvbVRhYmxlKHJuZCk7DQogICAgICAgICAgICAgICAgRGJDb21tYW5kIGNvbSA9IEZhY3RvcnkuR2V0Q29tbWFuZChybmQsIHRhYmxlLCBjb25uLCB0cnVlKTsNCiAgICAgICAgICAgICAgICBDb21tYW5kRXhlY3V0ZShybmQsIGNvbSwgdHJ1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBDb21tYW5kIFNlbGVjdCBUZXN0OiBFeGVjdXRlcyBhIHNpbmdsZSBTRUxFQ1Qgc3RhdGVtZW50IHdpdGggcGFyYW1ldGVycw0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBbU3RyZXNzVGVzdCgiVGVzdENvbW1hbmRTZWxlY3QiLCBXZWlnaHQgPSAxMCldDQogICAgICAgIHB1YmxpYyB2b2lkIFRlc3RDb21tYW5kU2VsZWN0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgUmFuZG9tIHJuZCA9IFJhbmRvbUluc3RhbmNlOw0KDQogICAgICAgICAgICB1c2luZyAoRGF0YVN0cmVzc0Nvbm5lY3Rpb24gY29ubiA9IEZhY3RvcnkuQ3JlYXRlQ29ubmVjdGlvbihybmQpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICghT3BlbkNvbm5lY3Rpb24oY29ubikpIHJldHVybjsNCiAgICAgICAgICAgICAgICBEYXRhU3RyZXNzRmFjdG9yeS5UYWJsZU1ldGFkYXRhIHRhYmxlID0gRmFjdG9yeS5HZXRSYW5kb21UYWJsZShybmQpOw0KICAgICAgICAgICAgICAgIERiQ29tbWFuZCBjb20gPSBGYWN0b3J5LkdldFNlbGVjdENvbW1hbmQocm5kLCB0YWJsZSwgY29ubik7DQogICAgICAgICAgICAgICAgQ29tbWFuZEV4ZWN1dGUocm5kLCBjb20sIHRydWUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gQ29tbWFuZCBJbnNlcnQgVGVzdDogRXhlY3V0ZXMgYSBzaW5nbGUgSU5TRVJUIHN0YXRlbWVudCB3aXRoIHBhcmFtZXRlcnMNCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgW1N0cmVzc1Rlc3QoIlRlc3RDb21tYW5kSW5zZXJ0IiwgV2VpZ2h0ID0gMTApXQ0KICAgICAgICBwdWJsaWMgdm9pZCBUZXN0Q29tbWFuZEluc2VydCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFJhbmRvbSBybmQgPSBSYW5kb21JbnN0YW5jZTsNCg0KICAgICAgICAgICAgdXNpbmcgKERhdGFTdHJlc3NDb25uZWN0aW9uIGNvbm4gPSBGYWN0b3J5LkNyZWF0ZUNvbm5lY3Rpb24ocm5kKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoIU9wZW5Db25uZWN0aW9uKGNvbm4pKSByZXR1cm47DQogICAgICAgICAgICAgICAgRGF0YVN0cmVzc0ZhY3RvcnkuVGFibGVNZXRhZGF0YSB0YWJsZSA9IEZhY3RvcnkuR2V0UmFuZG9tVGFibGUocm5kKTsNCiAgICAgICAgICAgICAgICBEYkNvbW1hbmQgY29tID0gRmFjdG9yeS5HZXRJbnNlcnRDb21tYW5kKHJuZCwgdGFibGUsIGNvbm4pOw0KICAgICAgICAgICAgICAgIENvbW1hbmRFeGVjdXRlKHJuZCwgY29tLCBmYWxzZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBDb21tYW5kIFVwZGF0ZSBUZXN0OiBFeGVjdXRlcyBhIHNpbmdsZSBVUERBVEUgc3RhdGVtZW50IHdpdGggcGFyYW1ldGVycw0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBbU3RyZXNzVGVzdCgiVGVzdENvbW1hbmRVcGRhdGUiLCBXZWlnaHQgPSAxMCldDQogICAgICAgIHB1YmxpYyB2b2lkIFRlc3RDb21tYW5kVXBkYXRlKCkNCiAgICAgICAgew0KICAgICAgICAgICAgUmFuZG9tIHJuZCA9IFJhbmRvbUluc3RhbmNlOw0KDQogICAgICAgICAgICB1c2luZyAoRGF0YVN0cmVzc0Nvbm5lY3Rpb24gY29ubiA9IEZhY3RvcnkuQ3JlYXRlQ29ubmVjdGlvbihybmQpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICghT3BlbkNvbm5lY3Rpb24oY29ubikpIHJldHVybjsNCiAgICAgICAgICAgICAgICBEYXRhU3RyZXNzRmFjdG9yeS5UYWJsZU1ldGFkYXRhIHRhYmxlID0gRmFjdG9yeS5HZXRSYW5kb21UYWJsZShybmQpOw0KICAgICAgICAgICAgICAgIERiQ29tbWFuZCBjb20gPSBGYWN0b3J5LkdldFVwZGF0ZUNvbW1hbmQocm5kLCB0YWJsZSwgY29ubik7DQogICAgICAgICAgICAgICAgQ29tbWFuZEV4ZWN1dGUocm5kLCBjb20sIGZhbHNlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIENvbW1hbmQgVXBkYXRlIFRlc3Q6IEV4ZWN1dGVzIGEgc2luZ2xlIERFTEVURSBzdGF0ZW1lbnQgd2l0aCBwYXJhbWV0ZXJzDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIFtTdHJlc3NUZXN0KCJUZXN0Q29tbWFuZERlbGV0ZSIsIFdlaWdodCA9IDEwKV0NCiAgICAgICAgcHVibGljIHZvaWQgVGVzdENvbW1hbmREZWxldGUoKQ0KICAgICAgICB7DQogICAgICAgICAgICBSYW5kb20gcm5kID0gUmFuZG9tSW5zdGFuY2U7DQoNCiAgICAgICAgICAgIHVzaW5nIChEYXRhU3RyZXNzQ29ubmVjdGlvbiBjb25uID0gRmFjdG9yeS5DcmVhdGVDb25uZWN0aW9uKHJuZCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKCFPcGVuQ29ubmVjdGlvbihjb25uKSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgIERhdGFTdHJlc3NGYWN0b3J5LlRhYmxlTWV0YWRhdGEgdGFibGUgPSBGYWN0b3J5LkdldFJhbmRvbVRhYmxlKHJuZCk7DQogICAgICAgICAgICAgICAgRGJDb21tYW5kIGNvbSA9IEZhY3RvcnkuR2V0RGVsZXRlQ29tbWFuZChybmQsIHRhYmxlLCBjb25uKTsNCiAgICAgICAgICAgICAgICBDb21tYW5kRXhlY3V0ZShybmQsIGNvbSwgZmFsc2UpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgW1N0cmVzc1Rlc3QoIlRlc3RDb21tYW5kVGltZW91dCIsIFdlaWdodCA9IDEwKV0NCiAgICAgICAgcHVibGljIHZvaWQgVGVzdENvbW1hbmRUaW1lb3V0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgUmFuZG9tIHJuZCA9IFJhbmRvbUluc3RhbmNlOw0KICAgICAgICAgICAgRGF0YVN0cmVzc0Nvbm5lY3Rpb24gY29ubiA9IG51bGw7DQogICAgICAgICAgICB0cnkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBVc2UgYSB0cmFuc2FjdGlvbiA1MCUgb2YgdGhlIHRpbWUNCiAgICAgICAgICAgICAgICBpZiAocm5kLk5leHRCb29sKCkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIHNlbGVjdCBjb21tYW5kDQogICAgICAgICAgICAgICAgY29ubiA9IEZhY3RvcnkuQ3JlYXRlQ29ubmVjdGlvbihybmQpOw0KICAgICAgICAgICAgICAgIGlmICghT3BlbkNvbm5lY3Rpb24oY29ubikpIHJldHVybjsNCiAgICAgICAgICAgICAgICBEYXRhU3RyZXNzRmFjdG9yeS5UYWJsZU1ldGFkYXRhIHRhYmxlID0gRmFjdG9yeS5HZXRSYW5kb21UYWJsZShybmQpOw0KICAgICAgICAgICAgICAgIERiQ29tbWFuZCBjb20gPSBGYWN0b3J5LkdldFNlbGVjdENvbW1hbmQocm5kLCB0YWJsZSwgY29ubik7DQoNCiAgICAgICAgICAgICAgICAvLyBTZXR1cCB0aW1lb3V0LiBXZSB3YW50IHRvIHNlZSB2YXJpb3VzIHBvc3NpYmlsaXRpZXMgb2YgdGltZW91dCBoYXBwZW5pbmcgYmVmb3JlLCBhZnRlciwgb3IgYXQgdGhlIHNhbWUgdGltZSBhcyB3aGVuIHRoZSByZXN1bHQgY29tZXMgaW4uDQogICAgICAgICAgICAgICAgaW50IGRlbGF5ID0gcm5kLk5leHQoMCwgMTApOyAvLyBkZWxheSBpcyBmcm9tIDAgdG8gOSBzZWNvbmRzIGluY2x1c2l2ZQ0KICAgICAgICAgICAgICAgIGludCB0aW1lb3V0ID0gcm5kLk5leHQoMSwgMTApOyAvLyB0aW1lb3V0IGlzIGZyb20gMSB0byA5IHNlY29uZHMgaW5jbHVzaXZlDQogICAgICAgICAgICAgICAgY29tLkNvbW1hbmRUZXh0ICs9IHN0cmluZy5Gb3JtYXQoIjsgV0FJVEZPUiBERUxBWSAnMDA6MDA6MHswfSciLCBkZWxheSk7DQogICAgICAgICAgICAgICAgY29tLkNvbW1hbmRUaW1lb3V0ID0gdGltZW91dDsNCg0KICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgY29tbWFuZCBhbmQgY2F0Y2ggdGltZW91dCBleGNlcHRpb24NCiAgICAgICAgICAgICAgICB0cnkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIENvbW1hbmRFeGVjdXRlKHJuZCwgY29tLCB0cnVlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2F0Y2ggKERiRXhjZXB0aW9uIGUpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZSBpcyBTcWxFeGNlcHRpb24gJiYgKChTcWxFeGNlcHRpb24pZSkuTnVtYmVyID09IDM5ODkpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IERhdGFTdHJlc3NFcnJvcnMuUHJvZHVjdEVycm9yKCJUaW1pbmcgaXNzdWUgYmV0d2VlbiBPblRpbWVvdXQgYW5kIFJlYWRBc3luY0NhbGxiYWNrIHJlc3VsdHMgaW4gU3FsQ2xpZW50J3MgcGFja2V0IHBhcnNpbmcgZ29pbmcgb3V0IG9mIHN5bmMiLCBlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghZS5NZXNzYWdlLlRvTG93ZXIoKS5Db250YWlucygidGltZW91dCIpKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZpbmFsbHkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoY29ubiAhPSBudWxsKSBjb25uLkRpc3Bvc2UoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFtTdHJlc3NUZXN0KCJUZXN0Q29tbWFuZEFuZFJlYWRlckFzeW5jIiwgV2VpZ2h0ID0gMTApXQ0KICAgICAgICBwdWJsaWMgdm9pZCBUZXN0Q29tbWFuZEFuZFJlYWRlckFzeW5jKCkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gU2luY2Ugd2UncmUgY2FsbGluZyBhbiAiYXN5bmMiIG1ldGhvZCwgd2UgbmVlZCB0byBkbyBhIFdhaXQoKSBoZXJlLg0KICAgICAgICAgICAgQXN5bmNVdGlscy5XYWl0QW5kVW53cmFwRXhjZXB0aW9uKFRlc3RDb21tYW5kQW5kUmVhZGVyQXN5bmNJbnRlcm5hbCgpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIFV0aWxpdHkgbWV0aG9kIHRvIHRlc3QgQXN5bmMgc2NlbmFyaW8gdXNpbmcgYXdhaXQga2V5d29yZA0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICAvLy8gPHJldHVybnM+PC9yZXR1cm5zPg0KICAgICAgICBwcm90ZWN0ZWQgdmlydHVhbCBhc3luYyBUYXNrIFRlc3RDb21tYW5kQW5kUmVhZGVyQXN5bmNJbnRlcm5hbCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFJhbmRvbSBybmQgPSBSYW5kb21JbnN0YW5jZTsNCiAgICAgICAgICAgIHVzaW5nIChEYXRhU3RyZXNzQ29ubmVjdGlvbiBjb25uID0gRmFjdG9yeS5DcmVhdGVDb25uZWN0aW9uKHJuZCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKCFPcGVuQ29ubmVjdGlvbihjb25uKSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgIERhdGFTdHJlc3NGYWN0b3J5LlRhYmxlTWV0YWRhdGEgdGFibGUgPSBGYWN0b3J5LkdldFJhbmRvbVRhYmxlKHJuZCk7DQogICAgICAgICAgICAgICAgRGJDb21tYW5kIGNvbTsNCg0KICAgICAgICAgICAgICAgIGNvbSA9IEZhY3RvcnkuR2V0SW5zZXJ0Q29tbWFuZChybmQsIHRhYmxlLCBjb25uKTsNCiAgICAgICAgICAgICAgICBhd2FpdCBDb21tYW5kRXhlY3V0ZUFzeW5jKHJuZCwgY29tLCBmYWxzZSk7DQoNCiAgICAgICAgICAgICAgICBjb20gPSBGYWN0b3J5LkdldERlbGV0ZUNvbW1hbmQocm5kLCB0YWJsZSwgY29ubik7DQogICAgICAgICAgICAgICAgYXdhaXQgQ29tbWFuZEV4ZWN1dGVBc3luYyhybmQsIGNvbSwgZmFsc2UpOw0KDQogICAgICAgICAgICAgICAgY29tID0gRmFjdG9yeS5HZXRTZWxlY3RDb21tYW5kKHJuZCwgdGFibGUsIGNvbm4pOw0KICAgICAgICAgICAgICAgIGF3YWl0IGNvbS5FeGVjdXRlU2NhbGFyQXN5bmMoKTsNCg0KICAgICAgICAgICAgICAgIGNvbSA9IEZhY3RvcnkuR2V0U2VsZWN0Q29tbWFuZChybmQsIHRhYmxlLCBjb25uKTsNCiAgICAgICAgICAgICAgICBhd2FpdCBDb21tYW5kRXhlY3V0ZUFzeW5jKHJuZCwgY29tLCB0cnVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIFV0aWxpdHkgZnVuY3Rpb24gdXNlZCBieSBNQVJTIHRlc3RzDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIHByaXZhdGUgdm9pZCBUZXN0Q29tbWFuZE1BUlMoUmFuZG9tIHJuZCwgYm9vbCBxdWVyeSkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKFNvdXJjZS5UeXBlICE9IERhdGFTb3VyY2VUeXBlLlNxbFNlcnZlcikNCiAgICAgICAgICAgICAgICByZXR1cm47IC8vIHNraXAgZm9yIG5vbi1TUUwgU2VydmVyIGRhdGFiYXNlcw0KDQogICAgICAgICAgICB1c2luZyAoRGF0YVN0cmVzc0Nvbm5lY3Rpb24gY29ubiA9IEZhY3RvcnkuQ3JlYXRlQ29ubmVjdGlvbihybmQsIERhdGFTdHJlc3NGYWN0b3J5LkNvbm5lY3Rpb25TdHJpbmdPcHRpb25zLkVuYWJsZU1hcnMpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICghT3BlbkNvbm5lY3Rpb24oY29ubikpIHJldHVybjsNCiAgICAgICAgICAgICAgICBEYkNvbW1hbmRbXSBjb21tYW5kcyA9IG5ldyBEYkNvbW1hbmRbcm5kLk5leHQoNSwgMTApXTsNCiAgICAgICAgICAgICAgICBMaXN0PFRhc2s+IHRhc2tzID0gbmV3IExpc3Q8VGFzaz4oKTsNCiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgY29tbWFuZHMNCiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbW1hbmRzLkxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgRGF0YVN0cmVzc0ZhY3RvcnkuVGFibGVNZXRhZGF0YSB0YWJsZSA9IEZhY3RvcnkuR2V0UmFuZG9tVGFibGUocm5kKTsNCiAgICAgICAgICAgICAgICAgICAgY29tbWFuZHNbaV0gPSBGYWN0b3J5LkdldENvbW1hbmQocm5kLCB0YWJsZSwgY29ubiwgcXVlcnkpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSBjb21tYW5kcw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbW1hbmRzLkxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocm5kLk5leHRCb29sKDAuNykpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza3MuQWRkKENvbW1hbmRFeGVjdXRlQXN5bmMocm5kLCBjb21tYW5kc1tpXSwgcXVlcnkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb21tYW5kRXhlY3V0ZShybmQsIGNvbW1hbmRzW2ldLCBxdWVyeSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZmluYWxseQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQWxsIGNvbW1hbmRzIG11c3QgYmUgY29tcGxldGUgYmVmb3JlIGNsb3NpbmcgdGhlIGNvbm5lY3Rpb24NCiAgICAgICAgICAgICAgICAgICAgQXN5bmNVdGlscy5XYWl0QWxsKHRhc2tzLlRvQXJyYXkoKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gQ29tbWFuZCBNQVJTIFRlc3Q6IFRlc3RzIE1BUlMgYnkgZXhlY3V0aW5nIG11bHRpcGxlIHJlYWRlcnMgb24gc2FtZSBjb25uZWN0aW9uDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIFtTdHJlc3NUZXN0KCJUZXN0Q29tbWFuZE1BUlNSZWFkIiwgV2VpZ2h0ID0gMTApXQ0KICAgICAgICBwdWJsaWMgdm9pZCBUZXN0Q29tbWFuZE1BUlNSZWFkKCkNCiAgICAgICAgew0KICAgICAgICAgICAgUmFuZG9tIHJuZCA9IFJhbmRvbUluc3RhbmNlOw0KICAgICAgICAgICAgVGVzdENvbW1hbmRNQVJTKHJuZCwgdHJ1ZSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBDb21tYW5kIE1BUlMgVGVzdDogVGVzdHMgTUFSUyBieSBnZXR0aW5nIG11bHRpcGxlIGNvbm5lY3Rpb24gb2JqZWN0cyBmcm9tIHNhbWUgY29ubmVjdGlvbg0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBbU3RyZXNzVGVzdCgiVGVzdENvbW1hbmRNQVJTV3JpdGUiLCBXZWlnaHQgPSAxMCldDQogICAgICAgIHB1YmxpYyB2b2lkIFRlc3RDb21tYW5kTUFSU1dyaXRlKCkNCiAgICAgICAgew0KICAgICAgICAgICAgUmFuZG9tIHJuZCA9IFJhbmRvbUluc3RhbmNlOw0KICAgICAgICAgICAgVGVzdENvbW1hbmRNQVJTKHJuZCwgZmFsc2UpOw0KICAgICAgICB9DQoNCiAgICAgICAgI2VuZHJlZ2lvbg0KICAgIH0NCn0NCg=="
        },
        "file:///C:/corefx/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlDependencyListener.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljOw0KdXNpbmcgU3lzdGVtLkRhdGE7DQp1c2luZyBTeXN0ZW0uRGF0YS5Db21tb247DQp1c2luZyBTeXN0ZW0uRGF0YS5Qcm92aWRlckJhc2U7DQp1c2luZyBTeXN0ZW0uRGF0YS5TcWxDbGllbnQ7DQp1c2luZyBTeXN0ZW0uRGF0YS5TcWxUeXBlczsNCnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljczsNCnVzaW5nIFN5c3RlbS5UaHJlYWRpbmc7DQp1c2luZyBTeXN0ZW0uWG1sOw0KdXNpbmcgU3lzdGVtLlJ1bnRpbWUuVmVyc2lvbmluZzsNCnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljcy5Db2RlQW5hbHlzaXM7DQoNCi8vIFRoaXMgY2xhc3MgaXMgdGhlIHByb2Nlc3Mgd2lkZSBkZXBlbmRlbmN5IGRpc3BhdGNoZXIuICBJdCBjb250YWlucyBhbGwgY29ubmVjdGlvbiBsaXN0ZW5lcnMgZm9yIHRoZSBlbnRpcmUgcHJvY2VzcyBhbmQgDQovLyByZWNlaXZlcyBub3RpZmljYXRpb25zIG9uIHRob3NlIGNvbm5lY3Rpb25zIHRvIGRpc3BhdGNoIHRvIHRoZSBjb3JyZXNwb25kaW5nIEFwcERvbWFpbiBkaXNwYXRjaGVyIHRvIG5vdGlmeSB0aGUNCi8vIGFwcHJvcHJpYXRlIGRlcGVuZGVuY2llcy4NCg0KaW50ZXJuYWwgY2xhc3MgU3FsRGVwZW5kZW5jeVByb2Nlc3NEaXNwYXRjaGVyIDogTWFyc2hhbEJ5UmVmT2JqZWN0DQp7DQogICAgLy8gQ2xhc3MgdG8gY29udGFpbi9zdG9yZSBhbGwgcmVsZXZhbnQgaW5mb3JtYXRpb24gYWJvdXQgYSBjb25uZWN0aW9uIHRoYXQgd2FpdHMgb24gdGhlIFNTQiBxdWV1ZS4NCiAgICBwcml2YXRlIGNsYXNzIFNxbENvbm5lY3Rpb25Db250YWluZXINCiAgICB7DQogICAgICAgIHByaXZhdGUgU3FsQ29ubmVjdGlvbiBfY29uOw0KICAgICAgICBwcml2YXRlIFNxbENvbW1hbmQgX2NvbTsNCiAgICAgICAgcHJpdmF0ZSBTcWxQYXJhbWV0ZXIgX2NvbnZlcnNhdGlvbkd1aWRQYXJhbTsNCiAgICAgICAgcHJpdmF0ZSBTcWxQYXJhbWV0ZXIgX3RpbWVvdXRQYXJhbTsNCiAgICAgICAgcHJpdmF0ZSBTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlciBfaGFzaEhlbHBlcjsNCiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgX3F1ZXVlOw0KICAgICAgICBwcml2YXRlIHN0cmluZyBfcmVjZWl2ZVF1ZXJ5Ow0KICAgICAgICBwcml2YXRlIHN0cmluZyBfYmVnaW5Db252ZXJzYXRpb25RdWVyeTsNCiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgX2VuZENvbnZlcnNhdGlvblF1ZXJ5Ow0KICAgICAgICBwcml2YXRlIHN0cmluZyBfY29uY2F0UXVlcnk7DQogICAgICAgIHByaXZhdGUgcmVhZG9ubHkgaW50IF9kZWZhdWx0V2FpdGZvclRpbWVvdXQgPSA2MDAwMDsgLy8gV2FpdGZvcihSZWNlaXZlKSB0aW1lb3V0IChtaWxsZXNlY29uZHMpDQogICAgICAgIHByaXZhdGUgc3RyaW5nIF9lc2NhcGVkUXVldWVOYW1lOw0KICAgICAgICBwcml2YXRlIHN0cmluZyBfc3Byb2NOYW1lOw0KICAgICAgICBwcml2YXRlIHN0cmluZyBfZGlhbG9nSGFuZGxlOw0KICAgICAgICBwcml2YXRlIHN0cmluZyBfY2FjaGVkU2VydmVyOw0KICAgICAgICBwcml2YXRlIHN0cmluZyBfY2FjaGVkRGF0YWJhc2U7DQogICAgICAgIHByaXZhdGUgdm9sYXRpbGUgYm9vbCBfZXJyb3JTdGF0ZSA9IGZhbHNlOw0KICAgICAgICBwcml2YXRlIHZvbGF0aWxlIGJvb2wgX3N0b3AgPSBmYWxzZTsgLy8gQ2FuIHByb2JhYmx5IHNpbXBsaWZ5IHRoaXMgc2xpZ2h0bHkgLSBvbmUgYm9vbCBpbnN0ZWFkIG9mIHR3by4NCiAgICAgICAgcHJpdmF0ZSB2b2xhdGlsZSBib29sIF9zdG9wcGVkID0gZmFsc2U7DQogICAgICAgIHByaXZhdGUgdm9sYXRpbGUgYm9vbCBfc2VydmljZVF1ZXVlQ3JlYXRlZCA9IGZhbHNlOw0KICAgICAgICBwcml2YXRlIGludCBfc3RhcnRDb3VudCA9IDA7ICAgICAvLyBFYWNoIGNvbnRhaW5lciBjbGFzcyBpcyBjYWxsZWQgb25jZSBwZXIgU3RhcnQoKSAtIHdlIHJlZkNvdW50IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byB0cmFjayB3aGVuIHdlIGNhbiBkaXNwb3NlLg0KICAgICAgICBwcml2YXRlIFRpbWVyIF9yZXRyeVRpbWVyID0gbnVsbDsNCiAgICAgICAgcHJpdmF0ZSBEaWN0aW9uYXJ5PHN0cmluZywgaW50PiBfYXBwRG9tYWluS2V5SGFzaCA9IG51bGw7ICAvLyBBcHBEb21haW5LZXktPk9wZW4gUmVmQ291bnQNCg0KICAgICAgICAvLyBDb25zdHJ1Y3Rvcg0KDQogICAgICAgIGludGVybmFsIFNxbENvbm5lY3Rpb25Db250YWluZXIoU3FsQ29ubmVjdGlvbkNvbnRhaW5lckhhc2hIZWxwZXIgaGFzaEhlbHBlciwgc3RyaW5nIGFwcERvbWFpbktleSwgYm9vbCB1c2VEZWZhdWx0cykNCiAgICAgICAgew0KICAgICAgICAgICAgYm9vbCBzZXR1cENvbXBsZXRlZCA9IGZhbHNlOw0KICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgX2hhc2hIZWxwZXIgPSBoYXNoSGVscGVyOw0KICAgICAgICAgICAgICAgIHN0cmluZyBndWlkID0gbnVsbDsNCg0KICAgICAgICAgICAgICAgIC8vIElmIGRlZmF1bHQsIHF1ZXVlIG5hbWUgaXMgbm90IHByZXNlbnQgb24gaGFzaEhlbHBlciBhdCB0aGlzIHBvaW50IC0gc28gd2UgbmVlZCB0byANCiAgICAgICAgICAgICAgICAvLyBnZW5lcmF0ZSBvbmUgYW5kIGNvbXBsZXRlIGluaXRpYWxpemF0aW9uLg0KICAgICAgICAgICAgICAgIGlmICh1c2VEZWZhdWx0cykNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGd1aWQgPSBHdWlkLk5ld0d1aWQoKS5Ub1N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICBfcXVldWUgPSBTUUwuU3FsTm90aWZpY2F0aW9uU2VydmljZURlZmF1bHQgKyAiLSIgKyBndWlkOw0KICAgICAgICAgICAgICAgICAgICBfaGFzaEhlbHBlci5Db25uZWN0aW9uU3RyaW5nQnVpbGRlci5BcHBsaWNhdGlvbk5hbWUgPSBfcXVldWU7IC8vIFVzZWQgYnkgY2xlYW51cCBzcHJvYy4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgX3F1ZXVlID0gX2hhc2hIZWxwZXIuUXVldWU7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gQWx3YXlzIHVzZSBDb25uZWN0aW9uU3RyaW5nQnVpbGRlciBzaW5jZSBpbiBkZWZhdWx0IGNhc2UgaXQgaXMgZGlmZmVyZW50IGZyb20gdGhlIA0KICAgICAgICAgICAgICAgIC8vIGNvbm5lY3Rpb24gc3RyaW5nIHVzZWQgaW4gdGhlIGhhc2hIZWxwZXIuDQogICAgICAgICAgICAgICAgX2NvbiA9IG5ldyBTcWxDb25uZWN0aW9uKF9oYXNoSGVscGVyLkNvbm5lY3Rpb25TdHJpbmdCdWlsZGVyLkNvbm5lY3Rpb25TdHJpbmcpOyAvLyBDcmVhdGUgY29ubmVjdGlvbiBhbmQgb3Blbi4NCg0KICAgICAgICAgICAgICAgIC8vIEFzc2VydCBwZXJtaXNzaW9uIGZvciB0aGlzIHBhcnRpY3VsYXIgY29ubmVjdGlvbiBzdHJpbmcgc2luY2UgaXQgZGlmZmVycyBmcm9tIHRoZSB1c2VyIHBhc3NlZCBzdHJpbmcNCiAgICAgICAgICAgICAgICAvLyB3aGljaCB3ZSBoYXZlIGFscmVhZHkgZGVtYW5kZWQgdXBvbi4gIA0KICAgICAgICAgICAgICAgIFNxbENvbm5lY3Rpb25TdHJpbmcgY29ublN0cmluZ09iaiA9IChTcWxDb25uZWN0aW9uU3RyaW5nKV9jb24uQ29ubmVjdGlvbk9wdGlvbnM7DQoNCiAgICAgICAgICAgICAgICBfY29uLk9wZW4oKTsNCg0KICAgICAgICAgICAgICAgIF9jYWNoZWRTZXJ2ZXIgPSBfY29uLkRhdGFTb3VyY2U7DQoNCiAgICAgICAgICAgICAgICBfZXNjYXBlZFF1ZXVlTmFtZSA9IFNxbENvbm5lY3Rpb24uRml4dXBEYXRhYmFzZVRyYW5zYWN0aW9uTmFtZShfcXVldWUpOyAvLyBQcm9wZXJseSBlc2NhcGUgdG8gcHJldmVudCBTUUwgSW5qZWN0aW9uLg0KICAgICAgICAgICAgICAgIF9hcHBEb21haW5LZXlIYXNoID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBpbnQ+KCk7IC8vIERpY3Rpb25hcnkgc3RvcmVzIHRoZSBTdGFydC9TdG9wIHJlZmNvdW50IHBlciBBcHBEb21haW4gZm9yIHRoaXMgY29udGFpbmVyLg0KICAgICAgICAgICAgICAgIF9jb20gPSBuZXcgU3FsQ29tbWFuZCgpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBDb25uZWN0aW9uID0gX2NvbiwNCiAgICAgICAgICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIGJyb2tlciBpcyBlbmFibGVkIG9uIGN1cnJlbnQgZGF0YWJhc2UuDQogICAgICAgICAgICAgICAgICAgIENvbW1hbmRUZXh0ID0gInNlbGVjdCBpc19icm9rZXJfZW5hYmxlZCBmcm9tIHN5cy5kYXRhYmFzZXMgd2hlcmUgZGF0YWJhc2VfaWQ9ZGJfaWQoKSINCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgaWYgKCEoYm9vbClfY29tLkV4ZWN1dGVTY2FsYXIoKSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IFNRTC5TcWxEZXBlbmRlbmN5RGF0YWJhc2VCcm9rZXJEaXNhYmxlZCgpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIF9jb252ZXJzYXRpb25HdWlkUGFyYW0gPSBuZXcgU3FsUGFyYW1ldGVyKCJAcDEiLCBTcWxEYlR5cGUuVW5pcXVlSWRlbnRpZmllcik7DQogICAgICAgICAgICAgICAgX3RpbWVvdXRQYXJhbSA9IG5ldyBTcWxQYXJhbWV0ZXIoIkBwMiIsIFNxbERiVHlwZS5JbnQpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBWYWx1ZSA9IDAgLy8gVGltZW91dCBzZXQgdG8gMCBmb3IgaW5pdGlhbCBzeW5jIHF1ZXJ5Lg0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgX2NvbS5QYXJhbWV0ZXJzLkFkZChfdGltZW91dFBhcmFtKTsNCg0KICAgICAgICAgICAgICAgIHNldHVwQ29tcGxldGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAvLyBjb25uZWN0aW9uIHdpdGggdGhlIHNlcnZlciBoYXMgYmVlbiBzZXR1cCAtIGZyb20gdGhpcyBwb2ludCB1c2UgVGVhckRvd25BbmREaXNwb3NlKCkgaW4gY2FzZSBvZiBlcnJvcg0KDQogICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHN0YW5kYXJkIHF1ZXJ5Lg0KICAgICAgICAgICAgICAgIF9yZWNlaXZlUXVlcnkgPSAiV0FJVEZPUihSRUNFSVZFIFRPUCAoMSkgbWVzc2FnZV90eXBlX25hbWUsIGNvbnZlcnNhdGlvbl9oYW5kbGUsIGNhc3QobWVzc2FnZV9ib2R5IEFTIFhNTCkgYXMgbWVzc2FnZV9ib2R5IGZyb20gIiArIF9lc2NhcGVkUXVldWVOYW1lICsgIiksIFRJTUVPVVQgQHAyOyI7DQoNCiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgcXVldWUsIHNlcnZpY2UsIHN5bmMgcXVlcnksIGFuZCBhc3luYyBxdWVyeSBvbiB1c2VyIHRocmVhZCB0byBlbnN1cmUgcHJvcGVyDQogICAgICAgICAgICAgICAgLy8gaW5pdCBwcmlvciB0byByZXR1cm4uDQoNCiAgICAgICAgICAgICAgICBpZiAodXNlRGVmYXVsdHMpDQogICAgICAgICAgICAgICAgeyAvLyBPbmx5IGNyZWF0ZSBpZiB1c2VyIGRpZCBub3Qgc3BlY2lmeSBzZXJ2aWNlICYgZGF0YWJhc2UuDQogICAgICAgICAgICAgICAgICAgIF9zcHJvY05hbWUgPSBTcWxDb25uZWN0aW9uLkZpeHVwRGF0YWJhc2VUcmFuc2FjdGlvbk5hbWUoU1FMLlNxbE5vdGlmaWNhdGlvblN0b3JlZFByb2NlZHVyZURlZmF1bHQgKyAiLSIgKyBndWlkKTsNCiAgICAgICAgICAgICAgICAgICAgQ3JlYXRlUXVldWVBbmRTZXJ2aWNlKGZhbHNlKTsgLy8gRmFpbCBpZiB3ZSBjYW5ub3QgY3JlYXRlIHNlcnZpY2UsIHF1ZXVlLCBldGMuDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vIENvbnRpbnVlIHF1ZXJ5IHNldHVwLg0KICAgICAgICAgICAgICAgICAgICBfY29tLkNvbW1hbmRUZXh0ID0gX3JlY2VpdmVRdWVyeTsNCiAgICAgICAgICAgICAgICAgICAgX2VuZENvbnZlcnNhdGlvblF1ZXJ5ID0gIkVORCBDT05WRVJTQVRJT04gQHAxOyAiOw0KICAgICAgICAgICAgICAgICAgICBfY29uY2F0UXVlcnkgPSBfZW5kQ29udmVyc2F0aW9uUXVlcnkgKyBfcmVjZWl2ZVF1ZXJ5Ow0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIEluY3JlbWVudFN0YXJ0Q291bnQoYXBwRG9tYWluS2V5LCBvdXQgYm9vbCBpZ25vcmVkKTsNCiAgICAgICAgICAgICAgICAvLyBRdWVyeSBzeW5jaHJvbm91c2x5IG9uY2UgdG8gZW5zdXJlIGV2ZXJ5dGhpbmcgaXMgd29ya2luZyBjb3JyZWN0bHkuDQogICAgICAgICAgICAgICAgLy8gV2Ugd2FudCB0aGUgZXhjZXB0aW9uIHRvIG9jY3VyIG9uIHN0YXJ0IHRvIGltbWVkaWF0ZWx5IGluZm9ybSBjYWxsZXIuDQogICAgICAgICAgICAgICAgU3luY2hyb25vdXNseVF1ZXJ5U2VydmljZUJyb2tlclF1ZXVlKCk7DQogICAgICAgICAgICAgICAgX3RpbWVvdXRQYXJhbS5WYWx1ZSA9IF9kZWZhdWx0V2FpdGZvclRpbWVvdXQ7IC8vIFN5bmMgc3VjY2Vzc2Z1bCwgZXh0ZW5kIHRpbWVvdXQgdG8gNjAgc2Vjb25kcy4NCiAgICAgICAgICAgICAgICBBc3luY2hyb25vdXNseVF1ZXJ5U2VydmljZUJyb2tlclF1ZXVlKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKCFBRFAuSXNDYXRjaGFibGVFeGNlcHRpb25UeXBlKGUpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgQURQLlRyYWNlRXhjZXB0aW9uV2l0aG91dFJldGhyb3coZSk7IC8vIERpc2NhcmQgZmFpbHVyZSwgYnV0IHRyYWNlIGZvciBub3cuDQogICAgICAgICAgICAgICAgaWYgKHNldHVwQ29tcGxldGVkKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQmUgc3VyZSB0byBkcm9wIHNlcnZpY2UgJiBxdWV1ZS4gIFRoaXMgbWF5IGZhaWwgaWYgY3JlYXRlIHNlcnZpY2UgJiBxdWV1ZSBmYWlsZWQuDQogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgbWV0aG9kIHdpbGwgbm90IGRyb3AgdW5sZXNzIHdlIGNyZWF0ZWQgb3Igc2VydmljZSAmIHF1ZXVlIHJlZi1jb3VudCBpcyAwLg0KICAgICAgICAgICAgICAgICAgICBUZWFyRG93bkFuZERpc3Bvc2UoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gY29ubmVjdGlvbiBoYXMgbm90IGJlZW4gZnVsbHkgc2V0dXAgeWV0IC0gY2Fubm90IHVzZSBUZWFyRG93bkFuZERpc3Bvc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBkaXNwb3NlIHRoZSBjb21tYW5kIGFuZCB0aGUgY29ubmVjdGlvbiB0byBhdm9pZCBjb25uZWN0aW9uIGxlYWtzICh1bnRpbCBHQyBjb2xsZWN0cyB0aGVtKS4NCiAgICAgICAgICAgICAgICAgICAgaWYgKF9jb20gIT0gbnVsbCkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgX2NvbS5EaXNwb3NlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBfY29tID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoX2NvbiAhPSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBfY29uLkRpc3Bvc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIF9jb24gPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBQcm9wZXJ0aWVzDQoNCiAgICAgICAgaW50ZXJuYWwgc3RyaW5nIERhdGFiYXNlDQogICAgICAgIHsNCiAgICAgICAgICAgIGdldA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChfY2FjaGVkRGF0YWJhc2UgPT0gbnVsbCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIF9jYWNoZWREYXRhYmFzZSA9IF9jb24uRGF0YWJhc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBfY2FjaGVkRGF0YWJhc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlciBIYXNoSGVscGVyID0+IF9oYXNoSGVscGVyOw0KDQogICAgICAgIGludGVybmFsIGJvb2wgSW5FcnJvclN0YXRlID0+IF9lcnJvclN0YXRlOw0KDQogICAgICAgIGludGVybmFsIHN0cmluZyBRdWV1ZSA9PiBfcXVldWU7DQoNCiAgICAgICAgaW50ZXJuYWwgc3RyaW5nIFNlcnZlciA9PiBfY2FjaGVkU2VydmVyOw0KDQogICAgICAgIC8vIE1ldGhvZHMNCg0KICAgICAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBieSBhIFRocmVhZFBvb2wgdGhyZWFkIGFzIGEgcmVzdWx0IG9mIGFuIEFwcERvbWFpbiBjYWxsaW5nIA0KICAgICAgICAvLyBTcWxEZXBlbmRlbmN5UHJvY2Vzc0Rpc3BhdGNoZXIuUXVldWVBcHBEb21haW5VbmxvYWQgb24gQXBwRG9tYWluLlVubG9hZC4NCiAgICAgICAgaW50ZXJuYWwgYm9vbCBBcHBEb21haW5VbmxvYWQoc3RyaW5nIGFwcERvbWFpbktleSkNCiAgICAgICAgew0KICAgICAgICAgICAgRGVidWcuQXNzZXJ0KCFzdHJpbmcuSXNOdWxsT3JFbXB0eShhcHBEb21haW5LZXkpLCAiVW5leHBlY3RlZCBlbXB0eSBhcHBEb21haW5LZXkhIik7DQoNCiAgICAgICAgICAgIC8vIERpY3Rpb25hcnkgdXNlZCB0byB0cmFjayBob3cgbWFueSB0aW1lcyBzdGFydCBoYXMgYmVlbiBjYWxsZWQgcGVyIGFwcCBkb21haW4uDQogICAgICAgICAgICAvLyBGb3IgZWFjaCBkZWNyZW1lbnQsIHN1YnRyYWN0IGZyb20gY291bnQsIGFuZCBkZWxldGUgaWYgd2UgcmVhY2ggMC4NCiAgICAgICAgICAgIGxvY2sgKF9hcHBEb21haW5LZXlIYXNoKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChfYXBwRG9tYWluS2V5SGFzaC5Db250YWluc0tleShhcHBEb21haW5LZXkpKQ0KICAgICAgICAgICAgICAgIHsgLy8gRG8gbm90aGluZyBpZiBBcHBEb21haW4gZGlkIG5vdCBjYWxsIFN0YXJ0IQ0KICAgICAgICAgICAgICAgICAgICBpbnQgdmFsdWUgPSBfYXBwRG9tYWluS2V5SGFzaFthcHBEb21haW5LZXldOw0KICAgICAgICAgICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQodmFsdWUgPiAwLCAiV2h5IGlzIHZhbHVlIDAgb3IgbGVzcz8iKTsNCg0KICAgICAgICAgICAgICAgICAgICBib29sIGlnbm9yZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHZhbHVlID4gMCkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgRGVidWcuQXNzZXJ0KCFfc3RvcHBlZCwgIldlIHNob3VsZCBub3QgeWV0IGJlIHN0b3BwZWQhIik7DQogICAgICAgICAgICAgICAgICAgICAgICBTdG9wKGFwcERvbWFpbktleSwgb3V0IGlnbm9yZWQpOyAvLyBTdG9wIHdpbGwgZGVjcmVtZW50IHZhbHVlIGFuZCByZW1vdmUgaWYgbmVjZXNzYXJ5IGZyb20gX2FwcERvbWFpbktleUhhc2guDQogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS0tOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gU3RvcCB3aWxsIHJlbW92ZSBrZXkgd2hlbiBkZWNyZW1lbnRlZCB0byAwIGZvciB0aGlzIEFwcERvbWFpbiwgd2hpY2ggc2hvdWxkIG5vdyBiZSB0aGUgY2FzZS4NCiAgICAgICAgICAgICAgICAgICAgRGVidWcuQXNzZXJ0KDAgPT0gdmFsdWUsICJXZSBkaWQgbm90IHJlYWNoIDAgYXQgZW5kIG9mIGxvb3AgaW4gQXBwRG9tYWluVW5sb2FkISIpOw0KICAgICAgICAgICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQoIV9hcHBEb21haW5LZXlIYXNoLkNvbnRhaW5zS2V5KGFwcERvbWFpbktleSksICJLZXkgbm90IHJlbW92ZWQgYWZ0ZXIgQXBwRG9tYWluVW5sb2FkISIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIF9zdG9wcGVkOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSB2b2lkIEFzeW5jaHJvbm91c2x5UXVlcnlTZXJ2aWNlQnJva2VyUXVldWUoKQ0KICAgICAgICB7DQogICAgICAgICAgICBBc3luY0NhbGxiYWNrIGNhbGxiYWNrID0gbmV3IEFzeW5jQ2FsbGJhY2soQXN5bmNSZXN1bHRDYWxsYmFjayk7DQogICAgICAgICAgICBfY29tLkJlZ2luRXhlY3V0ZVJlYWRlcihDb21tYW5kQmVoYXZpb3IuRGVmYXVsdCwgY2FsbGJhY2ssIG51bGwpOyAvLyBOTyBMT0NLIE5FRURFRA0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSB2b2lkIEFzeW5jUmVzdWx0Q2FsbGJhY2soSUFzeW5jUmVzdWx0IGFzeW5jUmVzdWx0KQ0KICAgICAgICB7DQogICAgICAgICAgICB0cnkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB1c2luZyAoU3FsRGF0YVJlYWRlciByZWFkZXIgPSBfY29tLkVuZEV4ZWN1dGVSZWFkZXIoYXN5bmNSZXN1bHQpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzc05vdGlmaWNhdGlvblJlc3VsdHMocmVhZGVyKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzZnVsbCBjb21wbGV0aW9uIG9mIHF1ZXJ5IC0gbm8gZXJyb3JzLg0KICAgICAgICAgICAgICAgIGlmICghX3N0b3ApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBBc3luY2hyb25vdXNseVF1ZXJ5U2VydmljZUJyb2tlclF1ZXVlKCk7IC8vIFJlcXVldWUuLi4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgVGVhckRvd25BbmREaXNwb3NlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICghQURQLklzQ2F0Y2hhYmxlRXhjZXB0aW9uVHlwZShlKSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vIExldCB0aGUgd2FpdGluZyB0aHJlYWQgZGV0ZWN0IHRoZSBlcnJvciBhbmQgZXhpdCAob3RoZXJ3aXNlLCB0aGUgU3RvcCBjYWxsIGxvb3BzIGZvcmV2ZXIpDQogICAgICAgICAgICAgICAgICAgIF9lcnJvclN0YXRlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCFfc3RvcCkNCiAgICAgICAgICAgICAgICB7IC8vIE9ubHkgYXNzZXJ0IGlmIG5vdCBpbiBjYW5jZWwgcGF0aC4NCiAgICAgICAgICAgICAgICAgICAgQURQLlRyYWNlRXhjZXB0aW9uV2l0aG91dFJldGhyb3coZSk7IC8vIERpc2NhcmQgZmFpbHVyZSwgYnV0IHRyYWNlIGZvciBub3cuDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gRmFpbHVyZSAtIGxpa2VseSBkdWUgdG8gY2FuY2VsbGVkIGNvbW1hbmQuICBDaGVjayBfc3RvcCBzdGF0ZS4NCiAgICAgICAgICAgICAgICBpZiAoX3N0b3ApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBUZWFyRG93bkFuZERpc3Bvc2UoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgX2Vycm9yU3RhdGUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICBSZXN0YXJ0KG51bGwpOyAvLyBFcnJvciBjb2RlIHBhdGguICBXaWxsIEludmFsaWRhdGUgYmFzZWQgb24gc2VydmVyIGlmIDFzdCByZXRyeSBmYWlscy4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIHZvaWQgQ3JlYXRlUXVldWVBbmRTZXJ2aWNlKGJvb2wgcmVzdGFydCkNCiAgICAgICAgew0KICAgICAgICAgICAgU3FsQ29tbWFuZCBjb20gPSBuZXcgU3FsQ29tbWFuZCgpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgQ29ubmVjdGlvbiA9IF9jb24NCiAgICAgICAgICAgIH07DQogICAgICAgICAgICBTcWxUcmFuc2FjdGlvbiB0cmFucyA9IG51bGw7DQoNCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRyYW5zID0gX2Nvbi5CZWdpblRyYW5zYWN0aW9uKCk7IC8vIFNpbmNlIHdlIGNhbm5vdCBiYXRjaCBwcm9jIGNyZWF0aW9uLCBzdGFydCB0cmFuc2FjdGlvbi4NCiAgICAgICAgICAgICAgICBjb20uVHJhbnNhY3Rpb24gPSB0cmFuczsNCg0KICAgICAgICAgICAgICAgIHN0cmluZyBuYW1lTGl0ZXJhbCA9IFNxbFNlcnZlckVzY2FwZUhlbHBlci5NYWtlU3RyaW5nTGl0ZXJhbChfcXVldWUpOw0KDQogICAgICAgICAgICAgICAgY29tLkNvbW1hbmRUZXh0ID0NCiAgICAgICAgICAgICAgICAgICAgICAgICJDUkVBVEUgUFJPQ0VEVVJFICIgKyBfc3Byb2NOYW1lICsgIiBBUyINCiAgICAgICAgICAgICAgICAgICAgICAgICsgIiBCRUdJTiINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgQkVHSU4gVFJBTlNBQ1RJT047Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBSRUNFSVZFIFRPUCgwKSBjb252ZXJzYXRpb25faGFuZGxlIEZST00gIiArIF9lc2NhcGVkUXVldWVOYW1lICsgIjsiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIElGIChTRUxFQ1QgQ09VTlQoKikgRlJPTSAiICsgX2VzY2FwZWRRdWV1ZU5hbWUgKyAiIFdIRVJFIG1lc3NhZ2VfdHlwZV9uYW1lID0gJ2h0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vU1FML1NlcnZpY2VCcm9rZXIvRGlhbG9nVGltZXInKSA+IDAiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIEJFR0lOIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgaWYgKChTRUxFQ1QgQ09VTlQoKikgRlJPTSBzeXMuc2VydmljZXMgV0hFUkUgbmFtZSA9ICIgKyBuYW1lTGl0ZXJhbCArICIpID4gMCkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiAgIERST1AgU0VSVklDRSAiICsgX2VzY2FwZWRRdWV1ZU5hbWUgKyAiOyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIGlmIChPQkpFQ1RfSUQoIiArIG5hbWVMaXRlcmFsICsgIiwgJ1NRJykgSVMgTk9UIE5VTEwpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgICBEUk9QIFFVRVVFICIgKyBfZXNjYXBlZFF1ZXVlTmFtZSArICI7Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgRFJPUCBQUk9DRURVUkUgIiArIF9zcHJvY05hbWUgKyAiOyIgLy8gRG9uJ3QgbmVlZCBjb25kaXRpb25hbCBiZWNhdXNlIHRoaXMgaXMgc2VsZg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBFTkQiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIENPTU1JVCBUUkFOU0FDVElPTjsiDQogICAgICAgICAgICAgICAgICAgICAgICArICIgRU5EIjsNCg0KICAgICAgICAgICAgICAgIGlmICghcmVzdGFydCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGNvbS5FeGVjdXRlTm9uUXVlcnkoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsgLy8gVXBvbiByZXN0YXJ0LCBiZSByZXNpbGllbnQgdG8gdGhlIHVzZXIgZHJvcHBpbmcgcXVldWUsIHNlcnZpY2UsIG9yIHByb2NlZHVyZS4NCiAgICAgICAgICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbS5FeGVjdXRlTm9uUXVlcnkoKTsgLy8gQ2Fubm90IGFkZCAnSUYgT0JKRUNUX0lEJyB0byBjcmVhdGUgcHJvY2VkdXJlIHF1ZXJ5IC0gd3JhcCBhbmQgZGlzY2FyZCBmYWlsdXJlLg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBRFAuSXNDYXRjaGFibGVFeGNlcHRpb25UeXBlKGUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgQURQLlRyYWNlRXhjZXB0aW9uV2l0aG91dFJldGhyb3coZSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgICAgICAgICAgeyAvLyBTaW5jZSB0aGUgZmFpbHVyZSB3aWxsIHJlc3VsdCBpbiBhIHJvbGxiYWNrLCByb2xsYmFjayBvdXIgb2JqZWN0Lg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHRyYW5zKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnMuUm9sbGJhY2soKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnMgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZikNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFEUC5Jc0NhdGNoYWJsZUV4Y2VwdGlvblR5cGUoZikpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQURQLlRyYWNlRXhjZXB0aW9uV2l0aG91dFJldGhyb3coZik7IC8vIERpc2NhcmQgZmFpbHVyZSwgYnV0IHRyYWNlIGZvciBub3cuDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSB0cmFucykNCiAgICAgICAgICAgICAgICAgICAgeyAvLyBDcmVhdGUgYSBuZXcgdHJhbnNhY3Rpb24gZm9yIG5leHQgb3BlcmF0aW9ucy4NCiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zID0gX2Nvbi5CZWdpblRyYW5zYWN0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb20uVHJhbnNhY3Rpb24gPSB0cmFuczsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgY29tLkNvbW1hbmRUZXh0ID0NCiAgICAgICAgICAgICAgICAgICAgICAgICAiSUYgT0JKRUNUX0lEKCIgKyBuYW1lTGl0ZXJhbCArICIsICdTUScpIElTIE5VTEwiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIEJFR0lOIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBDUkVBVEUgUVVFVUUgIiArIF9lc2NhcGVkUXVldWVOYW1lICsgIiBXSVRIIEFDVElWQVRJT04gKFBST0NFRFVSRV9OQU1FPSIgKyBfc3Byb2NOYW1lICsgIiwgTUFYX1FVRVVFX1JFQURFUlM9MSwgRVhFQ1VURSBBUyBPV05FUik7Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBFTkQ7Ig0KICAgICAgICAgICAgICAgICAgICAgICsgIiBJRiAoU0VMRUNUIENPVU5UKCopIEZST00gc3lzLnNlcnZpY2VzIFdIRVJFIE5BTUU9IiArIG5hbWVMaXRlcmFsICsgIikgPSAwIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBCRUdJTiINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgQ1JFQVRFIFNFUlZJQ0UgIiArIF9lc2NhcGVkUXVldWVOYW1lICsgIiBPTiBRVUVVRSAiICsgX2VzY2FwZWRRdWV1ZU5hbWUgKyAiIChbaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS9TUUwvTm90aWZpY2F0aW9ucy9Qb3N0UXVlcnlOb3RpZmljYXRpb25dKTsiDQogICAgICAgICAgICAgICAgICAgICAgICAgKyAiIElGIChTRUxFQ1QgQ09VTlQoKikgRlJPTSBzeXMuZGF0YWJhc2VfcHJpbmNpcGFscyBXSEVSRSBuYW1lPSdzcWxfZGVwZW5kZW5jeV9zdWJzY3JpYmVyJyBBTkQgdHlwZT0nUicpIDw+IDAiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgQkVHSU4iDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgR1JBTlQgU0VORCBPTiBTRVJWSUNFOjoiICsgX2VzY2FwZWRRdWV1ZU5hbWUgKyAiIFRPIHNxbF9kZXBlbmRlbmN5X3N1YnNjcmliZXI7Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIEVORDsgIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBFTkQ7Ig0KICAgICAgICAgICAgICAgICAgICAgICsgIiBCRUdJTiBESUFMT0cgQGRpYWxvZ19oYW5kbGUgRlJPTSBTRVJWSUNFICIgKyBfZXNjYXBlZFF1ZXVlTmFtZSArICIgVE8gU0VSVklDRSAiICsgbmFtZUxpdGVyYWw7DQoNCiAgICAgICAgICAgICAgICBTcWxQYXJhbWV0ZXIgcGFyYW0gPSBuZXcgU3FsUGFyYW1ldGVyKCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIFBhcmFtZXRlck5hbWUgPSAiQGRpYWxvZ19oYW5kbGUiLA0KICAgICAgICAgICAgICAgICAgICBEYlR5cGUgPSBEYlR5cGUuR3VpZCwNCiAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gUGFyYW1ldGVyRGlyZWN0aW9uLk91dHB1dA0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgY29tLlBhcmFtZXRlcnMuQWRkKHBhcmFtKTsNCiAgICAgICAgICAgICAgICBjb20uRXhlY3V0ZU5vblF1ZXJ5KCk7DQoNCiAgICAgICAgICAgICAgICAvLyBGaW5pc2ggc2V0dGluZyB1cCBxdWVyaWVzIGFuZCBzdGF0ZS4gIEZvciByZS1zdGFydCwgd2UgbmVlZCB0byBlbnN1cmUgd2UgYmVnaW4gYSBuZXcgZGlhbG9nIGFib3ZlIGFuZCByZXNldA0KICAgICAgICAgICAgICAgIC8vIG91ciBxdWVyaWVzIHRvIHVzZSB0aGUgbmV3IGRpYWxvZ0hhbmRsZS4NCiAgICAgICAgICAgICAgICBfZGlhbG9nSGFuZGxlID0gKChHdWlkKXBhcmFtLlZhbHVlKS5Ub1N0cmluZygpOw0KICAgICAgICAgICAgICAgIF9iZWdpbkNvbnZlcnNhdGlvblF1ZXJ5ID0gIkJFR0lOIENPTlZFUlNBVElPTiBUSU1FUiAoJyIgKyBfZGlhbG9nSGFuZGxlICsgIicpIFRJTUVPVVQgPSAxMjA7ICIgKyBfcmVjZWl2ZVF1ZXJ5Ow0KICAgICAgICAgICAgICAgIF9jb20uQ29tbWFuZFRleHQgPSBfYmVnaW5Db252ZXJzYXRpb25RdWVyeTsNCiAgICAgICAgICAgICAgICBfZW5kQ29udmVyc2F0aW9uUXVlcnkgPSAiRU5EIENPTlZFUlNBVElPTiBAcDE7ICI7DQogICAgICAgICAgICAgICAgX2NvbmNhdFF1ZXJ5ID0gX2VuZENvbnZlcnNhdGlvblF1ZXJ5ICsgX2NvbS5Db21tYW5kVGV4dDsNCg0KICAgICAgICAgICAgICAgIHRyYW5zLkNvbW1pdCgpOw0KICAgICAgICAgICAgICAgIHRyYW5zID0gbnVsbDsNCiAgICAgICAgICAgICAgICBfc2VydmljZVF1ZXVlQ3JlYXRlZCA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmaW5hbGx5DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdHJhbnMpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB0cnkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnMuUm9sbGJhY2soKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQURQLklzQ2F0Y2hhYmxlRXhjZXB0aW9uVHlwZShlKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIEFEUC5UcmFjZUV4Y2VwdGlvbldpdGhvdXRSZXRocm93KGUpOyAvLyBEaXNjYXJkIGZhaWx1cmUsIGJ1dCB0cmFjZSBmb3Igbm93Lg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgdm9pZCBJbmNyZW1lbnRTdGFydENvdW50KHN0cmluZyBhcHBEb21haW5LZXksIG91dCBib29sIGFwcERvbWFpblN0YXJ0KQ0KICAgICAgICB7DQogICAgICAgICAgICBhcHBEb21haW5TdGFydCA9IGZhbHNlOyAvLyBSZXNldCBvdXQgcGFyYW0uDQogICAgICAgICAgICBpbnQgcmVzdWx0ID0gSW50ZXJsb2NrZWQuSW5jcmVtZW50KHJlZiBfc3RhcnRDb3VudCk7IC8vIEFkZCB0byByZWZDb3VudC4NCg0KICAgICAgICAgICAgLy8gRGljdGlvbmFyeSB1c2VkIHRvIHRyYWNrIGhvdyBtYW55IHRpbWVzIHN0YXJ0IGhhcyBiZWVuIGNhbGxlZCBwZXIgYXBwIGRvbWFpbi4NCiAgICAgICAgICAgIC8vIEZvciBlYWNoIGluY3JlbWVudCwgYWRkIHRvIGNvdW50LCBhbmQgY3JlYXRlIGVudHJ5IGlmIG5vdCBwcmVzZW50Lg0KICAgICAgICAgICAgbG9jayAoX2FwcERvbWFpbktleUhhc2gpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKF9hcHBEb21haW5LZXlIYXNoLkNvbnRhaW5zS2V5KGFwcERvbWFpbktleSkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBfYXBwRG9tYWluS2V5SGFzaFthcHBEb21haW5LZXldID0gX2FwcERvbWFpbktleUhhc2hbYXBwRG9tYWluS2V5XSArIDE7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIF9hcHBEb21haW5LZXlIYXNoW2FwcERvbWFpbktleV0gPSAxOw0KICAgICAgICAgICAgICAgICAgICBhcHBEb21haW5TdGFydCA9IHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSB2b2lkIFByb2Nlc3NOb3RpZmljYXRpb25SZXN1bHRzKFNxbERhdGFSZWFkZXIgcmVhZGVyKQ0KICAgICAgICB7DQogICAgICAgICAgICBHdWlkIGhhbmRsZSA9IEd1aWQuRW1wdHk7IC8vIENvbnZlcnNhdGlvbl9oYW5kbGUuICBBbHdheXMgY2xvc2UgdGhpcyENCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICghX3N0b3ApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAocmVhZGVyLlJlYWQoKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nIG1zZ1R5cGUgPSByZWFkZXIuR2V0U3RyaW5nKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlID0gcmVhZGVyLkdldEd1aWQoMSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgcHJvY2VzcyBRdWVyeU5vdGlmaWNhdGlvbiBtZXNzYWdlcy4NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09IHN0cmluZy5Db21wYXJlKG1zZ1R5cGUsICJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL1NRTC9Ob3RpZmljYXRpb25zL1F1ZXJ5Tm90aWZpY2F0aW9uIiwgU3RyaW5nQ29tcGFyaXNvbi5PcmRpbmFsSWdub3JlQ2FzZSkpDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgU3FsWG1sIHBheWxvYWQgPSByZWFkZXIuR2V0U3FsWG1sKDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IHBheWxvYWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcWxOb3RpZmljYXRpb24gbm90aWZpY2F0aW9uID0gU3FsTm90aWZpY2F0aW9uUGFyc2VyLlByb2Nlc3NNZXNzYWdlKHBheWxvYWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBub3RpZmljYXRpb24pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZyBrZXkgPSBub3RpZmljYXRpb24uS2V5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGluZGV4ID0ga2V5LkluZGV4T2YoJzsnKTsgLy8gT3VyIGZvcm1hdCBpcyBzaW1wbGU6ICJBcHBEb21haW5LZXk7Y29tbWFuZEhhc2giDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA+PSAwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAvLyBFbnN1cmUgJzsnIHByZXNlbnQuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nIGFwcERvbWFpbktleSA9IGtleS5TdWJzdHJpbmcoMCwgaW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNxbERlcGVuZGVuY3lQZXJBcHBEb21haW5EaXNwYXRjaGVyIGRpc3BhdGNoZXI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jayAoc19zdGF0aWNJbnN0YW5jZS5fc3FsRGVwZW5kZW5jeVBlckFwcERvbWFpbkRpc3BhdGNoZXJzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hlciA9IHNfc3RhdGljSW5zdGFuY2UuX3NxbERlcGVuZGVuY3lQZXJBcHBEb21haW5EaXNwYXRjaGVyc1thcHBEb21haW5LZXldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBkaXNwYXRjaGVyKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoZXIuSW52YWxpZGF0ZUNvbW1hbmRJRChub3RpZmljYXRpb24pOyAvLyBDUk9TUyBBUFAtRE9NQUlOIENBTEwhDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFEUC5Jc0NhdGNoYWJsZUV4Y2VwdGlvblR5cGUoZSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBRFAuVHJhY2VFeGNlcHRpb25XaXRob3V0UmV0aHJvdyhlKTsgLy8gRGlzY2FyZCBmYWlsdXJlLiAgVXNlciBldmVudCBjb3VsZCB0aHJvdyBleGNlcHRpb24uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVidWcuRmFpbCgiUmVjZWl2ZWQgbm90aWZpY2F0aW9uIGJ1dCBkbyBub3QgaGF2ZSBhbiBhc3NvY2lhdGVkIFBlckFwcERvbWFpbkRpc3BhdGNoZXIhIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlYnVnLkZhaWwoIlVuZXhwZWN0ZWQgSUQgZm9ybWF0IHJlY2VpdmVkISIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVidWcuRmFpbCgiTnVsbCBub3RpZmljYXRpb24gcmV0dXJuZWQgZnJvbSBQcm9jZXNzTWVzc2FnZSEiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWJ1Zy5GYWlsKCJOdWxsIHBheWxvYWQgZm9yIFFOIG5vdGlmaWNhdGlvbiB0eXBlISIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGUgPSBHdWlkLkVtcHR5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZmluYWxseQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIFNpbmNlIHdlIGRvIG5vdCB3YW50IHRvIG1ha2UgYSBzZXBhcmF0ZSByb3VuZCB0cmlwIGp1c3QgZm9yIHRoZSBlbmQgY29udmVyc2F0aW9uIGNhbGwsIHdlIG5lZWQgdG8NCiAgICAgICAgICAgICAgICAvLyBiYXRjaCBpdCB3aXRoIHRoZSBuZXh0IGNvbW1hbmQuICANCiAgICAgICAgICAgICAgICBpZiAoaGFuZGxlID09IEd1aWQuRW1wdHkpDQogICAgICAgICAgICAgICAgeyAvLyBUaGlzIHNob3VsZCBvbmx5IGhhcHBlbiBpZiBmYWlsdXJlIG9jY3VycmVkLCBvciBpZiBub24tUU4gZm9ybWF0IHJlY2VpdmVkLg0KICAgICAgICAgICAgICAgICAgICBfY29tLkNvbW1hbmRUZXh0ID0gX2JlZ2luQ29udmVyc2F0aW9uUXVlcnkgPz8gX3JlY2VpdmVRdWVyeTsgLy8gSWYgd2UncmUgZG9pbmcgdGhlIGluaXRpYWwgcXVlcnksIHdlIHdvbid0IGhhdmUgYSBjb252ZXJzYXRpb24gR3VpZCB0byBiZWdpbiB5ZXQuDQogICAgICAgICAgICAgICAgICAgIGlmIChfY29tLlBhcmFtZXRlcnMuQ291bnQgPiAxKQ0KICAgICAgICAgICAgICAgICAgICB7IC8vIFJlbW92ZSBjb252ZXJzYXRpb24gcGFyYW0gc2luY2UgbmV4dCBleGVjdXRlIGlzIG9ubHkgcXVlcnkuDQogICAgICAgICAgICAgICAgICAgICAgICBfY29tLlBhcmFtZXRlcnMuUmVtb3ZlKF9jb252ZXJzYXRpb25HdWlkUGFyYW0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIERlYnVnLkFzc2VydChfY29tLlBhcmFtZXRlcnMuQ291bnQgPT0gMSwgIlVuZXhwZWN0ZWQgbnVtYmVyIG9mIHBhcmFtZXRlcnMhIik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIF9jb20uQ29tbWFuZFRleHQgPSBfY29uY2F0UXVlcnk7IC8vIEVORCBxdWVyeSArIFdBSVRGT1IgUkVDRUlWRSBxdWVyeS4NCiAgICAgICAgICAgICAgICAgICAgX2NvbnZlcnNhdGlvbkd1aWRQYXJhbS5WYWx1ZSA9IGhhbmRsZTsgLy8gU2V0IHZhbHVlIGZvciBjb252ZXJzYXRpb24gaGFuZGxlLg0KICAgICAgICAgICAgICAgICAgICBpZiAoX2NvbS5QYXJhbWV0ZXJzLkNvdW50ID09IDEpDQogICAgICAgICAgICAgICAgICAgIHsgLy8gQWRkIHBhcmFtZXRlciBpZiBwcmV2aW91cyBleGVjdXRlIHdhcyBvbmx5IHF1ZXJ5Lg0KICAgICAgICAgICAgICAgICAgICAgICAgX2NvbS5QYXJhbWV0ZXJzLkFkZChfY29udmVyc2F0aW9uR3VpZFBhcmFtKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQoX2NvbS5QYXJhbWV0ZXJzLkNvdW50ID09IDIsICJVbmV4cGVjdGVkIG51bWJlciBvZiBwYXJhbWV0ZXJzISIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN4UzogdGhpcyBtZXRob2QgdXNlcyBXaW5kb3dzSWRlbnRpdHkuSW1wZXJzb25hdGUgdG8gaW1wZXJzb25hdGUgdGhlIGN1cnJlbnQgdGhyZWFkIHdpdGggdGhlDQogICAgICAgIC8vIGNyZWRlbnRpYWxzIHVzZWQgdG8gY3JlYXRlIHRoaXMgU3FsQ29ubmVjdGlvbkNvbnRhaW5lci4NCiAgICAgICAgW1Jlc291cmNlRXhwb3N1cmUoUmVzb3VyY2VTY29wZS5Ob25lKV0NCiAgICAgICAgW1Jlc291cmNlQ29uc3VtcHRpb24oUmVzb3VyY2VTY29wZS5Qcm9jZXNzLCBSZXNvdXJjZVNjb3BlLlByb2Nlc3MpXQ0KICAgICAgICBwcml2YXRlIHZvaWQgUmVzdGFydChvYmplY3QgdW51c2VkKQ0KICAgICAgICB7IC8vIFVudXNlZCBhcmcgcmVxdWlyZWQgYnkgVGltZXJDYWxsYmFjay4NCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGxvY2sgKHRoaXMpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIV9zdG9wKQ0KICAgICAgICAgICAgICAgICAgICB7IC8vIE9ubHkgZXhlY3V0ZSBpZiB3ZSBhcmUgc3RpbGwgaW4gcnVubmluZyBzdGF0ZS4NCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb24uQ2xvc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFEUC5Jc0NhdGNoYWJsZUV4Y2VwdGlvblR5cGUoZSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQURQLlRyYWNlRXhjZXB0aW9uV2l0aG91dFJldGhyb3coZSk7IC8vIERpc2NhcmQgY2xvc2UgZmFpbHVyZSwgaWYgaXQgb2NjdXJzLiAgT25seSB0cmFjZSBpdC4NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIFJhdGhlciB0aGFuIG9uZSBsb25nIGxvY2sgLSB0YWtlIGxvY2sgMyB0aW1lcyBmb3Igc2hvcnRlciBwZXJpb2RzLg0KDQogICAgICAgICAgICAgICAgbG9jayAodGhpcykNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmICghX3N0b3ApDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIF9jb24uT3BlbigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgbG9jayAodGhpcykNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmICghX3N0b3ApDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfc2VydmljZVF1ZXVlQ3JlYXRlZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGZhaWx1cmUgPSBmYWxzZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ3JlYXRlUXVldWVBbmRTZXJ2aWNlKHRydWUpOyAvLyBFbnN1cmUgc2VydmljZSwgcXVldWUsIGV0YyBpcyBwcmVzZW50LCBpZiB3ZSBjcmVhdGVkIGl0Lg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFEUC5Jc0NhdGNoYWJsZUV4Y2VwdGlvblR5cGUoZSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFEUC5UcmFjZUV4Y2VwdGlvbldpdGhvdXRSZXRocm93KGUpOyAvLyBEaXNjYXJkIGZhaWx1cmUsIGJ1dCB0cmFjZSBmb3Igbm93Lg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsdXJlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIGZhaWxlZCB0byByZS1jcmVhdGVkIHF1ZXVlLCBzZXJ2aWNlLCBzcHJvYyAtIGludmFsaWRhdGUhDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNfc3RhdGljSW5zdGFuY2UuSW52YWxpZGF0ZShTZXJ2ZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBTcWxOb3RpZmljYXRpb24oU3FsTm90aWZpY2F0aW9uSW5mby5FcnJvciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcWxOb3RpZmljYXRpb25Tb3VyY2UuQ2xpZW50LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNxbE5vdGlmaWNhdGlvblR5cGUuQ2hhbmdlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwpKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGxvY2sgKHRoaXMpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIV9zdG9wKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBfdGltZW91dFBhcmFtLlZhbHVlID0gMDsgLy8gUmVzZXQgdGltZW91dCB0byB6ZXJvIC0gd2UgZG8gbm90IHdhbnQgdG8gYmxvY2suDQogICAgICAgICAgICAgICAgICAgICAgICBTeW5jaHJvbm91c2x5UXVlcnlTZXJ2aWNlQnJva2VyUXVldWUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBhYm92ZSBzdWNjZWVkcywgd2UgYXJlIGJhY2sgaW4gc3VjY2VzcyBjYXNlIC0gcmVxdWV1ZSBmb3IgYXN5bmMgY2FsbC4NCiAgICAgICAgICAgICAgICAgICAgICAgIF90aW1lb3V0UGFyYW0uVmFsdWUgPSBfZGVmYXVsdFdhaXRmb3JUaW1lb3V0OyAvLyBJZiBzdWNjZXNzLCByZXNldCB0byBkZWZhdWx0IGZvciByZS1xdWV1ZS4NCiAgICAgICAgICAgICAgICAgICAgICAgIEFzeW5jaHJvbm91c2x5UXVlcnlTZXJ2aWNlQnJva2VyUXVldWUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIF9lcnJvclN0YXRlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBUaW1lciByZXRyeVRpbWVyID0gX3JldHJ5VGltZXI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0cnlUaW1lciAhPSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZXRyeVRpbWVyID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRyeVRpbWVyLkRpc3Bvc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmIChfc3RvcCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIFRlYXJEb3duQW5kRGlzcG9zZSgpOyAvLyBGdW5jdGlvbiB3aWxsIGxvY2sodGhpcykuDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICghQURQLklzQ2F0Y2hhYmxlRXhjZXB0aW9uVHlwZShlKSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBBRFAuVHJhY2VFeGNlcHRpb25XaXRob3V0UmV0aHJvdyhlKTsNCg0KICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdW5leHBlY3RlZCBxdWVyeSBvciBjb25uZWN0aW9uIGZhaWx1cmUsIGludmFsaWRhdGUgYWxsIGRlcGVuZGVuY2llcyBhZ2FpbnN0IHRoaXMgc2VydmVyLg0KICAgICAgICAgICAgICAgICAgICAvLyBXZSBtYXkgb3Zlci1ub3RpZnkgaWYgb25seSBzb21lIG9mIHRoZSBjb25uZWN0aW9ucyB0byBhIHBhcnRpY3VsYXIgZGF0YWJhc2Ugd2VyZSBhZmZlY3RlZCwNCiAgICAgICAgICAgICAgICAgICAgLy8gYnV0IHRoaXMgc2hvdWxkIG5vdCBiZSBmcmVxdWVudCBlbm91Z2ggdG8gYmUgYSBjb25jZXJuLg0KICAgICAgICAgICAgICAgICAgICAvLyBOT1RFIC0gd2UgaW52YWxpZGF0ZSBhZnRlciBmYWlsdXJlIGZpcnN0IG9jY3VycyBhbmQgdGhlbiByZXRyeSBmYWlscy4gIFdlIHdpbGwgdGhlbiBjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAvLyB0byBpbnZhbGlkYXRlIGV2ZXJ5IHRpbWUgdGhlIHJldHJ5IGZhaWxzLg0KICAgICAgICAgICAgICAgICAgICBzX3N0YXRpY0luc3RhbmNlLkludmFsaWRhdGUoU2VydmVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgU3FsTm90aWZpY2F0aW9uKFNxbE5vdGlmaWNhdGlvbkluZm8uRXJyb3IsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3FsTm90aWZpY2F0aW9uU291cmNlLkNsaWVudCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcWxOb3RpZmljYXRpb25UeXBlLkNoYW5nZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZikNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmICghQURQLklzQ2F0Y2hhYmxlRXhjZXB0aW9uVHlwZShmKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgQURQLlRyYWNlRXhjZXB0aW9uV2l0aG91dFJldGhyb3coZik7IC8vIERpc2NhcmQgZXhjZXB0aW9uIGZyb20gSW52YWxpZGF0ZS4gIFVzZXIgZXZlbnRzIGNhbiB0aHJvdy4NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0cnkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIF9jb24uQ2xvc2UoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBmKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFBRFAuSXNDYXRjaGFibGVFeGNlcHRpb25UeXBlKGYpKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBBRFAuVHJhY2VFeGNlcHRpb25XaXRob3V0UmV0aHJvdyhmKTsgLy8gRGlzY2FyZCBjbG9zZSBmYWlsdXJlLCBpZiBpdCBvY2N1cnMuICBPbmx5IHRyYWNlIGl0Lg0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICghX3N0b3ApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSB0aW1lciB0byBjYWxsYmFjayBpbiBvbmUgbWludXRlLCByZXRyeWluZyB0aGUgY2FsbCB0byBSZXN0YXJ0KCkuDQogICAgICAgICAgICAgICAgICAgIF9yZXRyeVRpbWVyID0gbmV3IFRpbWVyKG5ldyBUaW1lckNhbGxiYWNrKFJlc3RhcnQpLCBudWxsLCBfZGVmYXVsdFdhaXRmb3JUaW1lb3V0LCBUaW1lb3V0LkluZmluaXRlKTsNCiAgICAgICAgICAgICAgICAgICAgLy8gV2Ugd2lsbCByZXRyeSB0aGlzIGluZGVmaW5pdGVseSwgdW50aWwgc3VjY2VzcyAtIG9yIFN0b3AoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBib29sIFN0b3Aoc3RyaW5nIGFwcERvbWFpbktleSwgb3V0IGJvb2wgYXBwRG9tYWluU3RvcCkNCiAgICAgICAgew0KICAgICAgICAgICAgYXBwRG9tYWluU3RvcCA9IGZhbHNlOw0KDQogICAgICAgICAgICAvLyBEaWN0aW9uYXJ5IHVzZWQgdG8gdHJhY2sgaG93IG1hbnkgdGltZXMgc3RhcnQgaGFzIGJlZW4gY2FsbGVkIHBlciBhcHAgZG9tYWluLg0KICAgICAgICAgICAgLy8gRm9yIGVhY2ggZGVjcmVtZW50LCBzdWJ0cmFjdCBmcm9tIGNvdW50LCBhbmQgZGVsZXRlIGlmIHdlIHJlYWNoIDAuDQoNCiAgICAgICAgICAgIGlmIChudWxsICE9IGFwcERvbWFpbktleSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBJZiBudWxsLCB0aGVuIHRoaXMgd2FzIGNhbGxlZCBmcm9tIFNxbERlcGVuZGVuY3lQcm9jZXNzRGlzcGF0Y2hlciwgd2UgaWdub3JlIGFwcERvbWFpbktleUhhc2guDQogICAgICAgICAgICAgICAgbG9jayAoX2FwcERvbWFpbktleUhhc2gpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAoX2FwcERvbWFpbktleUhhc2guQ29udGFpbnNLZXkoYXBwRG9tYWluS2V5KSkNCiAgICAgICAgICAgICAgICAgICAgeyAvLyBEbyBub3RoaW5nIGlmIEFwcERvbWFpbiBkaWQgbm90IGNhbGwgU3RhcnQhDQogICAgICAgICAgICAgICAgICAgICAgICBpbnQgdmFsdWUgPSBfYXBwRG9tYWluS2V5SGFzaFthcHBEb21haW5LZXldOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQodmFsdWUgPiAwLCAiVW5leHBlY3RlZCBjb3VudCBmb3IgYXBwRG9tYWluS2V5Iik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA+IDApDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FwcERvbWFpbktleUhhc2hbYXBwRG9tYWluS2V5XSA9IHZhbHVlIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWJ1Zy5GYWlsKCJVbmV4cGVjdGVkIEFwcERvbWFpbktleSBjb3VudCBpbiBTdG9wKCkiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT0gdmFsdWUpDQogICAgICAgICAgICAgICAgICAgICAgICB7IC8vIFJlbW92ZSBmcm9tIGRpY3Rpb25hcnkgaWYgcHJlLWRlY3JlbWVudCBjb3VudCB3YXMgb25lLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hcHBEb21haW5LZXlIYXNoLlJlbW92ZShhcHBEb21haW5LZXkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcERvbWFpblN0b3AgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgRGVidWcuRmFpbCgiVW5leHBlY3RlZCBzdGF0ZSBvbiBTdG9wKCkgLSBubyBBcHBEb21haW5LZXkgZW50cnkgaW4gaGFzaHRhYmxlISIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQoX3N0YXJ0Q291bnQgPiAwLCAiQWJvdXQgdG8gZGVjcmVtZW50IF9zdGFydENvdW50IGxlc3MgdGhhbiAwISIpOw0KICAgICAgICAgICAgaW50IHJlc3VsdCA9IEludGVybG9ja2VkLkRlY3JlbWVudChyZWYgX3N0YXJ0Q291bnQpOw0KDQogICAgICAgICAgICBpZiAoMCA9PSByZXN1bHQpDQogICAgICAgICAgICB7IC8vIElmIHdlJ3ZlIHJlYWNoZWQgcmVmQ291bnQgMCwgZGVzdHJveS4NCiAgICAgICAgICAgICAgICAvLyBMb2NrIHRvIGVuc3VyZSBDYW5jZWwoKSBjb21wbGV0ZSBwcmlvciB0byBvdGhlciB0aHJlYWQgY2FsbGluZyBUZWFyRG93bi4NCiAgICAgICAgICAgICAgICBsb2NrICh0aGlzKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJhY2UgY29uZGl0aW9uIHdpdGggZXhlY3V0aW5nIHRocmVhZCAtIHdpbGwgdGhyb3cgaWYgY29ubmVjdGlvbiBpcyBjbG9zZWQgZHVlIHRvIGZhaWx1cmUuDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBSYXRoZXIgdGhhbiBmaWdodGluZyB0aGUgcmFjZSBjb25kaXRpb24sIGp1c3QgY2FsbCBpdCBhbmQgZGlzY2FyZCBhbnkgcG90ZW50aWFsIGZhaWx1cmUuDQogICAgICAgICAgICAgICAgICAgICAgICBfY29tLkNhbmNlbCgpOyAvLyBDYW5jZWwgdGhlIHBlbmRpbmcgY29tbWFuZC4gIE5vLW9wIGlmIGNvbm5lY3Rpb24gY2xvc2VkLg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBRFAuSXNDYXRjaGFibGVFeGNlcHRpb25UeXBlKGUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgQURQLlRyYWNlRXhjZXB0aW9uV2l0aG91dFJldGhyb3coZSk7IC8vIERpc2NhcmQgZmFpbHVyZSwgaWYgaXQgc2hvdWxkIG9jY3VyLg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIF9zdG9wID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBXYWl0IHVudGlsIHN0b3BwZWQgYW5kIHNlcnZpY2UgJiBxdWV1ZSBhcmUgZHJvcHBlZC4NCiAgICAgICAgICAgICAgICBTdG9wd2F0Y2ggcmV0cnlTdG9wd2F0Y2ggPSBTdG9wd2F0Y2guU3RhcnROZXcoKTsNCiAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGxvY2sgKHRoaXMpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfc3RvcHBlZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgYXJlIGluIGVycm9yIHN0YXRlIChfZXJyb3JTdGF0ZSBpcyB0cnVlKSwgZm9yY2UgYSB0ZWFyIGRvd24uDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBMaWtld2lzZSwgaWYgd2UgaGF2ZSBleGNlZWRlZCB0aGUgbWF4aW11bSByZXRyeSBwZXJpb2QgKDMwIHNlY29uZHMpIHdhaXRpbmcgZm9yIGNsZWFudXAsIGZvcmNlIGEgdGVhciBkb3duLg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW4gcmFyZSBjYXNlcyBkdXJpbmcgYXBwIGRvbWFpbiB1bmxvYWQsIHRoZSBhc3luYyBjbGVhbnVwIHBlcmZvcm1lZCBieSBBc3luY1Jlc3VsdENhbGxiYWNrDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXkgZmFpbCB0byBleGVjdXRlIFRlYXJEb3duQW5kRGlzcG9zZSwgbGVhdmluZyB0aGlzIG1ldGhvZCBpbiBhbiBpbmZpbml0ZSBsb29wLg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVG8gYXZvaWQgdGhlIGluZmluaXRlIGxvb3AsIHdlIGZvcmNlIHRoZSBjbGVhbnVwIGhlcmUgYWZ0ZXIgMzAgc2Vjb25kcy4gIFNpbmNlIHdlIGhhdmUgcmVhY2hlZCANCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlZmNvdW50IG9mIDAsIGVpdGhlciB0aGlzIG1ldGhvZCBjYWxsIG9yIHRoZSB0aHJlYWQgcnVubmluZyBBc3luY1Jlc3VsdENhbGxiYWNrIGlzIHJlc3BvbnNpYmxlIGZvciBjYWxsaW5nIA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGVhckRvd25BbmREaXNwb3NlIHdoZW4gdHJhbnNpdGlvbmluZyB0byB0aGUgX3N0b3BwZWQgc3RhdGUuICBGYWlsaW5nIHRvIGNhbGwgVGVhckRvd25BbmREaXNwb3NlIG1lYW5zIHdlIGxlYWsgDQogICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmljZSBicm9rZXIgb2JqZWN0cyBjcmVhdGVkIGJ5IHRoaXMgU3FsRGVwZW5kZW5jeSBpbnN0YW5jZSwgc28gd2UgbWFrZSBhIGJlc3QgZWZmb3J0IGhlcmUgdG8gY2FsbCANCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRlYXJEb3duQW5kRGlzcG9zZSBpbiB0aGUgbWF4aW11bSByZXRyeSBwZXJpb2QgY2FzZSBhcyB3ZWxsIGFzIGluIHRoZSBfZXJyb3JTdGF0ZSBjYXNlLg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9lcnJvclN0YXRlIHx8IHJldHJ5U3RvcHdhdGNoLkVsYXBzZWQuU2Vjb25kcyA+PSAzMCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaW1lciByZXRyeVRpbWVyID0gX3JldHJ5VGltZXI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JldHJ5VGltZXIgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXRyeVRpbWVyICE9IG51bGwpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRyeVRpbWVyLkRpc3Bvc2UoKTsgLy8gRGlzcG9zZSB0aW1lciAtIHN0b3AgcmV0cnkgbG9vcCENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGVhckRvd25BbmREaXNwb3NlKCk7IC8vIFdpbGwgbm90IGhpdCBzZXJ2ZXIgdW5sZXNzIGNvbm5lY3Rpb24gb3BlbiENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFlpZWxkIHRoZSB0aHJlYWQgc2luY2UgdGhlIHN0b3AgaGFzIG5vdCB5ZXQgY29tcGxldGVkLg0KICAgICAgICAgICAgICAgICAgICAvLyBUbyBhdm9pZCBDUFUgc3Bpa2VzIHdoaWxlIHdhaXRpbmcsIHlpZWxkIGFuZCB3YWl0IGZvciBhdCBsZWFzdCBvbmUgbWlsbGlzZWNvbmQNCiAgICAgICAgICAgICAgICAgICAgVGhyZWFkLlNsZWVwKDEpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgRGVidWcuQXNzZXJ0KDAgPD0gX3N0YXJ0Q291bnQsICJJbnZhbGlkIHN0YXJ0IGNvdW50IHN0YXRlIik7DQoNCiAgICAgICAgICAgIHJldHVybiBfc3RvcHBlZDsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgdm9pZCBTeW5jaHJvbm91c2x5UXVlcnlTZXJ2aWNlQnJva2VyUXVldWUoKQ0KICAgICAgICB7DQogICAgICAgICAgICB1c2luZyAoU3FsRGF0YVJlYWRlciByZWFkZXIgPSBfY29tLkV4ZWN1dGVSZWFkZXIoKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBQcm9jZXNzTm90aWZpY2F0aW9uUmVzdWx0cyhyZWFkZXIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgW1N1cHByZXNzTWVzc2FnZSgiTWljcm9zb2Z0LlNlY3VyaXR5IiwgIkNBMjEwMDpSZXZpZXdTcWxRdWVyaWVzRm9yU2VjdXJpdHlWdWxuZXJhYmlsaXRpZXMiKV0NCiAgICAgICAgcHJpdmF0ZSB2b2lkIFRlYXJEb3duQW5kRGlzcG9zZSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIGxvY2sgKHRoaXMpDQogICAgICAgICAgICB7IC8vIExvY2sgdG8gZW5zdXJlIFN0b3AoKSAod2l0aCBDYW5jZWwoKSkgY29tcGxldGUgcHJpb3IgdG8gVGVhckRvd24uDQogICAgICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGV4ZWN1dGUgaWYgY29ubmVjdGlvbiBpcyBzdGlsbCB1cCBhbmQgb3Blbi4NCiAgICAgICAgICAgICAgICAgICAgaWYgKENvbm5lY3Rpb25TdGF0ZS5DbG9zZWQgIT0gX2Nvbi5TdGF0ZSAmJiBDb25uZWN0aW9uU3RhdGUuQnJva2VuICE9IF9jb24uU3RhdGUpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfY29tLlBhcmFtZXRlcnMuQ291bnQgPiAxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgeyAvLyBOZWVkIHRvIGNsb3NlIGRpYWxvZyBiZWZvcmUgY29tcGxldGluZy4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiB0aGUgbm9ybWFsIGNhc2UsIHRoZSAiRW5kIENvbnZlcnNhdGlvbiIgcXVlcnkgaXMgZXhlY3V0ZWQgYmVmb3JlIGENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZWNlaXZlIHF1ZXJ5IGFuZCB1cG9uIHJldHVybiB3ZSB3aWxsIGNsZWFyIHRoZSBzdGF0ZS4gIEhvd2V2ZXIsIHVubGVzcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGEgbm9uIG5vdGlmaWNhdGlvbiBxdWVyeSByZXN1bHQgaXMgcmV0dXJuZWQsIHdlIHdpbGwgbm90IGNsZWFyIGl0LiAgVGhhdA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lYW5zIGEgcXVlcnkgaXMgZ2VuZXJhbGx5IGFsd2F5cyBleGVjdXRpbmcgd2l0aCBhbiAiZW5kIGNvbnZlcnNhdGlvbiIgb24NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgd2lyZS4gIFJhdGhlciB0aGFuIHN5bmNocm9uaXplIGZvciBzdWNjZXNzIG9mIHRoZSBvdGhlciAiZW5kIGNvbnZlcnNhdGlvbiIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNpbXBseSByZS1leGVjdXRlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbS5Db21tYW5kVGV4dCA9IF9lbmRDb252ZXJzYXRpb25RdWVyeTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbS5QYXJhbWV0ZXJzLlJlbW92ZShfdGltZW91dFBhcmFtKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbS5FeGVjdXRlTm9uUXVlcnkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBRFAuSXNDYXRjaGFibGVFeGNlcHRpb25UeXBlKGUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBRFAuVHJhY2VFeGNlcHRpb25XaXRob3V0UmV0aHJvdyhlKTsgLy8gRGlzY2FyZCBmYWlsdXJlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9zZXJ2aWNlUXVldWVDcmVhdGVkICYmICFfZXJyb3JTdGF0ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCRUdJTiBUUkFOU0FDVElPTjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRFJPUCBTRVJWSUNFICIrX2VzY2FwZWRRdWV1ZU5hbWUrIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRFJPUCBRVUVVRSAiK19lc2NhcGVkUXVldWVOYW1lKyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERST1AgUFJPQ0VEVVJFICIrX3Nwcm9jTmFtZSsiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDT01NSVQgVFJBTlNBQ1RJT047DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29tLkNvbW1hbmRUZXh0ID0gIkJFR0lOIFRSQU5TQUNUSU9OOyBEUk9QIFNFUlZJQ0UgIiArIF9lc2NhcGVkUXVldWVOYW1lICsgIjsgRFJPUCBRVUVVRSAiICsgX2VzY2FwZWRRdWV1ZU5hbWUgKyAiOyBEUk9QIFBST0NFRFVSRSAiICsgX3Nwcm9jTmFtZSArICI7IENPTU1JVCBUUkFOU0FDVElPTjsiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbS5FeGVjdXRlTm9uUXVlcnkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBRFAuSXNDYXRjaGFibGVFeGNlcHRpb25UeXBlKGUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBRFAuVHJhY2VFeGNlcHRpb25XaXRob3V0UmV0aHJvdyhlKTsgLy8gRGlzY2FyZCBmYWlsdXJlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmaW5hbGx5DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBfc3RvcHBlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIF9jb24uRGlzcG9zZSgpOyAvLyBDbG9zZSBhbmQgZGlzcG9zZSBjb25uZWN0aW9uLg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIFByaXZhdGUgY2xhc3MgZW5jYXBzdWxhdGluZyB0aGUgbm90aWZpY2F0aW9uIHBheWxvYWQgcGFyc2luZyBsb2dpYy4NCg0KICAgIHByaXZhdGUgY2xhc3MgU3FsTm90aWZpY2F0aW9uUGFyc2VyDQogICAgew0KICAgICAgICBbRmxhZ3NdDQogICAgICAgIHByaXZhdGUgZW51bSBNZXNzYWdlQXR0cmlidXRlcw0KICAgICAgICB7DQogICAgICAgICAgICBOb25lID0gMCwNCiAgICAgICAgICAgIFR5cGUgPSAxLA0KICAgICAgICAgICAgU291cmNlID0gMiwNCiAgICAgICAgICAgIEluZm8gPSA0LA0KICAgICAgICAgICAgQWxsID0gVHlwZSArIFNvdXJjZSArIEluZm8sDQogICAgICAgIH0NCg0KICAgICAgICAvLyBub2RlIG5hbWVzIGluIHRoZSBwYXlsb2FkDQogICAgICAgIHByaXZhdGUgY29uc3Qgc3RyaW5nIFJvb3ROb2RlID0gIlF1ZXJ5Tm90aWZpY2F0aW9uIjsNCiAgICAgICAgcHJpdmF0ZSBjb25zdCBzdHJpbmcgTWVzc2FnZU5vZGUgPSAiTWVzc2FnZSI7DQoNCiAgICAgICAgLy8gYXR0cmlidXRlIG5hbWVzIChvbiB0aGUgUXVlcnlOb3RpZmljYXRpb24gZWxlbWVudCkNCiAgICAgICAgcHJpdmF0ZSBjb25zdCBzdHJpbmcgSW5mb0F0dHJpYnV0ZSA9ICJpbmZvIjsNCiAgICAgICAgcHJpdmF0ZSBjb25zdCBzdHJpbmcgU291cmNlQXR0cmlidXRlID0gInNvdXJjZSI7DQogICAgICAgIHByaXZhdGUgY29uc3Qgc3RyaW5nIFR5cGVBdHRyaWJ1dGUgPSAidHlwZSI7DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIFNxbE5vdGlmaWNhdGlvbiBQcm9jZXNzTWVzc2FnZShTcWxYbWwgeG1sTWVzc2FnZSkNCiAgICAgICAgew0KICAgICAgICAgICAgdXNpbmcgKFhtbFJlYWRlciB4bWxSZWFkZXIgPSB4bWxNZXNzYWdlLkNyZWF0ZVJlYWRlcigpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHN0cmluZyBrZXl2YWx1ZSA9IHN0cmluZy5FbXB0eTsNCg0KICAgICAgICAgICAgICAgIE1lc3NhZ2VBdHRyaWJ1dGVzIG1lc3NhZ2VBdHRyaWJ1dGVzID0gTWVzc2FnZUF0dHJpYnV0ZXMuTm9uZTsNCg0KICAgICAgICAgICAgICAgIFNxbE5vdGlmaWNhdGlvblR5cGUgdHlwZSA9IFNxbE5vdGlmaWNhdGlvblR5cGUuVW5rbm93bjsNCiAgICAgICAgICAgICAgICBTcWxOb3RpZmljYXRpb25JbmZvIGluZm8gPSBTcWxOb3RpZmljYXRpb25JbmZvLlVua25vd247DQogICAgICAgICAgICAgICAgU3FsTm90aWZpY2F0aW9uU291cmNlIHNvdXJjZSA9IFNxbE5vdGlmaWNhdGlvblNvdXJjZS5Vbmtub3duOw0KDQogICAgICAgICAgICAgICAgc3RyaW5nIGtleSA9IHN0cmluZy5FbXB0eTsNCg0KICAgICAgICAgICAgICAgIC8vIE1vdmUgdG8gbWFpbiBub2RlLCBleHBlY3RpbmcgIlF1ZXJ5Tm90aWZpY2F0aW9uIi4NCiAgICAgICAgICAgICAgICB4bWxSZWFkZXIuUmVhZCgpOw0KICAgICAgICAgICAgICAgIGlmICgoWG1sTm9kZVR5cGUuRWxlbWVudCA9PSB4bWxSZWFkZXIuTm9kZVR5cGUpICYmDQogICAgICAgICAgICAgICAgICAgICAoUm9vdE5vZGUgPT0geG1sUmVhZGVyLkxvY2FsTmFtZSkgJiYNCiAgICAgICAgICAgICAgICAgICAgICgzIDw9IHhtbFJlYWRlci5BdHRyaWJ1dGVDb3VudCkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBMb29wIHVudGlsIHdlJ3ZlIHByb2Nlc3NlZCBhbGwgdGhlIGF0dHJpYnV0ZXMuDQogICAgICAgICAgICAgICAgICAgIHdoaWxlICgoTWVzc2FnZUF0dHJpYnV0ZXMuQWxsICE9IG1lc3NhZ2VBdHRyaWJ1dGVzKSAmJiAoeG1sUmVhZGVyLk1vdmVUb05leHRBdHRyaWJ1dGUoKSkpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoeG1sUmVhZGVyLkxvY2FsTmFtZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgVHlwZUF0dHJpYnV0ZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNxbE5vdGlmaWNhdGlvblR5cGUgdGVtcCA9IChTcWxOb3RpZmljYXRpb25UeXBlKUVudW0uUGFyc2UodHlwZW9mKFNxbE5vdGlmaWNhdGlvblR5cGUpLCB4bWxSZWFkZXIuVmFsdWUsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChFbnVtLklzRGVmaW5lZCh0eXBlb2YoU3FsTm90aWZpY2F0aW9uVHlwZSksIHRlbXApKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IHRlbXA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQURQLklzQ2F0Y2hhYmxlRXhjZXB0aW9uVHlwZShlKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBRFAuVHJhY2VFeGNlcHRpb25XaXRob3V0UmV0aHJvdyhlKTsgLy8gRGlzY2FyZCBmYWlsdXJlLCBpZiBpdCBzaG91bGQgb2NjdXIuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQXR0cmlidXRlcyB8PSBNZXNzYWdlQXR0cmlidXRlcy5UeXBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgU291cmNlQXR0cmlidXRlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3FsTm90aWZpY2F0aW9uU291cmNlIHRlbXAgPSAoU3FsTm90aWZpY2F0aW9uU291cmNlKUVudW0uUGFyc2UodHlwZW9mKFNxbE5vdGlmaWNhdGlvblNvdXJjZSksIHhtbFJlYWRlci5WYWx1ZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEVudW0uSXNEZWZpbmVkKHR5cGVvZihTcWxOb3RpZmljYXRpb25Tb3VyY2UpLCB0ZW1wKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZSA9IHRlbXA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQURQLklzQ2F0Y2hhYmxlRXhjZXB0aW9uVHlwZShlKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBRFAuVHJhY2VFeGNlcHRpb25XaXRob3V0UmV0aHJvdyhlKTsgLy8gRGlzY2FyZCBmYWlsdXJlLCBpZiBpdCBzaG91bGQgb2NjdXIuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQXR0cmlidXRlcyB8PSBNZXNzYWdlQXR0cmlidXRlcy5Tb3VyY2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBJbmZvQXR0cmlidXRlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nIHZhbHVlID0geG1sUmVhZGVyLlZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDMgb2YgdGhlIHNlcnZlciBpbmZvIHZhbHVlcyBkbyBub3QgbWF0Y2ggY2xpZW50IHZhbHVlcyAtIG1hcC4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHZhbHVlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAic2V0IG9wdGlvbnMiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IFNxbE5vdGlmaWNhdGlvbkluZm8uT3B0aW9uczsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJwcmV2aW91cyBpbnZhbGlkIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBTcWxOb3RpZmljYXRpb25JbmZvLlByZXZpb3VzRmlyZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJxdWVyeSB0ZW1wbGF0ZSBsaW1pdCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvID0gU3FsTm90aWZpY2F0aW9uSW5mby5UZW1wbGF0ZUxpbWl0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcWxOb3RpZmljYXRpb25JbmZvIHRlbXAgPSAoU3FsTm90aWZpY2F0aW9uSW5mbylFbnVtLlBhcnNlKHR5cGVvZihTcWxOb3RpZmljYXRpb25JbmZvKSwgdmFsdWUsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEVudW0uSXNEZWZpbmVkKHR5cGVvZihTcWxOb3RpZmljYXRpb25JbmZvKSwgdGVtcCkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHRlbXA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBRFAuSXNDYXRjaGFibGVFeGNlcHRpb25UeXBlKGUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFEUC5UcmFjZUV4Y2VwdGlvbldpdGhvdXRSZXRocm93KGUpOyAvLyBEaXNjYXJkIGZhaWx1cmUsIGlmIGl0IHNob3VsZCBvY2N1ci4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VBdHRyaWJ1dGVzIHw9IE1lc3NhZ2VBdHRyaWJ1dGVzLkluZm87DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChBcmd1bWVudEV4Y2VwdGlvbiBlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFEUC5UcmFjZUV4Y2VwdGlvbldpdGhvdXRSZXRocm93KGUpOyAvLyBEaXNjYXJkIGZhaWx1cmUsIGJ1dCB0cmFjZS4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmIChNZXNzYWdlQXR0cmlidXRlcy5BbGwgIT0gbWVzc2FnZUF0dHJpYnV0ZXMpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gUHJvY2VlZCB0byB0aGUgIk1lc3NhZ2UiIG5vZGUuDQogICAgICAgICAgICAgICAgICAgIGlmICgheG1sUmVhZGVyLlJlYWQoKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBWZXJpZnkgc3RhdGUgYWZ0ZXIgUmVhZCgpLg0KICAgICAgICAgICAgICAgICAgICBpZiAoKFhtbE5vZGVUeXBlLkVsZW1lbnQgIT0geG1sUmVhZGVyLk5vZGVUeXBlKSB8fCAoMCAhPSBzdHJpbmcuQ29tcGFyZSh4bWxSZWFkZXIuTG9jYWxOYW1lLCBNZXNzYWdlTm9kZSwgU3RyaW5nQ29tcGFyaXNvbi5PcmRpbmFsSWdub3JlQ2FzZSkpKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFByb2NlZWQgdG8gdGhlIFRleHQgTm9kZS4NCiAgICAgICAgICAgICAgICAgICAgaWYgKCF4bWxSZWFkZXIuUmVhZCgpKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFZlcmlmeSBzdGF0ZSBhZnRlciBSZWFkKCkuDQogICAgICAgICAgICAgICAgICAgIGlmICh4bWxSZWFkZXIuTm9kZVR5cGUgIT0gWG1sTm9kZVR5cGUuVGV4dCkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgWG1sVGV4dFJlYWRlciBvbiB0aGUgTWVzc2FnZSBub2RlIHZhbHVlLg0KICAgICAgICAgICAgICAgICAgICB1c2luZyAoWG1sVGV4dFJlYWRlciB4bWxNZXNzYWdlUmVhZGVyID0gbmV3IFhtbFRleHRSZWFkZXIoeG1sUmVhZGVyLlZhbHVlLCBYbWxOb2RlVHlwZS5FbGVtZW50LCBudWxsKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJvY2VlZCB0byB0aGUgVGV4dCBOb2RlLg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF4bWxNZXNzYWdlUmVhZGVyLlJlYWQoKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhtbE1lc3NhZ2VSZWFkZXIuTm9kZVR5cGUgPT0gWG1sTm9kZVR5cGUuVGV4dCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSB4bWxNZXNzYWdlUmVhZGVyLlZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtbE1lc3NhZ2VSZWFkZXIuQ2xvc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3FsTm90aWZpY2F0aW9uKGluZm8sIHNvdXJjZSwgdHlwZSwga2V5KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIGZhaWx1cmUNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBQcml2YXRlIGNsYXNzIGVuY2Fwc3VsYXRpbmcgdGhlIFNxbENvbm5lY3Rpb25Db250YWluZXIgaGFzaCBsb2dpYy4NCg0KICAgIHByaXZhdGUgY2xhc3MgU3FsQ29ubmVjdGlvbkNvbnRhaW5lckhhc2hIZWxwZXINCiAgICB7DQogICAgICAgIC8vIEZvciBkZWZhdWx0LCBxdWV1ZSBpcyBjb21wdXRlZCBpbiBTcWxDb25uZWN0aW9uQ29udGFpbmVyIGNvbnN0cnVjdG9yLCBzbyBxdWV1ZSB3aWxsIGJlIGVtcHR5IGFuZA0KICAgICAgICAvLyBjb25uZWN0aW9uIHN0cmluZyB3aWxsIG5vdCBpbmNsdWRlIGFwcCBuYW1lIGJhc2VkIG9uIHF1ZXVlLiAgQXMgYSByZXN1bHQsIHRoZSBjb25uZWN0aW9uIHN0cmluZw0KICAgICAgICAvLyBidWlsZGVyIHdpbGwgYWx3YXlzIGNvbnRhaW4gdXAgdG8gZGF0ZSBpbmZvLCBidXQgX2Nvbm5lY3Rpb25TdHJpbmcgYW5kIF9xdWV1ZSB3aWxsIG5vdC4NCg0KICAgICAgICAvLyBBcyBhIHJlc3VsdCwgd2Ugd2lsbCBub3QgdXNlIF9jb25uZWN0aW9uU3RyaW5nQnVpbGRlciBhcyBwYXJ0IG9mIEVxdWFscyBvciBHZXRIYXNoQ29kZS4NCg0KICAgICAgICBwcml2YXRlIERiQ29ubmVjdGlvblBvb2xJZGVudGl0eSBfaWRlbnRpdHk7DQogICAgICAgIHByaXZhdGUgc3RyaW5nIF9jb25uZWN0aW9uU3RyaW5nOw0KICAgICAgICBwcml2YXRlIHN0cmluZyBfcXVldWU7DQogICAgICAgIHByaXZhdGUgU3FsQ29ubmVjdGlvblN0cmluZ0J1aWxkZXIgX2Nvbm5lY3Rpb25TdHJpbmdCdWlsZGVyOyAvLyBOb3QgdG8gYmUgdXNlZCBmb3IgY29tcGFyaXNvbiENCg0KICAgICAgICBpbnRlcm5hbCBTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlcihEYkNvbm5lY3Rpb25Qb29sSWRlbnRpdHkgaWRlbnRpdHksIHN0cmluZyBjb25uZWN0aW9uU3RyaW5nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgcXVldWUsIFNxbENvbm5lY3Rpb25TdHJpbmdCdWlsZGVyIGNvbm5lY3Rpb25TdHJpbmdCdWlsZGVyKQ0KICAgICAgICB7DQogICAgICAgICAgICBfaWRlbnRpdHkgPSBpZGVudGl0eTsNCiAgICAgICAgICAgIF9jb25uZWN0aW9uU3RyaW5nID0gY29ubmVjdGlvblN0cmluZzsNCiAgICAgICAgICAgIF9xdWV1ZSA9IHF1ZXVlOw0KICAgICAgICAgICAgX2Nvbm5lY3Rpb25TdHJpbmdCdWlsZGVyID0gY29ubmVjdGlvblN0cmluZ0J1aWxkZXI7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBOb3QgdG8gYmUgdXNlZCBmb3IgY29tcGFyaXNvbiENCiAgICAgICAgaW50ZXJuYWwgU3FsQ29ubmVjdGlvblN0cmluZ0J1aWxkZXIgQ29ubmVjdGlvblN0cmluZ0J1aWxkZXIgPT4gX2Nvbm5lY3Rpb25TdHJpbmdCdWlsZGVyOw0KDQogICAgICAgIGludGVybmFsIERiQ29ubmVjdGlvblBvb2xJZGVudGl0eSBJZGVudGl0eSA9PiBfaWRlbnRpdHk7DQoNCiAgICAgICAgaW50ZXJuYWwgc3RyaW5nIFF1ZXVlID0+IF9xdWV1ZTsNCg0KICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgYm9vbCBFcXVhbHMob2JqZWN0IHZhbHVlKQ0KICAgICAgICB7DQogICAgICAgICAgICBTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlciB0ZW1wID0gKFNxbENvbm5lY3Rpb25Db250YWluZXJIYXNoSGVscGVyKXZhbHVlOw0KDQogICAgICAgICAgICBib29sIHJlc3VsdCA9IGZhbHNlOw0KDQogICAgICAgICAgICAvLyBJZ25vcmUgU3FsQ29ubmVjdGlvblN0cmluZ0J1aWxkZXIsIHNpbmNlIGl0IGlzIHByZXNlbnQgbGFyZ2VseSBmb3IgZGVidWcgcHVycG9zZXMuDQoNCiAgICAgICAgICAgIGlmIChudWxsID09IHRlbXApDQogICAgICAgICAgICB7IC8vIElmIHBhc3NlZCB2YWx1ZSBudWxsIC0gZmFsc2UuDQogICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIGlmICh0aGlzID09IHRlbXApDQogICAgICAgICAgICB7IC8vIElmIGluc3RhbmNlcyBlcXVhbCAtIHRydWUuDQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoKF9pZGVudGl0eSAhPSBudWxsICYmIHRlbXAuX2lkZW50aXR5ID09IG51bGwpIHx8IC8vIElmIFhPUiBvZiBudWxsIGlkZW50aXRpZXMgZmFsc2UgLSBmYWxzZS4NCiAgICAgICAgICAgICAgICAgICAgIChfaWRlbnRpdHkgPT0gbnVsbCAmJiB0ZW1wLl9pZGVudGl0eSAhPSBudWxsKSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIGlmIChfaWRlbnRpdHkgPT0gbnVsbCAmJiB0ZW1wLl9pZGVudGl0eSA9PSBudWxsKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXAuX2Nvbm5lY3Rpb25TdHJpbmcgPT0gX2Nvbm5lY3Rpb25TdHJpbmcgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZy5FcXVhbHModGVtcC5fcXVldWUsIF9xdWV1ZSwgU3RyaW5nQ29tcGFyaXNvbi5PcmRpbmFsSWdub3JlQ2FzZSkpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAodGVtcC5faWRlbnRpdHkuRXF1YWxzKF9pZGVudGl0eSkgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAuX2Nvbm5lY3Rpb25TdHJpbmcgPT0gX2Nvbm5lY3Rpb25TdHJpbmcgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZy5FcXVhbHModGVtcC5fcXVldWUsIF9xdWV1ZSwgU3RyaW5nQ29tcGFyaXNvbi5PcmRpbmFsSWdub3JlQ2FzZSkpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBvdmVycmlkZSBpbnQgR2V0SGFzaENvZGUoKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgaGFzaFZhbHVlID0gMDsNCg0KICAgICAgICAgICAgaWYgKG51bGwgIT0gX2lkZW50aXR5KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGhhc2hWYWx1ZSA9IF9pZGVudGl0eS5HZXRIYXNoQ29kZSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAobnVsbCAhPSBfcXVldWUpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaGFzaFZhbHVlID0gdW5jaGVja2VkKF9jb25uZWN0aW9uU3RyaW5nLkdldEhhc2hDb2RlKCkgKyBfcXVldWUuR2V0SGFzaENvZGUoKSArIGhhc2hWYWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaGFzaFZhbHVlID0gdW5jaGVja2VkKF9jb25uZWN0aW9uU3RyaW5nLkdldEhhc2hDb2RlKCkgKyBoYXNoVmFsdWUpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gaGFzaFZhbHVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gU3FsRGVwZW5kZW5jeVByb2Nlc3NEaXNwYXRjaGVyIHN0YXRpYyBtZW1iZXJzDQoNCiAgICBwcml2YXRlIHN0YXRpYyBTcWxEZXBlbmRlbmN5UHJvY2Vzc0Rpc3BhdGNoZXIgc19zdGF0aWNJbnN0YW5jZSA9IG5ldyBTcWxEZXBlbmRlbmN5UHJvY2Vzc0Rpc3BhdGNoZXIobnVsbCk7DQoNCiAgICAvLyBEaWN0aW9uYXJpZXMgdXNlZCBhcyBtYXBzLg0KICAgIHByaXZhdGUgRGljdGlvbmFyeTxTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlciwgU3FsQ29ubmVjdGlvbkNvbnRhaW5lcj4gX2Nvbm5lY3Rpb25Db250YWluZXJzOyAgICAgICAgICAgICAgICAgLy8gTlRfSUQrQ29uU3RyK1NlcnZpY2UtPkNvbnRhaW5lcg0KICAgIHByaXZhdGUgRGljdGlvbmFyeTxzdHJpbmcsIFNxbERlcGVuZGVuY3lQZXJBcHBEb21haW5EaXNwYXRjaGVyPiBfc3FsRGVwZW5kZW5jeVBlckFwcERvbWFpbkRpc3BhdGNoZXJzOyAvLyBBcHBEb21haW5LZXktPkNhbGxiYWNrDQoNCiAgICAvLyBDb25zdHJ1Y3RvcnMNCg0KICAgIC8vIFByaXZhdGUgY29uc3RydWN0b3IgLSBvbmx5IGNhbGxlZCBieSBwdWJsaWMgY29uc3RydWN0b3IgZm9yIHN0YXRpYyBpbml0aWFsaXphdGlvbi4NCiAgICBwcml2YXRlIFNxbERlcGVuZGVuY3lQcm9jZXNzRGlzcGF0Y2hlcihvYmplY3QgZHVtbXlWYXJpYWJsZSkNCiAgICB7DQogICAgICAgIERlYnVnLkFzc2VydChudWxsID09IHNfc3RhdGljSW5zdGFuY2UsICJSZWFsIGNvbnN0cnVjdG9yIGNhbGxlZCB3aXRoIHN0YXRpYyBpbnN0YW5jZSBhbHJlYWR5IGNyZWF0ZWQhIik7DQoNCiAgICAgICAgX2Nvbm5lY3Rpb25Db250YWluZXJzID0gbmV3IERpY3Rpb25hcnk8U3FsQ29ubmVjdGlvbkNvbnRhaW5lckhhc2hIZWxwZXIsIFNxbENvbm5lY3Rpb25Db250YWluZXI+KCk7DQogICAgICAgIF9zcWxEZXBlbmRlbmN5UGVyQXBwRG9tYWluRGlzcGF0Y2hlcnMgPSBuZXcgRGljdGlvbmFyeTxzdHJpbmcsIFNxbERlcGVuZGVuY3lQZXJBcHBEb21haW5EaXNwYXRjaGVyPigpOw0KICAgIH0NCg0KICAgIC8vIENvbnN0cnVjdG9yIGlzIG9ubHkgY2FsbGVkIGJ5IHJlbW90aW5nLg0KICAgIC8vIFJlcXVpcmVkIHRvIGJlIHB1YmxpYywgZXZlbiBvbiBpbnRlcm5hbCBjbGFzcywgZm9yIFJlbW90aW5nIGluZnJhc3RydWN0dXJlLg0KICAgIHB1YmxpYyBTcWxEZXBlbmRlbmN5UHJvY2Vzc0Rpc3BhdGNoZXIoKQ0KICAgIHsNCiAgICAgICAgLy8gRW1wdHkgY29uc3RydWN0b3IgYW5kIG9iamVjdCAtIGR1bW15IHRvIG9idGFpbiBzaW5nbGV0b24uDQogICAgfQ0KDQogICAgLy8gUHJvcGVydGllcw0KDQogICAgaW50ZXJuYWwgc3RhdGljIFNxbERlcGVuZGVuY3lQcm9jZXNzRGlzcGF0Y2hlciBTaW5nbGV0b25Qcm9jZXNzRGlzcGF0Y2hlciA9PiBzX3N0YXRpY0luc3RhbmNlOw0KDQogICAgLy8gVmFyaW91cyBwcml2YXRlIG1ldGhvZHMNCg0KICAgIHByaXZhdGUgc3RhdGljIFNxbENvbm5lY3Rpb25Db250YWluZXJIYXNoSGVscGVyIEdldEhhc2hIZWxwZXIoDQogICAgICAgIHN0cmluZyBjb25uZWN0aW9uU3RyaW5nLA0KICAgICAgICBvdXQgU3FsQ29ubmVjdGlvblN0cmluZ0J1aWxkZXIgY29ubmVjdGlvblN0cmluZ0J1aWxkZXIsDQogICAgICAgIG91dCBEYkNvbm5lY3Rpb25Qb29sSWRlbnRpdHkgaWRlbnRpdHksDQogICAgICAgIG91dCBzdHJpbmcgdXNlciwNCiAgICAgICAgICAgIHN0cmluZyBxdWV1ZSkNCiAgICB7DQogICAgICAgIC8vIEZvcmNlIGNlcnRhaW4gY29ubmVjdGlvbiBzdHJpbmcgcHJvcGVydGllcyB0byBiZSB1c2VkIGJ5IFNxbERlcGVuZGVuY3lQcm9jZXNzRGlzcGF0Y2hlci4gIA0KICAgICAgICAvLyBUaGlzIGxvZ2ljIGlzIGRvbmUgaGVyZSB0byBlbmFibGUgdXMgdG8gaGF2ZSB0aGUgY29tcGxldGUgY29ubmVjdGlvbiBzdHJpbmcgbm93IHRvIGJlIHVzZWQNCiAgICAgICAgLy8gZm9yIHRyYWNpbmcgYXMgd2UgZmxvdyB0aHJvdWdoIHRoZSBsb2dpYy4NCiAgICAgICAgY29ubmVjdGlvblN0cmluZ0J1aWxkZXIgPSBuZXcgU3FsQ29ubmVjdGlvblN0cmluZ0J1aWxkZXIoY29ubmVjdGlvblN0cmluZykNCiAgICAgICAgew0KICAgICAgICAgICAgUG9vbGluZyA9IGZhbHNlLA0KICAgICAgICAgICAgRW5saXN0ID0gZmFsc2UsDQogICAgICAgICAgICBDb25uZWN0UmV0cnlDb3VudCA9IDANCiAgICAgICAgfTsNCiAgICAgICAgaWYgKG51bGwgIT0gcXVldWUpDQogICAgICAgIHsgLy8gVXNlciBwcm92aWRlZCENCiAgICAgICAgICAgIGNvbm5lY3Rpb25TdHJpbmdCdWlsZGVyLkFwcGxpY2F0aW9uTmFtZSA9IHF1ZXVlOyAvLyBBcHBsaWNhdGlvbk5hbWUgd2lsbCBiZSBzZXQgdG8gcXVldWUgbmFtZS4NCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChjb25uZWN0aW9uU3RyaW5nQnVpbGRlci5JbnRlZ3JhdGVkU2VjdXJpdHkpDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIFVzZSBleGlzdGluZyBpZGVudGl0eSBpbmZyYXN0cnVjdHVyZSBmb3IgZXJyb3IgY2FzZXMgYW5kIHByb3BlciBoYXNoIHZhbHVlLg0KICAgICAgICAgICAgaWRlbnRpdHkgPSBEYkNvbm5lY3Rpb25Qb29sSWRlbnRpdHkuR2V0Q3VycmVudCgpOw0KICAgICAgICAgICAgdXNlciA9IG51bGw7DQogICAgICAgIH0NCiAgICAgICAgZWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBpZGVudGl0eSA9IG51bGw7DQogICAgICAgICAgICB1c2VyID0gY29ubmVjdGlvblN0cmluZ0J1aWxkZXIuVXNlcklEOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlcihpZGVudGl0eSwgY29ubmVjdGlvblN0cmluZ0J1aWxkZXIuQ29ubmVjdGlvblN0cmluZywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZSwgY29ubmVjdGlvblN0cmluZ0J1aWxkZXIpOw0KICAgIH0NCg0KICAgIC8vIE5lZWRlZCBmb3IgcmVtb3RpbmcgdG8gcHJldmVudCBsaWZldGltZSBpc3N1ZXMgYW5kIGRlZmF1bHQgR0MgY2xlYW51cC4NCiAgICBwdWJsaWMgb3ZlcnJpZGUgb2JqZWN0IEluaXRpYWxpemVMaWZldGltZVNlcnZpY2UoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KDQogICAgcHJpdmF0ZSB2b2lkIEludmFsaWRhdGUoc3RyaW5nIHNlcnZlciwgU3FsTm90aWZpY2F0aW9uIHNxbE5vdGlmaWNhdGlvbikNCiAgICB7DQogICAgICAgIERlYnVnLkFzc2VydCh0aGlzID09IHNfc3RhdGljSW5zdGFuY2UsICJJbnN0YW5jZSBtZXRob2QgY2FsbGVkIG9uIG5vbiBfc3RhdGljSW5zdGFuY2UgaW5zdGFuY2UhIik7DQogICAgICAgIGxvY2sgKF9zcWxEZXBlbmRlbmN5UGVyQXBwRG9tYWluRGlzcGF0Y2hlcnMpDQogICAgICAgIHsNCg0KICAgICAgICAgICAgZm9yZWFjaCAoS2V5VmFsdWVQYWlyPHN0cmluZywgU3FsRGVwZW5kZW5jeVBlckFwcERvbWFpbkRpc3BhdGNoZXI+IGVudHJ5IGluIF9zcWxEZXBlbmRlbmN5UGVyQXBwRG9tYWluRGlzcGF0Y2hlcnMpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgU3FsRGVwZW5kZW5jeVBlckFwcERvbWFpbkRpc3BhdGNoZXIgcGVyQXBwRG9tYWluRGlzcGF0Y2hlciA9IGVudHJ5LlZhbHVlOw0KICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgcGVyQXBwRG9tYWluRGlzcGF0Y2hlci5JbnZhbGlkYXRlU2VydmVyKHNlcnZlciwgc3FsTm90aWZpY2F0aW9uKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBmKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gU2luY2Ugd2UgYXJlIGxvb3Bpbmcgb3ZlciBkZXBlbmRlbmN5IGRpc3BhdGNoZXJzLCBkbyBub3QgYWxsb3cgb25lIEludmFsaWRhdGUNCiAgICAgICAgICAgICAgICAgICAgLy8gdGhhdCByZXN1bHRzIGluIGEgdGhyb3cgcHJldmVudCB1cyBmcm9tIGludmFsaWRhdGluZyBhbGwgZGVwZW5kZW5jaWVzDQogICAgICAgICAgICAgICAgICAgIC8vIHJlbGF0ZWQgdG8gdGhpcyBzZXJ2ZXIuDQogICAgICAgICAgICAgICAgICAgIC8vIE5PVEUgLSBTcWxEZXBlbmRlbmN5UGVyQXBwRG9tYWluRGlzcGF0Y2hlciBhbHJlYWR5IHdyYXBzIGluZGl2aWR1YWwgZGVwZW5kZW5jeSBpbnZhbGlkYXRlcw0KICAgICAgICAgICAgICAgICAgICAvLyB3aXRoIHRyeS9jYXRjaCwgYnV0IHdlIHNob3VsZCBiZSBjYXJlZnVsIGFuZCBkbyB0aGUgc2FtZSBoZXJlLg0KICAgICAgICAgICAgICAgICAgICBpZiAoIUFEUC5Jc0NhdGNoYWJsZUV4Y2VwdGlvblR5cGUoZikpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIEFEUC5UcmFjZUV4Y2VwdGlvbldpdGhvdXRSZXRocm93KGYpOyAvLyBEaXNjYXJkIGZhaWx1cmUsIGJ1dCB0cmFjZS4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBDbGVhbi11cCBtZXRob2QgaW5pdGlhdGVkIGJ5IG90aGVyIEFwcERvbWFpbi5VbmxvYWRzDQoNCiAgICAvLyBJbmRpdmlkdWFsIEFwcERvbWFpbnMgdXBvbiBBcHBEb21haW4uVW5sb2FkRXZlbnQgd2lsbCBjYWxsIHRoaXMgbWV0aG9kLg0KICAgIGludGVybmFsIHZvaWQgUXVldWVBcHBEb21haW5VbmxvYWRpbmcoc3RyaW5nIGFwcERvbWFpbktleSkNCiAgICB7DQogICAgICAgIFRocmVhZFBvb2wuUXVldWVVc2VyV29ya0l0ZW0obmV3IFdhaXRDYWxsYmFjayhBcHBEb21haW5VbmxvYWRpbmcpLCBhcHBEb21haW5LZXkpOw0KICAgIH0NCg0KICAgIC8vIFRoaXMgbWV0aG9kIGlzIG9ubHkgY2FsbGVkIGJ5IHF1ZXVlZCB3b3JrLWl0ZW1zIGZyb20gdGhlIG1ldGhvZCBhYm92ZS4NCiAgICBwcml2YXRlIHZvaWQgQXBwRG9tYWluVW5sb2FkaW5nKG9iamVjdCBzdGF0ZSkNCiAgICB7DQogICAgICAgIHN0cmluZyBhcHBEb21haW5LZXkgPSAoc3RyaW5nKXN0YXRlOw0KDQogICAgICAgIERlYnVnLkFzc2VydCh0aGlzID09IHNfc3RhdGljSW5zdGFuY2UsICJJbnN0YW5jZSBtZXRob2QgY2FsbGVkIG9uIG5vbiBfc3RhdGljSW5zdGFuY2UgaW5zdGFuY2UhIik7DQogICAgICAgIGxvY2sgKF9jb25uZWN0aW9uQ29udGFpbmVycykNCiAgICAgICAgew0KICAgICAgICAgICAgTGlzdDxTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlcj4gY29udGFpbmVyc1RvUmVtb3ZlID0gbmV3IExpc3Q8U3FsQ29ubmVjdGlvbkNvbnRhaW5lckhhc2hIZWxwZXI+KCk7DQoNCiAgICAgICAgICAgIGZvcmVhY2ggKEtleVZhbHVlUGFpcjxTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlciwgU3FsQ29ubmVjdGlvbkNvbnRhaW5lcj4gZW50cnkgaW4gX2Nvbm5lY3Rpb25Db250YWluZXJzKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFNxbENvbm5lY3Rpb25Db250YWluZXIgY29udGFpbmVyID0gZW50cnkuVmFsdWU7DQogICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5BcHBEb21haW5VbmxvYWQoYXBwRG9tYWluS2V5KSkNCiAgICAgICAgICAgICAgICB7IC8vIFBlcmhhcHMgd3JhcCBpbiB0cnkgY2F0Y2guDQogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcnNUb1JlbW92ZS5BZGQoY29udGFpbmVyLkhhc2hIZWxwZXIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZm9yZWFjaCAoU3FsQ29ubmVjdGlvbkNvbnRhaW5lckhhc2hIZWxwZXIgaGFzaEhlbHBlciBpbiBjb250YWluZXJzVG9SZW1vdmUpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgX2Nvbm5lY3Rpb25Db250YWluZXJzLlJlbW92ZShoYXNoSGVscGVyKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGxvY2sgKF9zcWxEZXBlbmRlbmN5UGVyQXBwRG9tYWluRGlzcGF0Y2hlcnMpDQogICAgICAgIHsgLy8gUmVtb3ZlIGZyb20gZ2xvYmFsIERpY3Rpb25hcnkuDQogICAgICAgICAgICBfc3FsRGVwZW5kZW5jeVBlckFwcERvbWFpbkRpc3BhdGNoZXJzLlJlbW92ZShhcHBEb21haW5LZXkpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gLS0tLS0tLS0tLS0tLQ0KICAgIC8vIFN0YXJ0IG1ldGhvZHMNCiAgICAvLyAtLS0tLS0tLS0tLS0tDQoNCiAgICBpbnRlcm5hbCBib29sIFN0YXJ0V2l0aERlZmF1bHQoDQogICAgICAgIHN0cmluZyBjb25uZWN0aW9uU3RyaW5nLA0KICAgICAgICBvdXQgc3RyaW5nIHNlcnZlciwNCiAgICAgICAgb3V0IERiQ29ubmVjdGlvblBvb2xJZGVudGl0eSBpZGVudGl0eSwNCiAgICAgICAgb3V0IHN0cmluZyB1c2VyLA0KICAgICAgICBvdXQgc3RyaW5nIGRhdGFiYXNlLA0KICAgICAgICByZWYgc3RyaW5nIHNlcnZpY2UsDQogICAgICAgICAgICBzdHJpbmcgYXBwRG9tYWluS2V5LA0KICAgICAgICAgICAgU3FsRGVwZW5kZW5jeVBlckFwcERvbWFpbkRpc3BhdGNoZXIgZGlzcGF0Y2hlciwNCiAgICAgICAgb3V0IGJvb2wgZXJyb3JPY2N1cnJlZCwNCiAgICAgICAgb3V0IGJvb2wgYXBwRG9tYWluU3RhcnQpDQogICAgew0KICAgICAgICBEZWJ1Zy5Bc3NlcnQodGhpcyA9PSBzX3N0YXRpY0luc3RhbmNlLCAiSW5zdGFuY2UgbWV0aG9kIGNhbGxlZCBvbiBub24gX3N0YXRpY0luc3RhbmNlIGluc3RhbmNlISIpOw0KICAgICAgICByZXR1cm4gU3RhcnQoDQogICAgICAgICAgICBjb25uZWN0aW9uU3RyaW5nLA0KICAgICAgICAgICAgb3V0IHNlcnZlciwNCiAgICAgICAgICAgIG91dCBpZGVudGl0eSwNCiAgICAgICAgICAgIG91dCB1c2VyLA0KICAgICAgICAgICAgb3V0IGRhdGFiYXNlLA0KICAgICAgICAgICAgcmVmIHNlcnZpY2UsDQogICAgICAgICAgICAgICAgYXBwRG9tYWluS2V5LA0KICAgICAgICAgICAgICAgIGRpc3BhdGNoZXIsDQogICAgICAgICAgICBvdXQgZXJyb3JPY2N1cnJlZCwNCiAgICAgICAgICAgIG91dCBhcHBEb21haW5TdGFydCwNCiAgICAgICAgICAgICAgICB0cnVlKTsNCiAgICB9DQoNCiAgICBpbnRlcm5hbCBib29sIFN0YXJ0KA0KICAgICAgICBzdHJpbmcgY29ubmVjdGlvblN0cmluZywNCiAgICAgICAgc3RyaW5nIHF1ZXVlLA0KICAgICAgICBzdHJpbmcgYXBwRG9tYWluS2V5LA0KICAgICAgICBTcWxEZXBlbmRlbmN5UGVyQXBwRG9tYWluRGlzcGF0Y2hlciBkaXNwYXRjaGVyKQ0KICAgIHsNCiAgICAgICAgRGVidWcuQXNzZXJ0KHRoaXMgPT0gc19zdGF0aWNJbnN0YW5jZSwgIkluc3RhbmNlIG1ldGhvZCBjYWxsZWQgb24gbm9uIF9zdGF0aWNJbnN0YW5jZSBpbnN0YW5jZSEiKTsNCiAgICAgICAgcmV0dXJuIFN0YXJ0KA0KICAgICAgICAgICAgY29ubmVjdGlvblN0cmluZywNCiAgICAgICAgICAgIG91dCBzdHJpbmcgZHVtbXlWYWx1ZTEsDQogICAgICAgICAgICBvdXQgRGJDb25uZWN0aW9uUG9vbElkZW50aXR5IGR1bW15VmFsdWUzLA0KICAgICAgICAgICAgb3V0IGR1bW15VmFsdWUxLA0KICAgICAgICAgICAgb3V0IGR1bW15VmFsdWUxLA0KICAgICAgICAgICAgcmVmIHF1ZXVlLA0KICAgICAgICAgICAgICAgIGFwcERvbWFpbktleSwNCiAgICAgICAgICAgICAgICBkaXNwYXRjaGVyLA0KICAgICAgICAgICAgb3V0IGJvb2wgZHVtbXlWYWx1ZTIsDQogICAgICAgICAgICBvdXQgZHVtbXlWYWx1ZTIsDQogICAgICAgICAgICAgICAgZmFsc2UpOw0KICAgIH0NCg0KICAgIHByaXZhdGUgYm9vbCBTdGFydCgNCiAgICAgICAgc3RyaW5nIGNvbm5lY3Rpb25TdHJpbmcsDQogICAgICAgIG91dCBzdHJpbmcgc2VydmVyLA0KICAgICAgICBvdXQgRGJDb25uZWN0aW9uUG9vbElkZW50aXR5IGlkZW50aXR5LA0KICAgICAgICBvdXQgc3RyaW5nIHVzZXIsDQogICAgICAgIG91dCBzdHJpbmcgZGF0YWJhc2UsDQogICAgICAgIHJlZiBzdHJpbmcgcXVldWVTZXJ2aWNlLA0KICAgICAgICAgICAgc3RyaW5nIGFwcERvbWFpbktleSwNCiAgICAgICAgICAgIFNxbERlcGVuZGVuY3lQZXJBcHBEb21haW5EaXNwYXRjaGVyIGRpc3BhdGNoZXIsDQogICAgICAgIG91dCBib29sIGVycm9yT2NjdXJyZWQsDQogICAgICAgIG91dCBib29sIGFwcERvbWFpblN0YXJ0LA0KICAgICAgICAgICAgYm9vbCB1c2VEZWZhdWx0cykNCiAgICB7DQogICAgICAgIERlYnVnLkFzc2VydCh0aGlzID09IHNfc3RhdGljSW5zdGFuY2UsICJJbnN0YW5jZSBtZXRob2QgY2FsbGVkIG9uIG5vbiBfc3RhdGljSW5zdGFuY2UgaW5zdGFuY2UhIik7DQogICAgICAgIHNlcnZlciA9IG51bGw7ICAvLyBSZXNldCBvdXQgcGFyYW1zLg0KICAgICAgICBpZGVudGl0eSA9IG51bGw7DQogICAgICAgIHVzZXIgPSBudWxsOw0KICAgICAgICBkYXRhYmFzZSA9IG51bGw7DQogICAgICAgIGVycm9yT2NjdXJyZWQgPSBmYWxzZTsNCiAgICAgICAgYXBwRG9tYWluU3RhcnQgPSBmYWxzZTsNCg0KICAgICAgICBsb2NrIChfc3FsRGVwZW5kZW5jeVBlckFwcERvbWFpbkRpc3BhdGNoZXJzKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoIV9zcWxEZXBlbmRlbmN5UGVyQXBwRG9tYWluRGlzcGF0Y2hlcnMuQ29udGFpbnNLZXkoYXBwRG9tYWluS2V5KSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBfc3FsRGVwZW5kZW5jeVBlckFwcERvbWFpbkRpc3BhdGNoZXJzW2FwcERvbWFpbktleV0gPSBkaXNwYXRjaGVyOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgU3FsQ29ubmVjdGlvbkNvbnRhaW5lckhhc2hIZWxwZXIgaGFzaEhlbHBlciA9IEdldEhhc2hIZWxwZXIoY29ubmVjdGlvblN0cmluZywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dCBTcWxDb25uZWN0aW9uU3RyaW5nQnVpbGRlciBjb25uZWN0aW9uU3RyaW5nQnVpbGRlciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dCBpZGVudGl0eSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dCB1c2VyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlU2VydmljZSk7DQoNCiAgICAgICAgYm9vbCBzdGFydGVkID0gZmFsc2U7DQoNCiAgICAgICAgU3FsQ29ubmVjdGlvbkNvbnRhaW5lciBjb250YWluZXIgPSBudWxsOw0KICAgICAgICBsb2NrIChfY29ubmVjdGlvbkNvbnRhaW5lcnMpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICghX2Nvbm5lY3Rpb25Db250YWluZXJzLkNvbnRhaW5zS2V5KGhhc2hIZWxwZXIpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IG5ldyBTcWxDb25uZWN0aW9uQ29udGFpbmVyKGhhc2hIZWxwZXIsIGFwcERvbWFpbktleSwgdXNlRGVmYXVsdHMpOw0KICAgICAgICAgICAgICAgIF9jb25uZWN0aW9uQ29udGFpbmVycy5BZGQoaGFzaEhlbHBlciwgY29udGFpbmVyKTsNCiAgICAgICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBhcHBEb21haW5TdGFydCA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgY29udGFpbmVyID0gX2Nvbm5lY3Rpb25Db250YWluZXJzW2hhc2hIZWxwZXJdOw0KICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuSW5FcnJvclN0YXRlKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JPY2N1cnJlZCA9IHRydWU7IC8vIFNldCBvdXRwYXJhbSBlcnJvck9jY3VycmVkIHRydWUgc28gd2UgaW52YWxpZGF0ZSBvbiBTdGFydCgpLg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuSW5jcmVtZW50U3RhcnRDb3VudChhcHBEb21haW5LZXksIG91dCBhcHBEb21haW5TdGFydCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHVzZURlZmF1bHRzICYmICFlcnJvck9jY3VycmVkKQ0KICAgICAgICB7IC8vIFJldHVybiBzZXJ2ZXIsIGRhdGFiYXNlLCBhbmQgcXVldWUgZm9yIHVzZSBieSBTcWxEZXBlbmRlbmN5Lg0KICAgICAgICAgICAgc2VydmVyID0gY29udGFpbmVyLlNlcnZlcjsNCiAgICAgICAgICAgIGRhdGFiYXNlID0gY29udGFpbmVyLkRhdGFiYXNlOw0KICAgICAgICAgICAgcXVldWVTZXJ2aWNlID0gY29udGFpbmVyLlF1ZXVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHN0YXJ0ZWQ7DQogICAgfQ0KDQogICAgLy8gU3RvcCBtZXRob2RzDQoNCiAgICBpbnRlcm5hbCBib29sIFN0b3AoDQogICAgICAgIHN0cmluZyBjb25uZWN0aW9uU3RyaW5nLA0KICAgICAgICBvdXQgc3RyaW5nIHNlcnZlciwNCiAgICAgICAgb3V0IERiQ29ubmVjdGlvblBvb2xJZGVudGl0eSBpZGVudGl0eSwNCiAgICAgICAgb3V0IHN0cmluZyB1c2VyLA0KICAgICAgICBvdXQgc3RyaW5nIGRhdGFiYXNlLA0KICAgICAgICByZWYgc3RyaW5nIHF1ZXVlU2VydmljZSwNCiAgICAgICAgICAgIHN0cmluZyBhcHBEb21haW5LZXksDQogICAgICAgIG91dCBib29sIGFwcERvbWFpblN0b3ApDQogICAgew0KICAgICAgICAgRGVidWcuQXNzZXJ0KHRoaXMgPT0gc19zdGF0aWNJbnN0YW5jZSwgIkluc3RhbmNlIG1ldGhvZCBjYWxsZWQgb24gbm9uIF9zdGF0aWNJbnN0YW5jZSBpbnN0YW5jZSEiKTsNCiAgICAgICAgIHNlcnZlciA9IG51bGw7ICAvLyBSZXNldCBvdXQgcGFyYW0uDQogICAgICAgICBpZGVudGl0eSA9IG51bGw7DQogICAgICAgICB1c2VyID0gbnVsbDsNCiAgICAgICAgIGRhdGFiYXNlID0gbnVsbDsNCiAgICAgICAgIGFwcERvbWFpblN0b3AgPSBmYWxzZTsNCg0KICAgICAgICBTcWxDb25uZWN0aW9uQ29udGFpbmVySGFzaEhlbHBlciBoYXNoSGVscGVyID0gR2V0SGFzaEhlbHBlcihjb25uZWN0aW9uU3RyaW5nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dCBTcWxDb25uZWN0aW9uU3RyaW5nQnVpbGRlciBjb25uZWN0aW9uU3RyaW5nQnVpbGRlciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQgaWRlbnRpdHksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0IHVzZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlU2VydmljZSk7DQoNCiAgICAgICAgYm9vbCBzdG9wcGVkID0gZmFsc2U7DQoNCiAgICAgICAgIGxvY2sgKF9jb25uZWN0aW9uQ29udGFpbmVycykNCiAgICAgICAgIHsNCiAgICAgICAgICAgICBpZiAoX2Nvbm5lY3Rpb25Db250YWluZXJzLkNvbnRhaW5zS2V5KGhhc2hIZWxwZXIpKQ0KICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgU3FsQ29ubmVjdGlvbkNvbnRhaW5lciBjb250YWluZXIgPSBfY29ubmVjdGlvbkNvbnRhaW5lcnNbaGFzaEhlbHBlcl07DQogICAgICAgICAgICAgICAgIHNlcnZlciA9IGNvbnRhaW5lci5TZXJ2ZXI7ICAgLy8gUmV0dXJuIHNlcnZlciwgZGF0YWJhc2UsIGFuZCBxdWV1ZSBpbmZvIGZvciB1c2UgYnkgY2FsbGluZyBTcWxEZXBlbmRlbmN5Lg0KICAgICAgICAgICAgICAgICBkYXRhYmFzZSA9IGNvbnRhaW5lci5EYXRhYmFzZTsNCiAgICAgICAgICAgICAgICAgcXVldWVTZXJ2aWNlID0gY29udGFpbmVyLlF1ZXVlOw0KDQogICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuU3RvcChhcHBEb21haW5LZXksIG91dCBhcHBEb21haW5TdG9wKSkNCiAgICAgICAgICAgICAgICAgeyAvLyBTdG9wIGNhbiBiZSBibG9ja2luZyBpZiByZWZDb3VudCA9PSAwIG9uIGNvbnRhaW5lci4NCiAgICAgICAgICAgICAgICAgICAgIHN0b3BwZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgX2Nvbm5lY3Rpb25Db250YWluZXJzLlJlbW92ZShoYXNoSGVscGVyKTsgLy8gUmVtb3ZlIGZyb20gY29sbGVjdGlvbi4NCiAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgIH0NCiAgICAgICAgIH0NCg0KICAgICAgICAgcmV0dXJuIHN0b3BwZWQ7DQogICAgfQ0KfQ0K"
        },
        "file:///C:/corefx/src/System.Data.SqlClient/tests/Tools/TDS/TDS.Servers/TDSServerArguments.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5JTzsNCnVzaW5nIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuWDUwOUNlcnRpZmljYXRlczsNCg0KdXNpbmcgTWljcm9zb2Z0LlNxbFNlcnZlci5URFMuUHJlTG9naW47DQoNCm5hbWVzcGFjZSBNaWNyb3NvZnQuU3FsU2VydmVyLlREUy5TZXJ2ZXJzDQp7DQogICAgLy8vIDxzdW1tYXJ5Pg0KICAgIC8vLyBDb21tb24gYXJndW1lbnRzIGZvciBURFMgU2VydmVyDQogICAgLy8vIDwvc3VtbWFyeT4NCiAgICBwdWJsaWMgY2xhc3MgVERTU2VydmVyQXJndW1lbnRzDQogICAgew0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBTZXJ2aWNlIFByaW5jaXBhbCBOYW1lLCByZXByZXNlbnRpbmcgQXp1cmUgU1FMIERhdGFiYXNlIGluIEF6dXJlIEFjdGl2ZSBEaXJlY3RvcnkuDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIHB1YmxpYyBjb25zdCBzdHJpbmcgQXp1cmVBRFNlcnZpY2VQcmluY2lwYWxOYW1lID0gQCJodHRwczovL2RhdGFiYXNlLndpbmRvd3MubmV0LyI7DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gVGhlIEF6dXJlIEFjdGl2ZSBEaXJlY3RvcnkgcHJvZHVjdGlvbiB0b2tlbiBlbmRwb2ludCB0byByZS1kaXJlY3QgdGhlIGNsaWVudCB0byBmZXRjaCBhIHRva2VuIGZyb20uDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIHB1YmxpYyBjb25zdCBzdHJpbmcgQXp1cmVBRFByb2R1Y3Rpb25Ub2tlbkVuZHBvaW50ID0gQCJodHRwczovL2xvZ2luLndpbmRvd3MubmV0L2NvbW1vbiI7DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gTG9nIHRvIHdoaWNoIHNlbmQgVERTIGNvbnZlcnNhdGlvbg0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBwdWJsaWMgVGV4dFdyaXRlciBMb2cgeyBnZXQ7IHNldDsgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIFNlcnZlciBuYW1lDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIHB1YmxpYyBzdHJpbmcgU2VydmVyTmFtZSB7IGdldDsgc2V0OyB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gU2VydmVyIHZlcnNpb24NCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgcHVibGljIFZlcnNpb24gU2VydmVyVmVyc2lvbiB7IGdldDsgc2V0OyB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gU2VydmVyIHByaW5jaXBhbCBuYW1lDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIHB1YmxpYyBzdHJpbmcgU2VydmVyUHJpbmNpcGFsTmFtZSB7IGdldDsgc2V0OyB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gU3RzIFVybA0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBwdWJsaWMgc3RyaW5nIFN0c1VybCB7IGdldDsgc2V0OyB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gU2l6ZSBvZiB0aGUgVERTIHBhY2tldCBzZXJ2ZXIgc2hvdWxkIG9wZXJhdGUgd2l0aA0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBwdWJsaWMgaW50IFBhY2tldFNpemUgeyBnZXQ7IHNldDsgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIFRyYW5zcG9ydCBlbmNyeXB0aW9uDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIHB1YmxpYyBURFNQcmVMb2dpblRva2VuRW5jcnlwdGlvblR5cGUgRW5jcnlwdGlvbiB7IGdldDsgc2V0OyB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gU3BlY2lmaWVzIHRoZSBGZWRBdXRoUmVxdWlyZWQgb3B0aW9uDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIHB1YmxpYyBUZHNQcmVMb2dpbkZlZEF1dGhSZXF1aXJlZE9wdGlvbiBGZWRBdXRoUmVxdWlyZWRQcmVMb2dpbk9wdGlvbiB7IGdldDsgc2V0OyB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gQ2VydGlmaWNhdGUgdG8gdXNlIGZvciB0cmFuc3BvcnQgZW5jcnlwdGlvbg0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICBwdWJsaWMgWDUwOUNlcnRpZmljYXRlIEVuY3J5cHRpb25DZXJ0aWZpY2F0ZSB7IGdldDsgc2V0OyB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gSW5pdGlhbGl6YXRpb24gY29uc3RydWN0b3INCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgcHVibGljIFREU1NlcnZlckFyZ3VtZW50cygpDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIEFzc2lnbiBkZWZhdWx0IHNlcnZlciB2ZXJzaW9uDQogICAgICAgICAgICBTZXJ2ZXJOYW1lID0gRW52aXJvbm1lbnQuTWFjaGluZU5hbWU7DQogICAgICAgICAgICBTZXJ2ZXJWZXJzaW9uID0gbmV3IFZlcnNpb24oMTEsIDAsIDEwODMpOw0KDQogICAgICAgICAgICAvLyBEZWZhdWx0IHBhY2tldCBzaXplDQogICAgICAgICAgICBQYWNrZXRTaXplID0gNDA5NjsNCg0KICAgICAgICAgICAgLy8gQnkgZGVmYXVsdCB3ZSBkb24ndCBzdXBwb3J0IGVuY3J5cHRpb24NCiAgICAgICAgICAgIEVuY3J5cHRpb24gPSBURFNQcmVMb2dpblRva2VuRW5jcnlwdGlvblR5cGUuTm90U3VwcG9ydGVkOw0KDQogICAgICAgICAgICAvLyBCeSBEZWZhdWx0IFNRTCBhdXRoZW50aWNhdGlvbiB3aWxsIGJlIHVzZWQuDQogICAgICAgICAgICBGZWRBdXRoUmVxdWlyZWRQcmVMb2dpbk9wdGlvbiA9IFRkc1ByZUxvZ2luRmVkQXV0aFJlcXVpcmVkT3B0aW9uLkZlZEF1dGhOb3RSZXF1aXJlZDsNCg0KICAgICAgICAgICAgRW5jcnlwdGlvbkNlcnRpZmljYXRlID0gbmV3IFg1MDlDZXJ0aWZpY2F0ZTIoIlRkc1NlcnZlckNlcnRpZmljYXRlLnBmeCIsICJTZWNyZXRQYXNzd29yZDEyMzQ1NiIpOw0KDQogICAgICAgICAgICBTZXJ2ZXJQcmluY2lwYWxOYW1lID0gQXp1cmVBRFNlcnZpY2VQcmluY2lwYWxOYW1lOw0KICAgICAgICAgICAgU3RzVXJsID0gQXp1cmVBRFByb2R1Y3Rpb25Ub2tlbkVuZHBvaW50Ow0KICAgICAgICB9DQogICAgfQ0KfQ0K"
        },
        "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/Helpers.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQp1c2luZyBTeXN0ZW07DQp1c2luZyBTeXN0ZW0uRGF0YTsNCnVzaW5nIFN5c3RlbS5EYXRhLkNvbW1vbjsNCg0KbmFtZXNwYWNlIFN5c3RlbS5EYXRhLlNxbENsaWVudC5NYW51YWxUZXN0aW5nLlRlc3RzDQp7DQogICAgcHVibGljIGNsYXNzIEhlbHBlcnMNCiAgICB7DQogICAgICAgIHB1YmxpYyBzdGF0aWMgaW50IEV4ZWN1dGUoRGJDb21tYW5kIGNtZCwgc3RyaW5nIHN0clRleHQpDQogICAgICAgIHsNCiAgICAgICAgICAgIGNtZC5Db21tYW5kVGV4dCA9IHN0clRleHQ7DQogICAgICAgICAgICByZXR1cm4gY21kLkV4ZWN1dGVOb25RdWVyeSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHZvaWQgUHJvY2Vzc0NvbW1hbmRCYXRjaChUeXBlIGNvbm5UeXBlLCBzdHJpbmcgY29uc3RyLCBzdHJpbmdbXSBiYXRjaCkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKGJhdGNoLkxlbmd0aCA+IDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgb2JqZWN0W10gYWN0aXZhdG9yQXJncyA9IG5ldyBvYmplY3RbMV07DQogICAgICAgICAgICAgICAgYWN0aXZhdG9yQXJnc1swXSA9IGNvbnN0cjsNCiAgICAgICAgICAgICAgICB1c2luZyAoRGJDb25uZWN0aW9uIGNvbm4gPSAoRGJDb25uZWN0aW9uKUFjdGl2YXRvci5DcmVhdGVJbnN0YW5jZShjb25uVHlwZSwgYWN0aXZhdG9yQXJncykpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBjb25uLk9wZW4oKTsNCiAgICAgICAgICAgICAgICAgICAgRGJDb21tYW5kIGNtZCA9IGNvbm4uQ3JlYXRlQ29tbWFuZCgpOw0KDQogICAgICAgICAgICAgICAgICAgIFByb2Nlc3NDb21tYW5kQmF0Y2goY21kLCBiYXRjaCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHZvaWQgUHJvY2Vzc0NvbW1hbmRCYXRjaChEYkNvbW1hbmQgY21kLCBzdHJpbmdbXSBiYXRjaCkNCiAgICAgICAgew0KICAgICAgICAgICAgZm9yZWFjaCAoc3RyaW5nIGNtZHRleHQgaW4gYmF0Y2gpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgSGVscGVycy5UcnlFeGVjdXRlKGNtZCwgY21kdGV4dCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgc3RhdGljIGludCBUcnlEcm9wVGFibGUoc3RyaW5nIGRzdENvbnN0ciwgc3RyaW5nIHRhYmxlTmFtZSkNCiAgICAgICAgew0KICAgICAgICAgICAgdXNpbmcgKFNxbENvbm5lY3Rpb24gZHJvcENvbm4gPSBuZXcgU3FsQ29ubmVjdGlvbihkc3RDb25zdHIpKQ0KICAgICAgICAgICAgdXNpbmcgKFNxbENvbW1hbmQgZHJvcENtZCA9IGRyb3BDb25uLkNyZWF0ZUNvbW1hbmQoKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBkcm9wQ29ubi5PcGVuKCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIEhlbHBlcnMuVHJ5RXhlY3V0ZShkcm9wQ21kLCAiZHJvcCB0YWJsZSAiICsgdGFibGVOYW1lKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBzdGF0aWMgaW50IFRyeUV4ZWN1dGUoRGJDb21tYW5kIGNtZCwgc3RyaW5nIHN0clRleHQpDQogICAgICAgIHsNCiAgICAgICAgICAgIGNtZC5Db21tYW5kVGV4dCA9IHN0clRleHQ7DQogICAgICAgICAgICByZXR1cm4gY21kLkV4ZWN1dGVOb25RdWVyeSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIFZlcmlmeVJlc3VsdHMoRGJDb25uZWN0aW9uIGNvbm4sIHN0cmluZyBkc3RUYWJsZSwgaW50IGV4cGVjdGVkQ29sdW1ucywgaW50IGV4cGVjdGVkUm93cykNCiAgICAgICAgew0KICAgICAgICAgICAgdXNpbmcgKERiQ29tbWFuZCBjbWQgPSBjb25uLkNyZWF0ZUNvbW1hbmQoKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBjbWQuQ29tbWFuZFRleHQgPSAic2VsZWN0ICogZnJvbSAiICsgZHN0VGFibGUgKyAiOyBzZWxlY3QgY291bnQoKikgZnJvbSAiICsgZHN0VGFibGU7DQogICAgICAgICAgICAgICAgdXNpbmcgKERiRGF0YVJlYWRlciByZWFkZXIgPSBjbWQuRXhlY3V0ZVJlYWRlcigpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaW50IG51bUNvbHVtbnMgPSByZWFkZXIuRmllbGRDb3VudDsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLk5leHRSZXN1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLlJlYWQoKTsNCiAgICAgICAgICAgICAgICAgICAgaW50IG51bVJvd3MgPSAoaW50KXJlYWRlclswXTsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLkNsb3NlKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgRGF0YVRlc3RVdGlsaXR5LkFzc2VydEVxdWFsc1dpdGhEZXNjcmlwdGlvbihleHBlY3RlZENvbHVtbnMsIG51bUNvbHVtbnMsICJVbmV4cGVjdGVkIG51bWJlciBvZiBjb2x1bW5zLiIpOw0KICAgICAgICAgICAgICAgICAgICBEYXRhVGVzdFV0aWxpdHkuQXNzZXJ0RXF1YWxzV2l0aERlc2NyaXB0aW9uKGV4cGVjdGVkUm93cywgbnVtUm93cywgIlVuZXhwZWN0ZWQgbnVtYmVyIG9mIGNvbHVtbnMuIik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIENoZWNrVGFibGVSb3dzKERiQ29ubmVjdGlvbiBjb25uLCBzdHJpbmcgdGFibGUsIGJvb2wgc2hvdWxkSGF2ZVJvd3MpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyBxdWVyeSA9ICJzZWxlY3QgKiBmcm9tICIgKyB0YWJsZTsNCiAgICAgICAgICAgIHVzaW5nIChEYkNvbW1hbmQgY21kID0gY29ubi5DcmVhdGVDb21tYW5kKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgY21kLkNvbW1hbmRUZXh0ID0gcXVlcnk7DQogICAgICAgICAgICAgICAgdXNpbmcgKERiRGF0YVJlYWRlciByZWFkZXIgPSBjbWQuRXhlY3V0ZVJlYWRlcigpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgRGF0YVRlc3RVdGlsaXR5LkFzc2VydEVxdWFsc1dpdGhEZXNjcmlwdGlvbihzaG91bGRIYXZlUm93cywgcmVhZGVyLkhhc1Jvd3MsICJVbmV4cGVjdGVkIHZhbHVlIGZvciBIYXNSb3dzLiIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="
        },
        "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/SpecialCharacterNames.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQp1c2luZyBTeXN0ZW07DQp1c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYzsNCnVzaW5nIFN5c3RlbS5UZXh0Ow0KdXNpbmcgU3lzdGVtLkRhdGE7DQp1c2luZyBTeXN0ZW0uRGF0YS5TcWxDbGllbnQ7DQoNCm5hbWVzcGFjZSBTeXN0ZW0uRGF0YS5TcWxDbGllbnQuTWFudWFsVGVzdGluZy5UZXN0cw0Kew0KICAgIHB1YmxpYyBjbGFzcyBTcGVjaWFsQ2hhcmFjdGVyTmFtZXMNCiAgICB7DQogICAgICAgIHByaXZhdGUgc3RhdGljIHN0cmluZyBFc2NhcGVJZGVudGlmaWVyKHN0cmluZyBuYW1lKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gIlsiICsgbmFtZS5SZXBsYWNlKCJdIiwgIl1dIikgKyAiXSI7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgVGVzdChzdHJpbmcgc3JjQ29uc3RyLCBzdHJpbmcgZHN0Q29uc3RyLCBzdHJpbmcgZHN0UHJlZml4KQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBjcmVhdGUgc2NoZW1hIGFuZCB0YWJsZSBuYW1lcyB3aXRoIHNwZWNpYWwgY2hhcmFjdGVycywgd2l0aCBdIGNoYXJhY3RlciBlc2NhcGVkLg0KICAgICAgICAgICAgc3RyaW5nIGRzdHNjaGVtYSA9IGRzdFByZWZpeCArICJfU2NoZW1hJy1dWycnXSI7DQogICAgICAgICAgICBkc3RzY2hlbWEgPSBFc2NhcGVJZGVudGlmaWVyKGRzdHNjaGVtYSk7DQoNCiAgICAgICAgICAgIHN0cmluZyBkc3RUYWJsZSA9IGRzdFByZWZpeCArICJfVGFibGUnLV1bJyddIjsNCiAgICAgICAgICAgIGRzdFRhYmxlID0gRXNjYXBlSWRlbnRpZmllcihkc3RUYWJsZSk7DQoNCiAgICAgICAgICAgIHVzaW5nIChTcWxDb25uZWN0aW9uIGRzdENvbm4gPSBuZXcgU3FsQ29ubmVjdGlvbihkc3RDb25zdHIpKQ0KICAgICAgICAgICAgdXNpbmcgKFNxbENvbW1hbmQgZHN0Q21kID0gZHN0Q29ubi5DcmVhdGVDb21tYW5kKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZHN0Q29ubi5PcGVuKCk7DQoNCiAgICAgICAgICAgICAgICB0cnkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIEhlbHBlcnMuRXhlY3V0ZShkc3RDbWQsICJjcmVhdGUgc2NoZW1hICIgKyBkc3RzY2hlbWEpOw0KICAgICAgICAgICAgICAgICAgICBIZWxwZXJzLkV4ZWN1dGUoZHN0Q21kLCAiY3JlYXRlIHRhYmxlICIgKyBkc3RUYWJsZSArICIgKG9yZGVyaWQgaW50LCBjdXN0b21lcmlkIG5jaGFyKDUpKSIpOw0KDQogICAgICAgICAgICAgICAgICAgIHVzaW5nIChTcWxDb25uZWN0aW9uIHNyY0Nvbm4gPSBuZXcgU3FsQ29ubmVjdGlvbihzcmNDb25zdHIpKQ0KICAgICAgICAgICAgICAgICAgICB1c2luZyAoU3FsQ29tbWFuZCBzcmNDbWQgPSBuZXcgU3FsQ29tbWFuZCgic2VsZWN0IHRvcCAyIG9yZGVyaWQsIGN1c3RvbWVyaWQgZnJvbSBvcmRlcnMiLCBzcmNDb25uKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3JjQ29ubi5PcGVuKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHVzaW5nIChTcWxEYXRhUmVhZGVyIHNyY3JlYWRlciA9IHNyY0NtZC5FeGVjdXRlUmVhZGVyKCkpDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNpbmcgKFNxbEJ1bGtDb3B5IGJ1bGtjb3B5ID0gbmV3IFNxbEJ1bGtDb3B5KGRzdENvbm4pKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVsa2NvcHkuRGVzdGluYXRpb25UYWJsZU5hbWUgPSBkc3RUYWJsZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWxrY29weS5Xcml0ZVRvU2VydmVyKHNyY3JlYWRlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgSGVscGVycy5WZXJpZnlSZXN1bHRzKGRzdENvbm4sIGRzdFRhYmxlLCAyLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmaW5hbGx5DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBIZWxwZXJzLlRyeUV4ZWN1dGUoZHN0Q21kLCAiZHJvcCB0YWJsZSAiICsgZHN0VGFibGUpOw0KICAgICAgICAgICAgICAgICAgICBIZWxwZXJzLlRyeUV4ZWN1dGUoZHN0Q21kLCAiZHJvcCBzY2hlbWEgIiArIGRzdHNjaGVtYSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0K"
        }
      },
      "results": [
        {
          "ruleId": "cs/empty-password-in-configuration",
          "level": "warning",
          "message": "Do not use empty passwords.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/StressTest.config",
                "region": {
                  "startLine": 5,
                  "startColumn": 1,
                  "length": 345
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_sqlTypes] in non-static context from [ConsumeReaderAsync].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 181,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 22,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_sqlTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 265,
                  "startColumn": 29,
                  "length": 18
                }
              },
              "message": "ConsumeReaderAsync"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_sqlTypes] in non-static context from [CommandExecuteAsync].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 181,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 22,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_sqlTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 198,
                  "startColumn": 29,
                  "length": 19
                }
              },
              "message": "CommandExecuteAsync"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_sqlTypes] in non-static context from [ConsumeRowAsync].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 181,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 22,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_sqlTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 313,
                  "startColumn": 29,
                  "length": 15
                }
              },
              "message": "ConsumeRowAsync"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_sqlTypes] in non-static context from [ConsumeBytesAsync].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 181,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 22,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_sqlTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 357,
                  "startColumn": 29,
                  "length": 17
                }
              },
              "message": "ConsumeBytesAsync"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_sqlTypes] in non-static context from [TestCommandAndReaderAsyncInternal].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 181,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 22,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_sqlTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 614,
                  "startColumn": 29,
                  "length": 33
                }
              },
              "message": "TestCommandAndReaderAsyncInternal"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_clrTypes] in non-static context from [ConsumeReaderAsync].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 187,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 23,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_clrTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 265,
                  "startColumn": 29,
                  "length": 18
                }
              },
              "message": "ConsumeReaderAsync"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_clrTypes] in non-static context from [CommandExecuteAsync].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 187,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 23,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_clrTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 198,
                  "startColumn": 29,
                  "length": 19
                }
              },
              "message": "CommandExecuteAsync"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_clrTypes] in non-static context from [ConsumeRowAsync].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 187,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 23,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_clrTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 313,
                  "startColumn": 29,
                  "length": 15
                }
              },
              "message": "ConsumeRowAsync"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_clrTypes] in non-static context from [ConsumeBytesAsync].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 187,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 23,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_clrTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 357,
                  "startColumn": 29,
                  "length": 17
                }
              },
              "message": "ConsumeBytesAsync"
            }
          ]
        },
        {
          "ruleId": "cs/unsynchronized-static-access",
          "level": "warning",
          "message": "Unsynchronized access to [s_clrTypes] in non-static context from [TestCommandAndReaderAsyncInternal].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 187,
                  "startColumn": 1,
                  "length": 54
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataStressReader.cs",
                "region": {
                  "startLine": 23,
                  "startColumn": 102,
                  "length": 10
                }
              },
              "message": "s_clrTypes"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/StressTests/System.Data.StressFramework/DataTestGroup.cs",
                "region": {
                  "startLine": 614,
                  "startColumn": 29,
                  "length": 33
                }
              },
              "message": "TestCommandAndReaderAsyncInternal"
            }
          ]
        },
        {
          "ruleId": "cs/insecure-xml-read",
          "level": "warning",
          "message": "Insecure XML processing: DTD processing is enabled by default, and resolver is insecure by default",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlDependencyListener.cs",
                "region": {
                  "startLine": 1030,
                  "startColumn": 40,
                  "length": 61
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"SecretPassword123456\" flows to the [password] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/Tools/TDS/TDS.Servers/TDSServerArguments.cs",
                "region": {
                  "startLine": 91,
                  "startColumn": 73,
                  "length": 22
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/Tools/TDS/TDS.Servers/TDSServerArguments.cs",
                "region": {
                  "startLine": 91,
                  "startColumn": 73,
                  "length": 22
                }
              },
              "message": "password"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/Tools/TDS/TDS.Servers/TDSServerArguments.cs",
                "region": {
                  "startLine": 91,
                  "startColumn": 24,
                  "length": 72
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/inappropriate-encoding",
          "level": "warning",
          "message": "This SQL expression may include data from a [possibly inappropriately encoded value].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/Helpers.cs",
                "region": {
                  "startLine": 14,
                  "startColumn": 18,
                  "length": 7
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/SpecialCharacterNames.cs",
                "region": {
                  "startLine": 23,
                  "startColumn": 12,
                  "length": 27
                }
              },
              "message": "possibly inappropriately encoded value"
            }
          ]
        },
        {
          "ruleId": "cs/inappropriate-encoding",
          "level": "warning",
          "message": "This SQL expression may include data from a [possibly inappropriately encoded value].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/Helpers.cs",
                "region": {
                  "startLine": 14,
                  "startColumn": 18,
                  "length": 7
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/SpecialCharacterNames.cs",
                "region": {
                  "startLine": 26,
                  "startColumn": 11,
                  "length": 26
                }
              },
              "message": "possibly inappropriately encoded value"
            }
          ]
        },
        {
          "ruleId": "cs/inappropriate-encoding",
          "level": "warning",
          "message": "This SQL expression may include data from a [possibly inappropriately encoded value].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/Helpers.cs",
                "region": {
                  "startLine": 54,
                  "startColumn": 18,
                  "length": 7
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/SpecialCharacterNames.cs",
                "region": {
                  "startLine": 23,
                  "startColumn": 12,
                  "length": 27
                }
              },
              "message": "possibly inappropriately encoded value"
            }
          ]
        },
        {
          "ruleId": "cs/inappropriate-encoding",
          "level": "warning",
          "message": "This SQL expression may include data from a [possibly inappropriately encoded value].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/Helpers.cs",
                "region": {
                  "startLine": 54,
                  "startColumn": 18,
                  "length": 7
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/SpecialCharacterNames.cs",
                "region": {
                  "startLine": 26,
                  "startColumn": 11,
                  "length": 26
                }
              },
              "message": "possibly inappropriately encoded value"
            }
          ]
        },
        {
          "ruleId": "cs/inappropriate-encoding",
          "level": "warning",
          "message": "This SQL expression may include data from a [possibly inappropriately encoded value].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/Helpers.cs",
                "region": {
                  "startLine": 62,
                  "startColumn": 18,
                  "length": 66
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Data.SqlClient/tests/ManualTests/SQL/SqlBulkCopyTest/SpecialCharacterNames.cs",
                "region": {
                  "startLine": 26,
                  "startColumn": 11,
                  "length": 26
                }
              },
              "message": "possibly inappropriately encoded value"
            }
          ]
        }
      ],
      "rules": {
        "cs/ldap-injection": {
          "id": "cs/ldap-injection",
          "name": "cs/ldap-injection",
          "shortDescription": "LDAP query built from user-controlled sources",
          "fullDescription": "Building an LDAP query from user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-090"
],
            "kind": "problem",
            "precision": "medium",
            "name": "LDAP query built from user-controlled sources",
            "description": "Building an LDAP query from user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
            "id": "cs/ldap-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-090/LDAPInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/xpath-injection": {
          "id": "cs/xml/xpath-injection",
          "name": "cs/xml/xpath-injection",
          "shortDescription": "XPath injection",
          "fullDescription": "Building an XPath expression from user-controlled sources is vulnerable to insertion of malicious code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-643"
],
            "kind": "problem",
            "precision": "medium",
            "name": "XPath injection",
            "description": "Building an XPath expression from user-controlled sources is vulnerable to insertion of malicious code by the user.",
            "id": "cs/xml/xpath-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-643/XPathInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/command-line-injection": {
          "id": "cs/command-line-injection",
          "name": "cs/command-line-injection",
          "shortDescription": "Uncontrolled command line",
          "fullDescription": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "correctness",
  "security",
  "external/cwe/cwe-078",
  "external/cwe/cwe-088"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled command line",
            "description": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
            "id": "cs/command-line-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-078/CommandInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/directory-browse-enabled": {
          "id": "cs/web/directory-browse-enabled",
          "name": "cs/web/directory-browse-enabled",
          "shortDescription": "ASP.NET config file enables directory browsing",
          "fullDescription": "Directory browsing should not be enabled in production as it can leak sensitive information.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-548"
],
            "kind": "problem",
            "precision": "very-high",
            "name": "ASP.NET config file enables directory browsing",
            "description": "Directory browsing should not be enabled in production as it can leak sensitive information.",
            "id": "cs/web/directory-browse-enabled",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-548/ASPNetDirectoryListing.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/unvalidated-url-redirection": {
          "id": "cs/web/unvalidated-url-redirection",
          "name": "cs/web/unvalidated-url-redirection",
          "shortDescription": "URL redirection from remote source",
          "fullDescription": "URL redirection based on unvalidated user input may cause redirection to malicious web sites.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-601"
],
            "kind": "problem",
            "precision": "medium",
            "name": "URL redirection from remote source",
            "description": "URL redirection based on unvalidated user input may cause redirection to malicious web sites.",
            "id": "cs/web/unvalidated-url-redirection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-601/UrlRedirect.ql",
            "problem.severity": "error"
          }
        },
        "cs/path-injection": {
          "id": "cs/path-injection",
          "name": "cs/path-injection",
          "shortDescription": "Uncontrolled data used in path expression",
          "fullDescription": "Accessing paths influenced by users can allow an attacker to access unexpected resources.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-022",
  "external/cwe/cwe-023",
  "external/cwe/cwe-036",
  "external/cwe/cwe-073",
  "external/cwe/cwe-099"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled data used in path expression",
            "description": "Accessing paths influenced by users can allow an attacker to access unexpected resources.",
            "id": "cs/path-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-022/TaintedPath.ql",
            "problem.severity": "error"
          }
        },
        "cs/user-controlled-bypass": {
          "id": "cs/user-controlled-bypass",
          "name": "cs/user-controlled-bypass",
          "shortDescription": "User-controlled bypass of sensitive method",
          "fullDescription": "User-controlled bypassing of sensitive methods may allow attackers to avoid passing through authentication systems.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-807",
  "external/cwe/cwe-247",
  "external/cwe/cwe-350"
],
            "kind": "problem",
            "precision": "medium",
            "name": "User-controlled bypass of sensitive method",
            "description": "User-controlled bypassing of sensitive methods may allow attackers to avoid passing through authentication systems.",
            "id": "cs/user-controlled-bypass",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-807/ConditionalBypass.ql",
            "problem.severity": "error"
          }
        },
        "cs/sensitive-data-transmission": {
          "id": "cs/sensitive-data-transmission",
          "name": "cs/sensitive-data-transmission",
          "shortDescription": "Information exposure through transmitted data",
          "fullDescription": "Transmitting sensitive information to the user is a potential security risk.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-201"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Information exposure through transmitted data",
            "description": "Transmitting sensitive information to the user is a potential security risk.",
            "id": "cs/sensitive-data-transmission",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-201/ExposureInTransmittedData.ql",
            "problem.severity": "error"
          }
        },
        "cs/inappropriate-encoding": {
          "id": "cs/inappropriate-encoding",
          "name": "cs/inappropriate-encoding",
          "shortDescription": "Inappropriate encoding",
          "fullDescription": "Using an inappropriate encoding may give unintended results and may pose a security risk.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-838"
],
            "kind": "problem",
            "precision": "low",
            "name": "Inappropriate encoding",
            "description": "Using an inappropriate encoding may give unintended results and may pose a security risk.",
            "id": "cs/inappropriate-encoding",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-838/InappropriateEncoding.ql",
            "problem.severity": "error"
          }
        },
        "cs/hardcoded-credentials": {
          "id": "cs/hardcoded-credentials",
          "name": "cs/hardcoded-credentials",
          "shortDescription": "Hard-coded credentials",
          "fullDescription": "Credentials are hard coded in the source code of the application.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-259",
  "external/cwe/cwe-321",
  "external/cwe/cwe-798"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Hard-coded credentials",
            "description": "Credentials are hard coded in the source code of the application.",
            "id": "cs/hardcoded-credentials",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-798/HardcodedCredentials.ql",
            "problem.severity": "error"
          }
        },
        "cs/insecure-randomness": {
          "id": "cs/insecure-randomness",
          "name": "cs/insecure-randomness",
          "shortDescription": "Insecure randomness",
          "fullDescription": "Using a cryptographically weak pseudo-random number generator to generate a security sensitive value may allow an attacker to predict what sensitive value will be generated.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-338"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Insecure randomness",
            "description": "Using a cryptographically weak pseudo-random number generator to generate a security sensitive value may allow an attacker to predict what sensitive value will be generated.",
            "id": "cs/insecure-randomness",
            "query-path": "/semmlecode-csharp-queries/Security Features/InsecureRandomness.ql",
            "problem.severity": "warning"
          }
        },
        "cs/empty-password-in-configuration": {
          "id": "cs/empty-password-in-configuration",
          "name": "cs/empty-password-in-configuration",
          "shortDescription": "Empty password in configuration file",
          "fullDescription": "Finds empty passwords in configuration files.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-258",
  "external/cwe/cwe-862"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Empty password in configuration file",
            "description": "Finds empty passwords in configuration files.",
            "id": "cs/empty-password-in-configuration",
            "query-path": "/semmlecode-csharp-queries/Configuration/EmptyPasswordInConfigurationFile.ql",
            "problem.severity": "warning"
          }
        },
        "cs/information-exposure-through-exception": {
          "id": "cs/information-exposure-through-exception",
          "name": "cs/information-exposure-through-exception",
          "shortDescription": "Information exposure through an exception",
          "fullDescription": "Leaking information about an exception, such as messages and stack traces, to an external user can expose implementation details that are useful to an attacker for developing a subsequent exploit.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-209",
  "external/cwe/cwe-497"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Information exposure through an exception",
            "description": "Leaking information about an exception, such as messages and stack traces, to an external user can expose implementation details that are useful to an attacker for developing a subsequent exploit.",
            "id": "cs/information-exposure-through-exception",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-209/ExceptionInformationExposure.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/missing-token-validation": {
          "id": "cs/web/missing-token-validation",
          "name": "cs/web/missing-token-validation",
          "shortDescription": "Missing cross-site request forgery token validation",
          "fullDescription": "Handling a POST request without verifying that the request came from the user allows a malicious attacker to submit a request on behalf of the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-352"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Missing cross-site request forgery token validation",
            "description": "Handling a POST request without verifying that the request came from the user allows a malicious attacker to submit a request on behalf of the user.",
            "id": "cs/web/missing-token-validation",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-352/MissingAntiForgeryTokenValidation.ql",
            "problem.severity": "error"
          }
        },
        "cs/second-order-sql-injection": {
          "id": "cs/second-order-sql-injection",
          "name": "cs/second-order-sql-injection",
          "shortDescription": "SQL query built from stored user-controlled sources",
          "fullDescription": "Building a SQL query from stored user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-089"
],
            "kind": "problem",
            "precision": "medium",
            "name": "SQL query built from stored user-controlled sources",
            "description": "Building a SQL query from stored user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
            "id": "cs/second-order-sql-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-089/SecondOrderSqlInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/unsynchronized-static-access": {
          "id": "cs/unsynchronized-static-access",
          "name": "cs/unsynchronized-static-access",
          "shortDescription": "Unsynchronized access to static collection member in non-static context",
          "fullDescription": "If an unsynchronized access to a static collection member occurs during an addition or resizing operation, an infinite loop can occur.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "concurrency",
  "external/cwe/cwe-362",
  "external/cwe/cwe-567"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Unsynchronized access to static collection member in non-static context",
            "description": "If an unsynchronized access to a static collection member occurs during an addition or resizing operation, an infinite loop can occur.",
            "id": "cs/unsynchronized-static-access",
            "query-path": "/semmlecode-csharp-queries/Concurrency/UnsynchronizedStaticAccess.ql",
            "problem.severity": "error"
          }
        },
        "cs/insufficient-key-size": {
          "id": "cs/insufficient-key-size",
          "name": "cs/insufficient-key-size",
          "shortDescription": "Weak encryption: Insufficient key size",
          "fullDescription": "Finds uses of encryption algorithms with too small a key size",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption: Insufficient key size",
            "description": "Finds uses of encryption algorithms with too small a key size",
            "id": "cs/insufficient-key-size",
            "query-path": "/semmlecode-csharp-queries/Security Features/InsufficientKeySize.ql",
            "problem.severity": "warning"
          }
        },
        "cs/stored-command-line-injection": {
          "id": "cs/stored-command-line-injection",
          "name": "cs/stored-command-line-injection",
          "shortDescription": "Uncontrolled command line from stored user input",
          "fullDescription": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "correctness",
  "security",
  "external/cwe/cwe-078",
  "external/cwe/cwe-088"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled command line from stored user input",
            "description": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
            "id": "cs/stored-command-line-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-078/StoredCommandInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/ecb-encryption": {
          "id": "cs/ecb-encryption",
          "name": "cs/ecb-encryption",
          "shortDescription": "Encryption using ECB",
          "fullDescription": "Highlights uses of the encryption mode 'CipherMode.ECB'. This mode should normally not be used because it is vulnerable to replay attacks.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Encryption using ECB",
            "description": "Highlights uses of the encryption mode \u0027CipherMode.ECB\u0027. This mode should normally not be used because it is vulnerable to replay attacks.",
            "id": "cs/ecb-encryption",
            "query-path": "/semmlecode-csharp-queries/Security Features/Encryption using ECB.ql",
            "problem.severity": "warning"
          }
        },
        "cs/inadequate-rsa-padding": {
          "id": "cs/inadequate-rsa-padding",
          "name": "cs/inadequate-rsa-padding",
          "shortDescription": "Weak encryption: inadequate RSA padding",
          "fullDescription": "Finds uses of RSA encryption with inadequate padding.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327",
  "external/cwe/cwe-780"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption: inadequate RSA padding",
            "description": "Finds uses of RSA encryption with inadequate padding.",
            "id": "cs/inadequate-rsa-padding",
            "query-path": "/semmlecode-csharp-queries/Security Features/InadequateRSAPadding.ql",
            "problem.severity": "warning"
          }
        },
        "cs/cleartext-storage-of-sensitive-information": {
          "id": "cs/cleartext-storage-of-sensitive-information",
          "name": "cs/cleartext-storage-of-sensitive-information",
          "shortDescription": "Clear text storage of sensitive information",
          "fullDescription": "Sensitive information stored without encryption or hashing can expose it to an attacker.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-312",
  "external/cwe/cwe-315",
  "external/cwe/cwe-359"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Clear text storage of sensitive information",
            "description": "Sensitive information stored without encryption or hashing can expose it to an attacker.",
            "id": "cs/cleartext-storage-of-sensitive-information",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-312/CleartextStorage.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/missing-global-error-handler": {
          "id": "cs/web/missing-global-error-handler",
          "name": "cs/web/missing-global-error-handler",
          "shortDescription": "Missing global error handler",
          "fullDescription": "ASP.NET applications should not set the 'customError' mode to \"off\" without providing a global error handler, otherwise they may leak exception information.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-12",
  "external/cwe/cwe-248"
],
            "kind": "problem",
            "precision": "high",
            "name": "Missing global error handler",
            "description": "ASP.NET applications should not set the \u0027customError\u0027 mode to \"off\" without providing a global error handler, otherwise they may leak exception information.",
            "id": "cs/web/missing-global-error-handler",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-248/MissingASPNETGlobalErrorHandler.ql",
            "problem.severity": "warning"
          }
        },
        "cs/session-reuse": {
          "id": "cs/session-reuse",
          "name": "cs/session-reuse",
          "shortDescription": "Failure to abandon session",
          "fullDescription": "Reusing an existing session as a different user could allow an attacker to access someone else's account by using their session.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-384"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Failure to abandon session",
            "description": "Reusing an existing session as a different user could allow an attacker to access someone else\u0027s account by using their session.",
            "id": "cs/session-reuse",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-384/AbandonSession.ql",
            "problem.severity": "error"
          }
        },
        "cs/password-in-configuration": {
          "id": "cs/password-in-configuration",
          "name": "cs/password-in-configuration",
          "shortDescription": "Password in configuration file",
          "fullDescription": "Finds passwords in configuration files.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-13",
  "external/cwe/cwe-256",
  "external/cwe/cwe-313"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Password in configuration file",
            "description": "Finds passwords in configuration files.",
            "id": "cs/password-in-configuration",
            "query-path": "/semmlecode-csharp-queries/Configuration/PasswordInConfigurationFile.ql",
            "problem.severity": "warning"
          }
        },
        "cs/xml/missing-validation": {
          "id": "cs/xml/missing-validation",
          "name": "cs/xml/missing-validation",
          "shortDescription": "Missing XML validation",
          "fullDescription": "User input should not be processed as XML without validating it against a known schema.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-112"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Missing XML validation",
            "description": "User input should not be processed as XML without validating it against a known schema.",
            "id": "cs/xml/missing-validation",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-112/MissingXMLValidation.ql",
            "problem.severity": "recommendation"
          }
        },
        "cs/web/broad-cookie-domain": {
          "id": "cs/web/broad-cookie-domain",
          "name": "cs/web/broad-cookie-domain",
          "shortDescription": "Cookie security: overly broad domain",
          "fullDescription": "Finds cookies with an overly broad domain.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-287"
],
            "kind": "problem",
            "precision": "high",
            "name": "Cookie security: overly broad domain",
            "description": "Finds cookies with an overly broad domain.",
            "id": "cs/web/broad-cookie-domain",
            "query-path": "/semmlecode-csharp-queries/Security Features/CookieWithOverlyBroadDomain.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/persistent-cookie": {
          "id": "cs/web/persistent-cookie",
          "name": "cs/web/persistent-cookie",
          "shortDescription": "Cookie security: persistent cookie",
          "fullDescription": "Persistent cookies are vulnerable to attacks.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-539"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Cookie security: persistent cookie",
            "description": "Persistent cookies are vulnerable to attacks.",
            "id": "cs/web/persistent-cookie",
            "query-path": "/semmlecode-csharp-queries/Security Features/PersistentCookie.ql",
            "problem.severity": "warning"
          }
        },
        "cs/insecure-xml-read": {
          "id": "cs/insecure-xml-read",
          "name": "cs/insecure-xml-read",
          "shortDescription": "XML is read insecurely",
          "fullDescription": "XML may include dangerous external references, which should be restricted using a secure resolver or disabling DTD processing.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-611",
  "external/cwe/cwe-827",
  "external/cwe/cwe-776"
],
            "kind": "problem",
            "precision": "medium",
            "name": "XML is read insecurely",
            "description": "XML may include dangerous external references, which should be restricted using a secure resolver or disabling DTD processing.",
            "id": "cs/insecure-xml-read",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-611/UseXmlSecureResolver.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/xss": {
          "id": "cs/web/xss",
          "name": "cs/web/xss",
          "shortDescription": "Cross-site scripting",
          "fullDescription": "Writing user input directly to a web page allows for a cross-site scripting vulnerability.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-079",
  "external/cwe/cwe-116"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Cross-site scripting",
            "description": "Writing user input directly to a web page allows for a cross-site scripting vulnerability.",
            "id": "cs/web/xss",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-079/XSS.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/stored-xpath-injection": {
          "id": "cs/xml/stored-xpath-injection",
          "name": "cs/xml/stored-xpath-injection",
          "shortDescription": "Stored XPath injection",
          "fullDescription": "Building an XPath expression from stored data which may have been provided by the user is vulnerable to insertion of malicious code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-643"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Stored XPath injection",
            "description": "Building an XPath expression from stored data which may have been provided by the user is vulnerable to insertion of malicious code by the user.",
            "id": "cs/xml/stored-xpath-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-643/StoredXPathInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/stored-xss": {
          "id": "cs/web/stored-xss",
          "name": "cs/web/stored-xss",
          "shortDescription": "Stored cross-site scripting",
          "fullDescription": "Writing input from the database directly to a web page indicates a cross-site scripting vulnerability if the data was originally user-provided.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-079",
  "external/cwe/cwe-116"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Stored cross-site scripting",
            "description": "Writing input from the database directly to a web page indicates a cross-site scripting vulnerability if the data was originally user-provided.",
            "id": "cs/web/stored-xss",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-079/StoredXSS.ql",
            "problem.severity": "error"
          }
        },
        "cs/resource-injection": {
          "id": "cs/resource-injection",
          "name": "cs/resource-injection",
          "shortDescription": "Resource injection",
          "fullDescription": "Building a resource descriptor from untrusted user input is vulnerable to a malicious user providing an unintended resource.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-099"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Resource injection",
            "description": "Building a resource descriptor from untrusted user input is vulnerable to a malicious user providing an unintended resource.",
            "id": "cs/resource-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-099/ResourceInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/debug-binary": {
          "id": "cs/web/debug-binary",
          "name": "cs/web/debug-binary",
          "shortDescription": "Creating an ASP.NET debug binary may reveal sensitive information",
          "fullDescription": "ASP.NET projects should not produce debug binaries when deploying to production as debug builds provide additional information useful to a malicious attacker.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "maintainability",
  "frameworks/asp.net",
  "external/cwe/cwe-11"
],
            "kind": "problem",
            "precision": "very-high",
            "name": "Creating an ASP.NET debug binary may reveal sensitive information",
            "description": "ASP.NET projects should not produce debug binaries when deploying to production as debug builds provide additional information useful to a malicious attacker.",
            "id": "cs/web/debug-binary",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-011/ASPNetDebug.ql",
            "problem.severity": "warning"
          }
        },
        "cs/stored-ldap-injection": {
          "id": "cs/stored-ldap-injection",
          "name": "cs/stored-ldap-injection",
          "shortDescription": "LDAP query built from stored user-controlled sources",
          "fullDescription": "Building an LDAP query from stored user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-090"
],
            "kind": "problem",
            "precision": "medium",
            "name": "LDAP query built from stored user-controlled sources",
            "description": "Building an LDAP query from stored user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
            "id": "cs/stored-ldap-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-090/StoredLDAPInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/code-injection": {
          "id": "cs/code-injection",
          "name": "cs/code-injection",
          "shortDescription": "Improper control of generation of code",
          "fullDescription": "Treating externally controlled strings as code can allow an attacker to execute malicious code.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-094",
  "external/cwe/cwe-095",
  "external/cwe/cwe-096"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Improper control of generation of code",
            "description": "Treating externally controlled strings as code can allow an attacker to execute malicious code.",
            "id": "cs/code-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-094/CodeInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/unvalidated-local-pointer-arithmetic": {
          "id": "cs/unvalidated-local-pointer-arithmetic",
          "name": "cs/unvalidated-local-pointer-arithmetic",
          "shortDescription": "Unvalidated local pointer arithmetic",
          "fullDescription": "Using the result of a virtual method call in pointer arithmetic without validation is dangerous because the method may be overridden by a subtype to return any value.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-119",
  "external/cwe/cwe-120",
  "external/cwe/cwe-122",
  "external/cwe/cwe-788"
],
            "kind": "problem",
            "precision": "high",
            "name": "Unvalidated local pointer arithmetic",
            "description": "Using the result of a virtual method call in pointer arithmetic without validation is dangerous because the method may be overridden by a subtype to return any value.",
            "id": "cs/unvalidated-local-pointer-arithmetic",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-119/LocalUnvalidatedArithmetic.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/missing-x-frame-options": {
          "id": "cs/web/missing-x-frame-options",
          "name": "cs/web/missing-x-frame-options",
          "shortDescription": "Missing X-Frame-Options HTTP header",
          "fullDescription": "If the 'X-Frame-Options' setting is not provided, a malicious user may be able to overlay their own UI on top of the site by using an iframe.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-451",
  "external/cwe/cwe-829"
],
            "kind": "problem",
            "precision": "high",
            "name": "Missing X-Frame-Options HTTP header",
            "description": "If the \u0027X-Frame-Options\u0027 setting is not provided, a malicious user may be able to overlay their own UI on top of the site by using an iframe.",
            "id": "cs/web/missing-x-frame-options",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-451/MissingXFrameOptions.ql",
            "problem.severity": "error"
          }
        },
        "cs/hardcoded-connection-string-credentials": {
          "id": "cs/hardcoded-connection-string-credentials",
          "name": "cs/hardcoded-connection-string-credentials",
          "shortDescription": "Hard-coded connection string with credentials",
          "fullDescription": "Credentials are hard-coded in a connection string in the source code of the application.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-259",
  "external/cwe/cwe-321",
  "external/cwe/cwe-798"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Hard-coded connection string with credentials",
            "description": "Credentials are hard-coded in a connection string in the source code of the application.",
            "id": "cs/hardcoded-connection-string-credentials",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-798/HardcodedConnectionString.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/broad-cookie-path": {
          "id": "cs/web/broad-cookie-path",
          "name": "cs/web/broad-cookie-path",
          "shortDescription": "Cookie security: overly broad path",
          "fullDescription": "Finds cookies with an overly broad path.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-287"
],
            "kind": "problem",
            "precision": "high",
            "name": "Cookie security: overly broad path",
            "description": "Finds cookies with an overly broad path.",
            "id": "cs/web/broad-cookie-path",
            "query-path": "/semmlecode-csharp-queries/Security Features/CookieWithOverlyBroadPath.ql",
            "problem.severity": "warning"
          }
        },
        "cs/weak-encryption": {
          "id": "cs/weak-encryption",
          "name": "cs/weak-encryption",
          "shortDescription": "Weak encryption",
          "fullDescription": "Finds uses of encryption algorithms that are weak and obsolete",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption",
            "description": "Finds uses of encryption algorithms that are weak and obsolete",
            "id": "cs/weak-encryption",
            "query-path": "/semmlecode-csharp-queries/Security Features/WeakEncryption.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/disabled-header-checking": {
          "id": "cs/web/disabled-header-checking",
          "name": "cs/web/disabled-header-checking",
          "shortDescription": "Header checking disabled",
          "fullDescription": "Finds places where header checking is disabled.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-113"
],
            "kind": "problem",
            "precision": "high",
            "name": "Header checking disabled",
            "description": "Finds places where header checking is disabled.",
            "id": "cs/web/disabled-header-checking",
            "query-path": "/semmlecode-csharp-queries/Security Features/HeaderCheckingDisabled.ql",
            "problem.severity": "warning"
          }
        },
        "cs/log-forging": {
          "id": "cs/log-forging",
          "name": "cs/log-forging",
          "shortDescription": "Log entries created from user input",
          "fullDescription": "Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-117"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Log entries created from user input",
            "description": "Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.",
            "id": "cs/log-forging",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-117/LogForging.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/requiressl-not-set": {
          "id": "cs/web/requiressl-not-set",
          "name": "cs/web/requiressl-not-set",
          "shortDescription": "'requireSSL' attribute is not set to true",
          "fullDescription": "Omitting the 'requireSSL' attribute allows data to be transmitted insecurely using HTTP. Always set 'requireSSL' to 'true' to ensure that HTTPS is used at all times.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-319",
  "external/cwe/cwe-614"
],
            "kind": "problem",
            "precision": "high",
            "name": "\u0027requireSSL\u0027 attribute is not set to true",
            "description": "Omitting the \u0027requireSSL\u0027 attribute allows data to be transmitted insecurely using HTTP. Always set \u0027requireSSL\u0027 to \u0027true\u0027 to ensure that HTTPS is used at all times.",
            "id": "cs/web/requiressl-not-set",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-614/RequireSSL.ql",
            "problem.severity": "error"
          }
        },
        "cs/regex-injection": {
          "id": "cs/regex-injection",
          "name": "cs/regex-injection",
          "shortDescription": "Regular expression injection",
          "fullDescription": "User input should not be used in regular expressions without first being escaped, otherwise a malicious user may be able to provide a regex that could require exponential time on certain inputs.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-730",
  "external/cwe/cwe-400"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Regular expression injection",
            "description": "User input should not be used in regular expressions without first being escaped, otherwise a malicious user may be able to provide a regex that could require exponential time on certain inputs.",
            "id": "cs/regex-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-730/RegexInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/insecure-dtd-handling": {
          "id": "cs/xml/insecure-dtd-handling",
          "name": "cs/xml/insecure-dtd-handling",
          "shortDescription": "Untrusted XML is read insecurely",
          "fullDescription": "Untrusted XML is read with an insecure resolver and DTD processing enabled.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-611",
  "external/cwe/cwe-827",
  "external/cwe/cwe-776"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Untrusted XML is read insecurely",
            "description": "Untrusted XML is read with an insecure resolver and DTD processing enabled.",
            "id": "cs/xml/insecure-dtd-handling",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-611/UntrustedDataInsecureXml.ql",
            "problem.severity": "error"
          }
        },
        "cs/sql-injection": {
          "id": "cs/sql-injection",
          "name": "cs/sql-injection",
          "shortDescription": "SQL query built from user-controlled sources",
          "fullDescription": "Building a SQL query from user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-089"
],
            "kind": "problem",
            "precision": "medium",
            "name": "SQL query built from user-controlled sources",
            "description": "Building a SQL query from user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
            "id": "cs/sql-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-089/SqlInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/redos": {
          "id": "cs/redos",
          "name": "cs/redos",
          "shortDescription": "Denial of Service from comparison of user input against expensive regex",
          "fullDescription": "User input should not be matched against a regular expression that could require exponential time on certain input.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-730",
  "external/cwe/cwe-400"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Denial of Service from comparison of user input against expensive regex",
            "description": "User input should not be matched against a regular expression that could require exponential time on certain input.",
            "id": "cs/redos",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-730/ReDoS.ql",
            "problem.severity": "error"
          }
        },
        "cs/exposure-of-sensitive-information": {
          "id": "cs/exposure-of-sensitive-information",
          "name": "cs/exposure-of-sensitive-information",
          "shortDescription": "Exposure of private information",
          "fullDescription": "If private information is written to an external location, it may be accessible by unauthorized persons.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-359"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Exposure of private information",
            "description": "If private information is written to an external location, it may be accessible by unauthorized persons.",
            "id": "cs/exposure-of-sensitive-information",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-359/ExposureOfPrivateInformation.ql",
            "problem.severity": "error"
          }
        }
      },
      "properties": {
        "originalUriBaseIds": {
  "%SRCROOT%": "file:///C:/corefx/src/System.Data.SqlClient/"
}
      }
    }
  ]
}