{
  "$schema": "http://json.schemastore.org/sarif-1.0.0",
  "version": "1.0.0",
  "runs": [
    {
      "tool": {
        "name": "Semmle",
        "version": "1.15.2"
      },
      "files": {
        "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/src/Internal/Cryptography/AesImplementation.Unix.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHk7DQoNCm5hbWVzcGFjZSBJbnRlcm5hbC5DcnlwdG9ncmFwaHkNCnsNCiAgICBpbnRlcm5hbCBwYXJ0aWFsIGNsYXNzIEFlc0ltcGxlbWVudGF0aW9uDQogICAgew0KICAgICAgICBwcml2YXRlIHN0YXRpYyBJQ3J5cHRvVHJhbnNmb3JtIENyZWF0ZVRyYW5zZm9ybUNvcmUoDQogICAgICAgICAgICBDaXBoZXJNb2RlIGNpcGhlck1vZGUsDQogICAgICAgICAgICBQYWRkaW5nTW9kZSBwYWRkaW5nTW9kZSwNCiAgICAgICAgICAgIGJ5dGVbXSBrZXksDQogICAgICAgICAgICBieXRlW10gaXYsDQogICAgICAgICAgICBpbnQgYmxvY2tTaXplLA0KICAgICAgICAgICAgYm9vbCBlbmNyeXB0aW5nKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBUaGUgYWxnb3JpdGhtIHBvaW50ZXIgaXMgYSBzdGF0aWMgcG9pbnRlciwgc28gbm90IGhhdmluZyBhbnkgY2xlYW51cCBjb2RlIGlzIGNvcnJlY3QuDQogICAgICAgICAgICBJbnRQdHIgYWxnb3JpdGhtID0gR2V0QWxnb3JpdGhtKGtleS5MZW5ndGggKiA4LCBjaXBoZXJNb2RlKTsNCg0KICAgICAgICAgICAgQmFzaWNTeW1tZXRyaWNDaXBoZXIgY2lwaGVyID0gbmV3IE9wZW5Tc2xDaXBoZXIoYWxnb3JpdGhtLCBjaXBoZXJNb2RlLCBibG9ja1NpemUsIGtleSwgMCwgaXYsIGVuY3J5cHRpbmcpOw0KICAgICAgICAgICAgcmV0dXJuIFVuaXZlcnNhbENyeXB0b1RyYW5zZm9ybS5DcmVhdGUocGFkZGluZ01vZGUsIGNpcGhlciwgZW5jcnlwdGluZyk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAvLyAtLS0tIFBBTCBsYXllciBlbmRzIGhlcmUgLS0tLQ0KICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFR1cGxlPGludCwgQ2lwaGVyTW9kZSwgRnVuYzxJbnRQdHI+PltdIHNfYWxnb3JpdGhtSW5pdGlhbGl6ZXJzID0NCiAgICAgICAgew0KICAgICAgICAgICAgLy8gTmVpdGhlciBPcGVuU1NMIG5vciBDbmcgQWVzIHN1cHBvcnQgQ1RTIG1vZGUuDQogICAgICAgICAgICAvLyBDbmcgQWVzIGRvZXNuJ3Qgc2VlbSB0byBzdXBwb3J0IENGQiBtb2RlLCBhbmQgdGhhdCB3b3VsZA0KICAgICAgICAgICAgLy8gcmVxdWlyZSBwYXNzaW5nIGluIHRoZSBmZWVkYmFjayBzaXplLiAgU2luY2UgV2luZG93cyBkb2Vzbid0IHN1cHBvcnQgaXQsDQogICAgICAgICAgICAvLyB3ZSBjYW4gc2tpcCBpdCBoZXJlLCB0b28uDQogICAgICAgICAgICBUdXBsZS5DcmVhdGUoMTI4LCBDaXBoZXJNb2RlLkNCQywgKEZ1bmM8SW50UHRyPilJbnRlcm9wLkNyeXB0by5FdnBBZXMxMjhDYmMpLA0KICAgICAgICAgICAgVHVwbGUuQ3JlYXRlKDEyOCwgQ2lwaGVyTW9kZS5FQ0IsIChGdW5jPEludFB0cj4pSW50ZXJvcC5DcnlwdG8uRXZwQWVzMTI4RWNiKSwNCg0KICAgICAgICAgICAgVHVwbGUuQ3JlYXRlKDE5MiwgQ2lwaGVyTW9kZS5DQkMsIChGdW5jPEludFB0cj4pSW50ZXJvcC5DcnlwdG8uRXZwQWVzMTkyQ2JjKSwNCiAgICAgICAgICAgIFR1cGxlLkNyZWF0ZSgxOTIsIENpcGhlck1vZGUuRUNCLCAoRnVuYzxJbnRQdHI+KUludGVyb3AuQ3J5cHRvLkV2cEFlczE5MkVjYiksDQoNCiAgICAgICAgICAgIFR1cGxlLkNyZWF0ZSgyNTYsIENpcGhlck1vZGUuQ0JDLCAoRnVuYzxJbnRQdHI+KUludGVyb3AuQ3J5cHRvLkV2cEFlczI1NkNiYyksDQogICAgICAgICAgICBUdXBsZS5DcmVhdGUoMjU2LCBDaXBoZXJNb2RlLkVDQiwgKEZ1bmM8SW50UHRyPilJbnRlcm9wLkNyeXB0by5FdnBBZXMyNTZFY2IpLA0KICAgICAgICB9Ow0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIEludFB0ciBHZXRBbGdvcml0aG0oaW50IGtleVNpemUsIENpcGhlck1vZGUgY2lwaGVyTW9kZSkNCiAgICAgICAgew0KICAgICAgICAgICAgYm9vbCBmb3VuZEtleXNpemUgPSBmYWxzZTsNCg0KICAgICAgICAgICAgZm9yZWFjaCAodmFyIHRyaXBsZXQgaW4gc19hbGdvcml0aG1Jbml0aWFsaXplcnMpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKHRyaXBsZXQuSXRlbTEgPT0ga2V5U2l6ZSAmJiB0cmlwbGV0Lkl0ZW0yID09IGNpcGhlck1vZGUpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJpcGxldC5JdGVtMygpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICh0cmlwbGV0Lkl0ZW0xID09IGtleVNpemUpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBmb3VuZEtleXNpemUgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCFmb3VuZEtleXNpemUpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IENyeXB0b2dyYXBoaWNFeGNlcHRpb24oU1IuQ3J5cHRvZ3JhcGh5X0ludmFsaWRLZXlTaXplKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhyb3cgbmV3IE5vdFN1cHBvcnRlZEV4Y2VwdGlvbigpOw0KICAgICAgICB9DQogICAgfQ0KfQ0K"
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/src/Internal/Cryptography/AppleCCCryptor.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljczsNCnVzaW5nIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHk7DQoNCm5hbWVzcGFjZSBJbnRlcm5hbC5DcnlwdG9ncmFwaHkNCnsNCiAgICBpbnRlcm5hbCBzZWFsZWQgY2xhc3MgQXBwbGVDQ0NyeXB0b3IgOiBCYXNpY1N5bW1ldHJpY0NpcGhlcg0KICAgIHsNCiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBib29sIF9lbmNyeXB0aW5nOw0KICAgICAgICBwcml2YXRlIFNhZmVBcHBsZUNyeXB0b3JIYW5kbGUgX2NyeXB0b3I7DQoNCiAgICAgICAgcHVibGljIEFwcGxlQ0NDcnlwdG9yKA0KICAgICAgICAgICAgSW50ZXJvcC5BcHBsZUNyeXB0by5QQUxfU3ltbWV0cmljQWxnb3JpdGhtIGFsZ29yaXRobSwNCiAgICAgICAgICAgIENpcGhlck1vZGUgY2lwaGVyTW9kZSwNCiAgICAgICAgICAgIGludCBibG9ja1NpemVJbkJ5dGVzLA0KICAgICAgICAgICAgYnl0ZVtdIGtleSwNCiAgICAgICAgICAgIGJ5dGVbXSBpdiwNCiAgICAgICAgICAgIGJvb2wgZW5jcnlwdGluZykNCiAgICAgICAgICAgIDogYmFzZShjaXBoZXJNb2RlLkdldENpcGhlckl2KGl2KSwgYmxvY2tTaXplSW5CeXRlcykNCiAgICAgICAgew0KICAgICAgICAgICAgX2VuY3J5cHRpbmcgPSBlbmNyeXB0aW5nOw0KDQogICAgICAgICAgICBPcGVuQ3J5cHRvcihhbGdvcml0aG0sIGNpcGhlck1vZGUsIGtleSk7DQogICAgICAgIH0NCg0KICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBEaXNwb3NlKGJvb2wgZGlzcG9zaW5nKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoZGlzcG9zaW5nKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIF9jcnlwdG9yPy5EaXNwb3NlKCk7DQogICAgICAgICAgICAgICAgX2NyeXB0b3IgPSBudWxsOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBiYXNlLkRpc3Bvc2UoZGlzcG9zaW5nKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBvdmVycmlkZSBpbnQgVHJhbnNmb3JtKGJ5dGVbXSBpbnB1dCwgaW50IGlucHV0T2Zmc2V0LCBpbnQgY291bnQsIGJ5dGVbXSBvdXRwdXQsIGludCBvdXRwdXRPZmZzZXQpDQogICAgICAgIHsNCiAgICAgICAgICAgIERlYnVnLkFzc2VydChpbnB1dCAhPSBudWxsLCAiRXhwZWN0ZWQgdmFsaWQgaW5wdXQsIGdvdCBudWxsIik7DQogICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQoaW5wdXRPZmZzZXQgPj0gMCwgJCJFeHBlY3RlZCBub24tbmVnYXRpdmUgaW5wdXRPZmZzZXQsIGdvdCB7aW5wdXRPZmZzZXR9Iik7DQogICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQoY291bnQgPiAwLCAkIkV4cGVjdGVkIHBvc2l0aXZlIGNvdW50LCBnb3Qge2NvdW50fSIpOw0KICAgICAgICAgICAgRGVidWcuQXNzZXJ0KChjb3VudCAlIEJsb2NrU2l6ZUluQnl0ZXMpID09IDAsICQiRXhwZWN0ZWQgY291bnQgYWxpZ25lZCB0byBibG9jayBzaXplIHtCbG9ja1NpemVJbkJ5dGVzfSwgZ290IHtjb3VudH0iKTsNCiAgICAgICAgICAgIERlYnVnLkFzc2VydChpbnB1dC5MZW5ndGggLSBpbnB1dE9mZnNldCA+PSBjb3VudCwgJCJFeHBlY3RlZCB2YWxpZCBpbnB1dCBsZW5ndGgvb2Zmc2V0L2NvdW50IHRyaXBsZXQsIGdvdCB7aW5wdXQuTGVuZ3RofS97aW5wdXRPZmZzZXR9L3tjb3VudH0iKTsNCiAgICAgICAgICAgIERlYnVnLkFzc2VydChvdXRwdXQgIT0gbnVsbCwgIkV4cGVjdGVkIHZhbGlkIG91dHB1dCwgZ290IG51bGwiKTsNCiAgICAgICAgICAgIERlYnVnLkFzc2VydChvdXRwdXRPZmZzZXQgPj0gMCwgJCJFeHBlY3RlZCBub24tbmVnYXRpdmUgb3V0cHV0T2Zmc2V0LCBnb3Qge291dHB1dE9mZnNldH0iKTsNCiAgICAgICAgICAgIERlYnVnLkFzc2VydChvdXRwdXQuTGVuZ3RoIC0gb3V0cHV0T2Zmc2V0ID49IGNvdW50LCAkIkV4cGVjdGVkIHZhbGlkIG91dHB1dCBsZW5ndGgvb2Zmc2V0L2NvdW50IHRyaXBsZXQsIGdvdCB7b3V0cHV0Lkxlbmd0aH0ve291dHB1dE9mZnNldH0ve2NvdW50fSIpOw0KDQogICAgICAgICAgICByZXR1cm4gQ2lwaGVyVXBkYXRlKGlucHV0LCBpbnB1dE9mZnNldCwgY291bnQsIG91dHB1dCwgb3V0cHV0T2Zmc2V0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBvdmVycmlkZSBieXRlW10gVHJhbnNmb3JtRmluYWwoYnl0ZVtdIGlucHV0LCBpbnQgaW5wdXRPZmZzZXQsIGludCBjb3VudCkNCiAgICAgICAgew0KICAgICAgICAgICAgRGVidWcuQXNzZXJ0KGlucHV0ICE9IG51bGwsICJFeHBlY3RlZCB2YWxpZCBpbnB1dCwgZ290IG51bGwiKTsNCiAgICAgICAgICAgIERlYnVnLkFzc2VydChpbnB1dE9mZnNldCA+PSAwLCAkIkV4cGVjdGVkIG5vbi1uZWdhdGl2ZSBpbnB1dE9mZnNldCwgZ290IHtpbnB1dE9mZnNldH0iKTsNCiAgICAgICAgICAgIERlYnVnLkFzc2VydChjb3VudCA+IDAsICQiRXhwZWN0ZWQgcG9zaXRpdmUgY291bnQsIGdvdCB7Y291bnR9Iik7DQogICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQoKGNvdW50ICUgQmxvY2tTaXplSW5CeXRlcykgPT0gMCwgJCJFeHBlY3RlZCBjb3VudCBhbGlnbmVkIHRvIGJsb2NrIHNpemUge0Jsb2NrU2l6ZUluQnl0ZXN9LCBnb3Qge2NvdW50fSIpOw0KICAgICAgICAgICAgRGVidWcuQXNzZXJ0KGlucHV0Lkxlbmd0aCAtIGlucHV0T2Zmc2V0ID49IGNvdW50LCAkIkV4cGVjdGVkIHZhbGlkIGlucHV0IGxlbmd0aC9vZmZzZXQvY291bnQgdHJpcGxldCwgZ290IHtpbnB1dC5MZW5ndGh9L3tpbnB1dE9mZnNldH0ve2NvdW50fSIpOw0KDQogICAgICAgICAgICBieXRlW10gb3V0cHV0ID0gUHJvY2Vzc0ZpbmFsQmxvY2soaW5wdXQsIGlucHV0T2Zmc2V0LCBjb3VudCk7DQogICAgICAgICAgICBSZXNldCgpOw0KICAgICAgICAgICAgcmV0dXJuIG91dHB1dDsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgdW5zYWZlIGJ5dGVbXSBQcm9jZXNzRmluYWxCbG9jayhieXRlW10gaW5wdXQsIGludCBpbnB1dE9mZnNldCwgaW50IGNvdW50KQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoY291bnQgPT0gMCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuRW1wdHk8Ynl0ZT4oKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgYnl0ZVtdIG91dHB1dCA9IG5ldyBieXRlW2NvdW50XTsNCiAgICAgICAgICAgIGludCBvdXRwdXRCeXRlcyA9IENpcGhlclVwZGF0ZShpbnB1dCwgaW5wdXRPZmZzZXQsIGNvdW50LCBvdXRwdXQsIDApOw0KICAgICAgICAgICAgaW50IHJldDsNCiAgICAgICAgICAgIGludCBlcnJvckNvZGU7DQoNCiAgICAgICAgICAgIGZpeGVkIChieXRlKiBvdXRwdXRTdGFydCA9ICZvdXRwdXRbMF0pDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYnl0ZSogb3V0cHV0Q3VycmVudCA9IG91dHB1dFN0YXJ0ICsgb3V0cHV0Qnl0ZXM7DQogICAgICAgICAgICAgICAgaW50IGJ5dGVzV3JpdHRlbjsNCg0KICAgICAgICAgICAgICAgIHJldCA9IEludGVyb3AuQXBwbGVDcnlwdG8uQ3J5cHRvckZpbmFsKA0KICAgICAgICAgICAgICAgICAgICBfY3J5cHRvciwNCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0Q3VycmVudCwNCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0Lkxlbmd0aCAtIG91dHB1dEJ5dGVzLA0KICAgICAgICAgICAgICAgICAgICBvdXQgYnl0ZXNXcml0dGVuLA0KICAgICAgICAgICAgICAgICAgICBvdXQgZXJyb3JDb2RlKTsNCg0KICAgICAgICAgICAgICAgIG91dHB1dEJ5dGVzICs9IGJ5dGVzV3JpdHRlbjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgUHJvY2Vzc0ludGVyb3BFcnJvcihyZXQsIGVycm9yQ29kZSk7DQoNCiAgICAgICAgICAgIGlmIChvdXRwdXRCeXRlcyA9PSBvdXRwdXQuTGVuZ3RoKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChvdXRwdXRCeXRlcyA9PSAwKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5FbXB0eTxieXRlPigpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBieXRlW10gdXNlckRhdGEgPSBuZXcgYnl0ZVtvdXRwdXRCeXRlc107DQogICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KG91dHB1dCwgMCwgdXNlckRhdGEsIDAsIG91dHB1dEJ5dGVzKTsNCiAgICAgICAgICAgIHJldHVybiB1c2VyRGF0YTsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgdW5zYWZlIGludCBDaXBoZXJVcGRhdGUoYnl0ZVtdIGlucHV0LCBpbnQgaW5wdXRPZmZzZXQsIGludCBjb3VudCwgYnl0ZVtdIG91dHB1dCwgaW50IG91dHB1dE9mZnNldCkNCiAgICAgICAgew0KICAgICAgICAgICAgaW50IHJldDsNCiAgICAgICAgICAgIGludCBjY1N0YXR1czsNCiAgICAgICAgICAgIGludCBieXRlc1dyaXR0ZW47DQoNCiAgICAgICAgICAgIGlmIChjb3VudCA9PSAwKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBmaXhlZCAoYnl0ZSogaW5wdXRTdGFydCA9IGlucHV0KQ0KICAgICAgICAgICAgZml4ZWQgKGJ5dGUqIG91dHB1dFN0YXJ0ID0gb3V0cHV0KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGJ5dGUqIGlucHV0Q3VycmVudCA9IGlucHV0U3RhcnQgKyBpbnB1dE9mZnNldDsNCiAgICAgICAgICAgICAgICBieXRlKiBvdXRwdXRDdXJyZW50ID0gb3V0cHV0U3RhcnQgKyBvdXRwdXRPZmZzZXQ7DQoNCiAgICAgICAgICAgICAgICByZXQgPSBJbnRlcm9wLkFwcGxlQ3J5cHRvLkNyeXB0b3JVcGRhdGUoDQogICAgICAgICAgICAgICAgICAgIF9jcnlwdG9yLA0KICAgICAgICAgICAgICAgICAgICBpbnB1dEN1cnJlbnQsDQogICAgICAgICAgICAgICAgICAgIGNvdW50LA0KICAgICAgICAgICAgICAgICAgICBvdXRwdXRDdXJyZW50LA0KICAgICAgICAgICAgICAgICAgICBvdXRwdXQuTGVuZ3RoIC0gb3V0cHV0T2Zmc2V0LA0KICAgICAgICAgICAgICAgICAgICBvdXQgYnl0ZXNXcml0dGVuLA0KICAgICAgICAgICAgICAgICAgICBvdXQgY2NTdGF0dXMpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBQcm9jZXNzSW50ZXJvcEVycm9yKHJldCwgY2NTdGF0dXMpOw0KDQogICAgICAgICAgICByZXR1cm4gYnl0ZXNXcml0dGVuOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSB1bnNhZmUgdm9pZCBPcGVuQ3J5cHRvcigNCiAgICAgICAgICAgIEludGVyb3AuQXBwbGVDcnlwdG8uUEFMX1N5bW1ldHJpY0FsZ29yaXRobSBhbGdvcml0aG0sDQogICAgICAgICAgICBDaXBoZXJNb2RlIGNpcGhlck1vZGUsDQogICAgICAgICAgICBieXRlW10ga2V5KQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgcmV0Ow0KICAgICAgICAgICAgaW50IGNjU3RhdHVzOw0KDQogICAgICAgICAgICBieXRlW10gaXYgPSBJVjsNCg0KICAgICAgICAgICAgZml4ZWQgKGJ5dGUqIHBiS2V5ID0ga2V5KQ0KICAgICAgICAgICAgZml4ZWQgKGJ5dGUqIHBiSXYgPSBpdikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByZXQgPSBJbnRlcm9wLkFwcGxlQ3J5cHRvLkNyeXB0b3JDcmVhdGUoDQogICAgICAgICAgICAgICAgICAgIF9lbmNyeXB0aW5nDQogICAgICAgICAgICAgICAgICAgICAgICA/IEludGVyb3AuQXBwbGVDcnlwdG8uUEFMX1N5bW1ldHJpY09wZXJhdGlvbi5FbmNyeXB0DQogICAgICAgICAgICAgICAgICAgICAgICA6IEludGVyb3AuQXBwbGVDcnlwdG8uUEFMX1N5bW1ldHJpY09wZXJhdGlvbi5EZWNyeXB0LA0KICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG0sDQogICAgICAgICAgICAgICAgICAgIEdldFBhbENoYWluTW9kZShjaXBoZXJNb2RlKSwNCiAgICAgICAgICAgICAgICAgICAgSW50ZXJvcC5BcHBsZUNyeXB0by5QQUxfUGFkZGluZ01vZGUuTm9uZSwNCiAgICAgICAgICAgICAgICAgICAgcGJLZXksDQogICAgICAgICAgICAgICAgICAgIGtleS5MZW5ndGgsDQogICAgICAgICAgICAgICAgICAgIHBiSXYsDQogICAgICAgICAgICAgICAgICAgIEludGVyb3AuQXBwbGVDcnlwdG8uUEFMX1N5bW1ldHJpY09wdGlvbnMuTm9uZSwNCiAgICAgICAgICAgICAgICAgICAgb3V0IF9jcnlwdG9yLA0KICAgICAgICAgICAgICAgICAgICBvdXQgY2NTdGF0dXMpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBQcm9jZXNzSW50ZXJvcEVycm9yKHJldCwgY2NTdGF0dXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSBJbnRlcm9wLkFwcGxlQ3J5cHRvLlBBTF9DaGFpbmluZ01vZGUgR2V0UGFsQ2hhaW5Nb2RlKENpcGhlck1vZGUgY2lwaGVyTW9kZSkNCiAgICAgICAgew0KICAgICAgICAgICAgc3dpdGNoIChjaXBoZXJNb2RlKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGNhc2UgQ2lwaGVyTW9kZS5DQkM6DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBJbnRlcm9wLkFwcGxlQ3J5cHRvLlBBTF9DaGFpbmluZ01vZGUuQ0JDOw0KICAgICAgICAgICAgICAgIGNhc2UgQ2lwaGVyTW9kZS5FQ0I6DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBJbnRlcm9wLkFwcGxlQ3J5cHRvLlBBTF9DaGFpbmluZ01vZGUuRUNCOw0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBQbGF0Zm9ybU5vdFN1cHBvcnRlZEV4Y2VwdGlvbihTUi5Gb3JtYXQoU1IuQ3J5cHRvZ3JhcGh5X0NpcGhlck1vZGVOb3RTdXBwb3J0ZWQsIGNpcGhlck1vZGUpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgdW5zYWZlIHZvaWQgUmVzZXQoKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgcmV0Ow0KICAgICAgICAgICAgaW50IGNjU3RhdHVzOw0KDQogICAgICAgICAgICBieXRlW10gaXYgPSBJVjsNCg0KICAgICAgICAgICAgZml4ZWQgKGJ5dGUqIHBiSXYgPSBpdikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByZXQgPSBJbnRlcm9wLkFwcGxlQ3J5cHRvLkNyeXB0b3JSZXNldChfY3J5cHRvciwgcGJJdiwgb3V0IGNjU3RhdHVzKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgUHJvY2Vzc0ludGVyb3BFcnJvcihyZXQsIGNjU3RhdHVzKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIHZvaWQgUHJvY2Vzc0ludGVyb3BFcnJvcihpbnQgZnVuY3Rpb25SZXR1cm5Db2RlLCBpbnQgY2NTdGF0dXMpDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIFN1Y2Nlc3MNCiAgICAgICAgICAgIGlmIChmdW5jdGlvblJldHVybkNvZGUgPT0gMSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFBsYXRmb3JtIGVycm9yDQogICAgICAgICAgICBpZiAoZnVuY3Rpb25SZXR1cm5Db2RlID09IDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgRGVidWcuQXNzZXJ0KGNjU3RhdHVzICE9IDAsICJJbnRlcm9wIGZ1bmN0aW9uIHJldHVybmVkIDAgYnV0IGEgc3lzdGVtIGNvZGUgb2Ygc3VjY2VzcyIpOw0KICAgICAgICAgICAgICAgIHRocm93IEludGVyb3AuQXBwbGVDcnlwdG8uQ3JlYXRlRXhjZXB0aW9uRm9yQ0NFcnJvcigNCiAgICAgICAgICAgICAgICAgICAgY2NTdGF0dXMsDQogICAgICAgICAgICAgICAgICAgIEludGVyb3AuQXBwbGVDcnlwdG8uQ0NDcnlwdG9yU3RhdHVzKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gVXN1YWxseSB0aGlzIHdpbGwgYmUgLTEsIGEgZ2VuZXJhbCBpbmRpY2F0aW9uIG9mIGJhZCBpbnB1dHMuDQogICAgICAgICAgICBEZWJ1Zy5GYWlsKCQiSW50ZXJvcCBib3VuZGFyeSByZXR1cm5lZCB1bmV4cGVjdGVkIHZhbHVlIHtmdW5jdGlvblJldHVybkNvZGV9Iik7DQogICAgICAgICAgICB0aHJvdyBuZXcgQ3J5cHRvZ3JhcGhpY0V4Y2VwdGlvbigpOw0KICAgICAgICB9DQogICAgfQ0KfQ0K"
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/src/Internal/Cryptography/Helpers.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljczsNCnVzaW5nIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHk7DQoNCm5hbWVzcGFjZSBJbnRlcm5hbC5DcnlwdG9ncmFwaHkNCnsNCiAgICBpbnRlcm5hbCBzdGF0aWMgY2xhc3MgSGVscGVycw0KICAgIHsNCiAgICAgICAgcHVibGljIHN0YXRpYyBieXRlW10gQ2xvbmVCeXRlQXJyYXkodGhpcyBieXRlW10gc3JjKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoc3JjID09IG51bGwpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAoYnl0ZVtdKShzcmMuQ2xvbmUoKSk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgc3RhdGljIEtleVNpemVzW10gQ2xvbmVLZXlTaXplc0FycmF5KHRoaXMgS2V5U2l6ZXNbXSBzcmMpDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiAoS2V5U2l6ZXNbXSkoc3JjLkNsb25lKCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIFVzZXNJdih0aGlzIENpcGhlck1vZGUgY2lwaGVyTW9kZSkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIGNpcGhlck1vZGUgIT0gQ2lwaGVyTW9kZS5FQ0I7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgc3RhdGljIGJ5dGVbXSBHZXRDaXBoZXJJdih0aGlzIENpcGhlck1vZGUgY2lwaGVyTW9kZSwgYnl0ZVtdIGl2KQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoY2lwaGVyTW9kZS5Vc2VzSXYoKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoaXYgPT0gbnVsbCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBDcnlwdG9ncmFwaGljRXhjZXB0aW9uKFNSLkNyeXB0b2dyYXBoeV9NaXNzaW5nSVYpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiBpdjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgc3RhdGljIGJvb2wgSXNMZWdhbFNpemUodGhpcyBpbnQgc2l6ZSwgS2V5U2l6ZXNbXSBsZWdhbFNpemVzKQ0KICAgICAgICB7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGxlZ2FsU2l6ZXMuTGVuZ3RoOyBpKyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgS2V5U2l6ZXMgY3VycmVudFNpemVzID0gbGVnYWxTaXplc1tpXTsNCiAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gSWYgYSBjaXBoZXIgaGFzIG9ubHkgb25lIHZhbGlkIGtleSBzaXplLCBNaW5TaXplID09IE1heFNpemUgYW5kIFNraXBTaXplIHdpbGwgYmUgMA0KICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U2l6ZXMuU2tpcFNpemUgPT0gMCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U2l6ZXMuTWluU2l6ZSA9PSBzaXplKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gY3VycmVudFNpemVzLk1pblNpemUgJiYgc2l6ZSA8PSBjdXJyZW50U2l6ZXMuTWF4U2l6ZSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBudW1iZXIgaXMgaW4gcmFuZ2UsIGNoZWNrIHRvIHNlZSBpZiBpdCdzIGEgbGVnYWwgaW5jcmVtZW50IGFib3ZlIE1pblNpemUNCiAgICAgICAgICAgICAgICAgICAgaW50IGRlbHRhID0gc2l6ZSAtIGN1cnJlbnRTaXplcy5NaW5TaXplOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIFdoaWxlIGl0IHdvdWxkIGJlIHVudXN1YWwgdG8gc2VlIEtleVNpemVzIHsgMTAsIDIwLCA1IH0gYW5kIHsgMTEsIDE0LCAxIH0sIGl0IGNvdWxkIGhhcHBlbi4NCiAgICAgICAgICAgICAgICAgICAgLy8gU28gZG9uJ3QgcmV0dXJuIGZhbHNlIGp1c3QgYmVjYXVzZSB0aGlzIG9uZSBkb2Vzbid0IG1hdGNoLg0KICAgICAgICAgICAgICAgICAgICBpZiAoZGVsdGEgJSBjdXJyZW50U2l6ZXMuU2tpcFNpemUgPT0gMCkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHB1YmxpYyBzdGF0aWMgYnl0ZVtdIEdlbmVyYXRlUmFuZG9tKGludCBjb3VudCkNCiAgICAgICAgew0KICAgICAgICAgICAgYnl0ZVtdIGJ1ZmZlciA9IG5ldyBieXRlW2NvdW50XTsNCiAgICAgICAgICAgIHVzaW5nIChSYW5kb21OdW1iZXJHZW5lcmF0b3Igcm5nID0gUmFuZG9tTnVtYmVyR2VuZXJhdG9yLkNyZWF0ZSgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJuZy5HZXRCeXRlcyhidWZmZXIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIGVuY29kZXMgdGhlIGludGVnZXIgaSBpbnRvIGEgNC1ieXRlIGFycmF5LCBpbiBiaWcgZW5kaWFuLg0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgV3JpdGVJbnQodWludCBpLCBieXRlW10gYXJyLCBpbnQgb2Zmc2V0KQ0KICAgICAgICB7DQogICAgICAgICAgICB1bmNoZWNrZWQNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQoYXJyICE9IG51bGwpOw0KICAgICAgICAgICAgICAgIERlYnVnLkFzc2VydChhcnIuTGVuZ3RoID49IG9mZnNldCArIHNpemVvZih1aW50KSk7DQoNCiAgICAgICAgICAgICAgICBhcnJbb2Zmc2V0XSA9IChieXRlKShpID4+IDI0KTsNCiAgICAgICAgICAgICAgICBhcnJbb2Zmc2V0ICsgMV0gPSAoYnl0ZSkoaSA+PiAxNik7DQogICAgICAgICAgICAgICAgYXJyW29mZnNldCArIDJdID0gKGJ5dGUpKGkgPj4gOCk7DQogICAgICAgICAgICAgICAgYXJyW29mZnNldCArIDNdID0gKGJ5dGUpaTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBzdGF0aWMgYnl0ZVtdIEZpeHVwS2V5UGFyaXR5KHRoaXMgYnl0ZVtdIGtleSkNCiAgICAgICAgew0KICAgICAgICAgICAgYnl0ZVtdIG9kZFBhcml0eUtleSA9IG5ldyBieXRlW2tleS5MZW5ndGhdOw0KICAgICAgICAgICAgZm9yIChpbnQgaW5kZXggPSAwOyBpbmRleCA8IGtleS5MZW5ndGg7IGluZGV4KyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBiaXRzIHdlIGFyZSBpbnRlcmVzdGVkIGluDQogICAgICAgICAgICAgICAgb2RkUGFyaXR5S2V5W2luZGV4XSA9IChieXRlKShrZXlbaW5kZXhdICYgMHhmZSk7DQoNCiAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIHBhcml0eSBvZiB0aGUgc3VtIG9mIHRoZSBwcmV2aW91cyBiaXRzDQogICAgICAgICAgICAgICAgYnl0ZSB0bXAxID0gKGJ5dGUpKChvZGRQYXJpdHlLZXlbaW5kZXhdICYgMHhGKSBeIChvZGRQYXJpdHlLZXlbaW5kZXhdID4+IDQpKTsNCiAgICAgICAgICAgICAgICBieXRlIHRtcDIgPSAoYnl0ZSkoKHRtcDEgJiAweDMpIF4gKHRtcDEgPj4gMikpOw0KICAgICAgICAgICAgICAgIGJ5dGUgc3VtQml0c01vZDIgPSAoYnl0ZSkoKHRtcDIgJiAweDEpIF4gKHRtcDIgPj4gMSkpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gc2V0IHRoZSBsYXN0IGJpdCBpbiBvZGRQYXJpdHlLZXlbaW5kZXhdIHRvIHRoZSBuZWdhdGlvbg0KICAgICAgICAgICAgICAgIC8vIG9mIHRoZSBsYXN0IGJpdCBpbiBzdW1CaXRzTW9kMg0KICAgICAgICAgICAgICAgIGlmIChzdW1CaXRzTW9kMiA9PSAwKQ0KICAgICAgICAgICAgICAgICAgICBvZGRQYXJpdHlLZXlbaW5kZXhdIHw9IDE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gb2RkUGFyaXR5S2V5Ow0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHZvaWQgQ29udmVydEludFRvQnl0ZUFycmF5KHVpbnQgdmFsdWUsIGJ5dGVbXSBkZXN0KQ0KICAgICAgICB7DQogICAgICAgICAgICBEZWJ1Zy5Bc3NlcnQoZGVzdCAhPSBudWxsKTsNCiAgICAgICAgICAgIERlYnVnLkFzc2VydChkZXN0Lkxlbmd0aCA9PSA0KTsNCiAgICAgICAgICAgIGRlc3RbMF0gPSAoYnl0ZSkoKHZhbHVlICYgMHhGRjAwMDAwMCkgPj4gMjQpOw0KICAgICAgICAgICAgZGVzdFsxXSA9IChieXRlKSgodmFsdWUgJiAweEZGMDAwMCkgPj4gMTYpOw0KICAgICAgICAgICAgZGVzdFsyXSA9IChieXRlKSgodmFsdWUgJiAweEZGMDApID4+IDgpOw0KICAgICAgICAgICAgZGVzdFszXSA9IChieXRlKSh2YWx1ZSAmIDB4RkYpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQo="
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/tests/AesManagedTests.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbS5UZXh0Ow0KdXNpbmcgVGVzdC5DcnlwdG9ncmFwaHk7DQp1c2luZyBYdW5pdDsNCg0KbmFtZXNwYWNlIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuRW5jcnlwdGlvbi5BZXMuVGVzdHMNCnsNCiAgICAvLy8gPHN1bW1hcnk+DQogICAgLy8vIFNpbmNlIEFlc01hbmFnZWQgd3JhcHMgQWVzLCB3ZSBvbmx5IHRlc3QgbWluaW1hbGx5IGhlcmUuDQogICAgLy8vIDwvc3VtbWFyeT4NCiAgICBwdWJsaWMgY2xhc3MgQWVzTWFuYWdlZFRlc3RzDQogICAgew0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFZlcmlmeURlZmF1bHRzKCkNCiAgICAgICAgew0KICAgICAgICAgICAgdXNpbmcgKHZhciBhbGcgPSBuZXcgQWVzTWFuYWdlZCgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIEFzc2VydC5FcXVhbCgxMjgsIGFsZy5CbG9ja1NpemUpOw0KICAgICAgICAgICAgICAgIEFzc2VydC5FcXVhbCgyNTYsIGFsZy5LZXlTaXplKTsNCiAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwoQ2lwaGVyTW9kZS5DQkMsIGFsZy5Nb2RlKTsNCiAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwoUGFkZGluZ01vZGUuUEtDUzcsIGFsZy5QYWRkaW5nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgRW5jcnlwdERlY3J5cHRLbm93bkVDQjE5MigpDQogICAgICAgIHsNCiAgICAgICAgICAgIGJ5dGVbXSBwbGFpblRleHRCeXRlcyA9DQogICAgICAgICAgICAgICAgbmV3IEFTQ0lJRW5jb2RpbmcoKS5HZXRCeXRlcygiVGhpcyBpcyBhIHNlbnRlbmNlIHRoYXQgaXMgbG9uZ2VyIHRoYW4gYSBibG9jaywgaXQgZW5zdXJlcyB0aGF0IG11bHRpLWJsb2NrIGZ1bmN0aW9ucyB3b3JrLiIpOw0KDQogICAgICAgICAgICBieXRlW10gZW5jcnlwdGVkQnl0ZXNFeHBlY3RlZCA9IG5ldyBieXRlW10NCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAweEM5LCAweDdGLCAweEE1LCAweDVCLCAweEMzLCAweDkyLCAweERDLCAweEE2LA0KICAgICAgICAgICAgICAgIDB4RTQsIDB4OUYsIDB4MkQsIDB4MUEsIDB4RUYsIDB4N0EsIDB4MjcsIDB4MDMsDQogICAgICAgICAgICAgICAgMHgwNCwgMHg5QywgMHhGQiwgMHg1NiwgMHg2MywgMHgzOCwgMHhBRSwgMHg0RiwNCiAgICAgICAgICAgICAgICAweERDLCAweEY2LCAweDM2LCAweDk4LCAweDI4LCAweDA1LCAweDMyLCAweEU5LA0KICAgICAgICAgICAgICAgIDB4RjIsIDB4NkUsIDB4RUMsIDB4MEMsIDB4MDQsIDB4OUQsIDB4MTIsIDB4MTcsDQogICAgICAgICAgICAgICAgMHgxOCwgMHgzNSwgMHhENCwgMHgyOSwgMHhGQywgMHgwMSwgMHhCMSwgMHgyMCwNCiAgICAgICAgICAgICAgICAweEZBLCAweDMwLCAweEFFLCAweDAwLCAweDUzLCAweEQ0LCAweDI2LCAweDI1LA0KICAgICAgICAgICAgICAgIDB4QTQsIDB4RkQsIDB4RDUsIDB4RTYsIDB4RUQsIDB4NzksIDB4MzUsIDB4MkEsDQogICAgICAgICAgICAgICAgMHhFMiwgMHhCQiwgMHg5NSwgMHgwRCwgMHhFRiwgMHgwOSwgMHhCQiwgMHg2RCwNCiAgICAgICAgICAgICAgICAweEM1LCAweEM0LCAweERCLCAweDI4LCAweEM2LCAweEY0LCAweDMxLCAweDMzLA0KICAgICAgICAgICAgICAgIDB4OUEsIDB4OTAsIDB4MTIsIDB4MzYsIDB4NTAsIDB4QTAsIDB4QjcsIDB4RDEsDQogICAgICAgICAgICAgICAgMHgzNSwgMHhDNCwgMHhDRSwgMHg4MSwgMHhFNSwgMHgyQiwgMHg4NSwgMHg2QiwNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIGJ5dGVbXSBhZXMxOTJLZXkgPSBuZXcgYnl0ZVtdDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgMHhBNiwgMHgxRSwgMHhDNywgMHg1NCwgMHgzNywgMHg0RCwgMHg4QywgMHhBNSwNCiAgICAgICAgICAgICAgICAweEE0LCAweEJCLCAweDk5LCAweDUwLCAweDM1LCAweDRCLCAweDMwLCAweDRELA0KICAgICAgICAgICAgICAgIDB4NkMsIDB4RkUsIDB4M0IsIDB4NTksIDB4NjUsIDB4Q0IsIDB4OTMsIDB4RTMsDQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICB1c2luZyAodmFyIGFsZyA9IG5ldyBBZXNNYW5hZ2VkKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gVGhlIENpcGhlck1vZGUgYW5kIEtleVNpemUgYXJlIGRpZmZlcmVudCB0aGFuIHRoZSBkZWZhdWx0IHZhbHVlczsgdGhpcyBlbnN1cmVzIHRoZSB0eXBlDQogICAgICAgICAgICAgICAgLy8gZm9yd2FyZHMgdGhlIHN0YXRlIHByb3Blcmx5IHRvIEFlcy4NCiAgICAgICAgICAgICAgICBhbGcuTW9kZSA9IENpcGhlck1vZGUuRUNCOw0KICAgICAgICAgICAgICAgIGFsZy5LZXkgPSBhZXMxOTJLZXk7DQoNCiAgICAgICAgICAgICAgICBieXRlW10gZW5jcnlwdGVkQnl0ZXMgPSBhbGcuRW5jcnlwdChwbGFpblRleHRCeXRlcyk7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKGVuY3J5cHRlZEJ5dGVzRXhwZWN0ZWQsIGVuY3J5cHRlZEJ5dGVzKTsNCg0KICAgICAgICAgICAgICAgIGJ5dGVbXSBkZWNyeXB0ZWRCeXRlcyA9IGFsZy5EZWNyeXB0KGVuY3J5cHRlZEJ5dGVzKTsNCiAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwocGxhaW5UZXh0Qnl0ZXMsIGRlY3J5cHRlZEJ5dGVzKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgVGVzdFNoaW1zKCkNCiAgICAgICAgew0KICAgICAgICAgICAgdXNpbmcgKHZhciBhbGcgPSBuZXcgQWVzTWFuYWdlZCgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGFsZy5CbG9ja1NpemUgPSAxMjg7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDEyOCwgYWxnLkJsb2NrU2l6ZSk7DQoNCiAgICAgICAgICAgICAgICB2YXIgZW1wdHlJViA9IG5ldyBieXRlW2FsZy5CbG9ja1NpemUgLyA4XTsNCiAgICAgICAgICAgICAgICBhbGcuSVYgPSBlbXB0eUlWOw0KICAgICAgICAgICAgICAgIEFzc2VydC5FcXVhbChlbXB0eUlWLCBhbGcuSVYpOw0KICAgICAgICAgICAgICAgIGFsZy5HZW5lcmF0ZUlWKCk7DQogICAgICAgICAgICAgICAgQXNzZXJ0Lk5vdEVxdWFsKGVtcHR5SVYsIGFsZy5JVik7DQoNCiAgICAgICAgICAgICAgICB2YXIgZW1wdHlLZXkgPSBuZXcgYnl0ZVthbGcuS2V5U2l6ZSAvIDhdOw0KICAgICAgICAgICAgICAgIGFsZy5LZXkgPSBlbXB0eUtleTsNCiAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwoZW1wdHlLZXksIGFsZy5LZXkpOw0KICAgICAgICAgICAgICAgIGFsZy5HZW5lcmF0ZUtleSgpOw0KICAgICAgICAgICAgICAgIEFzc2VydC5Ob3RFcXVhbChlbXB0eUtleSwgYWxnLktleSk7DQoNCiAgICAgICAgICAgICAgICBhbGcuS2V5U2l6ZSA9IDEyODsNCiAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwoMTI4LCBhbGcuS2V5U2l6ZSk7DQoNCiAgICAgICAgICAgICAgICBhbGcuTW9kZSA9IENpcGhlck1vZGUuRUNCOw0KICAgICAgICAgICAgICAgIEFzc2VydC5FcXVhbChDaXBoZXJNb2RlLkVDQiwgYWxnLk1vZGUpOw0KDQogICAgICAgICAgICAgICAgYWxnLlBhZGRpbmcgPSBQYWRkaW5nTW9kZS5QS0NTNzsNCiAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwoUGFkZGluZ01vZGUuUEtDUzcsIGFsZy5QYWRkaW5nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/tests/RijndaelTests.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbS5UZXh0Ow0KdXNpbmcgVGVzdC5DcnlwdG9ncmFwaHk7DQp1c2luZyBYdW5pdDsNCg0KbmFtZXNwYWNlIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuRW5jcnlwdGlvbi5SaWpuZGFlbC5UZXN0cw0Kew0KICAgIHVzaW5nIFJpam5kYWVsID0gU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5SaWpuZGFlbDsNCg0KICAgIC8vLyA8c3VtbWFyeT4NCiAgICAvLy8gU2luY2UgUmlqbmRhZWxJbXBsZW1lbnRhdGlvbiAoZnJvbSBSaWpuZGFlbC5DcmVhdGUoKSkgYW5kIFJpam5kYWVsTWFuYWdlZCBjbGFzc2VzIHdyYXAgQWVzLA0KICAgIC8vLyB3ZSBvbmx5IHRlc3QgbWluaW1hbGx5IGhlcmUuDQogICAgLy8vIDwvc3VtbWFyeT4NCiAgICBwdWJsaWMgY2xhc3MgUmlqbmRhZWxUZXN0cw0KICAgIHsNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBWZXJpZnlEZWZhdWx0cygpDQogICAgICAgIHsNCiAgICAgICAgICAgIHVzaW5nICh2YXIgYWxnID0gUmlqbmRhZWwuQ3JlYXRlKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gV2UgdXNlIGFuIGludGVybmFsIGNsYXNzIGZvciB0aGUgaW1wbGVtZW50YXRpb24sIG5vdCB0aGUgcHVibGljIFJpam5kYWVsTWFuYWdlZA0KICAgICAgICAgICAgICAgIEFzc2VydC5Jc05vdFR5cGU8UmlqbmRhZWxNYW5hZ2VkPihhbGcpOw0KDQogICAgICAgICAgICAgICAgVmVyaWZ5RGVmYXVsdHMoYWxnKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdXNpbmcgKHZhciBhbGcgPSBuZXcgUmlqbmRhZWxNYW5hZ2VkKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgVmVyaWZ5RGVmYXVsdHMoYWxnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIHZvaWQgVmVyaWZ5RGVmYXVsdHMoUmlqbmRhZWwgYWxnKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBUaGUgYmxvY2sgc2l6ZSBkaWZmZXJzIGZyb20gdGhlIGJhc2UNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgxMjgsIGFsZy5MZWdhbEJsb2NrU2l6ZXNbMF0uTWluU2l6ZSk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoMTI4LCBhbGcuTGVnYWxCbG9ja1NpemVzWzBdLk1heFNpemUpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDEyOCwgYWxnLkJsb2NrU2l6ZSk7DQoNCiAgICAgICAgICAgIC8vIERpZmZlcmVudCBleGNlcHRpb24gc2luY2Ugd2UgaGF2ZSBkaWZmZXJlbnQgc3VwcG9ydGVkIEJsb2NrU2l6ZXMgdGhhbiBkZXNrdG9wDQogICAgICAgICAgICBBc3NlcnQuVGhyb3dzPFBsYXRmb3JtTm90U3VwcG9ydGVkRXhjZXB0aW9uPigoKSA9PiBhbGcuQmxvY2tTaXplID0gMTkyKTsNCiAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8UGxhdGZvcm1Ob3RTdXBwb3J0ZWRFeGNlcHRpb24+KCgpID0+IGFsZy5CbG9ja1NpemUgPSAyNTYpOw0KDQogICAgICAgICAgICAvLyBOb3JtYWwgZXhjZXB0aW9uIGZvciByZXN0DQogICAgICAgICAgICBBc3NlcnQuVGhyb3dzPENyeXB0b2dyYXBoaWNFeGNlcHRpb24+KCgpID0+IGFsZy5CbG9ja1NpemUgPSAxMTEpOw0KDQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoQ2lwaGVyTW9kZS5DQkMsIGFsZy5Nb2RlKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChQYWRkaW5nTW9kZS5QS0NTNywgYWxnLlBhZGRpbmcpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBWZXJpZnlCbG9ja3NpemVJVk51bGxpbmcoKQ0KICAgICAgICB7DQogICAgICAgICAgICB1c2luZyAodmFyIHRlc3RJVkFsZyA9IFJpam5kYWVsLkNyZWF0ZSgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHVzaW5nICh2YXIgYWxnID0gUmlqbmRhZWwuQ3JlYXRlKCkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBhbGcuSVYgPSB0ZXN0SVZBbGcuSVY7DQogICAgICAgICAgICAgICAgICAgIGFsZy5CbG9ja1NpemUgPSAxMjg7DQogICAgICAgICAgICAgICAgICAgIEFzc2VydC5FcXVhbCh0ZXN0SVZBbGcuSVYsIGFsZy5JVik7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdXNpbmcgKHZhciBhbGcgPSBuZXcgUmlqbmRhZWxNYW5hZ2VkKCkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBhbGcuSVYgPSB0ZXN0SVZBbGcuSVY7DQogICAgICAgICAgICAgICAgICAgIGFsZy5CbG9ja1NpemUgPSAxMjg7DQogICAgICAgICAgICAgICAgICAgIEFzc2VydC5FcXVhbCh0ZXN0SVZBbGcuSVYsIGFsZy5JVik7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdXNpbmcgKHZhciBhbGcgPSBuZXcgUmlqbmRhZWxMZWdhbFNpemVzQnJlYWtlcigpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBvbmUgc2hvdWxkIHNldCBJViB0byBudWxsIG9uIHNldHRpbmcgQmxvY2tTaXplIHNpbmNlIHRoZXJlIGlzIG9ubHkgb25lIHZhbGlkIEJsb2NrU2l6ZQ0KICAgICAgICAgICAgICAgICAgICBhbGcuSVYgPSB0ZXN0SVZBbGcuSVY7DQogICAgICAgICAgICAgICAgICAgIGFsZy5CbG9ja1NpemUgPSAxOw0KICAgICAgICAgICAgICAgICAgICBBc3NlcnQuVGhyb3dzPE5vdEltcGxlbWVudGVkRXhjZXB0aW9uPigoKSA9PiBhbGcuSVYpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHVzaW5nICh2YXIgYWxnID0gbmV3IFJpam5kYWVsTWluaW1hbCgpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgYWxnLklWID0gdGVzdElWQWxnLklWOw0KICAgICAgICAgICAgICAgICAgICBhbGcuQmxvY2tTaXplID0gMTI4Ow0KICAgICAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwodGVzdElWQWxnLklWLCBhbGcuSVYpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgRW5jcnlwdERlY3J5cHRLbm93bkVDQjE5MigpDQogICAgICAgIHsNCiAgICAgICAgICAgIHVzaW5nICh2YXIgYWxnID0gUmlqbmRhZWwuQ3JlYXRlKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgRW5jcnlwdERlY3J5cHRLbm93bkVDQjE5MihhbGcpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB1c2luZyAodmFyIGFsZyA9IG5ldyBSaWpuZGFlbE1hbmFnZWQoKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBFbmNyeXB0RGVjcnlwdEtub3duRUNCMTkyKGFsZyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIHN0YXRpYyB2b2lkIEVuY3J5cHREZWNyeXB0S25vd25FQ0IxOTIoUmlqbmRhZWwgYWxnKQ0KICAgICAgICB7DQogICAgICAgICAgICBieXRlW10gcGxhaW5UZXh0Qnl0ZXMgPQ0KICAgICAgICAgICAgICAgIG5ldyBBU0NJSUVuY29kaW5nKCkuR2V0Qnl0ZXMoIlRoaXMgaXMgYSBzZW50ZW5jZSB0aGF0IGlzIGxvbmdlciB0aGFuIGEgYmxvY2ssIGl0IGVuc3VyZXMgdGhhdCBtdWx0aS1ibG9jayBmdW5jdGlvbnMgd29yay4iKTsNCg0KICAgICAgICAgICAgYnl0ZVtdIGVuY3J5cHRlZEJ5dGVzRXhwZWN0ZWQgPSBuZXcgYnl0ZVtdDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgMHhDOSwgMHg3RiwgMHhBNSwgMHg1QiwgMHhDMywgMHg5MiwgMHhEQywgMHhBNiwNCiAgICAgICAgICAgICAgICAweEU0LCAweDlGLCAweDJELCAweDFBLCAweEVGLCAweDdBLCAweDI3LCAweDAzLA0KICAgICAgICAgICAgICAgIDB4MDQsIDB4OUMsIDB4RkIsIDB4NTYsIDB4NjMsIDB4MzgsIDB4QUUsIDB4NEYsDQogICAgICAgICAgICAgICAgMHhEQywgMHhGNiwgMHgzNiwgMHg5OCwgMHgyOCwgMHgwNSwgMHgzMiwgMHhFOSwNCiAgICAgICAgICAgICAgICAweEYyLCAweDZFLCAweEVDLCAweDBDLCAweDA0LCAweDlELCAweDEyLCAweDE3LA0KICAgICAgICAgICAgICAgIDB4MTgsIDB4MzUsIDB4RDQsIDB4MjksIDB4RkMsIDB4MDEsIDB4QjEsIDB4MjAsDQogICAgICAgICAgICAgICAgMHhGQSwgMHgzMCwgMHhBRSwgMHgwMCwgMHg1MywgMHhENCwgMHgyNiwgMHgyNSwNCiAgICAgICAgICAgICAgICAweEE0LCAweEZELCAweEQ1LCAweEU2LCAweEVELCAweDc5LCAweDM1LCAweDJBLA0KICAgICAgICAgICAgICAgIDB4RTIsIDB4QkIsIDB4OTUsIDB4MEQsIDB4RUYsIDB4MDksIDB4QkIsIDB4NkQsDQogICAgICAgICAgICAgICAgMHhDNSwgMHhDNCwgMHhEQiwgMHgyOCwgMHhDNiwgMHhGNCwgMHgzMSwgMHgzMywNCiAgICAgICAgICAgICAgICAweDlBLCAweDkwLCAweDEyLCAweDM2LCAweDUwLCAweEEwLCAweEI3LCAweEQxLA0KICAgICAgICAgICAgICAgIDB4MzUsIDB4QzQsIDB4Q0UsIDB4ODEsIDB4RTUsIDB4MkIsIDB4ODUsIDB4NkIsDQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICBieXRlW10gYWVzMTkyS2V5ID0gbmV3IGJ5dGVbXQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIDB4QTYsIDB4MUUsIDB4QzcsIDB4NTQsIDB4MzcsIDB4NEQsIDB4OEMsIDB4QTUsDQogICAgICAgICAgICAgICAgMHhBNCwgMHhCQiwgMHg5OSwgMHg1MCwgMHgzNSwgMHg0QiwgMHgzMCwgMHg0RCwNCiAgICAgICAgICAgICAgICAweDZDLCAweEZFLCAweDNCLCAweDU5LCAweDY1LCAweENCLCAweDkzLCAweEUzLA0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgLy8gVGhlIENpcGhlck1vZGUgYW5kIEtleVNpemUgYXJlIGRpZmZlcmVudCB0aGFuIHRoZSBkZWZhdWx0IHZhbHVlczsgdGhpcyBlbnN1cmVzIHRoZSB0eXBlDQogICAgICAgICAgICAvLyBmb3J3YXJkcyB0aGUgc3RhdGUgcHJvcGVybHkgdG8gQWVzLg0KICAgICAgICAgICAgYWxnLk1vZGUgPSBDaXBoZXJNb2RlLkVDQjsNCiAgICAgICAgICAgIGFsZy5LZXkgPSBhZXMxOTJLZXk7DQoNCiAgICAgICAgICAgIGJ5dGVbXSBlbmNyeXB0ZWRCeXRlcyA9IGFsZy5FbmNyeXB0KHBsYWluVGV4dEJ5dGVzKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChlbmNyeXB0ZWRCeXRlc0V4cGVjdGVkLCBlbmNyeXB0ZWRCeXRlcyk7DQoNCiAgICAgICAgICAgIGJ5dGVbXSBkZWNyeXB0ZWRCeXRlcyA9IGFsZy5EZWNyeXB0KGVuY3J5cHRlZEJ5dGVzKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChwbGFpblRleHRCeXRlcywgZGVjcnlwdGVkQnl0ZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBUZXN0U2hpbXMoKQ0KICAgICAgICB7DQogICAgICAgICAgICB1c2luZyAodmFyIGFsZyA9IFJpam5kYWVsLkNyZWF0ZSgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFRlc3RTaGltcyhhbGcpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB1c2luZyAodmFyIGFsZyA9IG5ldyBSaWpuZGFlbE1hbmFnZWQoKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBUZXN0U2hpbXMoYWxnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIHZvaWQgVGVzdFNoaW1zKFJpam5kYWVsIGFsZykNCiAgICAgICAgew0KICAgICAgICAgICAgYWxnLkJsb2NrU2l6ZSA9IDEyODsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgxMjgsIGFsZy5CbG9ja1NpemUpOw0KDQogICAgICAgICAgICB2YXIgZW1wdHlJViA9IG5ldyBieXRlW2FsZy5CbG9ja1NpemUgLyA4XTsNCiAgICAgICAgICAgIGFsZy5JViA9IGVtcHR5SVY7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoZW1wdHlJViwgYWxnLklWKTsNCiAgICAgICAgICAgIGFsZy5HZW5lcmF0ZUlWKCk7DQogICAgICAgICAgICBBc3NlcnQuTm90RXF1YWwoZW1wdHlJViwgYWxnLklWKTsNCg0KICAgICAgICAgICAgdmFyIGVtcHR5S2V5ID0gbmV3IGJ5dGVbYWxnLktleVNpemUgLyA4XTsNCiAgICAgICAgICAgIGFsZy5LZXkgPSBlbXB0eUtleTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChlbXB0eUtleSwgYWxnLktleSk7DQogICAgICAgICAgICBhbGcuR2VuZXJhdGVLZXkoKTsNCiAgICAgICAgICAgIEFzc2VydC5Ob3RFcXVhbChlbXB0eUtleSwgYWxnLktleSk7DQoNCiAgICAgICAgICAgIGFsZy5LZXlTaXplID0gMTI4Ow0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDEyOCwgYWxnLktleVNpemUpOw0KDQogICAgICAgICAgICBhbGcuTW9kZSA9IENpcGhlck1vZGUuRUNCOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKENpcGhlck1vZGUuRUNCLCBhbGcuTW9kZSk7DQoNCiAgICAgICAgICAgIGFsZy5QYWRkaW5nID0gUGFkZGluZ01vZGUuUEtDUzc7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoUGFkZGluZ01vZGUuUEtDUzcsIGFsZy5QYWRkaW5nKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgUmlqbmRhZWxLZXlTaXplX0Jhc2VDbGFzcygpDQogICAgICAgIHsNCiAgICAgICAgICAgIHVzaW5nIChSaWpuZGFlbCBhbGcgPSBuZXcgUmlqbmRhZWxNaW5pbWFsKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDEyOCwgYWxnLkxlZ2FsS2V5U2l6ZXNbMF0uTWluU2l6ZSk7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDI1NiwgYWxnLkxlZ2FsS2V5U2l6ZXNbMF0uTWF4U2l6ZSk7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDY0LCBhbGcuTGVnYWxLZXlTaXplc1swXS5Ta2lwU2l6ZSk7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDI1NiwgYWxnLktleVNpemUpOw0KDQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDEyOCwgYWxnLkxlZ2FsQmxvY2tTaXplc1swXS5NaW5TaXplKTsNCiAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwoMjU2LCBhbGcuTGVnYWxCbG9ja1NpemVzWzBdLk1heFNpemUpOw0KICAgICAgICAgICAgICAgIEFzc2VydC5FcXVhbCg2NCwgYWxnLkxlZ2FsQmxvY2tTaXplc1swXS5Ta2lwU2l6ZSk7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDEyOCwgYWxnLkJsb2NrU2l6ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIEVuc3VyZUxlZ2FsU2l6ZXNWYWx1ZXNJc29sYXRlZCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIG5ldyBSaWpuZGFlbExlZ2FsU2l6ZXNCcmVha2VyKCkuRGlzcG9zZSgpOw0KDQogICAgICAgICAgICB1c2luZyAoUmlqbmRhZWwgYWxnID0gUmlqbmRhZWwuQ3JlYXRlKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDEyOCwgYWxnLkxlZ2FsS2V5U2l6ZXNbMF0uTWluU2l6ZSk7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDEyOCwgYWxnLkxlZ2FsQmxvY2tTaXplc1swXS5NaW5TaXplKTsNCg0KICAgICAgICAgICAgICAgIGFsZy5LZXkgPSBuZXcgYnl0ZVsxNl07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBbVGhlb3J5XQ0KICAgICAgICBbSW5saW5lRGF0YSh0cnVlKV0NCiAgICAgICAgW0lubGluZURhdGEoZmFsc2UpXQ0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgRW5jcnlwdFdpdGhMYXJnZU91dHB1dEJ1ZmZlcihib29sIGJsb2NrQWxpZ25lZE91dHB1dCkNCiAgICAgICAgew0KICAgICAgICAgICAgdXNpbmcgKFJpam5kYWVsIGFsZyA9IFJpam5kYWVsLkNyZWF0ZSgpKQ0KICAgICAgICAgICAgdXNpbmcgKElDcnlwdG9UcmFuc2Zvcm0geGZvcm0gPSBhbGcuQ3JlYXRlRW5jcnlwdG9yKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gOCBibG9ja3MsIHBsdXMgbWF5YmUgdGhyZWUgYnl0ZXMNCiAgICAgICAgICAgICAgICBpbnQgb3V0cHV0UGFkZGluZyA9IGJsb2NrQWxpZ25lZE91dHB1dCA/IDAgOiAzOw0KICAgICAgICAgICAgICAgIGJ5dGVbXSBvdXRwdXQgPSBuZXcgYnl0ZVthbGcuQmxvY2tTaXplICsgb3V0cHV0UGFkZGluZ107DQogICAgICAgICAgICAgICAgLy8gMiBibG9ja3Mgb2YgMHgwMA0KICAgICAgICAgICAgICAgIGJ5dGVbXSBpbnB1dCA9IG5ldyBieXRlW2FsZy5CbG9ja1NpemUgLyA0XTsNCiAgICAgICAgICAgICAgICBpbnQgb3V0cHV0T2Zmc2V0ID0gMDsNCg0KICAgICAgICAgICAgICAgIG91dHB1dE9mZnNldCArPSB4Zm9ybS5UcmFuc2Zvcm1CbG9jayhpbnB1dCwgMCwgaW5wdXQuTGVuZ3RoLCBvdXRwdXQsIG91dHB1dE9mZnNldCk7DQogICAgICAgICAgICAgICAgYnl0ZVtdIG92ZXJmbG93ID0geGZvcm0uVHJhbnNmb3JtRmluYWxCbG9jayhBcnJheS5FbXB0eTxieXRlPigpLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KG92ZXJmbG93LCAwLCBvdXRwdXQsIG91dHB1dE9mZnNldCwgb3ZlcmZsb3cuTGVuZ3RoKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRPZmZzZXQgKz0gb3ZlcmZsb3cuTGVuZ3RoOw0KDQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDMgKiAoYWxnLkJsb2NrU2l6ZSAvIDgpLCBvdXRwdXRPZmZzZXQpOw0KICAgICAgICAgICAgICAgIHN0cmluZyBvdXRwdXRBc0hleCA9IG91dHB1dC5CeXRlQXJyYXlUb0hleCgpOw0KICAgICAgICAgICAgICAgIEFzc2VydC5Ob3RFcXVhbChuZXcgc3RyaW5nKCcwJywgb3V0cHV0T2Zmc2V0ICogMiksIG91dHB1dEFzSGV4LlN1YnN0cmluZygwLCBvdXRwdXRPZmZzZXQgKiAyKSk7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKG5ldyBzdHJpbmcoJzAnLCAob3V0cHV0Lkxlbmd0aCAtIG91dHB1dE9mZnNldCkgKiAyKSwgb3V0cHV0QXNIZXguU3Vic3RyaW5nKG91dHB1dE9mZnNldCAqIDIpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFtUaGVvcnldDQogICAgICAgIFtJbmxpbmVEYXRhKHRydWUsIHRydWUpXQ0KICAgICAgICBbSW5saW5lRGF0YSh0cnVlLCBmYWxzZSldDQogICAgICAgIFtJbmxpbmVEYXRhKGZhbHNlLCB0cnVlKV0NCiAgICAgICAgW0lubGluZURhdGEoZmFsc2UsIGZhbHNlKV0NCiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFRyYW5zZm9ybVdpdGhUb29TaG9ydE91dHB1dEJ1ZmZlcihib29sIGVuY3J5cHQsIGJvb2wgYmxvY2tBbGlnbmVkT3V0cHV0KQ0KICAgICAgICB7DQogICAgICAgICAgICB1c2luZyAoUmlqbmRhZWwgYWxnID0gUmlqbmRhZWwuQ3JlYXRlKCkpDQogICAgICAgICAgICB1c2luZyAoSUNyeXB0b1RyYW5zZm9ybSB4Zm9ybSA9IGVuY3J5cHQgPyBhbGcuQ3JlYXRlRW5jcnlwdG9yKCkgOiBhbGcuQ3JlYXRlRGVjcnlwdG9yKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gMSBibG9jaywgcGx1cyBtYXliZSB0aHJlZSBieXRlcw0KICAgICAgICAgICAgICAgIGludCBvdXRwdXRQYWRkaW5nID0gYmxvY2tBbGlnbmVkT3V0cHV0ID8gMCA6IDM7DQogICAgICAgICAgICAgICAgYnl0ZVtdIG91dHB1dCA9IG5ldyBieXRlW2FsZy5CbG9ja1NpemUgLyA4ICsgb3V0cHV0UGFkZGluZ107DQogICAgICAgICAgICAgICAgLy8gMyBibG9ja3Mgb2YgMHgwMA0KICAgICAgICAgICAgICAgIGJ5dGVbXSBpbnB1dCA9IG5ldyBieXRlWzMgKiAoYWxnLkJsb2NrU2l6ZSAvIDgpXTsNCg0KICAgICAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8QXJndW1lbnRPdXRPZlJhbmdlRXhjZXB0aW9uPigNCiAgICAgICAgICAgICAgICAgICAgKCkgPT4geGZvcm0uVHJhbnNmb3JtQmxvY2soaW5wdXQsIDAsIGlucHV0Lkxlbmd0aCwgb3V0cHV0LCAwKSk7DQoNCiAgICAgICAgICAgICAgICBBc3NlcnQuRXF1YWwobmV3IGJ5dGVbb3V0cHV0Lkxlbmd0aF0sIG91dHB1dCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBbVGhlb3J5XQ0KICAgICAgICBbSW5saW5lRGF0YSh0cnVlKV0NCiAgICAgICAgW0lubGluZURhdGEoZmFsc2UpXQ0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgTXVsdGlwbGVCbG9ja0RlY3J5cHRUcmFuc2Zvcm0oYm9vbCBibG9ja0FsaWduZWRPdXRwdXQpDQogICAgICAgIHsNCiAgICAgICAgICAgIGNvbnN0IHN0cmluZyBFeHBlY3RlZE91dHB1dCA9ICJUaGlzIGlzIGEgMTI4LWJpdCBibG9jayB0ZXN0IjsNCg0KICAgICAgICAgICAgaW50IG91dHB1dFBhZGRpbmcgPSBibG9ja0FsaWduZWRPdXRwdXQgPyAwIDogMzsNCiAgICAgICAgICAgIGJ5dGVbXSBrZXkgPSAiMDEyMzQ1Njc4OUFCQ0RFRkZFRENCQTk4NzY1NDMyMTAiLkhleFRvQnl0ZUFycmF5KCk7DQogICAgICAgICAgICBieXRlW10gaXYgPSAiMDEyMzQ1Njc4OUFCQ0RFRjAxMjM0NTY3ODlBQkNERUYiLkhleFRvQnl0ZUFycmF5KCk7DQogICAgICAgICAgICBieXRlW10gb3V0cHV0Qnl0ZXMgPSBuZXcgYnl0ZVtpdi5MZW5ndGggKiAyICsgb3V0cHV0UGFkZGluZ107DQogICAgICAgICAgICBieXRlW10gaW5wdXQgPSAiRDFCRjg3QzY1MEZDRDEwQjc1ODQ0NUJFMEUwQTk5RDE0NjUyNDgwREY1MzQyM0E4QjcyN0QzMEM4QzAxMEVERSIuSGV4VG9CeXRlQXJyYXkoKTsNCiAgICAgICAgICAgIGludCBvdXRwdXRPZmZzZXQgPSAwOw0KDQogICAgICAgICAgICB1c2luZyAoUmlqbmRhZWwgYWxnID0gUmlqbmRhZWwuQ3JlYXRlKCkpDQogICAgICAgICAgICB1c2luZyAoSUNyeXB0b1RyYW5zZm9ybSB4Zm9ybSA9IGFsZy5DcmVhdGVEZWNyeXB0b3Ioa2V5LCBpdikpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKDIgKiBhbGcuQmxvY2tTaXplLCAob3V0cHV0Qnl0ZXMuTGVuZ3RoIC0gb3V0cHV0UGFkZGluZykgKiA4KTsNCiAgICAgICAgICAgICAgICBvdXRwdXRPZmZzZXQgKz0geGZvcm0uVHJhbnNmb3JtQmxvY2soaW5wdXQsIDAsIGlucHV0Lkxlbmd0aCwgb3V0cHV0Qnl0ZXMsIG91dHB1dE9mZnNldCk7DQogICAgICAgICAgICAgICAgYnl0ZVtdIG92ZXJmbG93ID0geGZvcm0uVHJhbnNmb3JtRmluYWxCbG9jayhBcnJheS5FbXB0eTxieXRlPigpLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KG92ZXJmbG93LCAwLCBvdXRwdXRCeXRlcywgb3V0cHV0T2Zmc2V0LCBvdmVyZmxvdy5MZW5ndGgpOw0KICAgICAgICAgICAgICAgIG91dHB1dE9mZnNldCArPSBvdmVyZmxvdy5MZW5ndGg7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHN0cmluZyBkZWNyeXB0ZWQgPSBFbmNvZGluZy5BU0NJSS5HZXRTdHJpbmcob3V0cHV0Qnl0ZXMsIDAsIG91dHB1dE9mZnNldCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoRXhwZWN0ZWRPdXRwdXQsIGRlY3J5cHRlZCk7DQogICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIGNsYXNzIFJpam5kYWVsTGVnYWxTaXplc0JyZWFrZXIgOiBSaWpuZGFlbE1pbmltYWwNCiAgICAgICAgew0KICAgICAgICAgICAgcHVibGljIFJpam5kYWVsTGVnYWxTaXplc0JyZWFrZXIoKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIExlZ2FsS2V5U2l6ZXNWYWx1ZVswXSA9IG5ldyBLZXlTaXplcygxLCAxLCAwKTsNCiAgICAgICAgICAgICAgICBMZWdhbEJsb2NrU2l6ZXNWYWx1ZVswXSA9IG5ldyBLZXlTaXplcygxLCAxLCAwKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgY2xhc3MgUmlqbmRhZWxNaW5pbWFsIDogUmlqbmRhZWwNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gSWYgdGhlIGNvbnN0cnVjdG9yIHVzZXMgYSB2aXJ0dWFsIGNhbGwgdG8gYW55IG9mIHRoZSBwcm9wZXJ0eSBzZXR0ZXJzDQogICAgICAgICAgICAvLyB0aGV5IHdpbGwgZmFpbC4NCiAgICAgICAgICAgIHByaXZhdGUgcmVhZG9ubHkgYm9vbCBfcmVhZHk7DQoNCiAgICAgICAgICAgIHB1YmxpYyBSaWpuZGFlbE1pbmltYWwoKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIERvbid0IHNldCB0aGlzIGFzIGEgZmllbGQgaW5pdGlhbGl6ZXIsIG90aGVyd2lzZSBpdCBydW5zIGJlZm9yZSB0aGUgYmFzZSBjdG9yLg0KICAgICAgICAgICAgICAgIF9yZWFkeSA9IHRydWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHB1YmxpYyBvdmVycmlkZSBpbnQgS2V5U2l6ZQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHNldA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFfcmVhZHkpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBiYXNlLktleVNpemUgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHB1YmxpYyBvdmVycmlkZSBpbnQgQmxvY2tTaXplDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc2V0DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIV9yZWFkeSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGJhc2UuQmxvY2tTaXplID0gdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgYnl0ZVtdIElWDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc2V0DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIV9yZWFkeSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGJhc2UuSVYgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHB1YmxpYyBvdmVycmlkZSBieXRlW10gS2V5DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc2V0DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIV9yZWFkeSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGJhc2UuS2V5ID0gdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgQ2lwaGVyTW9kZSBNb2RlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc2V0DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIV9yZWFkeSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGJhc2UuTW9kZSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcHVibGljIG92ZXJyaWRlIFBhZGRpbmdNb2RlIFBhZGRpbmcNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBzZXQNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmICghX3JlYWR5KQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbigpOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgYmFzZS5QYWRkaW5nID0gdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgSUNyeXB0b1RyYW5zZm9ybSBDcmVhdGVEZWNyeXB0b3IoYnl0ZVtdIHJnYktleSwgYnl0ZVtdIHJnYklWKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbigpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgSUNyeXB0b1RyYW5zZm9ybSBDcmVhdGVFbmNyeXB0b3IoYnl0ZVtdIHJnYktleSwgYnl0ZVtdIHJnYklWKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbigpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBHZW5lcmF0ZUlWKCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFeGNlcHRpb24oKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcHVibGljIG92ZXJyaWRlIHZvaWQgR2VuZXJhdGVLZXkoKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0K"
        }
      },
      "results": [
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/src/Internal/Cryptography/AesImplementation.Unix.cs",
                "region": {
                  "startLine": 38,
                  "startColumn": 18,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/src/Internal/Cryptography/AesImplementation.Unix.cs",
                "region": {
                  "startLine": 41,
                  "startColumn": 18,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/src/Internal/Cryptography/AesImplementation.Unix.cs",
                "region": {
                  "startLine": 44,
                  "startColumn": 18,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/src/Internal/Cryptography/AppleCCCryptor.cs",
                "region": {
                  "startLine": 181,
                  "startColumn": 5,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/src/Internal/Cryptography/Helpers.cs",
                "region": {
                  "startLine": 30,
                  "startColumn": 21,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/tests/AesManagedTests.cs",
                "region": {
                  "startLine": 61,
                  "startColumn": 11,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/tests/AesManagedTests.cs",
                "region": {
                  "startLine": 95,
                  "startColumn": 11,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/tests/AesManagedTests.cs",
                "region": {
                  "startLine": 96,
                  "startColumn": 13,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/tests/RijndaelTests.cs",
                "region": {
                  "startLine": 134,
                  "startColumn": 11,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/tests/RijndaelTests.cs",
                "region": {
                  "startLine": 178,
                  "startColumn": 11,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/tests/RijndaelTests.cs",
                "region": {
                  "startLine": 179,
                  "startColumn": 13,
                  "length": 14
                }
              }
            }
          ]
        }
      ],
      "rules": {
        "cs/ldap-injection": {
          "id": "cs/ldap-injection",
          "name": "cs/ldap-injection",
          "shortDescription": "LDAP query built from user-controlled sources",
          "fullDescription": "Building an LDAP query from user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-090"
],
            "kind": "problem",
            "precision": "medium",
            "name": "LDAP query built from user-controlled sources",
            "description": "Building an LDAP query from user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
            "id": "cs/ldap-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-090/LDAPInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/xpath-injection": {
          "id": "cs/xml/xpath-injection",
          "name": "cs/xml/xpath-injection",
          "shortDescription": "XPath injection",
          "fullDescription": "Building an XPath expression from user-controlled sources is vulnerable to insertion of malicious code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-643"
],
            "kind": "problem",
            "precision": "medium",
            "name": "XPath injection",
            "description": "Building an XPath expression from user-controlled sources is vulnerable to insertion of malicious code by the user.",
            "id": "cs/xml/xpath-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-643/XPathInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/command-line-injection": {
          "id": "cs/command-line-injection",
          "name": "cs/command-line-injection",
          "shortDescription": "Uncontrolled command line",
          "fullDescription": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "correctness",
  "security",
  "external/cwe/cwe-078",
  "external/cwe/cwe-088"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled command line",
            "description": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
            "id": "cs/command-line-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-078/CommandInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/directory-browse-enabled": {
          "id": "cs/web/directory-browse-enabled",
          "name": "cs/web/directory-browse-enabled",
          "shortDescription": "ASP.NET config file enables directory browsing",
          "fullDescription": "Directory browsing should not be enabled in production as it can leak sensitive information.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-548"
],
            "kind": "problem",
            "precision": "very-high",
            "name": "ASP.NET config file enables directory browsing",
            "description": "Directory browsing should not be enabled in production as it can leak sensitive information.",
            "id": "cs/web/directory-browse-enabled",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-548/ASPNetDirectoryListing.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/unvalidated-url-redirection": {
          "id": "cs/web/unvalidated-url-redirection",
          "name": "cs/web/unvalidated-url-redirection",
          "shortDescription": "URL redirection from remote source",
          "fullDescription": "URL redirection based on unvalidated user input may cause redirection to malicious web sites.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-601"
],
            "kind": "problem",
            "precision": "medium",
            "name": "URL redirection from remote source",
            "description": "URL redirection based on unvalidated user input may cause redirection to malicious web sites.",
            "id": "cs/web/unvalidated-url-redirection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-601/UrlRedirect.ql",
            "problem.severity": "error"
          }
        },
        "cs/path-injection": {
          "id": "cs/path-injection",
          "name": "cs/path-injection",
          "shortDescription": "Uncontrolled data used in path expression",
          "fullDescription": "Accessing paths influenced by users can allow an attacker to access unexpected resources.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-022",
  "external/cwe/cwe-023",
  "external/cwe/cwe-036",
  "external/cwe/cwe-073",
  "external/cwe/cwe-099"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled data used in path expression",
            "description": "Accessing paths influenced by users can allow an attacker to access unexpected resources.",
            "id": "cs/path-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-022/TaintedPath.ql",
            "problem.severity": "error"
          }
        },
        "cs/user-controlled-bypass": {
          "id": "cs/user-controlled-bypass",
          "name": "cs/user-controlled-bypass",
          "shortDescription": "User-controlled bypass of sensitive method",
          "fullDescription": "User-controlled bypassing of sensitive methods may allow attackers to avoid passing through authentication systems.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-807",
  "external/cwe/cwe-247",
  "external/cwe/cwe-350"
],
            "kind": "problem",
            "precision": "medium",
            "name": "User-controlled bypass of sensitive method",
            "description": "User-controlled bypassing of sensitive methods may allow attackers to avoid passing through authentication systems.",
            "id": "cs/user-controlled-bypass",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-807/ConditionalBypass.ql",
            "problem.severity": "error"
          }
        },
        "cs/sensitive-data-transmission": {
          "id": "cs/sensitive-data-transmission",
          "name": "cs/sensitive-data-transmission",
          "shortDescription": "Information exposure through transmitted data",
          "fullDescription": "Transmitting sensitive information to the user is a potential security risk.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-201"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Information exposure through transmitted data",
            "description": "Transmitting sensitive information to the user is a potential security risk.",
            "id": "cs/sensitive-data-transmission",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-201/ExposureInTransmittedData.ql",
            "problem.severity": "error"
          }
        },
        "cs/inappropriate-encoding": {
          "id": "cs/inappropriate-encoding",
          "name": "cs/inappropriate-encoding",
          "shortDescription": "Inappropriate encoding",
          "fullDescription": "Using an inappropriate encoding may give unintended results and may pose a security risk.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-838"
],
            "kind": "problem",
            "precision": "low",
            "name": "Inappropriate encoding",
            "description": "Using an inappropriate encoding may give unintended results and may pose a security risk.",
            "id": "cs/inappropriate-encoding",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-838/InappropriateEncoding.ql",
            "problem.severity": "error"
          }
        },
        "cs/hardcoded-credentials": {
          "id": "cs/hardcoded-credentials",
          "name": "cs/hardcoded-credentials",
          "shortDescription": "Hard-coded credentials",
          "fullDescription": "Credentials are hard coded in the source code of the application.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-259",
  "external/cwe/cwe-321",
  "external/cwe/cwe-798"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Hard-coded credentials",
            "description": "Credentials are hard coded in the source code of the application.",
            "id": "cs/hardcoded-credentials",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-798/HardcodedCredentials.ql",
            "problem.severity": "error"
          }
        },
        "cs/insecure-randomness": {
          "id": "cs/insecure-randomness",
          "name": "cs/insecure-randomness",
          "shortDescription": "Insecure randomness",
          "fullDescription": "Using a cryptographically weak pseudo-random number generator to generate a security sensitive value may allow an attacker to predict what sensitive value will be generated.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-338"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Insecure randomness",
            "description": "Using a cryptographically weak pseudo-random number generator to generate a security sensitive value may allow an attacker to predict what sensitive value will be generated.",
            "id": "cs/insecure-randomness",
            "query-path": "/semmlecode-csharp-queries/Security Features/InsecureRandomness.ql",
            "problem.severity": "warning"
          }
        },
        "cs/empty-password-in-configuration": {
          "id": "cs/empty-password-in-configuration",
          "name": "cs/empty-password-in-configuration",
          "shortDescription": "Empty password in configuration file",
          "fullDescription": "Finds empty passwords in configuration files.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-258",
  "external/cwe/cwe-862"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Empty password in configuration file",
            "description": "Finds empty passwords in configuration files.",
            "id": "cs/empty-password-in-configuration",
            "query-path": "/semmlecode-csharp-queries/Configuration/EmptyPasswordInConfigurationFile.ql",
            "problem.severity": "warning"
          }
        },
        "cs/information-exposure-through-exception": {
          "id": "cs/information-exposure-through-exception",
          "name": "cs/information-exposure-through-exception",
          "shortDescription": "Information exposure through an exception",
          "fullDescription": "Leaking information about an exception, such as messages and stack traces, to an external user can expose implementation details that are useful to an attacker for developing a subsequent exploit.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-209",
  "external/cwe/cwe-497"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Information exposure through an exception",
            "description": "Leaking information about an exception, such as messages and stack traces, to an external user can expose implementation details that are useful to an attacker for developing a subsequent exploit.",
            "id": "cs/information-exposure-through-exception",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-209/ExceptionInformationExposure.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/missing-token-validation": {
          "id": "cs/web/missing-token-validation",
          "name": "cs/web/missing-token-validation",
          "shortDescription": "Missing cross-site request forgery token validation",
          "fullDescription": "Handling a POST request without verifying that the request came from the user allows a malicious attacker to submit a request on behalf of the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-352"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Missing cross-site request forgery token validation",
            "description": "Handling a POST request without verifying that the request came from the user allows a malicious attacker to submit a request on behalf of the user.",
            "id": "cs/web/missing-token-validation",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-352/MissingAntiForgeryTokenValidation.ql",
            "problem.severity": "error"
          }
        },
        "cs/second-order-sql-injection": {
          "id": "cs/second-order-sql-injection",
          "name": "cs/second-order-sql-injection",
          "shortDescription": "SQL query built from stored user-controlled sources",
          "fullDescription": "Building a SQL query from stored user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-089"
],
            "kind": "problem",
            "precision": "medium",
            "name": "SQL query built from stored user-controlled sources",
            "description": "Building a SQL query from stored user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
            "id": "cs/second-order-sql-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-089/SecondOrderSqlInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/unsynchronized-static-access": {
          "id": "cs/unsynchronized-static-access",
          "name": "cs/unsynchronized-static-access",
          "shortDescription": "Unsynchronized access to static collection member in non-static context",
          "fullDescription": "If an unsynchronized access to a static collection member occurs during an addition or resizing operation, an infinite loop can occur.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "concurrency",
  "external/cwe/cwe-362",
  "external/cwe/cwe-567"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Unsynchronized access to static collection member in non-static context",
            "description": "If an unsynchronized access to a static collection member occurs during an addition or resizing operation, an infinite loop can occur.",
            "id": "cs/unsynchronized-static-access",
            "query-path": "/semmlecode-csharp-queries/Concurrency/UnsynchronizedStaticAccess.ql",
            "problem.severity": "error"
          }
        },
        "cs/insufficient-key-size": {
          "id": "cs/insufficient-key-size",
          "name": "cs/insufficient-key-size",
          "shortDescription": "Weak encryption: Insufficient key size",
          "fullDescription": "Finds uses of encryption algorithms with too small a key size",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption: Insufficient key size",
            "description": "Finds uses of encryption algorithms with too small a key size",
            "id": "cs/insufficient-key-size",
            "query-path": "/semmlecode-csharp-queries/Security Features/InsufficientKeySize.ql",
            "problem.severity": "warning"
          }
        },
        "cs/stored-command-line-injection": {
          "id": "cs/stored-command-line-injection",
          "name": "cs/stored-command-line-injection",
          "shortDescription": "Uncontrolled command line from stored user input",
          "fullDescription": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "correctness",
  "security",
  "external/cwe/cwe-078",
  "external/cwe/cwe-088"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled command line from stored user input",
            "description": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
            "id": "cs/stored-command-line-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-078/StoredCommandInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/ecb-encryption": {
          "id": "cs/ecb-encryption",
          "name": "cs/ecb-encryption",
          "shortDescription": "Encryption using ECB",
          "fullDescription": "Highlights uses of the encryption mode 'CipherMode.ECB'. This mode should normally not be used because it is vulnerable to replay attacks.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Encryption using ECB",
            "description": "Highlights uses of the encryption mode \u0027CipherMode.ECB\u0027. This mode should normally not be used because it is vulnerable to replay attacks.",
            "id": "cs/ecb-encryption",
            "query-path": "/semmlecode-csharp-queries/Security Features/Encryption using ECB.ql",
            "problem.severity": "warning"
          }
        },
        "cs/inadequate-rsa-padding": {
          "id": "cs/inadequate-rsa-padding",
          "name": "cs/inadequate-rsa-padding",
          "shortDescription": "Weak encryption: inadequate RSA padding",
          "fullDescription": "Finds uses of RSA encryption with inadequate padding.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327",
  "external/cwe/cwe-780"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption: inadequate RSA padding",
            "description": "Finds uses of RSA encryption with inadequate padding.",
            "id": "cs/inadequate-rsa-padding",
            "query-path": "/semmlecode-csharp-queries/Security Features/InadequateRSAPadding.ql",
            "problem.severity": "warning"
          }
        },
        "cs/cleartext-storage-of-sensitive-information": {
          "id": "cs/cleartext-storage-of-sensitive-information",
          "name": "cs/cleartext-storage-of-sensitive-information",
          "shortDescription": "Clear text storage of sensitive information",
          "fullDescription": "Sensitive information stored without encryption or hashing can expose it to an attacker.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-312",
  "external/cwe/cwe-315",
  "external/cwe/cwe-359"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Clear text storage of sensitive information",
            "description": "Sensitive information stored without encryption or hashing can expose it to an attacker.",
            "id": "cs/cleartext-storage-of-sensitive-information",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-312/CleartextStorage.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/missing-global-error-handler": {
          "id": "cs/web/missing-global-error-handler",
          "name": "cs/web/missing-global-error-handler",
          "shortDescription": "Missing global error handler",
          "fullDescription": "ASP.NET applications should not set the 'customError' mode to \"off\" without providing a global error handler, otherwise they may leak exception information.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-12",
  "external/cwe/cwe-248"
],
            "kind": "problem",
            "precision": "high",
            "name": "Missing global error handler",
            "description": "ASP.NET applications should not set the \u0027customError\u0027 mode to \"off\" without providing a global error handler, otherwise they may leak exception information.",
            "id": "cs/web/missing-global-error-handler",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-248/MissingASPNETGlobalErrorHandler.ql",
            "problem.severity": "warning"
          }
        },
        "cs/session-reuse": {
          "id": "cs/session-reuse",
          "name": "cs/session-reuse",
          "shortDescription": "Failure to abandon session",
          "fullDescription": "Reusing an existing session as a different user could allow an attacker to access someone else's account by using their session.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-384"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Failure to abandon session",
            "description": "Reusing an existing session as a different user could allow an attacker to access someone else\u0027s account by using their session.",
            "id": "cs/session-reuse",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-384/AbandonSession.ql",
            "problem.severity": "error"
          }
        },
        "cs/password-in-configuration": {
          "id": "cs/password-in-configuration",
          "name": "cs/password-in-configuration",
          "shortDescription": "Password in configuration file",
          "fullDescription": "Finds passwords in configuration files.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-13",
  "external/cwe/cwe-256",
  "external/cwe/cwe-313"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Password in configuration file",
            "description": "Finds passwords in configuration files.",
            "id": "cs/password-in-configuration",
            "query-path": "/semmlecode-csharp-queries/Configuration/PasswordInConfigurationFile.ql",
            "problem.severity": "warning"
          }
        },
        "cs/xml/missing-validation": {
          "id": "cs/xml/missing-validation",
          "name": "cs/xml/missing-validation",
          "shortDescription": "Missing XML validation",
          "fullDescription": "User input should not be processed as XML without validating it against a known schema.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-112"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Missing XML validation",
            "description": "User input should not be processed as XML without validating it against a known schema.",
            "id": "cs/xml/missing-validation",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-112/MissingXMLValidation.ql",
            "problem.severity": "recommendation"
          }
        },
        "cs/web/broad-cookie-domain": {
          "id": "cs/web/broad-cookie-domain",
          "name": "cs/web/broad-cookie-domain",
          "shortDescription": "Cookie security: overly broad domain",
          "fullDescription": "Finds cookies with an overly broad domain.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-287"
],
            "kind": "problem",
            "precision": "high",
            "name": "Cookie security: overly broad domain",
            "description": "Finds cookies with an overly broad domain.",
            "id": "cs/web/broad-cookie-domain",
            "query-path": "/semmlecode-csharp-queries/Security Features/CookieWithOverlyBroadDomain.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/persistent-cookie": {
          "id": "cs/web/persistent-cookie",
          "name": "cs/web/persistent-cookie",
          "shortDescription": "Cookie security: persistent cookie",
          "fullDescription": "Persistent cookies are vulnerable to attacks.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-539"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Cookie security: persistent cookie",
            "description": "Persistent cookies are vulnerable to attacks.",
            "id": "cs/web/persistent-cookie",
            "query-path": "/semmlecode-csharp-queries/Security Features/PersistentCookie.ql",
            "problem.severity": "warning"
          }
        },
        "cs/insecure-xml-read": {
          "id": "cs/insecure-xml-read",
          "name": "cs/insecure-xml-read",
          "shortDescription": "XML is read insecurely",
          "fullDescription": "XML may include dangerous external references, which should be restricted using a secure resolver or disabling DTD processing.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-611",
  "external/cwe/cwe-827",
  "external/cwe/cwe-776"
],
            "kind": "problem",
            "precision": "medium",
            "name": "XML is read insecurely",
            "description": "XML may include dangerous external references, which should be restricted using a secure resolver or disabling DTD processing.",
            "id": "cs/insecure-xml-read",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-611/UseXmlSecureResolver.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/xss": {
          "id": "cs/web/xss",
          "name": "cs/web/xss",
          "shortDescription": "Cross-site scripting",
          "fullDescription": "Writing user input directly to a web page allows for a cross-site scripting vulnerability.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-079",
  "external/cwe/cwe-116"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Cross-site scripting",
            "description": "Writing user input directly to a web page allows for a cross-site scripting vulnerability.",
            "id": "cs/web/xss",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-079/XSS.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/stored-xpath-injection": {
          "id": "cs/xml/stored-xpath-injection",
          "name": "cs/xml/stored-xpath-injection",
          "shortDescription": "Stored XPath injection",
          "fullDescription": "Building an XPath expression from stored data which may have been provided by the user is vulnerable to insertion of malicious code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-643"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Stored XPath injection",
            "description": "Building an XPath expression from stored data which may have been provided by the user is vulnerable to insertion of malicious code by the user.",
            "id": "cs/xml/stored-xpath-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-643/StoredXPathInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/stored-xss": {
          "id": "cs/web/stored-xss",
          "name": "cs/web/stored-xss",
          "shortDescription": "Stored cross-site scripting",
          "fullDescription": "Writing input from the database directly to a web page indicates a cross-site scripting vulnerability if the data was originally user-provided.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-079",
  "external/cwe/cwe-116"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Stored cross-site scripting",
            "description": "Writing input from the database directly to a web page indicates a cross-site scripting vulnerability if the data was originally user-provided.",
            "id": "cs/web/stored-xss",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-079/StoredXSS.ql",
            "problem.severity": "error"
          }
        },
        "cs/resource-injection": {
          "id": "cs/resource-injection",
          "name": "cs/resource-injection",
          "shortDescription": "Resource injection",
          "fullDescription": "Building a resource descriptor from untrusted user input is vulnerable to a malicious user providing an unintended resource.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-099"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Resource injection",
            "description": "Building a resource descriptor from untrusted user input is vulnerable to a malicious user providing an unintended resource.",
            "id": "cs/resource-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-099/ResourceInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/debug-binary": {
          "id": "cs/web/debug-binary",
          "name": "cs/web/debug-binary",
          "shortDescription": "Creating an ASP.NET debug binary may reveal sensitive information",
          "fullDescription": "ASP.NET projects should not produce debug binaries when deploying to production as debug builds provide additional information useful to a malicious attacker.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "maintainability",
  "frameworks/asp.net",
  "external/cwe/cwe-11"
],
            "kind": "problem",
            "precision": "very-high",
            "name": "Creating an ASP.NET debug binary may reveal sensitive information",
            "description": "ASP.NET projects should not produce debug binaries when deploying to production as debug builds provide additional information useful to a malicious attacker.",
            "id": "cs/web/debug-binary",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-011/ASPNetDebug.ql",
            "problem.severity": "warning"
          }
        },
        "cs/stored-ldap-injection": {
          "id": "cs/stored-ldap-injection",
          "name": "cs/stored-ldap-injection",
          "shortDescription": "LDAP query built from stored user-controlled sources",
          "fullDescription": "Building an LDAP query from stored user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-090"
],
            "kind": "problem",
            "precision": "medium",
            "name": "LDAP query built from stored user-controlled sources",
            "description": "Building an LDAP query from stored user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
            "id": "cs/stored-ldap-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-090/StoredLDAPInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/code-injection": {
          "id": "cs/code-injection",
          "name": "cs/code-injection",
          "shortDescription": "Improper control of generation of code",
          "fullDescription": "Treating externally controlled strings as code can allow an attacker to execute malicious code.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-094",
  "external/cwe/cwe-095",
  "external/cwe/cwe-096"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Improper control of generation of code",
            "description": "Treating externally controlled strings as code can allow an attacker to execute malicious code.",
            "id": "cs/code-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-094/CodeInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/unvalidated-local-pointer-arithmetic": {
          "id": "cs/unvalidated-local-pointer-arithmetic",
          "name": "cs/unvalidated-local-pointer-arithmetic",
          "shortDescription": "Unvalidated local pointer arithmetic",
          "fullDescription": "Using the result of a virtual method call in pointer arithmetic without validation is dangerous because the method may be overridden by a subtype to return any value.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-119",
  "external/cwe/cwe-120",
  "external/cwe/cwe-122",
  "external/cwe/cwe-788"
],
            "kind": "problem",
            "precision": "high",
            "name": "Unvalidated local pointer arithmetic",
            "description": "Using the result of a virtual method call in pointer arithmetic without validation is dangerous because the method may be overridden by a subtype to return any value.",
            "id": "cs/unvalidated-local-pointer-arithmetic",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-119/LocalUnvalidatedArithmetic.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/missing-x-frame-options": {
          "id": "cs/web/missing-x-frame-options",
          "name": "cs/web/missing-x-frame-options",
          "shortDescription": "Missing X-Frame-Options HTTP header",
          "fullDescription": "If the 'X-Frame-Options' setting is not provided, a malicious user may be able to overlay their own UI on top of the site by using an iframe.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-451",
  "external/cwe/cwe-829"
],
            "kind": "problem",
            "precision": "high",
            "name": "Missing X-Frame-Options HTTP header",
            "description": "If the \u0027X-Frame-Options\u0027 setting is not provided, a malicious user may be able to overlay their own UI on top of the site by using an iframe.",
            "id": "cs/web/missing-x-frame-options",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-451/MissingXFrameOptions.ql",
            "problem.severity": "error"
          }
        },
        "cs/hardcoded-connection-string-credentials": {
          "id": "cs/hardcoded-connection-string-credentials",
          "name": "cs/hardcoded-connection-string-credentials",
          "shortDescription": "Hard-coded connection string with credentials",
          "fullDescription": "Credentials are hard-coded in a connection string in the source code of the application.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-259",
  "external/cwe/cwe-321",
  "external/cwe/cwe-798"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Hard-coded connection string with credentials",
            "description": "Credentials are hard-coded in a connection string in the source code of the application.",
            "id": "cs/hardcoded-connection-string-credentials",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-798/HardcodedConnectionString.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/broad-cookie-path": {
          "id": "cs/web/broad-cookie-path",
          "name": "cs/web/broad-cookie-path",
          "shortDescription": "Cookie security: overly broad path",
          "fullDescription": "Finds cookies with an overly broad path.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-287"
],
            "kind": "problem",
            "precision": "high",
            "name": "Cookie security: overly broad path",
            "description": "Finds cookies with an overly broad path.",
            "id": "cs/web/broad-cookie-path",
            "query-path": "/semmlecode-csharp-queries/Security Features/CookieWithOverlyBroadPath.ql",
            "problem.severity": "warning"
          }
        },
        "cs/weak-encryption": {
          "id": "cs/weak-encryption",
          "name": "cs/weak-encryption",
          "shortDescription": "Weak encryption",
          "fullDescription": "Finds uses of encryption algorithms that are weak and obsolete",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption",
            "description": "Finds uses of encryption algorithms that are weak and obsolete",
            "id": "cs/weak-encryption",
            "query-path": "/semmlecode-csharp-queries/Security Features/WeakEncryption.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/disabled-header-checking": {
          "id": "cs/web/disabled-header-checking",
          "name": "cs/web/disabled-header-checking",
          "shortDescription": "Header checking disabled",
          "fullDescription": "Finds places where header checking is disabled.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-113"
],
            "kind": "problem",
            "precision": "high",
            "name": "Header checking disabled",
            "description": "Finds places where header checking is disabled.",
            "id": "cs/web/disabled-header-checking",
            "query-path": "/semmlecode-csharp-queries/Security Features/HeaderCheckingDisabled.ql",
            "problem.severity": "warning"
          }
        },
        "cs/log-forging": {
          "id": "cs/log-forging",
          "name": "cs/log-forging",
          "shortDescription": "Log entries created from user input",
          "fullDescription": "Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-117"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Log entries created from user input",
            "description": "Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.",
            "id": "cs/log-forging",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-117/LogForging.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/requiressl-not-set": {
          "id": "cs/web/requiressl-not-set",
          "name": "cs/web/requiressl-not-set",
          "shortDescription": "'requireSSL' attribute is not set to true",
          "fullDescription": "Omitting the 'requireSSL' attribute allows data to be transmitted insecurely using HTTP. Always set 'requireSSL' to 'true' to ensure that HTTPS is used at all times.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-319",
  "external/cwe/cwe-614"
],
            "kind": "problem",
            "precision": "high",
            "name": "\u0027requireSSL\u0027 attribute is not set to true",
            "description": "Omitting the \u0027requireSSL\u0027 attribute allows data to be transmitted insecurely using HTTP. Always set \u0027requireSSL\u0027 to \u0027true\u0027 to ensure that HTTPS is used at all times.",
            "id": "cs/web/requiressl-not-set",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-614/RequireSSL.ql",
            "problem.severity": "error"
          }
        },
        "cs/regex-injection": {
          "id": "cs/regex-injection",
          "name": "cs/regex-injection",
          "shortDescription": "Regular expression injection",
          "fullDescription": "User input should not be used in regular expressions without first being escaped, otherwise a malicious user may be able to provide a regex that could require exponential time on certain inputs.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-730",
  "external/cwe/cwe-400"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Regular expression injection",
            "description": "User input should not be used in regular expressions without first being escaped, otherwise a malicious user may be able to provide a regex that could require exponential time on certain inputs.",
            "id": "cs/regex-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-730/RegexInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/insecure-dtd-handling": {
          "id": "cs/xml/insecure-dtd-handling",
          "name": "cs/xml/insecure-dtd-handling",
          "shortDescription": "Untrusted XML is read insecurely",
          "fullDescription": "Untrusted XML is read with an insecure resolver and DTD processing enabled.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-611",
  "external/cwe/cwe-827",
  "external/cwe/cwe-776"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Untrusted XML is read insecurely",
            "description": "Untrusted XML is read with an insecure resolver and DTD processing enabled.",
            "id": "cs/xml/insecure-dtd-handling",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-611/UntrustedDataInsecureXml.ql",
            "problem.severity": "error"
          }
        },
        "cs/sql-injection": {
          "id": "cs/sql-injection",
          "name": "cs/sql-injection",
          "shortDescription": "SQL query built from user-controlled sources",
          "fullDescription": "Building a SQL query from user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-089"
],
            "kind": "problem",
            "precision": "medium",
            "name": "SQL query built from user-controlled sources",
            "description": "Building a SQL query from user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
            "id": "cs/sql-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-089/SqlInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/redos": {
          "id": "cs/redos",
          "name": "cs/redos",
          "shortDescription": "Denial of Service from comparison of user input against expensive regex",
          "fullDescription": "User input should not be matched against a regular expression that could require exponential time on certain input.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-730",
  "external/cwe/cwe-400"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Denial of Service from comparison of user input against expensive regex",
            "description": "User input should not be matched against a regular expression that could require exponential time on certain input.",
            "id": "cs/redos",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-730/ReDoS.ql",
            "problem.severity": "error"
          }
        },
        "cs/exposure-of-sensitive-information": {
          "id": "cs/exposure-of-sensitive-information",
          "name": "cs/exposure-of-sensitive-information",
          "shortDescription": "Exposure of private information",
          "fullDescription": "If private information is written to an external location, it may be accessible by unauthorized persons.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-359"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Exposure of private information",
            "description": "If private information is written to an external location, it may be accessible by unauthorized persons.",
            "id": "cs/exposure-of-sensitive-information",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-359/ExposureOfPrivateInformation.ql",
            "problem.severity": "error"
          }
        }
      },
      "properties": {
        "originalUriBaseIds": {
  "%SRCROOT%": "file:///C:/corefx/src/System.Security.Cryptography.Algorithms/"
}
      }
    }
  ]
}