{
  "$schema": "http://json.schemastore.org/sarif-1.0.0",
  "version": "1.0.0",
  "runs": [
    {
      "tool": {
        "name": "Semmle",
        "version": "1.15.2"
      },
      "files": {
        "file:///C:/corefx/src/System.Security.Cryptography.Xml/src/System/Security/Cryptography/Xml/SymmetricKeyWrap.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljcy5Db2RlQW5hbHlzaXM7DQp1c2luZyBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Ow0KDQpuYW1lc3BhY2UgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5YbWwNCnsNCiAgICAvLyBhYnN0cmFjdCBjbGFzcyBwcm92aWRpbmcgc3ltbWV0cmljIGtleSB3cmFwIGltcGxlbWVudGF0aW9uDQogICAgaW50ZXJuYWwgc3RhdGljIGNsYXNzIFN5bW1ldHJpY0tleVdyYXANCiAgICB7DQogICAgICAgIHByaXZhdGUgcmVhZG9ubHkgc3RhdGljIGJ5dGVbXSBzX3JnYlRyaXBsZURFU19LV19JViA9IHsgMHg0YSwgMHhkZCwgMHhhMiwgMHgyYywgMHg3OSwgMHhlOCwgMHgyMSwgMHgwNSB9Ow0KICAgICAgICBwcml2YXRlIHJlYWRvbmx5IHN0YXRpYyBieXRlW10gc19yZ2JBRVNfS1dfSVYgPSB7IDB4YTYsIDB4YTYsIDB4YTYsIDB4YTYsIDB4YTYsIDB4YTYsIDB4YTYsIDB4YTYgfTsNCg0KICAgICAgICAvLw0KICAgICAgICAvLyBpbnRlcm5hbCBzdGF0aWMgbWV0aG9kcw0KICAgICAgICAvLw0KDQogICAgICAgIC8vIENNUyBUcmlwbGVERVMgS2V5V3JhcCBhcyBkZXNjcmliZWQgaW4gImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI2t3LXRyaXBsZWRlcyINCiAgICAgICAgW1N1cHByZXNzTWVzc2FnZSgiTWljcm9zb2Z0LkNyeXB0b2dyYXBoeSIsICJDQTUzNTAiLCBKdXN0aWZpY2F0aW9uID0gIkV4cGxpY2l0bHkgcmVxdWVzdGVkIGJ5IHRoZSBtZXNzYWdlIGNvbnRlbnRzIildDQogICAgICAgIGludGVybmFsIHN0YXRpYyBieXRlW10gVHJpcGxlREVTS2V5V3JhcEVuY3J5cHQoYnl0ZVtdIHJnYktleSwgYnl0ZVtdIHJnYldyYXBwZWRLZXlEYXRhKQ0KICAgICAgICB7DQogICAgICAgICAgICBieXRlW10gcmdiQ0tTOw0KDQogICAgICAgICAgICB1c2luZyAodmFyIHNoYSA9IFNIQTEuQ3JlYXRlKCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gY2hlY2tzdW0gdGhlIGtleQ0KICAgICAgICAgICAgICAgIHJnYkNLUyA9IHNoYS5Db21wdXRlSGFzaChyZ2JXcmFwcGVkS2V5RGF0YSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIGdlbmVyYXRlIGEgcmFuZG9tIElWDQogICAgICAgICAgICBieXRlW10gcmdiSVYgPSBuZXcgYnl0ZVs4XTsNCiAgICAgICAgICAgIHVzaW5nIChSYW5kb21OdW1iZXJHZW5lcmF0b3Igcm5nID0gUmFuZG9tTnVtYmVyR2VuZXJhdG9yLkNyZWF0ZSgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJuZy5HZXRCeXRlcyhyZ2JJVik7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIHJnYldLQ1MgPSByZ2JXcmFwcGVkS2V5RGF0YSB8IChmaXJzdCA4IGJ5dGVzIG9mIHRoZSBoYXNoKQ0KICAgICAgICAgICAgYnl0ZVtdIHJnYldLQ0tTID0gbmV3IGJ5dGVbcmdiV3JhcHBlZEtleURhdGEuTGVuZ3RoICsgOF07DQogICAgICAgICAgICBUcmlwbGVERVMgdHJpcGxlREVTID0gbnVsbDsNCiAgICAgICAgICAgIElDcnlwdG9UcmFuc2Zvcm0gZW5jMSA9IG51bGw7DQogICAgICAgICAgICBJQ3J5cHRvVHJhbnNmb3JtIGVuYzIgPSBudWxsOw0KDQogICAgICAgICAgICB0cnkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0cmlwbGVERVMgPSBUcmlwbGVERVMuQ3JlYXRlKCk7DQogICAgICAgICAgICAgICAgLy8gRG9uJ3QgYWRkIHBhZGRpbmcsIHVzZSBDQkMgbW9kZTogZm9yIGV4YW1wbGUsIGEgMTkyIGJpdHMga2V5IHdpbGwgeWllbGQgNDAgYnl0ZXMgb2YgZW5jcnlwdGVkIGRhdGENCiAgICAgICAgICAgICAgICB0cmlwbGVERVMuUGFkZGluZyA9IFBhZGRpbmdNb2RlLk5vbmU7DQogICAgICAgICAgICAgICAgZW5jMSA9IHRyaXBsZURFUy5DcmVhdGVFbmNyeXB0b3IocmdiS2V5LCByZ2JJVik7DQogICAgICAgICAgICAgICAgZW5jMiA9IHRyaXBsZURFUy5DcmVhdGVFbmNyeXB0b3IocmdiS2V5LCBzX3JnYlRyaXBsZURFU19LV19JVik7DQoNCiAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KHJnYldyYXBwZWRLZXlEYXRhLCAwLCByZ2JXS0NLUywgMCwgcmdiV3JhcHBlZEtleURhdGEuTGVuZ3RoKTsNCiAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KHJnYkNLUywgMCwgcmdiV0tDS1MsIHJnYldyYXBwZWRLZXlEYXRhLkxlbmd0aCwgOCk7DQogICAgICAgICAgICAgICAgYnl0ZVtdIHRlbXAxID0gZW5jMS5UcmFuc2Zvcm1GaW5hbEJsb2NrKHJnYldLQ0tTLCAwLCByZ2JXS0NLUy5MZW5ndGgpOw0KICAgICAgICAgICAgICAgIGJ5dGVbXSB0ZW1wMiA9IG5ldyBieXRlW3JnYklWLkxlbmd0aCArIHRlbXAxLkxlbmd0aF07DQogICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weShyZ2JJViwgMCwgdGVtcDIsIDAsIHJnYklWLkxlbmd0aCk7DQogICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weSh0ZW1wMSwgMCwgdGVtcDIsIHJnYklWLkxlbmd0aCwgdGVtcDEuTGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAvLyB0ZW1wMiA9IFJFViAocmdiSVYgfCBFX2socmdiV3JhcHBlZEtleURhdGEgfCByZ2JDS1MpKQ0KICAgICAgICAgICAgICAgIEFycmF5LlJldmVyc2UodGVtcDIpOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIGVuYzIuVHJhbnNmb3JtRmluYWxCbG9jayh0ZW1wMiwgMCwgdGVtcDIuTGVuZ3RoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZpbmFsbHkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBlbmMyPy5EaXNwb3NlKCk7DQogICAgICAgICAgICAgICAgZW5jMT8uRGlzcG9zZSgpOw0KICAgICAgICAgICAgICAgIHRyaXBsZURFUz8uRGlzcG9zZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgW1N1cHByZXNzTWVzc2FnZSgiTWljcm9zb2Z0LkNyeXB0b2dyYXBoeSIsICJDQTUzNTAiLCBKdXN0aWZpY2F0aW9uID0gIkV4cGxpY2l0bHkgcmVxdWVzdGVkIGJ5IHRoZSBtZXNzYWdlIGNvbnRlbnRzIildDQogICAgICAgIGludGVybmFsIHN0YXRpYyBieXRlW10gVHJpcGxlREVTS2V5V3JhcERlY3J5cHQoYnl0ZVtdIHJnYktleSwgYnl0ZVtdIHJnYkVuY3J5cHRlZFdyYXBwZWRLZXlEYXRhKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBDaGVjayB0byBzZWUgd2hldGhlciB0aGUgbGVuZ3RoIG9mIHRoZSBlbmNyeXB0ZWQga2V5IGlzIHJlYXNvbmFibGUNCiAgICAgICAgICAgIGlmIChyZ2JFbmNyeXB0ZWRXcmFwcGVkS2V5RGF0YS5MZW5ndGggIT0gMzIgJiYgcmdiRW5jcnlwdGVkV3JhcHBlZEtleURhdGEuTGVuZ3RoICE9IDQwDQogICAgICAgICAgICAgICAgJiYgcmdiRW5jcnlwdGVkV3JhcHBlZEtleURhdGEuTGVuZ3RoICE9IDQ4KQ0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBDcnlwdG9ncmFwaGljRXhjZXB0aW9uKFNSLkNyeXB0b2dyYXBoeV9YbWxfS1dfQmFkS2V5U2l6ZSk7DQoNCiAgICAgICAgICAgIFRyaXBsZURFUyB0cmlwbGVERVMgPSBudWxsOw0KICAgICAgICAgICAgSUNyeXB0b1RyYW5zZm9ybSBkZWMxID0gbnVsbDsNCiAgICAgICAgICAgIElDcnlwdG9UcmFuc2Zvcm0gZGVjMiA9IG51bGw7DQoNCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRyaXBsZURFUyA9IFRyaXBsZURFUy5DcmVhdGUoKTsNCiAgICAgICAgICAgICAgICAvLyBBc3N1bWUgbm8gcGFkZGluZywgdXNlIENCQyBtb2RlDQogICAgICAgICAgICAgICAgdHJpcGxlREVTLlBhZGRpbmcgPSBQYWRkaW5nTW9kZS5Ob25lOw0KICAgICAgICAgICAgICAgIGRlYzEgPSB0cmlwbGVERVMuQ3JlYXRlRGVjcnlwdG9yKHJnYktleSwgc19yZ2JUcmlwbGVERVNfS1dfSVYpOw0KDQogICAgICAgICAgICAgICAgYnl0ZVtdIHRlbXAyID0gZGVjMS5UcmFuc2Zvcm1GaW5hbEJsb2NrKHJnYkVuY3J5cHRlZFdyYXBwZWRLZXlEYXRhLCAwLCByZ2JFbmNyeXB0ZWRXcmFwcGVkS2V5RGF0YS5MZW5ndGgpOw0KICAgICAgICAgICAgICAgIEFycmF5LlJldmVyc2UodGVtcDIpOw0KICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgSVYgYW5kIHRlbXAxDQogICAgICAgICAgICAgICAgYnl0ZVtdIHJnYklWID0gbmV3IGJ5dGVbOF07DQogICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weSh0ZW1wMiwgMCwgcmdiSVYsIDAsIDgpOw0KICAgICAgICAgICAgICAgIGJ5dGVbXSB0ZW1wMSA9IG5ldyBieXRlW3RlbXAyLkxlbmd0aCAtIHJnYklWLkxlbmd0aF07DQogICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weSh0ZW1wMiwgOCwgdGVtcDEsIDAsIHRlbXAxLkxlbmd0aCk7DQoNCiAgICAgICAgICAgICAgICBkZWMyID0gdHJpcGxlREVTLkNyZWF0ZURlY3J5cHRvcihyZ2JLZXksIHJnYklWKTsNCiAgICAgICAgICAgICAgICBieXRlW10gcmdiV0tDS1MgPSBkZWMyLlRyYW5zZm9ybUZpbmFsQmxvY2sodGVtcDEsIDAsIHRlbXAxLkxlbmd0aCk7DQoNCiAgICAgICAgICAgICAgICAvLyBjaGVja3N1bSB0aGUga2V5DQogICAgICAgICAgICAgICAgYnl0ZVtdIHJnYldyYXBwZWRLZXlEYXRhID0gbmV3IGJ5dGVbcmdiV0tDS1MuTGVuZ3RoIC0gOF07DQogICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weShyZ2JXS0NLUywgMCwgcmdiV3JhcHBlZEtleURhdGEsIDAsIHJnYldyYXBwZWRLZXlEYXRhLkxlbmd0aCk7DQogICAgICAgICAgICAgICAgdXNpbmcgKHZhciBzaGEgPSBTSEExLkNyZWF0ZSgpKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgYnl0ZVtdIHJnYkNLUyA9IHNoYS5Db21wdXRlSGFzaChyZ2JXcmFwcGVkS2V5RGF0YSk7DQogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGluZGV4ID0gcmdiV3JhcHBlZEtleURhdGEuTGVuZ3RoLCBpbmRleDEgPSAwOyBpbmRleCA8IHJnYldLQ0tTLkxlbmd0aDsgaW5kZXgrKywgaW5kZXgxKyspDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmdiV0tDS1NbaW5kZXhdICE9IHJnYkNLU1tpbmRleDFdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBDcnlwdG9ncmFwaGljRXhjZXB0aW9uKFNSLkNyeXB0b2dyYXBoeV9YbWxfQmFkV3JhcHBlZEtleVNpemUpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmdiV3JhcHBlZEtleURhdGE7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZmluYWxseQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGRlYzI/LkRpc3Bvc2UoKTsNCiAgICAgICAgICAgICAgICBkZWMxPy5EaXNwb3NlKCk7DQogICAgICAgICAgICAgICAgdHJpcGxlREVTPy5EaXNwb3NlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBBRVMgS2V5V3JhcCBkZXNjcmliZWQgaW4gImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI2t3LWFlcyoqKiIsIGFzIHN1Z2dlc3RlZCBieSBOSVNUDQogICAgICAgIGludGVybmFsIHN0YXRpYyBieXRlW10gQUVTS2V5V3JhcEVuY3J5cHQoYnl0ZVtdIHJnYktleSwgYnl0ZVtdIHJnYldyYXBwZWRLZXlEYXRhKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgTiA9IHJnYldyYXBwZWRLZXlEYXRhLkxlbmd0aCA+PiAzOw0KICAgICAgICAgICAgLy8gVGhlIGluZm9ybWF0aW9uIHdyYXBwZWQgbmVlZCBub3QgYWN0dWFsbHkgYmUgYSBrZXksIGJ1dCBpdCBuZWVkcyB0byBiZSBhIG11bHRpcGxlIG9mIDY0IGJpdHMNCiAgICAgICAgICAgIGlmICgocmdiV3JhcHBlZEtleURhdGEuTGVuZ3RoICUgOCAhPSAwKSB8fCBOIDw9IDApDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IENyeXB0b2dyYXBoaWNFeGNlcHRpb24oU1IuQ3J5cHRvZ3JhcGh5X1htbF9LV19CYWRLZXlTaXplKTsNCg0KICAgICAgICAgICAgQWVzIGFlcyA9IG51bGw7DQogICAgICAgICAgICBJQ3J5cHRvVHJhbnNmb3JtIGVuYyA9IG51bGw7DQoNCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGFlcyA9IEFlcy5DcmVhdGUoKTsNCiAgICAgICAgICAgICAgICBhZXMuS2V5ID0gcmdiS2V5Ow0KICAgICAgICAgICAgICAgIC8vIFVzZSBFQ0IgbW9kZSwgbm8gcGFkZGluZw0KICAgICAgICAgICAgICAgIGFlcy5Nb2RlID0gQ2lwaGVyTW9kZS5FQ0I7DQogICAgICAgICAgICAgICAgYWVzLlBhZGRpbmcgPSBQYWRkaW5nTW9kZS5Ob25lOw0KICAgICAgICAgICAgICAgIGVuYyA9IGFlcy5DcmVhdGVFbmNyeXB0b3IoKTsNCiAgICAgICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2U6IG9ubHkgMSBibG9jayAtLSA4IGJ5dGVzDQogICAgICAgICAgICAgICAgaWYgKE4gPT0gMSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vIHRlbXAgPSAweGE2YTZhNmE2YTZhNmE2YTYgfCBQKDEpDQogICAgICAgICAgICAgICAgICAgIGJ5dGVbXSB0ZW1wID0gbmV3IGJ5dGVbc19yZ2JBRVNfS1dfSVYuTGVuZ3RoICsgcmdiV3JhcHBlZEtleURhdGEuTGVuZ3RoXTsNCiAgICAgICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weShzX3JnYkFFU19LV19JViwgMCwgdGVtcCwgMCwgc19yZ2JBRVNfS1dfSVYuTGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weShyZ2JXcmFwcGVkS2V5RGF0YSwgMCwgdGVtcCwgc19yZ2JBRVNfS1dfSVYuTGVuZ3RoLCByZ2JXcmFwcGVkS2V5RGF0YS5MZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW5jLlRyYW5zZm9ybUZpbmFsQmxvY2sodGVtcCwgMCwgdGVtcC5MZW5ndGgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvLyBzZWNvbmQgY2FzZTogbW9yZSB0aGFuIDEgYmxvY2sNCiAgICAgICAgICAgICAgICBsb25nIHQgPSAwOw0KICAgICAgICAgICAgICAgIGJ5dGVbXSByZ2JPdXRwdXQgPSBuZXcgYnl0ZVsoTiArIDEpIDw8IDNdOw0KICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgdGhlIFJfaSdzDQogICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weShyZ2JXcmFwcGVkS2V5RGF0YSwgMCwgcmdiT3V0cHV0LCA4LCByZ2JXcmFwcGVkS2V5RGF0YS5MZW5ndGgpOw0KICAgICAgICAgICAgICAgIGJ5dGVbXSByZ2JBID0gbmV3IGJ5dGVbOF07DQogICAgICAgICAgICAgICAgYnl0ZVtdIHJnYkJsb2NrID0gbmV3IGJ5dGVbMTZdOw0KICAgICAgICAgICAgICAgIEJ1ZmZlci5CbG9ja0NvcHkoc19yZ2JBRVNfS1dfSVYsIDAsIHJnYkEsIDAsIDgpOw0KICAgICAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDw9IDU7IGorKykNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IE47IGkrKykNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGkgKyBqICogTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIEJ1ZmZlci5CbG9ja0NvcHkocmdiQSwgMCwgcmdiQmxvY2ssIDAsIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weShyZ2JPdXRwdXQsIDggKiBpLCByZ2JCbG9jaywgOCwgOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBieXRlW10gcmdiQiA9IGVuYy5UcmFuc2Zvcm1GaW5hbEJsb2NrKHJnYkJsb2NrLCAwLCAxNik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBrID0gMDsgayA8IDg7IGsrKykNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlIHRtcCA9IChieXRlKSgodCA+PiAoOCAqICg3IC0gaykpKSAmIDB4RkYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJnYkFba10gPSAoYnl0ZSkodG1wIF4gcmdiQltrXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KHJnYkIsIDgsIHJnYk91dHB1dCwgOCAqIGksIDgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgZmlyc3QgYmxvY2sgb2YgcmdiT3V0cHV0IHRvIHJnYkENCiAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KHJnYkEsIDAsIHJnYk91dHB1dCwgMCwgOCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHJnYk91dHB1dDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZpbmFsbHkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBlbmM/LkRpc3Bvc2UoKTsNCiAgICAgICAgICAgICAgICBhZXM/LkRpc3Bvc2UoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBieXRlW10gQUVTS2V5V3JhcERlY3J5cHQoYnl0ZVtdIHJnYktleSwgYnl0ZVtdIHJnYkVuY3J5cHRlZFdyYXBwZWRLZXlEYXRhKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgTiA9IChyZ2JFbmNyeXB0ZWRXcmFwcGVkS2V5RGF0YS5MZW5ndGggPj4gMykgLSAxOw0KICAgICAgICAgICAgLy8gVGhlIGluZm9ybWF0aW9uIHdyYXBwZWQgbmVlZCBub3QgYWN0dWFsbHkgYmUgYSBrZXksIGJ1dCBpdCBuZWVkcyB0byBiZSBhIG11bHRpcGxlIG9mIDY0IGJpdHMNCiAgICAgICAgICAgIGlmICgocmdiRW5jcnlwdGVkV3JhcHBlZEtleURhdGEuTGVuZ3RoICUgOCAhPSAwKSB8fCBOIDw9IDApDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IENyeXB0b2dyYXBoaWNFeGNlcHRpb24oU1IuQ3J5cHRvZ3JhcGh5X1htbF9LV19CYWRLZXlTaXplKTsNCg0KICAgICAgICAgICAgYnl0ZVtdIHJnYk91dHB1dCA9IG5ldyBieXRlW04gPDwgM107DQogICAgICAgICAgICBBZXMgYWVzID0gbnVsbDsNCiAgICAgICAgICAgIElDcnlwdG9UcmFuc2Zvcm0gZGVjID0gbnVsbDsNCg0KICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYWVzID0gQWVzLkNyZWF0ZSgpOw0KICAgICAgICAgICAgICAgIGFlcy5LZXkgPSByZ2JLZXk7DQogICAgICAgICAgICAgICAgLy8gVXNlIEVDQiBtb2RlLCBubyBwYWRkaW5nDQogICAgICAgICAgICAgICAgYWVzLk1vZGUgPSBDaXBoZXJNb2RlLkVDQjsNCiAgICAgICAgICAgICAgICBhZXMuUGFkZGluZyA9IFBhZGRpbmdNb2RlLk5vbmU7DQogICAgICAgICAgICAgICAgZGVjID0gYWVzLkNyZWF0ZURlY3J5cHRvcigpOw0KDQogICAgICAgICAgICAgICAgLy8gc3BlY2lhbCBjYXNlOiBvbmx5IDEgYmxvY2sgLS0gOCBieXRlcw0KICAgICAgICAgICAgICAgIGlmIChOID09IDEpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBieXRlW10gdGVtcCA9IGRlYy5UcmFuc2Zvcm1GaW5hbEJsb2NrKHJnYkVuY3J5cHRlZFdyYXBwZWRLZXlEYXRhLCAwLCByZ2JFbmNyeXB0ZWRXcmFwcGVkS2V5RGF0YS5MZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAvLyBjaGVja3N1bSB0aGUga2V5DQogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGluZGV4ID0gMDsgaW5kZXggPCA4OyBpbmRleCsrKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXBbaW5kZXhdICE9IHNfcmdiQUVTX0tXX0lWW2luZGV4XSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ3J5cHRvZ3JhcGhpY0V4Y2VwdGlvbihTUi5DcnlwdG9ncmFwaHlfWG1sX0JhZFdyYXBwZWRLZXlTaXplKTsNCiAgICAgICAgICAgICAgICAgICAgLy8gcmdiT3V0cHV0IGlzIExTQih0ZW1wKQ0KICAgICAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KHRlbXAsIDgsIHJnYk91dHB1dCwgMCwgOCk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZ2JPdXRwdXQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIHNlY29uZCBjYXNlOiBtb3JlIHRoYW4gMSBibG9jaw0KICAgICAgICAgICAgICAgIGxvbmcgdCA9IDA7DQogICAgICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSB0aGUgQ19pJ3MNCiAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KHJnYkVuY3J5cHRlZFdyYXBwZWRLZXlEYXRhLCA4LCByZ2JPdXRwdXQsIDAsIHJnYk91dHB1dC5MZW5ndGgpOw0KICAgICAgICAgICAgICAgIGJ5dGVbXSByZ2JBID0gbmV3IGJ5dGVbOF07DQogICAgICAgICAgICAgICAgYnl0ZVtdIHJnYkJsb2NrID0gbmV3IGJ5dGVbMTZdOw0KICAgICAgICAgICAgICAgIEJ1ZmZlci5CbG9ja0NvcHkocmdiRW5jcnlwdGVkV3JhcHBlZEtleURhdGEsIDAsIHJnYkEsIDAsIDgpOw0KICAgICAgICAgICAgICAgIGZvciAoaW50IGogPSA1OyBqID49IDA7IGotLSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSBOOyBpID49IDE7IGktLSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGkgKyBqICogTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgODsgaysrKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGUgdG1wID0gKGJ5dGUpKCh0ID4+ICg4ICogKDcgLSBrKSkpICYgMHhGRik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmdiQVtrXSBePSB0bXA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBCdWZmZXIuQmxvY2tDb3B5KHJnYkEsIDAsIHJnYkJsb2NrLCAwLCA4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEJ1ZmZlci5CbG9ja0NvcHkocmdiT3V0cHV0LCA4ICogKGkgLSAxKSwgcmdiQmxvY2ssIDgsIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZVtdIHJnYkIgPSBkZWMuVHJhbnNmb3JtRmluYWxCbG9jayhyZ2JCbG9jaywgMCwgMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgQnVmZmVyLkJsb2NrQ29weShyZ2JCLCA4LCByZ2JPdXRwdXQsIDggKiAoaSAtIDEpLCA4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEJ1ZmZlci5CbG9ja0NvcHkocmdiQiwgMCwgcmdiQSwgMCwgOCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gY2hlY2tzdW0gdGhlIGtleQ0KICAgICAgICAgICAgICAgIGZvciAoaW50IGluZGV4ID0gMDsgaW5kZXggPCA4OyBpbmRleCsrKQ0KICAgICAgICAgICAgICAgICAgICBpZiAocmdiQVtpbmRleF0gIT0gc19yZ2JBRVNfS1dfSVZbaW5kZXhdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IENyeXB0b2dyYXBoaWNFeGNlcHRpb24oU1IuQ3J5cHRvZ3JhcGh5X1htbF9CYWRXcmFwcGVkS2V5U2l6ZSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHJnYk91dHB1dDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZpbmFsbHkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBkZWM/LkRpc3Bvc2UoKTsNCiAgICAgICAgICAgICAgICBhZXM/LkRpc3Bvc2UoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Xml/src/System/Security/Cryptography/Xml/Utils.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIE1pY3Jvc29mdC5XaW4zMjsNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9uczsNCnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljczsNCnVzaW5nIFN5c3RlbS5HbG9iYWxpemF0aW9uOw0KdXNpbmcgU3lzdGVtLklPOw0KdXNpbmcgU3lzdGVtLlNlY3VyaXR5Ow0KdXNpbmcgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeTsNCnVzaW5nIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuWDUwOUNlcnRpZmljYXRlczsNCnVzaW5nIFN5c3RlbS5TZWN1cml0eS5QZXJtaXNzaW9uczsNCnVzaW5nIFN5c3RlbS5UZXh0Ow0KdXNpbmcgU3lzdGVtLlRocmVhZGluZzsNCnVzaW5nIFN5c3RlbS5YbWw7DQoNCm5hbWVzcGFjZSBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlhtbA0Kew0KICAgIGludGVybmFsIGNsYXNzIFV0aWxzDQogICAgew0KICAgICAgICAvLyBUaGUgbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyBpbiBhbiBYTUwgZG9jdW1lbnQgKDAgbWVhbnMgbm8gbGltaXQpLg0KICAgICAgICBpbnRlcm5hbCBjb25zdCBpbnQgTWF4Q2hhcmFjdGVyc0luRG9jdW1lbnQgPSAwOw0KDQogICAgICAgIC8vIFRoZSBlbnRpdHkgZXhwYW5zaW9uIGxpbWl0LiBUaGlzIGlzIHVzZWQgdG8gcHJldmVudCBlbnRpdHkgZXhwYW5zaW9uIGRlbmlhbCBvZiBzZXJ2aWNlIGF0dGFja3MuDQogICAgICAgIGludGVybmFsIGNvbnN0IGxvbmcgTWF4Q2hhcmFjdGVyc0Zyb21FbnRpdGllcyA9IChsb25nKTFlNzsNCg0KICAgICAgICAvLyBUaGUgZGVmYXVsdCBYTUwgRHNpZyByZWN1cnNpb24gbGltaXQuDQogICAgICAgIC8vIFRoaXMgc2hvdWxkIGJlIHdpdGhpbiBsaW1pdHMgb2YgcmVhbCB3b3JsZCBzY2VuYXJpb3MuDQogICAgICAgIC8vIEtlZXBpbmcgdGhpcyBudW1iZXIgbG93IHdpbGwgcHJlc2VydmUgc29tZSBzdGFjayBzcGFjZQ0KICAgICAgICBpbnRlcm5hbCBjb25zdCBpbnQgWG1sRHNpZ1NlYXJjaERlcHRoID0gMjA7DQoNCiAgICAgICAgcHJpdmF0ZSBVdGlscygpIHsgfQ0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIGJvb2wgSGFzTmFtZXNwYWNlKFhtbEVsZW1lbnQgZWxlbWVudCwgc3RyaW5nIHByZWZpeCwgc3RyaW5nIHZhbHVlKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoSXNDb21taXR0ZWROYW1lc3BhY2UoZWxlbWVudCwgcHJlZml4LCB2YWx1ZSkpIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgaWYgKGVsZW1lbnQuUHJlZml4ID09IHByZWZpeCAmJiBlbGVtZW50Lk5hbWVzcGFjZVVSSSA9PSB2YWx1ZSkgcmV0dXJuIHRydWU7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBBIGhlbHBlciBmdW5jdGlvbiB0aGF0IGRldGVybWluZXMgaWYgYSBuYW1lc3BhY2Ugbm9kZSBpcyBhIGNvbW1pdHRlZCBhdHRyaWJ1dGUNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIGJvb2wgSXNDb21taXR0ZWROYW1lc3BhY2UoWG1sRWxlbWVudCBlbGVtZW50LCBzdHJpbmcgcHJlZml4LCBzdHJpbmcgdmFsdWUpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChlbGVtZW50ID09IG51bGwpDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEV4Y2VwdGlvbihuYW1lb2YoZWxlbWVudCkpOw0KDQogICAgICAgICAgICBzdHJpbmcgbmFtZSA9ICgocHJlZml4Lkxlbmd0aCA+IDApID8gInhtbG5zOiIgKyBwcmVmaXggOiAieG1sbnMiKTsNCiAgICAgICAgICAgIGlmIChlbGVtZW50Lkhhc0F0dHJpYnV0ZShuYW1lKSAmJiBlbGVtZW50LkdldEF0dHJpYnV0ZShuYW1lKSA9PSB2YWx1ZSkgcmV0dXJuIHRydWU7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgYm9vbCBJc1JlZHVuZGFudE5hbWVzcGFjZShYbWxFbGVtZW50IGVsZW1lbnQsIHN0cmluZyBwcmVmaXgsIHN0cmluZyB2YWx1ZSkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKGVsZW1lbnQgPT0gbnVsbCkNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXhjZXB0aW9uKG5hbWVvZihlbGVtZW50KSk7DQoNCiAgICAgICAgICAgIFhtbE5vZGUgYW5jZXN0b3JOb2RlID0gKChYbWxOb2RlKWVsZW1lbnQpLlBhcmVudE5vZGU7DQogICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3JOb2RlICE9IG51bGwpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgWG1sRWxlbWVudCBhbmNlc3RvckVsZW1lbnQgPSBhbmNlc3Rvck5vZGUgYXMgWG1sRWxlbWVudDsNCiAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JFbGVtZW50ICE9IG51bGwpDQogICAgICAgICAgICAgICAgICAgIGlmIChIYXNOYW1lc3BhY2UoYW5jZXN0b3JFbGVtZW50LCBwcmVmaXgsIHZhbHVlKSkgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgYW5jZXN0b3JOb2RlID0gYW5jZXN0b3JOb2RlLlBhcmVudE5vZGU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBzdHJpbmcgR2V0QXR0cmlidXRlKFhtbEVsZW1lbnQgZWxlbWVudCwgc3RyaW5nIGxvY2FsTmFtZSwgc3RyaW5nIG5hbWVzcGFjZVVSSSkNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIHMgPSAoZWxlbWVudC5IYXNBdHRyaWJ1dGUobG9jYWxOYW1lKSA/IGVsZW1lbnQuR2V0QXR0cmlidXRlKGxvY2FsTmFtZSkgOiBudWxsKTsNCiAgICAgICAgICAgIGlmIChzID09IG51bGwgJiYgZWxlbWVudC5IYXNBdHRyaWJ1dGUobG9jYWxOYW1lLCBuYW1lc3BhY2VVUkkpKQ0KICAgICAgICAgICAgICAgIHMgPSBlbGVtZW50LkdldEF0dHJpYnV0ZShsb2NhbE5hbWUsIG5hbWVzcGFjZVVSSSk7DQogICAgICAgICAgICByZXR1cm4gczsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBib29sIEhhc0F0dHJpYnV0ZShYbWxFbGVtZW50IGVsZW1lbnQsIHN0cmluZyBsb2NhbE5hbWUsIHN0cmluZyBuYW1lc3BhY2VVUkkpDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBlbGVtZW50Lkhhc0F0dHJpYnV0ZShsb2NhbE5hbWUpIHx8IGVsZW1lbnQuSGFzQXR0cmlidXRlKGxvY2FsTmFtZSwgbmFtZXNwYWNlVVJJKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBib29sIElzTmFtZXNwYWNlTm9kZShYbWxOb2RlIG4pDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBuLk5vZGVUeXBlID09IFhtbE5vZGVUeXBlLkF0dHJpYnV0ZSAmJiAobi5QcmVmaXguRXF1YWxzKCJ4bWxucyIpIHx8IChuLlByZWZpeC5MZW5ndGggPT0gMCAmJiBuLkxvY2FsTmFtZS5FcXVhbHMoInhtbG5zIikpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBib29sIElzWG1sTmFtZXNwYWNlTm9kZShYbWxOb2RlIG4pDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBuLk5vZGVUeXBlID09IFhtbE5vZGVUeXBlLkF0dHJpYnV0ZSAmJiBuLlByZWZpeC5FcXVhbHMoInhtbCIpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gV2UgY29uc2lkZXIgeG1sOnNwYWNlIHN0eWxlIGF0dHJpYnV0ZXMgYXMgZGVmYXVsdCBuYW1lc3BhY2Ugbm9kZXMgc2luY2UgdGhleSBvYmV5IHRoZSBzYW1lIHByb3BhZ2F0aW9uIHJ1bGVzDQogICAgICAgIGludGVybmFsIHN0YXRpYyBib29sIElzRGVmYXVsdE5hbWVzcGFjZU5vZGUoWG1sTm9kZSBuKQ0KICAgICAgICB7DQogICAgICAgICAgICBib29sIGIxID0gbi5Ob2RlVHlwZSA9PSBYbWxOb2RlVHlwZS5BdHRyaWJ1dGUgJiYgbi5QcmVmaXguTGVuZ3RoID09IDAgJiYgbi5Mb2NhbE5hbWUuRXF1YWxzKCJ4bWxucyIpOw0KICAgICAgICAgICAgYm9vbCBiMiA9IElzWG1sTmFtZXNwYWNlTm9kZShuKTsNCiAgICAgICAgICAgIHJldHVybiBiMSB8fCBiMjsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBib29sIElzRW1wdHlEZWZhdWx0TmFtZXNwYWNlTm9kZShYbWxOb2RlIG4pDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBJc0RlZmF1bHROYW1lc3BhY2VOb2RlKG4pICYmIG4uVmFsdWUuTGVuZ3RoID09IDA7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgc3RyaW5nIEdldE5hbWVzcGFjZVByZWZpeChYbWxBdHRyaWJ1dGUgYSkNCiAgICAgICAgew0KICAgICAgICAgICAgRGVidWcuQXNzZXJ0KElzTmFtZXNwYWNlTm9kZShhKSB8fCBJc1htbE5hbWVzcGFjZU5vZGUoYSkpOw0KICAgICAgICAgICAgcmV0dXJuIGEuUHJlZml4Lkxlbmd0aCA9PSAwID8gc3RyaW5nLkVtcHR5IDogYS5Mb2NhbE5hbWU7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgYm9vbCBIYXNOYW1lc3BhY2VQcmVmaXgoWG1sQXR0cmlidXRlIGEsIHN0cmluZyBuc1ByZWZpeCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIEdldE5hbWVzcGFjZVByZWZpeChhKS5FcXVhbHMobnNQcmVmaXgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIGJvb2wgSXNOb25SZWR1bmRhbnROYW1lc3BhY2VEZWNsKFhtbEF0dHJpYnV0ZSBhLCBYbWxBdHRyaWJ1dGUgbmVhcmVzdEFuY2VzdG9yV2l0aFNhbWVQcmVmaXgpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChuZWFyZXN0QW5jZXN0b3JXaXRoU2FtZVByZWZpeCA9PSBudWxsKQ0KICAgICAgICAgICAgICAgIHJldHVybiAhSXNFbXB0eURlZmF1bHROYW1lc3BhY2VOb2RlKGEpOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHJldHVybiAhbmVhcmVzdEFuY2VzdG9yV2l0aFNhbWVQcmVmaXguVmFsdWUuRXF1YWxzKGEuVmFsdWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIGJvb2wgSXNYbWxQcmVmaXhEZWZpbml0aW9uTm9kZShYbWxBdHRyaWJ1dGUgYSkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgLy8gICAgICAgICAgICByZXR1cm4gYS5QcmVmaXguRXF1YWxzKCJ4bWxucyIpICYmIGEuTG9jYWxOYW1lLkVxdWFscygieG1sIikgJiYgYS5WYWx1ZS5FcXVhbHMoTmFtZXNwYWNlVXJsRm9yWG1sUHJlZml4KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBzdHJpbmcgRGlzY2FyZFdoaXRlU3BhY2VzKHN0cmluZyBpbnB1dEJ1ZmZlcikNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIERpc2NhcmRXaGl0ZVNwYWNlcyhpbnB1dEJ1ZmZlciwgMCwgaW5wdXRCdWZmZXIuTGVuZ3RoKTsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHN0cmluZyBEaXNjYXJkV2hpdGVTcGFjZXMoc3RyaW5nIGlucHV0QnVmZmVyLCBpbnQgaW5wdXRPZmZzZXQsIGludCBpbnB1dENvdW50KQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgaSwgaUNvdW50ID0gMDsNCiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBpbnB1dENvdW50OyBpKyspDQogICAgICAgICAgICAgICAgaWYgKENoYXIuSXNXaGl0ZVNwYWNlKGlucHV0QnVmZmVyW2lucHV0T2Zmc2V0ICsgaV0pKSBpQ291bnQrKzsNCiAgICAgICAgICAgIGNoYXJbXSByZ2JPdXQgPSBuZXcgY2hhcltpbnB1dENvdW50IC0gaUNvdW50XTsNCiAgICAgICAgICAgIGlDb3VudCA9IDA7DQogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaW5wdXRDb3VudDsgaSsrKQ0KICAgICAgICAgICAgICAgIGlmICghQ2hhci5Jc1doaXRlU3BhY2UoaW5wdXRCdWZmZXJbaW5wdXRPZmZzZXQgKyBpXSkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICByZ2JPdXRbaUNvdW50KytdID0gaW5wdXRCdWZmZXJbaW5wdXRPZmZzZXQgKyBpXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbmV3IHN0cmluZyhyZ2JPdXQpOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHZvaWQgU0JSZXBsYWNlQ2hhcldpdGhTdHJpbmcoU3RyaW5nQnVpbGRlciBzYiwgY2hhciBvbGRDaGFyLCBzdHJpbmcgbmV3U3RyaW5nKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgaSA9IDA7DQogICAgICAgICAgICBpbnQgbmV3U3RyaW5nTGVuZ3RoID0gbmV3U3RyaW5nLkxlbmd0aDsNCiAgICAgICAgICAgIHdoaWxlIChpIDwgc2IuTGVuZ3RoKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChzYltpXSA9PSBvbGRDaGFyKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgc2IuUmVtb3ZlKGksIDEpOw0KICAgICAgICAgICAgICAgICAgICBzYi5JbnNlcnQoaSwgbmV3U3RyaW5nKTsNCiAgICAgICAgICAgICAgICAgICAgaSArPSBuZXdTdHJpbmdMZW5ndGg7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UgaSsrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIFhtbFJlYWRlciBQcmVQcm9jZXNzU3RyZWFtSW5wdXQoU3RyZWFtIGlucHV0U3RyZWFtLCBYbWxSZXNvbHZlciB4bWxSZXNvbHZlciwgc3RyaW5nIGJhc2VVcmkpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbFJlYWRlclNldHRpbmdzIHNldHRpbmdzID0gR2V0U2VjdXJlWG1sUmVhZGVyU2V0dGluZ3MoeG1sUmVzb2x2ZXIpOw0KICAgICAgICAgICAgWG1sUmVhZGVyIHJlYWRlciA9IFhtbFJlYWRlci5DcmVhdGUoaW5wdXRTdHJlYW0sIHNldHRpbmdzLCBiYXNlVXJpKTsNCiAgICAgICAgICAgIHJldHVybiByZWFkZXI7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgWG1sUmVhZGVyU2V0dGluZ3MgR2V0U2VjdXJlWG1sUmVhZGVyU2V0dGluZ3MoWG1sUmVzb2x2ZXIgeG1sUmVzb2x2ZXIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbFJlYWRlclNldHRpbmdzIHNldHRpbmdzID0gbmV3IFhtbFJlYWRlclNldHRpbmdzKCk7DQogICAgICAgICAgICBzZXR0aW5ncy5YbWxSZXNvbHZlciA9IHhtbFJlc29sdmVyOw0KICAgICAgICAgICAgc2V0dGluZ3MuRHRkUHJvY2Vzc2luZyA9IER0ZFByb2Nlc3NpbmcuUGFyc2U7DQogICAgICAgICAgICBzZXR0aW5ncy5NYXhDaGFyYWN0ZXJzRnJvbUVudGl0aWVzID0gTWF4Q2hhcmFjdGVyc0Zyb21FbnRpdGllczsNCiAgICAgICAgICAgIHNldHRpbmdzLk1heENoYXJhY3RlcnNJbkRvY3VtZW50ID0gTWF4Q2hhcmFjdGVyc0luRG9jdW1lbnQ7DQogICAgICAgICAgICByZXR1cm4gc2V0dGluZ3M7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgWG1sRG9jdW1lbnQgUHJlUHJvY2Vzc0RvY3VtZW50SW5wdXQoWG1sRG9jdW1lbnQgZG9jdW1lbnQsIFhtbFJlc29sdmVyIHhtbFJlc29sdmVyLCBzdHJpbmcgYmFzZVVyaSkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKGRvY3VtZW50ID09IG51bGwpDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEV4Y2VwdGlvbihuYW1lb2YoZG9jdW1lbnQpKTsNCg0KICAgICAgICAgICAgTXlYbWxEb2N1bWVudCBkb2MgPSBuZXcgTXlYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLlByZXNlcnZlV2hpdGVzcGFjZSA9IGRvY3VtZW50LlByZXNlcnZlV2hpdGVzcGFjZTsNCg0KICAgICAgICAgICAgLy8gTm9ybWFsaXplIHRoZSBkb2N1bWVudA0KICAgICAgICAgICAgdXNpbmcgKFRleHRSZWFkZXIgc3RyaW5nUmVhZGVyID0gbmV3IFN0cmluZ1JlYWRlcihkb2N1bWVudC5PdXRlclhtbCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgWG1sUmVhZGVyU2V0dGluZ3Mgc2V0dGluZ3MgPSBuZXcgWG1sUmVhZGVyU2V0dGluZ3MoKTsNCiAgICAgICAgICAgICAgICBzZXR0aW5ncy5YbWxSZXNvbHZlciA9IHhtbFJlc29sdmVyOw0KICAgICAgICAgICAgICAgIHNldHRpbmdzLkR0ZFByb2Nlc3NpbmcgPSBEdGRQcm9jZXNzaW5nLlBhcnNlOw0KICAgICAgICAgICAgICAgIHNldHRpbmdzLk1heENoYXJhY3RlcnNGcm9tRW50aXRpZXMgPSBNYXhDaGFyYWN0ZXJzRnJvbUVudGl0aWVzOw0KICAgICAgICAgICAgICAgIHNldHRpbmdzLk1heENoYXJhY3RlcnNJbkRvY3VtZW50ID0gTWF4Q2hhcmFjdGVyc0luRG9jdW1lbnQ7DQogICAgICAgICAgICAgICAgWG1sUmVhZGVyIHJlYWRlciA9IFhtbFJlYWRlci5DcmVhdGUoc3RyaW5nUmVhZGVyLCBzZXR0aW5ncywgYmFzZVVyaSk7DQogICAgICAgICAgICAgICAgZG9jLkxvYWQocmVhZGVyKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBkb2M7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgWG1sRG9jdW1lbnQgUHJlUHJvY2Vzc0VsZW1lbnRJbnB1dChYbWxFbGVtZW50IGVsZW0sIFhtbFJlc29sdmVyIHhtbFJlc29sdmVyLCBzdHJpbmcgYmFzZVVyaSkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKGVsZW0gPT0gbnVsbCkNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXhjZXB0aW9uKG5hbWVvZihlbGVtKSk7DQoNCiAgICAgICAgICAgIE15WG1sRG9jdW1lbnQgZG9jID0gbmV3IE15WG1sRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIGRvYy5QcmVzZXJ2ZVdoaXRlc3BhY2UgPSB0cnVlOw0KICAgICAgICAgICAgLy8gTm9ybWFsaXplIHRoZSBkb2N1bWVudA0KICAgICAgICAgICAgdXNpbmcgKFRleHRSZWFkZXIgc3RyaW5nUmVhZGVyID0gbmV3IFN0cmluZ1JlYWRlcihlbGVtLk91dGVyWG1sKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBYbWxSZWFkZXJTZXR0aW5ncyBzZXR0aW5ncyA9IG5ldyBYbWxSZWFkZXJTZXR0aW5ncygpOw0KICAgICAgICAgICAgICAgIHNldHRpbmdzLlhtbFJlc29sdmVyID0geG1sUmVzb2x2ZXI7DQogICAgICAgICAgICAgICAgc2V0dGluZ3MuRHRkUHJvY2Vzc2luZyA9IER0ZFByb2Nlc3NpbmcuUGFyc2U7DQogICAgICAgICAgICAgICAgc2V0dGluZ3MuTWF4Q2hhcmFjdGVyc0Zyb21FbnRpdGllcyA9IE1heENoYXJhY3RlcnNGcm9tRW50aXRpZXM7DQogICAgICAgICAgICAgICAgc2V0dGluZ3MuTWF4Q2hhcmFjdGVyc0luRG9jdW1lbnQgPSBNYXhDaGFyYWN0ZXJzSW5Eb2N1bWVudDsNCiAgICAgICAgICAgICAgICBYbWxSZWFkZXIgcmVhZGVyID0gWG1sUmVhZGVyLkNyZWF0ZShzdHJpbmdSZWFkZXIsIHNldHRpbmdzLCBiYXNlVXJpKTsNCiAgICAgICAgICAgICAgICBkb2MuTG9hZChyZWFkZXIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGRvYzsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBYbWxEb2N1bWVudCBEaXNjYXJkQ29tbWVudHMoWG1sRG9jdW1lbnQgZG9jdW1lbnQpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbE5vZGVMaXN0IG5vZGVMaXN0ID0gZG9jdW1lbnQuU2VsZWN0Tm9kZXMoIi8vY29tbWVudCgpIik7DQogICAgICAgICAgICBpZiAobm9kZUxpc3QgIT0gbnVsbCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoIChYbWxOb2RlIG5vZGUxIGluIG5vZGVMaXN0KQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgbm9kZTEuUGFyZW50Tm9kZS5SZW1vdmVDaGlsZChub2RlMSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50Ow0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIFhtbE5vZGVMaXN0IEFsbERlc2NlbmRhbnROb2RlcyhYbWxOb2RlIG5vZGUsIGJvb2wgaW5jbHVkZUNvbW1lbnRzKQ0KICAgICAgICB7DQogICAgICAgICAgICBDYW5vbmljYWxYbWxOb2RlTGlzdCBub2RlTGlzdCA9IG5ldyBDYW5vbmljYWxYbWxOb2RlTGlzdCgpOw0KICAgICAgICAgICAgQ2Fub25pY2FsWG1sTm9kZUxpc3QgZWxlbWVudExpc3QgPSBuZXcgQ2Fub25pY2FsWG1sTm9kZUxpc3QoKTsNCiAgICAgICAgICAgIENhbm9uaWNhbFhtbE5vZGVMaXN0IGF0dHJpYkxpc3QgPSBuZXcgQ2Fub25pY2FsWG1sTm9kZUxpc3QoKTsNCiAgICAgICAgICAgIENhbm9uaWNhbFhtbE5vZGVMaXN0IG5hbWVzcGFjZUxpc3QgPSBuZXcgQ2Fub25pY2FsWG1sTm9kZUxpc3QoKTsNCg0KICAgICAgICAgICAgaW50IGluZGV4ID0gMDsNCiAgICAgICAgICAgIGVsZW1lbnRMaXN0LkFkZChub2RlKTsNCg0KICAgICAgICAgICAgZG8NCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBYbWxOb2RlIHJvb3ROb2RlID0gKFhtbE5vZGUpZWxlbWVudExpc3RbaW5kZXhdOw0KICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgY2hpbGRyZW4gbm9kZXMNCiAgICAgICAgICAgICAgICBYbWxOb2RlTGlzdCBjaGlsZE5vZGVzID0gcm9vdE5vZGUuQ2hpbGROb2RlczsNCiAgICAgICAgICAgICAgICBpZiAoY2hpbGROb2RlcyAhPSBudWxsKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoWG1sTm9kZSBub2RlMSBpbiBjaGlsZE5vZGVzKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZUNvbW1lbnRzIHx8ICghKG5vZGUxIGlzIFhtbENvbW1lbnQpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50TGlzdC5BZGQobm9kZTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgYXR0cmlidXRlIG5vZGVzDQogICAgICAgICAgICAgICAgWG1sQXR0cmlidXRlQ29sbGVjdGlvbiBhdHRyaWJOb2RlcyA9IHJvb3ROb2RlLkF0dHJpYnV0ZXM7DQogICAgICAgICAgICAgICAgaWYgKGF0dHJpYk5vZGVzICE9IG51bGwpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChYbWxOb2RlIGF0dHJpYk5vZGUgaW4gcm9vdE5vZGUuQXR0cmlidXRlcykNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYk5vZGUuTG9jYWxOYW1lID09ICJ4bWxucyIgfHwgYXR0cmliTm9kZS5QcmVmaXggPT0gInhtbG5zIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lc3BhY2VMaXN0LkFkZChhdHRyaWJOb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJMaXN0LkFkZChhdHRyaWJOb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpbmRleCsrOw0KICAgICAgICAgICAgfSB3aGlsZSAoaW5kZXggPCBlbGVtZW50TGlzdC5Db3VudCk7DQogICAgICAgICAgICBmb3JlYWNoIChYbWxOb2RlIGVsZW1lbnROb2RlIGluIGVsZW1lbnRMaXN0KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIG5vZGVMaXN0LkFkZChlbGVtZW50Tm9kZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmb3JlYWNoIChYbWxOb2RlIGF0dHJpYk5vZGUgaW4gYXR0cmliTGlzdCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBub2RlTGlzdC5BZGQoYXR0cmliTm9kZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmb3JlYWNoIChYbWxOb2RlIG5hbWVzcGFjZU5vZGUgaW4gbmFtZXNwYWNlTGlzdCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBub2RlTGlzdC5BZGQobmFtZXNwYWNlTm9kZSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBub2RlTGlzdDsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBib29sIE5vZGVJbkxpc3QoWG1sTm9kZSBub2RlLCBYbWxOb2RlTGlzdCBub2RlTGlzdCkNCiAgICAgICAgew0KICAgICAgICAgICAgZm9yZWFjaCAoWG1sTm9kZSBub2RlRWxlbSBpbiBub2RlTGlzdCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW0gPT0gbm9kZSkgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgc3RyaW5nIEdldElkRnJvbUxvY2FsVXJpKHN0cmluZyB1cmksIG91dCBib29sIGRpc2NhcmRDb21tZW50cykNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIGlkcmVmID0gdXJpLlN1YnN0cmluZygxKTsNCiAgICAgICAgICAgIC8vIGluaXRpYWxpemUgdGhlIHJldHVybiB2YWx1ZQ0KICAgICAgICAgICAgZGlzY2FyZENvbW1lbnRzID0gdHJ1ZTsNCg0KICAgICAgICAgICAgLy8gRGVhbCB3aXRoIFhQb2ludGVyIG9mIHR5cGUgI3hwb2ludGVyKGlkKCJJRCIpKS4gT3RoZXIgWFBvaW50ZXIgc3VwcG9ydCBpc24ndCBoYW5kbGVkIGhlcmUgYW5kIGlzIGFueXdheSBvcHRpb25hbA0KICAgICAgICAgICAgaWYgKGlkcmVmLlN0YXJ0c1dpdGgoInhwb2ludGVyKGlkKCIsIFN0cmluZ0NvbXBhcmlzb24uT3JkaW5hbCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaW50IHN0YXJ0SWQgPSBpZHJlZi5JbmRleE9mKCJpZCgiLCBTdHJpbmdDb21wYXJpc29uLk9yZGluYWwpOw0KICAgICAgICAgICAgICAgIGludCBlbmRJZCA9IGlkcmVmLkluZGV4T2YoIikiLCBTdHJpbmdDb21wYXJpc29uLk9yZGluYWwpOw0KICAgICAgICAgICAgICAgIGlmIChlbmRJZCA8IDAgfHwgZW5kSWQgPCBzdGFydElkICsgMykNCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IENyeXB0b2dyYXBoaWNFeGNlcHRpb24oU1IuQ3J5cHRvZ3JhcGh5X1htbF9JbnZhbGlkUmVmZXJlbmNlKTsNCiAgICAgICAgICAgICAgICBpZHJlZiA9IGlkcmVmLlN1YnN0cmluZyhzdGFydElkICsgMywgZW5kSWQgLSBzdGFydElkIC0gMyk7DQogICAgICAgICAgICAgICAgaWRyZWYgPSBpZHJlZi5SZXBsYWNlKCJcJyIsICIiKTsNCiAgICAgICAgICAgICAgICBpZHJlZiA9IGlkcmVmLlJlcGxhY2UoIlwiIiwgIiIpOw0KICAgICAgICAgICAgICAgIGRpc2NhcmRDb21tZW50cyA9IGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGlkcmVmOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHN0cmluZyBFeHRyYWN0SWRGcm9tTG9jYWxVcmkoc3RyaW5nIHVyaSkNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIGlkcmVmID0gdXJpLlN1YnN0cmluZygxKTsNCg0KICAgICAgICAgICAgLy8gRGVhbCB3aXRoIFhQb2ludGVyIG9mIHR5cGUgI3hwb2ludGVyKGlkKCJJRCIpKS4gT3RoZXIgWFBvaW50ZXIgc3VwcG9ydCBpc24ndCBoYW5kbGVkIGhlcmUgYW5kIGlzIGFueXdheSBvcHRpb25hbA0KICAgICAgICAgICAgaWYgKGlkcmVmLlN0YXJ0c1dpdGgoInhwb2ludGVyKGlkKCIsIFN0cmluZ0NvbXBhcmlzb24uT3JkaW5hbCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaW50IHN0YXJ0SWQgPSBpZHJlZi5JbmRleE9mKCJpZCgiLCBTdHJpbmdDb21wYXJpc29uLk9yZGluYWwpOw0KICAgICAgICAgICAgICAgIGludCBlbmRJZCA9IGlkcmVmLkluZGV4T2YoIikiLCBTdHJpbmdDb21wYXJpc29uLk9yZGluYWwpOw0KICAgICAgICAgICAgICAgIGlmIChlbmRJZCA8IDAgfHwgZW5kSWQgPCBzdGFydElkICsgMykNCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IENyeXB0b2dyYXBoaWNFeGNlcHRpb24oU1IuQ3J5cHRvZ3JhcGh5X1htbF9JbnZhbGlkUmVmZXJlbmNlKTsNCiAgICAgICAgICAgICAgICBpZHJlZiA9IGlkcmVmLlN1YnN0cmluZyhzdGFydElkICsgMywgZW5kSWQgLSBzdGFydElkIC0gMyk7DQogICAgICAgICAgICAgICAgaWRyZWYgPSBpZHJlZi5SZXBsYWNlKCJcJyIsICIiKTsNCiAgICAgICAgICAgICAgICBpZHJlZiA9IGlkcmVmLlJlcGxhY2UoIlwiIiwgIiIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGlkcmVmOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gVGhpcyByZW1vdmVzIGFsbCBjaGlsZHJlbiBvZiBhbiBlbGVtZW50Lg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgdm9pZCBSZW1vdmVBbGxDaGlsZHJlbihYbWxFbGVtZW50IGlucHV0RWxlbWVudCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sTm9kZSBjaGlsZCA9IGlucHV0RWxlbWVudC5GaXJzdENoaWxkOw0KICAgICAgICAgICAgWG1sTm9kZSBzaWJsaW5nID0gbnVsbDsNCg0KICAgICAgICAgICAgd2hpbGUgKGNoaWxkICE9IG51bGwpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc2libGluZyA9IGNoaWxkLk5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgIGlucHV0RWxlbWVudC5SZW1vdmVDaGlsZChjaGlsZCk7DQogICAgICAgICAgICAgICAgY2hpbGQgPSBzaWJsaW5nOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gV3JpdGVzIG9uZSBzdHJlYW0gKHN0YXJ0aW5nIGZyb20gdGhlIGN1cnJlbnQgcG9zaXRpb24pIGludG8NCiAgICAgICAgLy8gYW4gb3V0cHV0IHN0cmVhbSwgY29ubmVjdGluZyB0aGVtIHVwIGFuZCByZWFkaW5nIHVudGlsDQogICAgICAgIC8vIGhpdHRpbmcgdGhlIGVuZCBvZiB0aGUgaW5wdXQgc3RyZWFtLg0KICAgICAgICAvLyByZXR1cm5zIHRoZSBudW1iZXIgb2YgYnl0ZXMgY29waWVkDQogICAgICAgIGludGVybmFsIHN0YXRpYyBsb25nIFB1bXAoU3RyZWFtIGlucHV0LCBTdHJlYW0gb3V0cHV0KQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBVc2UgTWVtb3J5U3RyZWFtJ3MgV3JpdGVUbyhTdHJlYW0pIG1ldGhvZCBpZiBwb3NzaWJsZQ0KICAgICAgICAgICAgTWVtb3J5U3RyZWFtIGlucHV0TVMgPSBpbnB1dCBhcyBNZW1vcnlTdHJlYW07DQogICAgICAgICAgICBpZiAoaW5wdXRNUyAhPSBudWxsICYmIGlucHV0TVMuUG9zaXRpb24gPT0gMCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpbnB1dE1TLldyaXRlVG8ob3V0cHV0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXRNUy5MZW5ndGg7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGNvbnN0IGludCBjb3VudCA9IDQwOTY7DQogICAgICAgICAgICBieXRlW10gYnl0ZXMgPSBuZXcgYnl0ZVtjb3VudF07DQogICAgICAgICAgICBpbnQgbnVtQnl0ZXM7DQogICAgICAgICAgICBsb25nIHRvdGFsQnl0ZXMgPSAwOw0KDQogICAgICAgICAgICB3aGlsZSAoKG51bUJ5dGVzID0gaW5wdXQuUmVhZChieXRlcywgMCwgY291bnQpKSA+IDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgb3V0cHV0LldyaXRlKGJ5dGVzLCAwLCBudW1CeXRlcyk7DQogICAgICAgICAgICAgICAgdG90YWxCeXRlcyArPSBudW1CeXRlczsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHRvdGFsQnl0ZXM7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgSGFzaHRhYmxlIFRva2VuaXplUHJlZml4TGlzdFN0cmluZyhzdHJpbmcgcykNCiAgICAgICAgew0KICAgICAgICAgICAgSGFzaHRhYmxlIHNldCA9IG5ldyBIYXNodGFibGUoKTsNCiAgICAgICAgICAgIGlmIChzICE9IG51bGwpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc3RyaW5nW10gcHJlZml4ZXMgPSBzLlNwbGl0KG51bGwpOw0KICAgICAgICAgICAgICAgIGZvcmVhY2ggKHN0cmluZyBwcmVmaXggaW4gcHJlZml4ZXMpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZiAocHJlZml4LkVxdWFscygiI2RlZmF1bHQiKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2V0LkFkZChzdHJpbmcuRW1wdHksIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHByZWZpeC5MZW5ndGggPiAwKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZXQuQWRkKHByZWZpeCwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gc2V0Ow0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHN0cmluZyBFc2NhcGVXaGl0ZXNwYWNlRGF0YShzdHJpbmcgZGF0YSkNCiAgICAgICAgew0KICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7DQogICAgICAgICAgICBzYi5BcHBlbmQoZGF0YSk7DQogICAgICAgICAgICBVdGlscy5TQlJlcGxhY2VDaGFyV2l0aFN0cmluZyhzYiwgKGNoYXIpMTMsICImI3hEOyIpOw0KICAgICAgICAgICAgcmV0dXJuIHNiLlRvU3RyaW5nKCk7IDsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBzdHJpbmcgRXNjYXBlVGV4dERhdGEoc3RyaW5nIGRhdGEpDQogICAgICAgIHsNCiAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOw0KICAgICAgICAgICAgc2IuQXBwZW5kKGRhdGEpOw0KICAgICAgICAgICAgc2IuUmVwbGFjZSgiJiIsICImYW1wOyIpOw0KICAgICAgICAgICAgc2IuUmVwbGFjZSgiPCIsICImbHQ7Iik7DQogICAgICAgICAgICBzYi5SZXBsYWNlKCI+IiwgIiZndDsiKTsNCiAgICAgICAgICAgIFNCUmVwbGFjZUNoYXJXaXRoU3RyaW5nKHNiLCAoY2hhcikxMywgIiYjeEQ7Iik7DQogICAgICAgICAgICByZXR1cm4gc2IuVG9TdHJpbmcoKTsgOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHN0cmluZyBFc2NhcGVDRGF0YShzdHJpbmcgZGF0YSkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIEVzY2FwZVRleHREYXRhKGRhdGEpOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHN0cmluZyBFc2NhcGVBdHRyaWJ1dGVWYWx1ZShzdHJpbmcgdmFsdWUpDQogICAgICAgIHsNCiAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOw0KICAgICAgICAgICAgc2IuQXBwZW5kKHZhbHVlKTsNCiAgICAgICAgICAgIHNiLlJlcGxhY2UoIiYiLCAiJmFtcDsiKTsNCiAgICAgICAgICAgIHNiLlJlcGxhY2UoIjwiLCAiJmx0OyIpOw0KICAgICAgICAgICAgc2IuUmVwbGFjZSgiXCIiLCAiJnF1b3Q7Iik7DQogICAgICAgICAgICBTQlJlcGxhY2VDaGFyV2l0aFN0cmluZyhzYiwgKGNoYXIpOSwgIiYjeDk7Iik7DQogICAgICAgICAgICBTQlJlcGxhY2VDaGFyV2l0aFN0cmluZyhzYiwgKGNoYXIpMTAsICImI3hBOyIpOw0KICAgICAgICAgICAgU0JSZXBsYWNlQ2hhcldpdGhTdHJpbmcoc2IsIChjaGFyKTEzLCAiJiN4RDsiKTsNCiAgICAgICAgICAgIHJldHVybiBzYi5Ub1N0cmluZygpOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIFhtbERvY3VtZW50IEdldE93bmVyRG9jdW1lbnQoWG1sTm9kZUxpc3Qgbm9kZUxpc3QpDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKFhtbE5vZGUgbm9kZSBpbiBub2RlTGlzdCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAobm9kZS5Pd25lckRvY3VtZW50ICE9IG51bGwpDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlLk93bmVyRG9jdW1lbnQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyB2b2lkIEFkZE5hbWVzcGFjZXMoWG1sRWxlbWVudCBlbGVtLCBDYW5vbmljYWxYbWxOb2RlTGlzdCBuYW1lc3BhY2VzKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAobmFtZXNwYWNlcyAhPSBudWxsKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGZvcmVhY2ggKFhtbE5vZGUgYXR0cmliIGluIG5hbWVzcGFjZXMpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBzdHJpbmcgbmFtZSA9ICgoYXR0cmliLlByZWZpeC5MZW5ndGggPiAwKSA/IGF0dHJpYi5QcmVmaXggKyAiOiIgKyBhdHRyaWIuTG9jYWxOYW1lIDogYXR0cmliLkxvY2FsTmFtZSk7DQogICAgICAgICAgICAgICAgICAgIC8vIFNraXAgdGhlIGF0dHJpYnV0ZSBpZiBvbmUgd2l0aCB0aGUgc2FtZSBxdWFsaWZpZWQgbmFtZSBhbHJlYWR5IGV4aXN0cw0KICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbS5IYXNBdHRyaWJ1dGUobmFtZSkgfHwgKG5hbWUuRXF1YWxzKCJ4bWxucyIpICYmIGVsZW0uUHJlZml4Lkxlbmd0aCA9PSAwKSkgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIFhtbEF0dHJpYnV0ZSBuc2F0dHJpYiA9IChYbWxBdHRyaWJ1dGUpZWxlbS5Pd25lckRvY3VtZW50LkNyZWF0ZUF0dHJpYnV0ZShuYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgbnNhdHRyaWIuVmFsdWUgPSBhdHRyaWIuVmFsdWU7DQogICAgICAgICAgICAgICAgICAgIGVsZW0uU2V0QXR0cmlidXRlTm9kZShuc2F0dHJpYik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHZvaWQgQWRkTmFtZXNwYWNlcyhYbWxFbGVtZW50IGVsZW0sIEhhc2h0YWJsZSBuYW1lc3BhY2VzKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAobmFtZXNwYWNlcyAhPSBudWxsKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGZvcmVhY2ggKHN0cmluZyBrZXkgaW4gbmFtZXNwYWNlcy5LZXlzKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0uSGFzQXR0cmlidXRlKGtleSkpIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICBYbWxBdHRyaWJ1dGUgbnNhdHRyaWIgPSAoWG1sQXR0cmlidXRlKWVsZW0uT3duZXJEb2N1bWVudC5DcmVhdGVBdHRyaWJ1dGUoa2V5KTsNCiAgICAgICAgICAgICAgICAgICAgbnNhdHRyaWIuVmFsdWUgPSBuYW1lc3BhY2VzW2tleV0gYXMgc3RyaW5nOw0KICAgICAgICAgICAgICAgICAgICBlbGVtLlNldEF0dHJpYnV0ZU5vZGUobnNhdHRyaWIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFRoaXMgbWV0aG9kIGdldHMgdGhlIGF0dHJpYnV0ZXMgdGhhdCBzaG91bGQgYmUgcHJvcGFnYXRlZA0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgQ2Fub25pY2FsWG1sTm9kZUxpc3QgR2V0UHJvcGFnYXRlZEF0dHJpYnV0ZXMoWG1sRWxlbWVudCBlbGVtKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoZWxlbSA9PSBudWxsKQ0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KDQogICAgICAgICAgICBDYW5vbmljYWxYbWxOb2RlTGlzdCBuYW1lc3BhY2VzID0gbmV3IENhbm9uaWNhbFhtbE5vZGVMaXN0KCk7DQogICAgICAgICAgICBYbWxOb2RlIGFuY2VzdG9yTm9kZSA9IGVsZW07DQoNCiAgICAgICAgICAgIGlmIChhbmNlc3Rvck5vZGUgPT0gbnVsbCkgcmV0dXJuIG51bGw7DQoNCiAgICAgICAgICAgIGJvb2wgYkRlZk5hbWVzcGFjZVRvQWRkID0gdHJ1ZTsNCg0KICAgICAgICAgICAgd2hpbGUgKGFuY2VzdG9yTm9kZSAhPSBudWxsKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFhtbEVsZW1lbnQgYW5jZXN0b3JFbGVtZW50ID0gYW5jZXN0b3JOb2RlIGFzIFhtbEVsZW1lbnQ7DQogICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yRWxlbWVudCA9PSBudWxsKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JOb2RlID0gYW5jZXN0b3JOb2RlLlBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIVV0aWxzLklzQ29tbWl0dGVkTmFtZXNwYWNlKGFuY2VzdG9yRWxlbWVudCwgYW5jZXN0b3JFbGVtZW50LlByZWZpeCwgYW5jZXN0b3JFbGVtZW50Lk5hbWVzcGFjZVVSSSkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIG5hbWVzcGFjZSBhdHRyaWJ1dGUgdG8gdGhlIGNvbGxlY3Rpb24gaWYgbmVlZGVkDQogICAgICAgICAgICAgICAgICAgIGlmICghVXRpbHMuSXNSZWR1bmRhbnROYW1lc3BhY2UoYW5jZXN0b3JFbGVtZW50LCBhbmNlc3RvckVsZW1lbnQuUHJlZml4LCBhbmNlc3RvckVsZW1lbnQuTmFtZXNwYWNlVVJJKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nIG5hbWUgPSAoKGFuY2VzdG9yRWxlbWVudC5QcmVmaXguTGVuZ3RoID4gMCkgPyAieG1sbnM6IiArIGFuY2VzdG9yRWxlbWVudC5QcmVmaXggOiAieG1sbnMiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIFhtbEF0dHJpYnV0ZSBuc2F0dHJpYiA9IGVsZW0uT3duZXJEb2N1bWVudC5DcmVhdGVBdHRyaWJ1dGUobmFtZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBuc2F0dHJpYi5WYWx1ZSA9IGFuY2VzdG9yRWxlbWVudC5OYW1lc3BhY2VVUkk7DQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lc3BhY2VzLkFkZChuc2F0dHJpYik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yRWxlbWVudC5IYXNBdHRyaWJ1dGVzKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgWG1sQXR0cmlidXRlQ29sbGVjdGlvbiBhdHRyaWJzID0gYW5jZXN0b3JFbGVtZW50LkF0dHJpYnV0ZXM7DQogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKFhtbEF0dHJpYnV0ZSBhdHRyaWIgaW4gYXR0cmlicykNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGEgZGVmYXVsdCBuYW1lc3BhY2UgaWYgbmVjZXNzYXJ5DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYkRlZk5hbWVzcGFjZVRvQWRkICYmIGF0dHJpYi5Mb2NhbE5hbWUgPT0gInhtbG5zIikNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBYbWxBdHRyaWJ1dGUgbnNhdHRyaWIgPSBlbGVtLk93bmVyRG9jdW1lbnQuQ3JlYXRlQXR0cmlidXRlKCJ4bWxucyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5zYXR0cmliLlZhbHVlID0gYXR0cmliLlZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZXMuQWRkKG5zYXR0cmliKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiRGVmTmFtZXNwYWNlVG9BZGQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJldGFpbiB0aGUgZGVjbGFyYXRpb25zIG9mIHR5cGUgJ3htbDoqJyBhcyB3ZWxsDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmliLlByZWZpeCA9PSAieG1sbnMiIHx8IGF0dHJpYi5QcmVmaXggPT0gInhtbCIpDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlcy5BZGQoYXR0cmliKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWIuTmFtZXNwYWNlVVJJLkxlbmd0aCA+IDApDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFVdGlscy5Jc0NvbW1pdHRlZE5hbWVzcGFjZShhbmNlc3RvckVsZW1lbnQsIGF0dHJpYi5QcmVmaXgsIGF0dHJpYi5OYW1lc3BhY2VVUkkpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBuYW1lc3BhY2UgYXR0cmlidXRlIHRvIHRoZSBjb2xsZWN0aW9uIGlmIG5lZWRlZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIVV0aWxzLklzUmVkdW5kYW50TmFtZXNwYWNlKGFuY2VzdG9yRWxlbWVudCwgYXR0cmliLlByZWZpeCwgYXR0cmliLk5hbWVzcGFjZVVSSSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZyBuYW1lID0gKChhdHRyaWIuUHJlZml4Lkxlbmd0aCA+IDApID8gInhtbG5zOiIgKyBhdHRyaWIuUHJlZml4IDogInhtbG5zIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBYbWxBdHRyaWJ1dGUgbnNhdHRyaWIgPSBlbGVtLk93bmVyRG9jdW1lbnQuQ3JlYXRlQXR0cmlidXRlKG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnNhdHRyaWIuVmFsdWUgPSBhdHRyaWIuTmFtZXNwYWNlVVJJOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlcy5BZGQobnNhdHRyaWIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGFuY2VzdG9yTm9kZSA9IGFuY2VzdG9yTm9kZS5QYXJlbnROb2RlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gbmFtZXNwYWNlczsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIG91dHB1dCBvZiB0aGlzIHJvdXRpbmUgaXMgYWx3YXlzIGJpZyBlbmRpYW4NCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIGJ5dGVbXSBDb252ZXJ0SW50VG9CeXRlQXJyYXkoaW50IGR3SW5wdXQpDQogICAgICAgIHsNCiAgICAgICAgICAgIGJ5dGVbXSByZ2JUZW1wID0gbmV3IGJ5dGVbOF07IC8vIGludCBjYW4gbmV2ZXIgYmUgZ3JlYXRlciB0aGFuIEludDY0DQogICAgICAgICAgICBpbnQgdDE7ICAvLyB0MSBpcyByZW1haW5pbmcgdmFsdWUgdG8gYWNjb3VudCBmb3INCiAgICAgICAgICAgIGludCB0MjsgIC8vIHQyIGlzIHQxICUgMjU2DQogICAgICAgICAgICBpbnQgaSA9IDA7DQoNCiAgICAgICAgICAgIGlmIChkd0lucHV0ID09IDApIHJldHVybiBuZXcgYnl0ZVsxXTsNCiAgICAgICAgICAgIHQxID0gZHdJbnB1dDsNCiAgICAgICAgICAgIHdoaWxlICh0MSA+IDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdDIgPSB0MSAlIDI1NjsNCiAgICAgICAgICAgICAgICByZ2JUZW1wW2ldID0gKGJ5dGUpdDI7DQogICAgICAgICAgICAgICAgdDEgPSAodDEgLSB0MikgLyAyNTY7DQogICAgICAgICAgICAgICAgaSsrOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8gTm93LCBjb3B5IG9ubHkgdGhlIG5vbi16ZXJvIHBhcnQgb2YgcmdiVGVtcCBhbmQgcmV2ZXJzZQ0KICAgICAgICAgICAgYnl0ZVtdIHJnYk91dHB1dCA9IG5ldyBieXRlW2ldOw0KICAgICAgICAgICAgLy8gY29weSBhbmQgcmV2ZXJzZSBpbiBvbmUgcGFzcw0KICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBpOyBqKyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcmdiT3V0cHV0W2pdID0gcmdiVGVtcFtpIC0gaiAtIDFdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHJnYk91dHB1dDsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBpbnQgQ29udmVydEJ5dGVBcnJheVRvSW50KGJ5dGVbXSBpbnB1dCkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gSW5wdXQgdG8gdGhpcyByb3V0aW5lIGlzIGFsd2F5cyBiaWcgZW5kaWFuDQogICAgICAgICAgICBpbnQgZHdPdXRwdXQgPSAwOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbnB1dC5MZW5ndGg7IGkrKykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBkd091dHB1dCAqPSAyNTY7DQogICAgICAgICAgICAgICAgZHdPdXRwdXQgKz0gaW5wdXRbaV07DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gKGR3T3V0cHV0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBpbnQgR2V0SGV4QXJyYXlTaXplKGJ5dGVbXSBoZXgpDQogICAgICAgIHsNCiAgICAgICAgICAgIGludCBpbmRleCA9IGhleC5MZW5ndGg7DQogICAgICAgICAgICB3aGlsZSAoaW5kZXgtLSA+IDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKGhleFtpbmRleF0gIT0gMCkNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gaW5kZXggKyAxOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gTWltaWMgdGhlIGJlaGF2aW9yIG9mIHRoZSBYNTA5SXNzdWVyU2VyaWFsIGNvbnN0cnVjdG9yIHdpdGggbnVsbCBhbmQgZW1wdHkgY2hlY2tzDQogICAgICAgIGludGVybmFsIHN0YXRpYyBYNTA5SXNzdWVyU2VyaWFsIENyZWF0ZVg1MDlJc3N1ZXJTZXJpYWwoc3RyaW5nIGlzc3Vlck5hbWUsIHN0cmluZyBzZXJpYWxOdW1iZXIpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChpc3N1ZXJOYW1lID09IG51bGwgfHwgaXNzdWVyTmFtZS5MZW5ndGggPT0gMCkNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oU1IuQXJnX0VtcHR5T3JOdWxsU3RyaW5nLCBuYW1lb2YoaXNzdWVyTmFtZSkpOw0KICAgICAgICAgICAgaWYgKHNlcmlhbE51bWJlciA9PSBudWxsIHx8IHNlcmlhbE51bWJlci5MZW5ndGggPT0gMCkNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oU1IuQXJnX0VtcHR5T3JOdWxsU3RyaW5nLCBuYW1lb2Yoc2VyaWFsTnVtYmVyKSk7DQoNCiAgICAgICAgICAgIHJldHVybiBuZXcgWDUwOUlzc3VlclNlcmlhbCgpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgSXNzdWVyTmFtZSA9IGlzc3Vlck5hbWUsDQogICAgICAgICAgICAgICAgU2VyaWFsTnVtYmVyID0gc2VyaWFsTnVtYmVyDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIFg1MDlDZXJ0aWZpY2F0ZTJDb2xsZWN0aW9uIEJ1aWxkQmFnT2ZDZXJ0cyhLZXlJbmZvWDUwOURhdGEga2V5SW5mb1g1MDlEYXRhLCBDZXJ0VXNhZ2VUeXBlIGNlcnRVc2FnZVR5cGUpDQogICAgICAgIHsNCiAgICAgICAgICAgIFg1MDlDZXJ0aWZpY2F0ZTJDb2xsZWN0aW9uIGNvbGxlY3Rpb24gPSBuZXcgWDUwOUNlcnRpZmljYXRlMkNvbGxlY3Rpb24oKTsNCiAgICAgICAgICAgIEFycmF5TGlzdCBkZWNyeXB0aW9uSXNzdWVyU2VyaWFscyA9IChjZXJ0VXNhZ2VUeXBlID09IENlcnRVc2FnZVR5cGUuRGVjcnlwdGlvbiA/IG5ldyBBcnJheUxpc3QoKSA6IG51bGwpOw0KICAgICAgICAgICAgaWYgKGtleUluZm9YNTA5RGF0YS5DZXJ0aWZpY2F0ZXMgIT0gbnVsbCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBmb3JlYWNoIChYNTA5Q2VydGlmaWNhdGUyIGNlcnRpZmljYXRlIGluIGtleUluZm9YNTA5RGF0YS5DZXJ0aWZpY2F0ZXMpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNlcnRVc2FnZVR5cGUpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgQ2VydFVzYWdlVHlwZS5WZXJpZmljYXRpb246DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5BZGQoY2VydGlmaWNhdGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBDZXJ0VXNhZ2VUeXBlLkRlY3J5cHRpb246DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjcnlwdGlvbklzc3VlclNlcmlhbHMuQWRkKENyZWF0ZVg1MDlJc3N1ZXJTZXJpYWwoY2VydGlmaWNhdGUuSXNzdWVyTmFtZS5OYW1lLCBjZXJ0aWZpY2F0ZS5TZXJpYWxOdW1iZXIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKGtleUluZm9YNTA5RGF0YS5TdWJqZWN0TmFtZXMgPT0gbnVsbCAmJiBrZXlJbmZvWDUwOURhdGEuSXNzdWVyU2VyaWFscyA9PSBudWxsICYmDQogICAgICAgICAgICAgICAga2V5SW5mb1g1MDlEYXRhLlN1YmplY3RLZXlJZHMgPT0gbnVsbCAmJiBkZWNyeXB0aW9uSXNzdWVyU2VyaWFscyA9PSBudWxsKQ0KICAgICAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uOw0KDQogICAgICAgICAgICAvLyBPcGVuIExvY2FsTWFjaGluZSBhbmQgQ3VycmVudFVzZXIgIk90aGVyIFBlb3BsZSIvIk15IiBzdG9yZXMuDQoNCiAgICAgICAgICAgIFg1MDlTdG9yZVtdIHN0b3JlcyA9IG5ldyBYNTA5U3RvcmVbMl07DQogICAgICAgICAgICBzdHJpbmcgc3RvcmVOYW1lID0gKGNlcnRVc2FnZVR5cGUgPT0gQ2VydFVzYWdlVHlwZS5WZXJpZmljYXRpb24gPyAiQWRkcmVzc0Jvb2siIDogIk15Iik7DQogICAgICAgICAgICBzdG9yZXNbMF0gPSBuZXcgWDUwOVN0b3JlKHN0b3JlTmFtZSwgU3RvcmVMb2NhdGlvbi5DdXJyZW50VXNlcik7DQogICAgICAgICAgICBzdG9yZXNbMV0gPSBuZXcgWDUwOVN0b3JlKHN0b3JlTmFtZSwgU3RvcmVMb2NhdGlvbi5Mb2NhbE1hY2hpbmUpOw0KDQogICAgICAgICAgICBmb3IgKGludCBpbmRleCA9IDA7IGluZGV4IDwgc3RvcmVzLkxlbmd0aDsgaW5kZXgrKykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoc3RvcmVzW2luZGV4XSAhPSBudWxsKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgWDUwOUNlcnRpZmljYXRlMkNvbGxlY3Rpb24gZmlsdGVycyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIC8vIFdlIGRvbid0IGNhcmUgaWYgd2UgY2FuJ3Qgb3BlbiB0aGUgc3RvcmUuDQogICAgICAgICAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBzdG9yZXNbaW5kZXhdLk9wZW4oT3BlbkZsYWdzLlJlYWRPbmx5IHwgT3BlbkZsYWdzLk9wZW5FeGlzdGluZ09ubHkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVycyA9IHN0b3Jlc1tpbmRleF0uQ2VydGlmaWNhdGVzOw0KICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmVzW2luZGV4XS5DbG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleUluZm9YNTA5RGF0YS5TdWJqZWN0TmFtZXMgIT0gbnVsbCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChzdHJpbmcgc3ViamVjdE5hbWUgaW4ga2V5SW5mb1g1MDlEYXRhLlN1YmplY3ROYW1lcykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcnMgPSBmaWx0ZXJzLkZpbmQoWDUwOUZpbmRUeXBlLkZpbmRCeVN1YmplY3REaXN0aW5ndWlzaGVkTmFtZSwgc3ViamVjdE5hbWUsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5SW5mb1g1MDlEYXRhLklzc3VlclNlcmlhbHMgIT0gbnVsbCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChYNTA5SXNzdWVyU2VyaWFsIGlzc3VlclNlcmlhbCBpbiBrZXlJbmZvWDUwOURhdGEuSXNzdWVyU2VyaWFscykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcnMgPSBmaWx0ZXJzLkZpbmQoWDUwOUZpbmRUeXBlLkZpbmRCeUlzc3VlckRpc3Rpbmd1aXNoZWROYW1lLCBpc3N1ZXJTZXJpYWwuSXNzdWVyTmFtZSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJzID0gZmlsdGVycy5GaW5kKFg1MDlGaW5kVHlwZS5GaW5kQnlTZXJpYWxOdW1iZXIsIGlzc3VlclNlcmlhbC5TZXJpYWxOdW1iZXIsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5SW5mb1g1MDlEYXRhLlN1YmplY3RLZXlJZHMgIT0gbnVsbCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoIChieXRlW10gc2tpIGluIGtleUluZm9YNTA5RGF0YS5TdWJqZWN0S2V5SWRzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nIGhleCA9IEVuY29kZUhleFN0cmluZyhza2kpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJzID0gZmlsdGVycy5GaW5kKFg1MDlGaW5kVHlwZS5GaW5kQnlTdWJqZWN0S2V5SWRlbnRpZmllciwgaGV4LCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlY3J5cHRpb25Jc3N1ZXJTZXJpYWxzICE9IG51bGwpDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoWDUwOUlzc3VlclNlcmlhbCBpc3N1ZXJTZXJpYWwgaW4gZGVjcnlwdGlvbklzc3VlclNlcmlhbHMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJzID0gZmlsdGVycy5GaW5kKFg1MDlGaW5kVHlwZS5GaW5kQnlJc3N1ZXJEaXN0aW5ndWlzaGVkTmFtZSwgaXNzdWVyU2VyaWFsLklzc3Vlck5hbWUsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVycyA9IGZpbHRlcnMuRmluZChYNTA5RmluZFR5cGUuRmluZEJ5U2VyaWFsTnVtYmVyLCBpc3N1ZXJTZXJpYWwuU2VyaWFsTnVtYmVyLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlIGRvZXNuJ3QgZXhpc3QsIG5vIHJlYWQgcGVybWlzc2lvbnMsIG90aGVyIHN5c3RlbSBlcnJvcg0KICAgICAgICAgICAgICAgICAgICBjYXRjaCAoQ3J5cHRvZ3JhcGhpY0V4Y2VwdGlvbikgeyB9DQogICAgICAgICAgICAgICAgICAgIC8vIE9wZW5pbmcgTG9jYWxNYWNoaW5lIHN0b3JlcyAob3RoZXIgdGhhbiBSb290IG9yIENlcnRpZmljYXRlQXV0aG9yaXR5KSBvbiBMaW51eA0KICAgICAgICAgICAgICAgICAgICBjYXRjaCAoUGxhdGZvcm1Ob3RTdXBwb3J0ZWRFeGNlcHRpb24pIHsgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJzICE9IG51bGwpDQogICAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLkFkZFJhbmdlKGZpbHRlcnMpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247DQogICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBjaGFyW10gc19oZXhWYWx1ZXMgPSB7JzAnLCAnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYnLCAnNycsICc4JywgJzknLCAnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnfTsNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHN0cmluZyBFbmNvZGVIZXhTdHJpbmcoYnl0ZVtdIHNBcnJheSkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIEVuY29kZUhleFN0cmluZyhzQXJyYXksIDAsICh1aW50KXNBcnJheS5MZW5ndGgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50ZXJuYWwgc3RhdGljIHN0cmluZyBFbmNvZGVIZXhTdHJpbmcoYnl0ZVtdIHNBcnJheSwgdWludCBzdGFydCwgdWludCBlbmQpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyByZXN1bHQgPSBudWxsOw0KICAgICAgICAgICAgaWYgKHNBcnJheSAhPSBudWxsKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGNoYXJbXSBoZXhPcmRlciA9IG5ldyBjaGFyWyhlbmQgLSBzdGFydCkgKiAyXTsNCiAgICAgICAgICAgICAgICB1aW50IGRpZ2l0Ow0KICAgICAgICAgICAgICAgIGZvciAodWludCBpID0gc3RhcnQsIGogPSAwOyBpIDwgZW5kOyBpKyspDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBkaWdpdCA9ICh1aW50KSgoc0FycmF5W2ldICYgMHhmMCkgPj4gNCk7DQogICAgICAgICAgICAgICAgICAgIGhleE9yZGVyW2orK10gPSBzX2hleFZhbHVlc1tkaWdpdF07DQogICAgICAgICAgICAgICAgICAgIGRpZ2l0ID0gKHVpbnQpKHNBcnJheVtpXSAmIDB4MGYpOw0KICAgICAgICAgICAgICAgICAgICBoZXhPcmRlcltqKytdID0gc19oZXhWYWx1ZXNbZGlnaXRdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3RyaW5nKGhleE9yZGVyKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgYnl0ZVtdIERlY29kZUhleFN0cmluZyhzdHJpbmcgcykNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIGhleFN0cmluZyA9IFV0aWxzLkRpc2NhcmRXaGl0ZVNwYWNlcyhzKTsNCiAgICAgICAgICAgIHVpbnQgY2JIZXggPSAodWludCloZXhTdHJpbmcuTGVuZ3RoIC8gMjsNCiAgICAgICAgICAgIGJ5dGVbXSBoZXggPSBuZXcgYnl0ZVtjYkhleF07DQogICAgICAgICAgICBpbnQgaSA9IDA7DQogICAgICAgICAgICBmb3IgKGludCBpbmRleCA9IDA7IGluZGV4IDwgY2JIZXg7IGluZGV4KyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaGV4W2luZGV4XSA9IChieXRlKSgoSGV4VG9CeXRlKGhleFN0cmluZ1tpXSkgPDwgNCkgfCBIZXhUb0J5dGUoaGV4U3RyaW5nW2kgKyAxXSkpOw0KICAgICAgICAgICAgICAgIGkgKz0gMjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBoZXg7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgYnl0ZSBIZXhUb0J5dGUoY2hhciB2YWwpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICh2YWwgPD0gJzknICYmIHZhbCA+PSAnMCcpDQogICAgICAgICAgICAgICAgcmV0dXJuIChieXRlKSh2YWwgLSAnMCcpOw0KICAgICAgICAgICAgZWxzZSBpZiAodmFsID49ICdhJyAmJiB2YWwgPD0gJ2YnKQ0KICAgICAgICAgICAgICAgIHJldHVybiAoYnl0ZSkoKHZhbCAtICdhJykgKyAxMCk7DQogICAgICAgICAgICBlbHNlIGlmICh2YWwgPj0gJ0EnICYmIHZhbCA8PSAnRicpDQogICAgICAgICAgICAgICAgcmV0dXJuIChieXRlKSgodmFsIC0gJ0EnKSArIDEwKTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICByZXR1cm4gMHhGRjsNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIHN0YXRpYyBib29sIElzU2VsZlNpZ25lZChYNTA5Q2hhaW4gY2hhaW4pDQogICAgICAgIHsNCiAgICAgICAgICAgIFg1MDlDaGFpbkVsZW1lbnRDb2xsZWN0aW9uIGVsZW1lbnRzID0gY2hhaW4uQ2hhaW5FbGVtZW50czsNCiAgICAgICAgICAgIGlmIChlbGVtZW50cy5Db3VudCAhPSAxKQ0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIFg1MDlDZXJ0aWZpY2F0ZTIgY2VydGlmaWNhdGUgPSBlbGVtZW50c1swXS5DZXJ0aWZpY2F0ZTsNCiAgICAgICAgICAgIGlmIChTdHJpbmcuQ29tcGFyZShjZXJ0aWZpY2F0ZS5TdWJqZWN0TmFtZS5OYW1lLCBjZXJ0aWZpY2F0ZS5Jc3N1ZXJOYW1lLk5hbWUsIFN0cmluZ0NvbXBhcmlzb24uT3JkaW5hbElnbm9yZUNhc2UpID09IDApDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdGF0aWMgQXN5bW1ldHJpY0FsZ29yaXRobSBHZXRBbnlQdWJsaWNLZXkoWDUwOUNlcnRpZmljYXRlMiBjZXJ0aWZpY2F0ZSkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIChBc3ltbWV0cmljQWxnb3JpdGhtKWNlcnRpZmljYXRlLkdldFJTQVB1YmxpY0tleSgpOw0KICAgICAgICB9DQogICAgfQ0KfQ0K"
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/TestHelpers.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gVGhlIC5ORVQgRm91bmRhdGlvbiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCi8vIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb24uDQoNCnVzaW5nIFN5c3RlbTsNCnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljOw0KdXNpbmcgU3lzdGVtLklPOw0KdXNpbmcgU3lzdGVtLlJlZmxlY3Rpb247DQp1c2luZyBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXM7DQp1c2luZyBTeXN0ZW0uVGV4dDsNCnVzaW5nIFN5c3RlbS5YbWw7DQp1c2luZyBTeXN0ZW0uWG1sLlJlc29sdmVyczsNCg0KbmFtZXNwYWNlIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuWG1sLlRlc3RzDQp7DQogICAgaW50ZXJuYWwgc3RhdGljIGNsYXNzIFRlc3RIZWxwZXJzDQogICAgew0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBDb252ZXJ0IGEgPHNlZSBjcmVmPSJTdHJlYW0iLz4gdG8gYSA8c2VlIGNyZWY9InN0cmluZyIvPiB1c2luZyB0aGUgZ2l2ZW4gPHNlZSBjcmVmPSJFbmNvZGluZyIvPi4NCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJzdHJlYW0iPg0KICAgICAgICAvLy8gVGhlIDxzZWUgY3JlZj0iU3RyZWFtIi8+IHRvIHJlYWQgZnJvbS4gVGhpcyBjYW5ub3QgYmUgbnVsbC4NCiAgICAgICAgLy8vIDwvcGFyYW0+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0iZW5jb2RpbmciPg0KICAgICAgICAvLy8gVGhlIDxzZWUgY3JlZj0iRW5jb2RpbmciLz4gdG8gdXNlLiBUaGlzIGNhbm5vdCBiZSBudWxsLg0KICAgICAgICAvLy8gPC9wYXJhbT4NCiAgICAgICAgLy8vIDxyZXR1cm5zPg0KICAgICAgICAvLy8gVGhlIHN0cmVhbSBhcyBhIHN0cmluZy4NCiAgICAgICAgLy8vIDwvcmV0dXJucz4NCiAgICAgICAgLy8vIDxleGNlcHRpb24gY3JlZj0iQXJndW1lbnROdWxsRXhjZXB0aW9uIj4NCiAgICAgICAgLy8vIE5vIGFyZ3VtZW50IGNhbiBiZSBudWxsLg0KICAgICAgICAvLy8gPC9leGNlcHRpb24+DQogICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIFN0cmVhbVRvU3RyaW5nKFN0cmVhbSBzdHJlYW0sIEVuY29kaW5nIGVuY29kaW5nKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoc3RyZWFtID09IG51bGwpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEV4Y2VwdGlvbihuYW1lb2Yoc3RyZWFtKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoZW5jb2RpbmcgPT0gbnVsbCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXhjZXB0aW9uKG5hbWVvZihlbmNvZGluZykpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB1c2luZyAoU3RyZWFtUmVhZGVyIHN0cmVhbVJlYWRlciA9IG5ldyBTdHJlYW1SZWFkZXIoc3RyZWFtLCBlbmNvZGluZykpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHN0cmVhbVJlYWRlci5SZWFkVG9FbmQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIFBlcmZvcm0NCiAgICAgICAgLy8vIDwvc3VtbWFyeT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJpbnB1dFhtbCI+DQogICAgICAgIC8vLyBUaGUgWE1MIHRvIHRyYW5zZm9ybS4gVGhpcyBjYW5ub3QgYmUgbnVsbCwgZW1wdHkgb3Igd2hpdGVzcGFjZS4NCiAgICAgICAgLy8vIDwvcGFyYW0+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0idHJhbnNmb3JtIj4NCiAgICAgICAgLy8vIFRoZSA8c2VlIGNyZWY9IlRyYW5zZm9ybSIvPiB0byBwZXJmb3JtIG9uIA0KICAgICAgICAvLy8gPHBhcmFtcmVmIG5hbWU9ImlucHV0WG1sIi8+LiBUaGlzIGNhbm5vdCBiZSBudWxsLg0KICAgICAgICAvLy8gPC9wYXJhbT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJlbmNvZGluZyI+DQogICAgICAgIC8vLyBBbiBvcHRpb25hbCA8c2VlIGNyZWY9IkVuY29kaW5nIi8+IHRvIHVzZSB3aGVuIHNlcmlhbGl6aW5nIG9yIA0KICAgICAgICAvLy8gZGVzZXJpYWxpemluZyA8cGFyYW1yZWYgbmFtZT0iaW5wdXRYbWwiLz4uIFRoaXMgc2hvdWxkIG1hdGNoIHRoZSANCiAgICAgICAgLy8vIGVuY29kaW5nIHNwZWNpZmllZCBpbiA8cGFyYW1yZWYgbmFtZT0iaW5wdXRYbWwiLz4uIElmIG9taXR0ZWQgb3IgDQogICAgICAgIC8vLyBudWxsLCA8c2VlIGNyZWY9IlVURjhFbmNvZGluZyIvPiBpcyB1c2VkLg0KICAgICAgICAvLy8gPC9wYXJhbT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJyZXNvbHZlciI+DQogICAgICAgIC8vLyBBbiBvcHRpb25hbCA8c2VlIGNyZWY9IlhtbFJlc29sdmVyIi8+IHRvIHVzZS4gSWYgb21pdHRlZCBvciBudWxsLCANCiAgICAgICAgLy8vIG5vIHJlc29sdmVyIGlzIHVzZWQuDQogICAgICAgIC8vLyA8L3BhcmFtPg0KICAgICAgICAvLy8gPHJldHVybnM+DQogICAgICAgIC8vLyBUaGUgdHJhbnNmb3JtZWQgPHBhcmFtcmVmIG5hbWU9ImlucHV0WG1sIi8+Lg0KICAgICAgICAvLy8gPC9yZXR1cm5zPg0KICAgICAgICAvLy8gPGV4Y2VwdGlvbiBjcmVmPSJBcmd1bWVudE51bGxFeGNlcHRpb24iPg0KICAgICAgICAvLy8gPHBhcmFtcmVmIG5hbWU9InRyYW5zZm9ybSIvPiBjYW5ub3QgYmUgbnVsbC4NCiAgICAgICAgLy8vIDwvZXhjZXB0aW9uPg0KICAgICAgICAvLy8gPGV4Y2VwdGlvbiBjcmVmPSJBcmd1bWVudEV4Y2VwdGlvbiI+DQogICAgICAgIC8vLyA8cGFyYW1yZWYgbmFtZT0iaW5wdXRYbWwiLz4gY2Fubm90IGJlIG51bGwsIGVtcHR5IG9yIHdoaXRlc3BhY2UuDQogICAgICAgIC8vLyA8L2V4Y2VwdGlvbj4NCiAgICAgICAgLy8vIDxleGNlcHRpb24gY3JlZj0iWG1sRXhjZXB0aW9uIj4NCiAgICAgICAgLy8vIDxwYXJhbXJlZiBuYW1lPSJpbnB1dFhtbCIvPiBpcyBub3QgdmFsaWQgWE1MLg0KICAgICAgICAvLy8gPC9leGNlcHRpb24+DQogICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIEV4ZWN1dGVUcmFuc2Zvcm0oc3RyaW5nIGlucHV0WG1sLCBUcmFuc2Zvcm0gdHJhbnNmb3JtLCBFbmNvZGluZyBlbmNvZGluZyA9IG51bGwsIFhtbFJlc29sdmVyIHJlc29sdmVyID0gbnVsbCkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoaW5wdXRYbWwpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudEV4Y2VwdGlvbigiQ2Fubm90IGJlIG51bGwsIGVtcHR5IG9yIHdoaXRlc3BhY2UiLCBuYW1lb2YoaW5wdXRYbWwpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICh0cmFuc2Zvcm0gPT0gbnVsbCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXhjZXB0aW9uKG5hbWVvZihUcmFuc2Zvcm0pKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBkb2MuWG1sUmVzb2x2ZXIgPSByZXNvbHZlcjsNCiAgICAgICAgICAgIGRvYy5QcmVzZXJ2ZVdoaXRlc3BhY2UgPSB0cnVlOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoaW5wdXRYbWwpOw0KDQogICAgICAgICAgICBFbmNvZGluZyBhY3R1YWxFbmNvZGluZyA9IGVuY29kaW5nID8/IEVuY29kaW5nLlVURjg7DQogICAgICAgICAgICBieXRlW10gZGF0YSA9IGFjdHVhbEVuY29kaW5nLkdldEJ5dGVzKGlucHV0WG1sKTsNCiAgICAgICAgICAgIHVzaW5nIChTdHJlYW0gc3RyZWFtID0gbmV3IE1lbW9yeVN0cmVhbShkYXRhKSkNCiAgICAgICAgICAgIHVzaW5nIChYbWxSZWFkZXIgcmVhZGVyID0gWG1sUmVhZGVyLkNyZWF0ZShzdHJlYW0sIG5ldyBYbWxSZWFkZXJTZXR0aW5ncyB7IFZhbGlkYXRpb25UeXBlID0gVmFsaWRhdGlvblR5cGUuTm9uZSwgRHRkUHJvY2Vzc2luZyA9IER0ZFByb2Nlc3NpbmcuUGFyc2UsIFhtbFJlc29sdmVyID0gcmVzb2x2ZXIgfSkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZG9jLkxvYWQocmVhZGVyKTsNCiAgICAgICAgICAgICAgICB0cmFuc2Zvcm0uTG9hZElucHV0KGRvYyk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFN0cmVhbVRvU3RyaW5nKChTdHJlYW0pdHJhbnNmb3JtLkdldE91dHB1dCgpLCBhY3R1YWxFbmNvZGluZyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLy8gPHN1bW1hcnk+DQogICAgICAgIC8vLyBDb252ZXJ0IDxwYXJhbXJlZiBuYW1lPSJmaWxlTmFtZSIvPiB0byBhIGZ1bGwgVVJJIGZvciByZWZlcmVuY2luZyANCiAgICAgICAgLy8vIGluIGFuIDxzZWUgY3JlZj0iWG1sUHJlbG9hZGVkUmVzb2x2ZXIiLz4uDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0iZmlsZU5hbWUiPg0KICAgICAgICAvLy8gVGhlIGZpbGUgbmFtZS4gVGhpcyBjYW5ub3QgYmUgbnVsbCwgZW1wdHkgb3Igd2hpdGVzcGFjZS4NCiAgICAgICAgLy8vIDwvcGFyYW0+DQogICAgICAgIC8vLyA8cmV0dXJucz4NCiAgICAgICAgLy8vIFRoZSBjcmVhdGVkIDxzZWUgY3JlZj0iVXJpIi8+Lg0KICAgICAgICAvLy8gPC9yZXR1cm5zPg0KICAgICAgICAvLy8gPGV4Y2VwdGlvbiBjcmVmPSJBcmd1bWVudEV4Y2VwdGlvbiI+DQogICAgICAgIC8vLyA8cGFyYW1yZWYgbmFtZT0iZmlsZU5hbWUiLz4gY2Fubm90IGJlIG51bGwsIGVtcHR5IG9yIHdoaXRlc3BhY2UuDQogICAgICAgIC8vLyA8L2V4Y2VwdGlvbj4NCiAgICAgICAgcHVibGljIHN0YXRpYyBVcmkgVG9Vcmkoc3RyaW5nIGZpbGVOYW1lKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShmaWxlTmFtZSkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKCJDYW5ub3QgYmUgbnVsbCwgZW1wdHkgb3Igd2hpdGVzcGFjZSIsIG5hbWVvZihmaWxlTmFtZSkpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBzdHJpbmcgcGF0aCA9IFBhdGguQ29tYmluZShEaXJlY3RvcnkuR2V0Q3VycmVudERpcmVjdG9yeSgpLCBmaWxlTmFtZSk7DQogICAgICAgICAgICByZXR1cm4gbmV3IFVyaSgiZmlsZTovLyIgKyAocGF0aFswXSA9PSAnLycgPyBwYXRoIDogJy8nICsgcGF0aCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAvLy8gR2V0IHNwZWNpZmljYXRpb24gVVJMIGZyb20gYWxnb3JpdGhtIGltcGxlbWVudGF0aW9uDQogICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0ia2V5Ij48L3BhcmFtPg0KICAgICAgICAvLy8gPHJldHVybnM+PC9yZXR1cm5zPg0KICAgICAgICBwdWJsaWMgc3RhdGljIHN0cmluZyBHZXRFbmNyeXB0aW9uTWV0aG9kTmFtZShTeW1tZXRyaWNBbGdvcml0aG0ga2V5LCBib29sIGtleVdyYXAgPSBmYWxzZSkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKGtleSBpcyBUcmlwbGVERVMpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGtleVdyYXAgPyBFbmNyeXB0ZWRYbWwuWG1sRW5jVHJpcGxlREVTS2V5V3JhcFVybCA6IEVuY3J5cHRlZFhtbC5YbWxFbmNUcmlwbGVERVNVcmw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIGlmIChrZXkgaXMgREVTKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJldHVybiBrZXlXcmFwID8gRW5jcnlwdGVkWG1sLlhtbEVuY1RyaXBsZURFU0tleVdyYXBVcmwgOiBFbmNyeXB0ZWRYbWwuWG1sRW5jREVTVXJsOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSBpZiAoa2V5IGlzIFJpam5kYWVsIHx8IGtleSBpcyBBZXMpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc3dpdGNoIChrZXkuS2V5U2l6ZSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMTI4Og0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleVdyYXAgPyBFbmNyeXB0ZWRYbWwuWG1sRW5jQUVTMTI4S2V5V3JhcFVybCA6IEVuY3J5cHRlZFhtbC5YbWxFbmNBRVMxMjhVcmw7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMTkyOg0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleVdyYXAgPyBFbmNyeXB0ZWRYbWwuWG1sRW5jQUVTMTkyS2V5V3JhcFVybCA6IEVuY3J5cHRlZFhtbC5YbWxFbmNBRVMxOTJVcmw7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMjU2Og0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleVdyYXAgPyBFbmNyeXB0ZWRYbWwuWG1sRW5jQUVTMjU2S2V5V3JhcFVybCA6IEVuY3J5cHRlZFhtbC5YbWxFbmNBRVMyNTZVcmw7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oJCJUaGUgc3BlY2lmaWVkIGFsZ29yaXRobSBge2tleS5HZXRUeXBlKCkuRnVsbE5hbWV9YCBpcyBub3Qgc3VwcG9ydGVkIGZvciBYTUwgRW5jcnlwdGlvbi4iKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgLy8vIExpc3RzIGZ1bmN0aW9ucyBjcmVhdGluZyBzeW1tZXRyaWMgYWxnb3JpdGhtcw0KICAgICAgICAvLy8gPC9zdW1tYXJ5Pg0KICAgICAgICAvLy8gPHJldHVybnM+PC9yZXR1cm5zPg0KICAgICAgICBwdWJsaWMgc3RhdGljIElFbnVtZXJhYmxlPFN5bW1ldHJpY0FsZ29yaXRobUZhY3Rvcnk+IEdldFN5bW1ldHJpY0FsZ29yaXRobXMoYm9vbCBza2lwRGVzID0gZmFsc2UpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICghc2tpcERlcykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB5aWVsZCByZXR1cm4gbmV3IFN5bW1ldHJpY0FsZ29yaXRobUZhY3RvcnkoIkRFUyIsICgpID0+IERFUy5DcmVhdGUoKSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHlpZWxkIHJldHVybiBuZXcgU3ltbWV0cmljQWxnb3JpdGhtRmFjdG9yeSgiVHJpcGxlREVTIiwgKCkgPT4gVHJpcGxlREVTLkNyZWF0ZSgpKTsNCg0KICAgICAgICAgICAgZm9yZWFjaCAodmFyIGtleVNpemUgaW4gbmV3W10geyAxMjgsIDE5MiwgMjU2IH0pDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgeWllbGQgcmV0dXJuIG5ldyBTeW1tZXRyaWNBbGdvcml0aG1GYWN0b3J5KCQiQUVTe2tleVNpemV9IiwgKCkgPT4NCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIEFlcyBhZXMgPSBBZXMuQ3JlYXRlKCk7DQogICAgICAgICAgICAgICAgICAgIGFlcy5LZXlTaXplID0ga2V5U2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFlczsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IGJ5dGVbXSBTYW1wbGVQZnggPSBDb252ZXJ0LkZyb21CYXNlNjRTdHJpbmcoDQogICAgQCJNSUlGcFFJQkF6Q0NCVjhHQ1NxR1NJYjNEUUVIQWFDQ0JWQUVnZ1ZNTUlJRlNEQ0NBbDhHQ1NxR1NJYjNEUUVIQnFDQ0FsQXdnZ0pNQWdFQU1JSUNSUVlKS29aSWh2Y05BUWNCTUJ3R0NpcUdTSWIzRFFFTUFRTXdEZ1FJR1RmVmE0K3ZSMVVDQWdmUWdJSUNHSnVGRTlhbEZXSkZrYW9lZXdLRElFblZ3UnhYZk1zaThkY3lTWW5wN2psakVVUUJmVy9HSWJPZjdMZzJuSGQwcXh2eFlJMllMNFpzK2QwaldicWZOSGFtR0ZDTVBlMWRLOTU3WjJQc0tYUjE4M3ZNU2dubWxMQUhrdHNJTitHb3I3cTFHYlE0bGpmWmtHcVovcmtnVXNnc1NZWlNuSmV2UC91SDBWbnZ4ZW1salZKN043Z0tNWU8wYXFyY2E0cUowTzRZeEJZeWFlclBGVU9ZdW5RbHZrNkRPRjNTUVh6YTVvRktjUEdyU3BFLzllUXJubW02NEJ0YmRuVUU2cXFFamZaZk5hNk1PRDN2T25hcExVQnNlbDJUdFZDdTh0RWw3SThGR3hvelRMWFZUWE9Ca0wzazd4TFJTNTJadHBiY1UySklobERHcHhlRlhtaktZemR6SG9MMjBpSnViZmRrVVl0SHdCMFhqQktLTGNJN2pmZ0dnak5hdWFUTEF4OEZGKzVPOXM3WmJqMitTS1d2NTZrcUF3ZFgraUgyMVZnakFOOUVCeUlYSGIzcDJaT3Z5NE9ORFhUbWZTbjdqYnVQTFpUaSt1NmJ4bjJKT0xmL2dqRUE4RmlDdVFETDlnRjI0N2JuVXEwOFoxdXp1QVVlYVBMMTNVOG14d0V1dkNPWHg1TkVRSXVmM2N1c25hSDQrN3VJaFBrNXRuZkE1WE9hQUJ5U2V0UmpaaFZONWRDNS9nM0tUd21hRGFtbFczWTdBei9OekFDNHVLYTJueTVqd1lLQmdIdmlFS095SmZMREtyNWZPTVJUb09mZ3h2QWRYWm9oUVFURTErVGNCanArZWVWNWtvRGZCMVJlQ0tJUkh1Z1BadTVqOVNDVmNZYW53RmVKNU00Y0VIWjlVMVl0c216amgwZndWMTdEL2h4UTRhUzRWd1ZwT015cE1JSUM0UVlKS29aSWh2Y05BUWNCb0lJQzBnU0NBczR3Z2dMS01JSUN4Z1lMS29aSWh2Y05BUXdLQVFLZ2dnS2VNSUlDbWpBY0Jnb3Foa2lHOXcwQkRBRURNQTRFQ0JSZEtxeDAyMmNmQWdJSDBBU0NBbmpaeDlmdlBDSGl6ZEg2YXBWeldXbWZ5Lzg0SHZEUGpGT1VWMVRQZWhUbkRQa05wRi91Sy95YTRqbGJsNEt3MFpma250NVh5ZGw4OVNNWElXYTJxK25XbXh5RzNYeWZHcU9BZUJmSkJTZENGNUszcWtaWm56RWZyYUtaWjVIaDhJRW1LK2V5NDVPNnNsdHVhNlhsNU1SQm1LTGl3bWE3dlg0aWhYUVRNZmIwV2xXRFlDWFppODVPZUYwT2xValJXQXd6NFBlZWlCSzRubUkvdk5tRjFFekRWZFpHa3JyRThtb3QzWTR6NmJ2d3FpcDJ0VVViSHVNbkMrLzFpa0FjSnpDT3c0TnBuRVdDUnRJSnhnSjllczhFOENVZkhFU25XS2U0bmg2dEpWSjE1QjgvN29GN042ajdvcTRPajM0Nkp0aEtvV1dremlmTmFINzlBNjAvdUZoMDhSdjd6cnRKZjZrZWRZNlZlMmJSNWxoV24wY3Y5UTZJYW9xVG1LS1RtS0puamRRTzlsS1JDUjZpSTJPc1l0WEJyb3BEOHhoTk5xc3lmcE5tUDBHNndGaUVaWnhaaldPa1pFSkxVekZiSCtTdSs3bDJsNEZOOXNNN2syMTEvbDMvM1lGMVFKSHdac2dMOThEWkw0cUUrbmt1WlFjZHRPVXg4UVR5VE9jVmIzSXpnQ0F3Wm0wcmdkWFFwSjl5UkJnT0MvNk1ucWFDUEkwakp1YXZYRi9hMjhHSldXR2xheng3U1dUcmJ6TlZKODNaaFErcGZQRVB0TWkzdDBZVkxMdmFwdTNvdGdwaU1rdjRldy9zc1h3WWJnNnhCV2ZvdEsrTkcxY1B3VkZ5OS9WOStINWRwZHZSSS9sZTJRRzBGNXhDZkNlS2gvM0F1TmlNUEVHb1ZVUjVrajVjd0ZLNmVza3Z0Lys3NFplbnhmTlBaMlV0dGl3OERzcXRUeDFneGhjU1plVTVZV3BPN083OFJhWUU0TGw0a1BiYnZJYVIxOE5hcGI2TktQODQ2ejAyenZhdytmZVhBUkxlMEhVWTU4VGxtVWpTWDNNWlJLNFBFZHlNSVEvVVJ5UGltajRySW1hRGZGcktQQUhJanFUM0VLditLdU5zOFRFVk1CTUdDU3FHU0liM0RRRUpGVEVHQkFRQkFBQUFNRDB3SVRBSkJnVXJEZ01DR2dVQUJCUlpPbzEzMmN1bzJ6Tnl5K1NIMmMrcE40T0dtUVFVMm5RYW8zamU3RFRqMkc2R2dlOHBvb1BmMm5jQ0FnZlEiKTsNCg0KICAgICAgICBwdWJsaWMgc3RhdGljIFg1MDlDZXJ0aWZpY2F0ZTIgR2V0U2FtcGxlWDUwOUNlcnRpZmljYXRlKCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBYNTA5Q2VydGlmaWNhdGUyKFNhbXBsZVBmeCwgIm1vbm8iKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBzdGF0aWMgU3RyZWFtIExvYWRSZXNvdXJjZVN0cmVhbShzdHJpbmcgcmVzb3VyY2VOYW1lKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gdHlwZW9mKFRlc3RIZWxwZXJzKS5Bc3NlbWJseS5HZXRNYW5pZmVzdFJlc291cmNlU3RyZWFtKHJlc291cmNlTmFtZSk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgc3RhdGljIGJ5dGVbXSBMb2FkUmVzb3VyY2Uoc3RyaW5nIHJlc291cmNlTmFtZSkNCiAgICAgICAgew0KICAgICAgICAgICAgdXNpbmcgKFN0cmVhbSBzdHJlYW0gPSB0eXBlb2YoVGVzdEhlbHBlcnMpLkFzc2VtYmx5LkdldE1hbmlmZXN0UmVzb3VyY2VTdHJlYW0ocmVzb3VyY2VOYW1lKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBsb25nIGxlbmd0aCA9IHN0cmVhbS5MZW5ndGg7DQogICAgICAgICAgICAgICAgYnl0ZVtdIGJ1ZmZlciA9IG5ldyBieXRlW2xlbmd0aF07DQogICAgICAgICAgICAgICAgc3RyZWFtLlJlYWQoYnVmZmVyLCAwLCAoaW50KWxlbmd0aCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/XmlDsigC14NWithCommentsTransformTest.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gU2VlIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbW9yZSBpbmZvcm1hdGlvbg0KLy8NCi8vIFhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtVGVzdC5jcyANCi8vCS0gVGVzdCBDYXNlcyBmb3IgWG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0NCi8vDQovLyBBdXRob3I6DQovLwlTZWJhc3RpZW4gUG91bGlvdCA8c2ViYXN0aWVuQHhpbWlhbi5jb20+DQovLw0KLy8gKEMpIDIwMDIsIDIwMDMgTW90dXMgVGVjaG5vbG9naWVzIEluYy4gKGh0dHA6Ly93d3cubW90dXMuY29tKQ0KLy8gQ29weXJpZ2h0IChDKSAyMDA0LTIwMDUgTm92ZWxsLCBJbmMgKGh0dHA6Ly93d3cubm92ZWxsLmNvbSkNCi8vDQovLyBMaWNlbnNlZCB0byB0aGUgLk5FVCBGb3VuZGF0aW9uIHVuZGVyIG9uZSBvciBtb3JlIGFncmVlbWVudHMuDQovLyBTZWUgdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcHJvamVjdCByb290IGZvciBtb3JlIGluZm9ybWF0aW9uLg0KDQp1c2luZyBTeXN0ZW0uSU87DQp1c2luZyBTeXN0ZW0uVGV4dDsNCnVzaW5nIFN5c3RlbS5YbWw7DQp1c2luZyBTeXN0ZW0uWG1sLlJlc29sdmVyczsNCnVzaW5nIFh1bml0Ow0KDQpuYW1lc3BhY2UgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5YbWwuVGVzdHMNCnsNCg0KICAgIC8vIE5vdGU6IEdldElubmVyWG1sIGlzIHByb3RlY3RlZCBpbiBYbWxEc2lnQzE0TldpdGhDb21tZW50c1RyYW5zZm9ybQ0KICAgIC8vIG1ha2luZyBpdCBkaWZmaWN1bHQgdG8gdGVzdCBwcm9wZXJseS4gVGhpcyBjbGFzcyAib3BlbiBpdCB1cCIgOi0pDQogICAgcHVibGljIGNsYXNzIFVucHJvdGVjdGVkWG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0gOiBYbWxEc2lnQzE0TldpdGhDb21tZW50c1RyYW5zZm9ybQ0KICAgIHsNCiAgICAgICAgcHVibGljIFhtbE5vZGVMaXN0IFVucHJvdGVjdGVkR2V0SW5uZXJYbWwoKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gYmFzZS5HZXRJbm5lclhtbCgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGNsYXNzIFhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtVGVzdA0KICAgIHsNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIENvbnN0cnVjdG9yKCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0geG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0gPSBuZXcgWG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtLkNvbnRleHQpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSNXaXRoQ29tbWVudHMiLCB4bWxEc2lnQzE0TldpdGhDb21tZW50c1RyYW5zZm9ybS5BbGdvcml0aG0pOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKG5ld1tdIHsgdHlwZW9mKFN0cmVhbSksIHR5cGVvZihYbWxEb2N1bWVudCksIHR5cGVvZihYbWxOb2RlTGlzdCkgfSwgeG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0uSW5wdXRUeXBlcyk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwobmV3W10geyB0eXBlb2YoU3RyZWFtKSB9LCB4bWxEc2lnQzE0TldpdGhDb21tZW50c1RyYW5zZm9ybS5PdXRwdXRUeXBlcyk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgR2V0SW5uZXJYbWwoKQ0KICAgICAgICB7DQogICAgICAgICAgICBVbnByb3RlY3RlZFhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtIHRyYW5zZm9ybSA9IG5ldyBVbnByb3RlY3RlZFhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtKCk7DQogICAgICAgICAgICBYbWxOb2RlTGlzdCB4bmwgPSB0cmFuc2Zvcm0uVW5wcm90ZWN0ZWRHZXRJbm5lclhtbCgpOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwoeG5sKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtUaGVvcnldDQogICAgICAgIFtJbmxpbmVEYXRhKCIiKV0NCiAgICAgICAgW0lubGluZURhdGEobmV3IGJ5dGVbXSB7IDB4QkEsIDB4RCB9KV0NCiAgICAgICAgcHVibGljIHZvaWQgTG9hZElucHV0X1Vuc3VwcG9ydGVkVHlwZShvYmplY3QgaW5wdXQpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtIHhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtID0gbmV3IFhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtKCk7DQogICAgICAgICAgICBBc3NlcnRFeHRlbnNpb25zLlRocm93czxBcmd1bWVudEV4Y2VwdGlvbj4oIm9iaiIsICgpID0+IHhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtLkxvYWRJbnB1dChpbnB1dCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgW1RoZW9yeV0NCiAgICAgICAgW0lubGluZURhdGEodHlwZW9mKFhtbERvY3VtZW50KSldDQogICAgICAgIFtJbmxpbmVEYXRhKHR5cGVvZihYbWxOb2RlTGlzdCkpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBHZXRPdXRwdXRfVW5zdXBwb3J0ZWRUeXBlKFR5cGUgdHlwZSkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0geG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0gPSBuZXcgWG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIEFzc2VydEV4dGVuc2lvbnMuVGhyb3dzPEFyZ3VtZW50RXhjZXB0aW9uPigidHlwZSIsICgpID0+IHhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtLkdldE91dHB1dCh0eXBlKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQzE0TlNwZWNFeGFtcGxlMSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbFByZWxvYWRlZFJlc29sdmVyIHJlc29sdmVyID0gbmV3IFhtbFByZWxvYWRlZFJlc29sdmVyKCk7DQogICAgICAgICAgICByZXNvbHZlci5BZGQoVGVzdEhlbHBlcnMuVG9VcmkoIndvcmxkLmR0ZCIpLCAiIik7DQogICAgICAgICAgICBzdHJpbmcgcmVzID0gVGVzdEhlbHBlcnMuRXhlY3V0ZVRyYW5zZm9ybShDMTROU3BlY0V4YW1wbGUxSW5wdXQsIG5ldyBYbWxEc2lnQzE0TldpdGhDb21tZW50c1RyYW5zZm9ybSgpLCBFbmNvZGluZy5VVEY4LCByZXNvbHZlcik7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoQzE0TlNwZWNFeGFtcGxlMU91dHB1dCwgcmVzKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtUaGVvcnldDQogICAgICAgIFtJbmxpbmVEYXRhKEMxNE5TcGVjRXhhbXBsZTJJbnB1dCwgQzE0TlNwZWNFeGFtcGxlMk91dHB1dCldDQogICAgICAgIFtJbmxpbmVEYXRhKEMxNE5TcGVjRXhhbXBsZTNJbnB1dCwgQzE0TlNwZWNFeGFtcGxlM091dHB1dCldDQogICAgICAgIFtJbmxpbmVEYXRhKEMxNE5TcGVjRXhhbXBsZTRJbnB1dCwgQzE0TlNwZWNFeGFtcGxlNE91dHB1dCldDQogICAgICAgIHB1YmxpYyB2b2lkIEMxNE5TcGVjRXhhbXBsZShzdHJpbmcgaW5wdXQsIHN0cmluZyBleHBlY3RlZE91dHB1dCkNCiAgICAgICAgew0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKGV4cGVjdGVkT3V0cHV0LCBFeGVjdXRlWG1sRFNpZ0MxNE5UcmFuc2Zvcm0oaW5wdXQpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBDMTROU3BlY0V4YW1wbGU1KCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sUHJlbG9hZGVkUmVzb2x2ZXIgcmVzb2x2ZXIgPSBuZXcgWG1sUHJlbG9hZGVkUmVzb2x2ZXIoKTsNCiAgICAgICAgICAgIHJlc29sdmVyLkFkZChUZXN0SGVscGVycy5Ub1VyaSgiZG9jLnR4dCIpLCAid29ybGQiKTsNCiAgICAgICAgICAgIHN0cmluZyBpbnB1dCA9IEMxNE5TcGVjRXhhbXBsZTVJbnB1dDsNCiAgICAgICAgICAgIHN0cmluZyByZXN1bHQgPSBFeGVjdXRlWG1sRFNpZ0MxNE5UcmFuc2Zvcm0oaW5wdXQsIEVuY29kaW5nLlVURjgsIHJlc29sdmVyKTsNCiAgICAgICAgICAgIHN0cmluZyBleHBlY3RlZFJlc3VsdCA9IEMxNE5TcGVjRXhhbXBsZTVPdXRwdXQ7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoZXhwZWN0ZWRSZXN1bHQsIHJlc3VsdCk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQzE0TlNwZWNFeGFtcGxlNigpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyByZXMgPSBFeGVjdXRlWG1sRFNpZ0MxNE5UcmFuc2Zvcm0oQzE0TlNwZWNFeGFtcGxlNklucHV0LCBFbmNvZGluZy5HZXRFbmNvZGluZygiSVNPLTg4NTktMSIpKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChDMTROU3BlY0V4YW1wbGU2T3V0cHV0LCByZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgRXhlY3V0ZVhtbERTaWdDMTROVHJhbnNmb3JtKHN0cmluZyBpbnB1dFhtbCwgRW5jb2RpbmcgZW5jb2RpbmcgPSBudWxsLCBYbWxSZXNvbHZlciByZXNvbHZlciA9IG51bGwpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLlhtbFJlc29sdmVyID0gcmVzb2x2ZXI7DQogICAgICAgICAgICBkb2MuUHJlc2VydmVXaGl0ZXNwYWNlID0gdHJ1ZTsNCiAgICAgICAgICAgIGRvYy5Mb2FkWG1sKGlucHV0WG1sKTsNCg0KICAgICAgICAgICAgRW5jb2RpbmcgYWN0dWFsRW5jb2RpbmcgPSBlbmNvZGluZyA/PyBFbmNvZGluZy5VVEY4Ow0KICAgICAgICAgICAgYnl0ZVtdIGRhdGEgPSBhY3R1YWxFbmNvZGluZy5HZXRCeXRlcyhpbnB1dFhtbCk7DQogICAgICAgICAgICB1c2luZyAoU3RyZWFtIHN0cmVhbSA9IG5ldyBNZW1vcnlTdHJlYW0oZGF0YSkpDQogICAgICAgICAgICB1c2luZyAoWG1sUmVhZGVyIHJlYWRlciA9IFhtbFJlYWRlci5DcmVhdGUoc3RyZWFtLCBuZXcgWG1sUmVhZGVyU2V0dGluZ3MgeyBWYWxpZGF0aW9uVHlwZSA9IFZhbGlkYXRpb25UeXBlLk5vbmUsIER0ZFByb2Nlc3NpbmcgPSBEdGRQcm9jZXNzaW5nLlBhcnNlLCBYbWxSZXNvbHZlciA9IHJlc29sdmVyIH0pKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGRvYy5Mb2FkKHJlYWRlcik7DQogICAgICAgICAgICAgICAgWG1sRHNpZ0MxNE5XaXRoQ29tbWVudHNUcmFuc2Zvcm0gdHJhbnNmb3JtID0gbmV3IFhtbERzaWdDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtKCk7DQogICAgICAgICAgICAgICAgdHJhbnNmb3JtLkxvYWRJbnB1dChkb2MpOw0KICAgICAgICAgICAgICAgIHJldHVybiBUZXN0SGVscGVycy5TdHJlYW1Ub1N0cmluZygoU3RyZWFtKSB0cmFuc2Zvcm0uR2V0T3V0cHV0KCksIGFjdHVhbEVuY29kaW5nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vDQogICAgICAgIC8vIEV4YW1wbGUgMSBmcm9tIEMxNE4gc3BlYyAtIFBJcywgQ29tbWVudHMsIGFuZCBPdXRzaWRlIG9mIERvY3VtZW50IEVsZW1lbnQ6IA0KICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi94bWwtYzE0biNFeGFtcGxlLU91dHNpZGVEb2MNCiAgICAgICAgLy8NCiAgICAgICAgc3RhdGljIHN0cmluZyBDMTROU3BlY0V4YW1wbGUxSW5wdXQgPT4NCiAgICAgICAgICAgICI8P3htbCB2ZXJzaW9uPVwiMS4wXCI/PlxuIiArDQogICAgICAgICAgICAgICAgIlxuIiArDQogICAgICAgICAgICAgICAgIjw/eG1sLXN0eWxlc2hlZXQgICBocmVmPVwiZG9jLnhzbFwiXG4iICsNCiAgICAgICAgICAgICAgICAiICAgdHlwZT1cInRleHQveHNsXCIgICA/PlxuIiArDQogICAgICAgICAgICAgICAgIlxuIiArDQogICAgICAgICAgICAgICAgIjwhRE9DVFlQRSBkb2MgU1lTVEVNIFwid29ybGQuZHRkXCI+XG4iICsNCiAgICAgICAgICAgICAgICAiXG4iICsNCiAgICAgICAgICAgICAgICAiPGRvYz5IZWxsbywgd29ybGQhPCEtLSBDb21tZW50IDEgLS0+PC9kb2M+XG4iICsNCiAgICAgICAgICAgICAgICAiXG4iICsNCiAgICAgICAgICAgICAgICAiPD9waS13aXRob3V0LWRhdGEgICAgID8+XG5cbiIgKw0KICAgICAgICAgICAgICAgICI8IS0tIENvbW1lbnQgMiAtLT5cblxuIiArDQogICAgICAgICAgICAgICAgIjwhLS0gQ29tbWVudCAzIC0tPlxuIjsNCiAgICAgICAgc3RhdGljIHN0cmluZyBDMTROU3BlY0V4YW1wbGUxT3V0cHV0ID0+DQogICAgICAgICAgICAgICAgIjw/eG1sLXN0eWxlc2hlZXQgaHJlZj1cImRvYy54c2xcIlxuIiArDQogICAgICAgICAgICAgICAgIiAgIHR5cGU9XCJ0ZXh0L3hzbFwiICAgPz5cbiIgKw0KICAgICAgICAgICAgICAgICI8ZG9jPkhlbGxvLCB3b3JsZCE8IS0tIENvbW1lbnQgMSAtLT48L2RvYz5cbiIgKw0KICAgICAgICAgICAgICAgICI8P3BpLXdpdGhvdXQtZGF0YT8+XG4iICsNCiAgICAgICAgICAgICAgICAiPCEtLSBDb21tZW50IDIgLS0+XG4iICsNCiAgICAgICAgICAgICAgICAiPCEtLSBDb21tZW50IDMgLS0+IjsNCg0KICAgICAgICAvLw0KICAgICAgICAvLyBFeGFtcGxlIDIgZnJvbSBDMTROIHNwZWMgLSBXaGl0ZXNwYWNlIGluIERvY3VtZW50IENvbnRlbnQ6IA0KICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi94bWwtYzE0biNFeGFtcGxlLVdoaXRlc3BhY2VJbkNvbnRlbnQNCiAgICAgICAgLy8gDQogICAgICAgIGNvbnN0IHN0cmluZyBDMTROU3BlY0V4YW1wbGUySW5wdXQgPQ0KICAgICAgICAgICAgICAgICI8ZG9jPlxuIiArDQogICAgICAgICAgICAgICAgIiAgPGNsZWFuPiAgIDwvY2xlYW4+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGRpcnR5PiAgIEEgICBCICAgPC9kaXJ0eT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8bWl4ZWQ+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgQVxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgIDxjbGVhbj4gICA8L2NsZWFuPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgIEJcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICA8ZGlydHk+ICAgQSAgIEIgICA8L2RpcnR5PlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgIENcbiIgKw0KICAgICAgICAgICAgICAgICIgICA8L21peGVkPlxuIiArDQogICAgICAgICAgICAgICAgIjwvZG9jPlxuIjsNCiAgICAgICAgY29uc3Qgc3RyaW5nIEMxNE5TcGVjRXhhbXBsZTJPdXRwdXQgPQ0KICAgICAgICAgICAgICAgICI8ZG9jPlxuIiArDQogICAgICAgICAgICAgICAgIiAgPGNsZWFuPiAgIDwvY2xlYW4+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGRpcnR5PiAgIEEgICBCICAgPC9kaXJ0eT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8bWl4ZWQ+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgQVxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgIDxjbGVhbj4gICA8L2NsZWFuPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgIEJcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICA8ZGlydHk+ICAgQSAgIEIgICA8L2RpcnR5PlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgIENcbiIgKw0KICAgICAgICAgICAgICAgICIgICA8L21peGVkPlxuIiArDQogICAgICAgICAgICAgICAgIjwvZG9jPiI7DQoNCiAgICAgICAgLy8NCiAgICAgICAgLy8gRXhhbXBsZSAzIGZyb20gQzE0TiBzcGVjIC0gU3RhcnQgYW5kIEVuZCBUYWdzOiANCiAgICAgICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIveG1sLWMxNG4jRXhhbXBsZS1TRVRhZ3MNCiAgICAgICAgLy8NCiAgICAgICAgY29uc3Qgc3RyaW5nIEMxNE5TcGVjRXhhbXBsZTNJbnB1dCA9DQogICAgICAgICAgICAgICAgIjwhRE9DVFlQRSBkb2MgWzwhQVRUTElTVCBlOSBhdHRyIENEQVRBIFwiZGVmYXVsdFwiPl0+XG4iICsNCiAgICAgICAgICAgICAgICAiPGRvYz5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8ZTEgICAvPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlMiAgID48L2UyPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlMyAgICBuYW1lID0gXCJlbGVtM1wiICAgaWQ9XCJlbGVtM1wiICAgIC8+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGU0ICAgIG5hbWU9XCJlbGVtNFwiICAgaWQ9XCJlbGVtNFwiICAgID48L2U0PlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlNSBhOmF0dHI9XCJvdXRcIiBiOmF0dHI9XCJzb3J0ZWRcIiBhdHRyMj1cImFsbFwiIGF0dHI9XCJJXCdtXCJcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgeG1sbnM6Yj1cImh0dHA6Ly93d3cuaWV0Zi5vcmdcIiBcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgeG1sbnM6YT1cImh0dHA6Ly93d3cudzMub3JnXCJcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgeG1sbnM9XCJodHRwOi8vd3d3LnV2aWMuY2FcIi8+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGU2IHhtbG5zPVwiXCIgeG1sbnM6YT1cImh0dHA6Ly93d3cudzMub3JnXCI+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgIDxlNyB4bWxucz1cImh0dHA6Ly93d3cuaWV0Zi5vcmdcIj5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgICAgIDxlOCB4bWxucz1cIlwiIHhtbG5zOmE9XCJodHRwOi8vd3d3LnczLm9yZ1wiPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgICAgICAgICAgIDxlOSB4bWxucz1cIlwiIHhtbG5zOmE9XCJodHRwOi8vd3d3LmlldGYub3JnXCIvPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgICAgICAgPC9lOD5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgPC9lNz5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8L2U2PlxuIiArDQogICAgICAgICAgICAgICAgIjwvZG9jPlxuIjsNCiAgICAgICAgY29uc3Qgc3RyaW5nIEMxNE5TcGVjRXhhbXBsZTNPdXRwdXQgPQ0KICAgICAgICAgICAgICAgICI8ZG9jPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlMT48L2UxPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlMj48L2UyPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlMyBpZD1cImVsZW0zXCIgbmFtZT1cImVsZW0zXCI+PC9lMz5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8ZTQgaWQ9XCJlbGVtNFwiIG5hbWU9XCJlbGVtNFwiPjwvZTQ+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGU1IHhtbG5zPVwiaHR0cDovL3d3dy51dmljLmNhXCIgeG1sbnM6YT1cImh0dHA6Ly93d3cudzMub3JnXCIgeG1sbnM6Yj1cImh0dHA6Ly93d3cuaWV0Zi5vcmdcIiBhdHRyPVwiSVwnbVwiIGF0dHIyPVwiYWxsXCIgYjphdHRyPVwic29ydGVkXCIgYTphdHRyPVwib3V0XCI+PC9lNT5cbiIgKw0KICAgICAgICAgICAgICAgICAgICAiICAgPGU2IHhtbG5zOmE9XCJodHRwOi8vd3d3LnczLm9yZ1wiPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgICA8ZTcgeG1sbnM9XCJodHRwOi8vd3d3LmlldGYub3JnXCI+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgICAgICA8ZTggeG1sbnM9XCJcIj5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgICAgICAgICA8ZTkgeG1sbnM6YT1cImh0dHA6Ly93d3cuaWV0Zi5vcmdcIiBhdHRyPVwiZGVmYXVsdFwiPjwvZTk+XG4iICsNCiAgICAgICAgICAgICAgICAvLwkJICAgIAkgICAgIiAgICAgICAgICAgICAgIDxlOSB4bWxuczphPVwiaHR0cDovL3d3dy5pZXRmLm9yZ1wiPjwvZTk+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgICAgICA8L2U4PlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgICA8L2U3PlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDwvZTY+XG4iICsNCiAgICAgICAgICAgICAgICAiPC9kb2M+IjsNCg0KDQogICAgICAgIC8vDQogICAgICAgIC8vIEV4YW1wbGUgNCBmcm9tIEMxNE4gc3BlYyAtIENoYXJhY3RlciBNb2RpZmljYXRpb25zIGFuZCBDaGFyYWN0ZXIgUmVmZXJlbmNlczogDQogICAgICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3htbC1jMTRuI0V4YW1wbGUtQ2hhcnMNCiAgICAgICAgLy8NCiAgICAgICAgLy8gQWxla3NleTogDQogICAgICAgIC8vIFRoaXMgdGVzdCBkb2VzIG5vdCBpbmNsdWRlICJub3JtSWQiIGVsZW1lbnQNCiAgICAgICAgLy8gYmVjYXVzZSBpdCBoYXMgYW4gaW52YWxpZCBJRCBhdHRyaWJ1dGUgImlkIiB3aGljaA0KICAgICAgICAvLyBzaG91bGQgYmUgbm9ybWFsaXplZCBieSBYTUwgcGFyc2VyLiBDdXJyZW50bHkgTW9ubw0KICAgICAgICAvLyBkb2VzIG5vdCBzdXBwb3J0IHRoaXMgKHNlZSBjb21tZW50IGFmdGVyIHRoaXMgZXhhbXBsZQ0KICAgICAgICAvLyBpbiB0aGUgc3BlYykuDQogICAgICAgIGNvbnN0IHN0cmluZyBDMTROU3BlY0V4YW1wbGU0SW5wdXQgPQ0KICAgICAgICAgICAgICAgICI8IURPQ1RZUEUgZG9jIFs8IUFUVExJU1Qgbm9ybUlkIGlkIElEICNJTVBMSUVEPl0+XG4iICsNCiAgICAgICAgICAgICAgICAiPGRvYz5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8dGV4dD5GaXJzdCBsaW5lJiN4MGQ7JiMxMDtTZWNvbmQgbGluZTwvdGV4dD5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8dmFsdWU+JiN4MzI7PC92YWx1ZT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8Y29tcHV0ZT48IVtDREFUQVt2YWx1ZT5cIjBcIiAmJiB2YWx1ZTxcIjEwXCIgP1widmFsaWRcIjpcImVycm9yXCJdXT48L2NvbXB1dGU+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGNvbXB1dGUgZXhwcj1cJ3ZhbHVlPlwiMFwiICZhbXA7JmFtcDsgdmFsdWUmbHQ7XCIxMFwiID9cInZhbGlkXCI6XCJlcnJvclwiXCc+dmFsaWQ8L2NvbXB1dGU+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPG5vcm0gYXR0cj1cJyAmYXBvczsgICAmI3gyMDsmIzEzOyYjeGE7JiM5OyAgICZhcG9zOyBcJy8+XG4iICsNCiAgICAgICAgICAgICAgICAvLyAiICAgPG5vcm1JZCBpZD1cJyAmYXBvczsgICAmI3gyMDsmIzEzOyYjeGE7JiM5OyAgICZhcG9zOyBcJy8+XG4iICsNCiAgICAgICAgICAgICAgICAiPC9kb2M+XG4iOw0KICAgICAgICBjb25zdCBzdHJpbmcgQzE0TlNwZWNFeGFtcGxlNE91dHB1dCA9DQogICAgICAgICAgICAgICAgIjxkb2M+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPHRleHQ+Rmlyc3QgbGluZSYjeEQ7XG4iICsNCiAgICAgICAgICAgICAgICAiU2Vjb25kIGxpbmU8L3RleHQ+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPHZhbHVlPjI8L3ZhbHVlPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxjb21wdXRlPnZhbHVlJmd0O1wiMFwiICZhbXA7JmFtcDsgdmFsdWUmbHQ7XCIxMFwiID9cInZhbGlkXCI6XCJlcnJvclwiPC9jb21wdXRlPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxjb21wdXRlIGV4cHI9XCJ2YWx1ZT4mcXVvdDswJnF1b3Q7ICZhbXA7JmFtcDsgdmFsdWUmbHQ7JnF1b3Q7MTAmcXVvdDsgPyZxdW90O3ZhbGlkJnF1b3Q7OiZxdW90O2Vycm9yJnF1b3Q7XCI+dmFsaWQ8L2NvbXB1dGU+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPG5vcm0gYXR0cj1cIiBcJyAgICAmI3hEOyYjeEE7JiN4OTsgICBcJyBcIj48L25vcm0+XG4iICsNCiAgICAgICAgICAgICAgICAvLyAiICAgPG5vcm1JZCBpZD1cIlwnICYjeEQ7JiN4QTsmI3g5OyBcJ1wiPjwvbm9ybUlkPlxuIiArDQogICAgICAgICAgICAgICAgIjwvZG9jPiI7DQoNCiAgICAgICAgLy8NCiAgICAgICAgLy8gRXhhbXBsZSA1IGZyb20gQzE0TiBzcGVjIC0gRW50aXR5IFJlZmVyZW5jZXM6IA0KICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi94bWwtYzE0biNFeGFtcGxlLUVudGl0aWVzDQogICAgICAgIC8vDQogICAgICAgIHN0YXRpYyBzdHJpbmcgQzE0TlNwZWNFeGFtcGxlNUlucHV0ID0+DQogICAgICAgICAgICAgICAgIjwhRE9DVFlQRSBkb2MgW1xuIiArDQogICAgICAgICAgICAgICAgIjwhQVRUTElTVCBkb2MgYXR0ckV4dEVudCBFTlRJVFkgI0lNUExJRUQ+XG4iICsNCiAgICAgICAgICAgICAgICAiPCFFTlRJVFkgZW50MSBcIkhlbGxvXCI+XG4iICsNCiAgICAgICAgICAgICAgICAkIjwhRU5USVRZIGVudDIgU1lTVEVNIFwiZG9jLnR4dFwiPlxuIiArDQogICAgICAgICAgICAgICAgIjwhRU5USVRZIGVudEV4dCBTWVNURU0gXCJlYXJ0aC5naWZcIiBOREFUQSBnaWY+XG4iICsNCiAgICAgICAgICAgICAgICAiPCFOT1RBVElPTiBnaWYgU1lTVEVNIFwidmlld2dpZi5leGVcIj5cbiIgKw0KICAgICAgICAgICAgICAgICJdPlxuIiArDQogICAgICAgICAgICAgICAgIjxkb2MgYXR0ckV4dEVudD1cImVudEV4dFwiPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICZlbnQxOywgJmVudDI7IVxuIiArDQogICAgICAgICAgICAgICAgIjwvZG9jPlxuIiArDQogICAgICAgICAgICAgICAgIlxuIiArDQogICAgICAgICAgICAgICAgJCI8IS0tIExldCBkb2MudHh0IGNvbnRhaW4gXCJ3b3JsZFwiIChleGNsdWRpbmcgdGhlIHF1b3RlcykgLS0+XG4iOw0KICAgICAgICBzdGF0aWMgc3RyaW5nIEMxNE5TcGVjRXhhbXBsZTVPdXRwdXQgPT4NCiAgICAgICAgICAgICAgICAiPGRvYyBhdHRyRXh0RW50PVwiZW50RXh0XCI+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgSGVsbG8sIHdvcmxkIVxuIiArDQogICAgICAgICAgICAgICAgIjwvZG9jPlxuIiArDQogICAgICAgICAgICAgICAgJCI8IS0tIExldCBkb2MudHh0IGNvbnRhaW4gXCJ3b3JsZFwiIChleGNsdWRpbmcgdGhlIHF1b3RlcykgLS0+IjsNCg0KICAgICAgICAvLw0KICAgICAgICAvLyBFeGFtcGxlIDYgZnJvbSBDMTROIHNwZWMgLSBVVEYtOCBFbmNvZGluZzogDQogICAgICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3htbC1jMTRuI0V4YW1wbGUtVVRGOA0KICAgICAgICAvLyANCiAgICAgICAgc3RhdGljIHN0cmluZyBDMTROU3BlY0V4YW1wbGU2SW5wdXQgPQ0KICAgICAgICAgICAgICAgICI8P3htbCB2ZXJzaW9uPVwiMS4wXCIgZW5jb2Rpbmc9XCJJU08tODg1OS0xXCI/PlxuIiArDQogICAgICAgICAgICAgICAgIjxkb2M+JiMxNjk7PC9kb2M+XG4iOw0KICAgICAgICBzdGF0aWMgc3RyaW5nIEMxNE5TcGVjRXhhbXBsZTZPdXRwdXQgPQ0KICAgICAgICAgICAgICAgICI8ZG9jPlx4QzJceEE5PC9kb2M+IjsNCiAgICB9DQp9DQo="
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/XmlDsigExcC14NTransformTest.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gU2VlIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbW9yZSBpbmZvcm1hdGlvbg0KLy8NCi8vIFhtbERzaWdFeGNDMTROVHJhbnNmb3JtVGVzdC5jcyAtIFRlc3QgQ2FzZXMgZm9yIFhtbERzaWdFeGNDMTROVHJhbnNmb3JtDQovLw0KLy8gQXV0aG9yOg0KLy8gIG9yaWdpbmFsOg0KLy8JU2ViYXN0aWVuIFBvdWxpb3QgPHNlYmFzdGllbkB4aW1pYW4uY29tPg0KLy8JQWxla3NleSBTYW5pbiAoYWxla3NleUBhbGVrc2V5LmNvbSkNCi8vICB0aGlzIGZpbGU6DQovLwlBdHN1c2hpIEVub21vdG8gPGF0c3VzaGlAeGltaWFuLmNvbT4NCi8vDQovLyAoQykgMjAwMiwgMjAwMyBNb3R1cyBUZWNobm9sb2dpZXMgSW5jLiAoaHR0cDovL3d3dy5tb3R1cy5jb20pDQovLyAoQykgMjAwMyBBbGVrc2V5IFNhbmluIChhbGVrc2V5QGFsZWtzZXkuY29tKQ0KLy8gKEMpIDIwMDQgTm92ZWxsIChodHRwOi8vd3d3Lm5vdmVsbC5jb20pDQovLw0KLy8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gU2VlIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbW9yZSBpbmZvcm1hdGlvbi4NCg0KDQp1c2luZyBTeXN0ZW0uSU87DQp1c2luZyBTeXN0ZW0uVGV4dDsNCnVzaW5nIFN5c3RlbS5YbWw7DQp1c2luZyBTeXN0ZW0uWG1sLlJlc29sdmVyczsNCnVzaW5nIFh1bml0Ow0KDQpuYW1lc3BhY2UgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5YbWwuVGVzdHMNCnsNCg0KICAgIC8vIE5vdGU6IEdldElubmVyWG1sIGlzIHByb3RlY3RlZCBpbiBYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybSBtYWtpbmcgaXQNCiAgICAvLyBkaWZmaWN1bHQgdG8gdGVzdCBwcm9wZXJseS4gVGhpcyBjbGFzcyAib3BlbiBpdCB1cCIgOi0pDQogICAgcHVibGljIGNsYXNzIFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0gOiBYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybQ0KICAgIHsNCiAgICAgICAgcHVibGljIFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0oKQ0KICAgICAgICB7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgVW5wcm90ZWN0ZWRYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybShib29sIGluY2x1ZGVDb21tZW50cykNCiAgICAgICAgICAgIDogYmFzZShpbmNsdWRlQ29tbWVudHMpDQogICAgICAgIHsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBVbnByb3RlY3RlZFhtbERzaWdFeGNDMTROVHJhbnNmb3JtKHN0cmluZyBpbmNsdXNpdmVOYW1lc3BhY2VzUHJlZml4TGlzdCkNCiAgICAgICAgICAgIDogYmFzZShpbmNsdXNpdmVOYW1lc3BhY2VzUHJlZml4TGlzdCkNCiAgICAgICAgew0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0oYm9vbCBpbmNsdWRlQ29tbWVudHMsIHN0cmluZyBpbmNsdXNpdmVOYW1lc3BhY2VzUHJlZml4TGlzdCkNCiAgICAgICAgICAgIDogYmFzZShpbmNsdWRlQ29tbWVudHMsIGluY2x1c2l2ZU5hbWVzcGFjZXNQcmVmaXhMaXN0KQ0KICAgICAgICB7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgWG1sTm9kZUxpc3QgVW5wcm90ZWN0ZWRHZXRJbm5lclhtbCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBiYXNlLkdldElubmVyWG1sKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgY2xhc3MgWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm1UZXN0DQogICAgew0KDQogICAgICAgIHByb3RlY3RlZCBVbnByb3RlY3RlZFhtbERzaWdFeGNDMTROVHJhbnNmb3JtIHRyYW5zZm9ybTsNCg0KICAgICAgICBwdWJsaWMgWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm1UZXN0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgdHJhbnNmb3JtID0gbmV3IFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0oKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XSAvLyBjdG9yICgpDQogICAgICAgIHB1YmxpYyB2b2lkIENvbnN0cnVjdG9yMSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIiwgdHJhbnNmb3JtLkFsZ29yaXRobSk7DQogICAgICAgICAgICBBc3NlcnQuTnVsbCh0cmFuc2Zvcm0uSW5jbHVzaXZlTmFtZXNwYWNlc1ByZWZpeExpc3QpOw0KICAgICAgICAgICAgQ2hlY2tQcm9wZXJ0aWVzKHRyYW5zZm9ybSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0gLy8gY3RvciAoQm9vbGVhbikNCiAgICAgICAgcHVibGljIHZvaWQgQ29uc3RydWN0b3IyKCkNCiAgICAgICAgew0KICAgICAgICAgICAgdHJhbnNmb3JtID0gbmV3IFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0odHJ1ZSk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuI1dpdGhDb21tZW50cyIsIHRyYW5zZm9ybS5BbGdvcml0aG0pOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwodHJhbnNmb3JtLkluY2x1c2l2ZU5hbWVzcGFjZXNQcmVmaXhMaXN0KTsNCiAgICAgICAgICAgIENoZWNrUHJvcGVydGllcyh0cmFuc2Zvcm0pOw0KDQogICAgICAgICAgICB0cmFuc2Zvcm0gPSBuZXcgVW5wcm90ZWN0ZWRYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybShmYWxzZSk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIsIHRyYW5zZm9ybS5BbGdvcml0aG0pOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwodHJhbnNmb3JtLkluY2x1c2l2ZU5hbWVzcGFjZXNQcmVmaXhMaXN0KTsNCiAgICAgICAgICAgIENoZWNrUHJvcGVydGllcyh0cmFuc2Zvcm0pOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdIC8vIGN0b3IgKFN0cmluZykNCiAgICAgICAgcHVibGljIHZvaWQgQ29uc3RydWN0b3IzKCkNCiAgICAgICAgew0KICAgICAgICAgICAgdHJhbnNmb3JtID0gbmV3IFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0obnVsbCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIsIHRyYW5zZm9ybS5BbGdvcml0aG0pOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwodHJhbnNmb3JtLkluY2x1c2l2ZU5hbWVzcGFjZXNQcmVmaXhMaXN0KTsNCiAgICAgICAgICAgIENoZWNrUHJvcGVydGllcyh0cmFuc2Zvcm0pOw0KDQogICAgICAgICAgICB0cmFuc2Zvcm0gPSBuZXcgVW5wcm90ZWN0ZWRYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybShzdHJpbmcuRW1wdHkpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLCB0cmFuc2Zvcm0uQWxnb3JpdGhtKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChzdHJpbmcuRW1wdHksIHRyYW5zZm9ybS5JbmNsdXNpdmVOYW1lc3BhY2VzUHJlZml4TGlzdCk7DQogICAgICAgICAgICBDaGVja1Byb3BlcnRpZXModHJhbnNmb3JtKTsNCg0KICAgICAgICAgICAgdHJhbnNmb3JtID0gbmV3IFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0oIiNkZWZhdWx0IHhzZCIpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLCB0cmFuc2Zvcm0uQWxnb3JpdGhtKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiI2RlZmF1bHQgeHNkIiwgdHJhbnNmb3JtLkluY2x1c2l2ZU5hbWVzcGFjZXNQcmVmaXhMaXN0KTsNCiAgICAgICAgICAgIENoZWNrUHJvcGVydGllcyh0cmFuc2Zvcm0pOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdIC8vIGN0b3IgKEJvb2xlYW4sIFN0cmluZykNCiAgICAgICAgcHVibGljIHZvaWQgQ29uc3RydWN0b3I0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgdHJhbnNmb3JtID0gbmV3IFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0odHJ1ZSwgbnVsbCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuI1dpdGhDb21tZW50cyIsIHRyYW5zZm9ybS5BbGdvcml0aG0pOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwodHJhbnNmb3JtLkluY2x1c2l2ZU5hbWVzcGFjZXNQcmVmaXhMaXN0KTsNCiAgICAgICAgICAgIENoZWNrUHJvcGVydGllcyh0cmFuc2Zvcm0pOw0KDQogICAgICAgICAgICB0cmFuc2Zvcm0gPSBuZXcgVW5wcm90ZWN0ZWRYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybSh0cnVlLCBzdHJpbmcuRW1wdHkpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biNXaXRoQ29tbWVudHMiLCB0cmFuc2Zvcm0uQWxnb3JpdGhtKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChzdHJpbmcuRW1wdHksIHRyYW5zZm9ybS5JbmNsdXNpdmVOYW1lc3BhY2VzUHJlZml4TGlzdCk7DQogICAgICAgICAgICBDaGVja1Byb3BlcnRpZXModHJhbnNmb3JtKTsNCg0KICAgICAgICAgICAgdHJhbnNmb3JtID0gbmV3IFVucHJvdGVjdGVkWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0odHJ1ZSwgIiNkZWZhdWx0IHhzZCIpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biNXaXRoQ29tbWVudHMiLCB0cmFuc2Zvcm0uQWxnb3JpdGhtKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiI2RlZmF1bHQgeHNkIiwgdHJhbnNmb3JtLkluY2x1c2l2ZU5hbWVzcGFjZXNQcmVmaXhMaXN0KTsNCiAgICAgICAgICAgIENoZWNrUHJvcGVydGllcyh0cmFuc2Zvcm0pOw0KDQogICAgICAgICAgICB0cmFuc2Zvcm0gPSBuZXcgVW5wcm90ZWN0ZWRYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybShmYWxzZSwgbnVsbCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIsIHRyYW5zZm9ybS5BbGdvcml0aG0pOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwodHJhbnNmb3JtLkluY2x1c2l2ZU5hbWVzcGFjZXNQcmVmaXhMaXN0KTsNCiAgICAgICAgICAgIENoZWNrUHJvcGVydGllcyh0cmFuc2Zvcm0pOw0KDQogICAgICAgICAgICB0cmFuc2Zvcm0gPSBuZXcgVW5wcm90ZWN0ZWRYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybShmYWxzZSwgc3RyaW5nLkVtcHR5KTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIiwgdHJhbnNmb3JtLkFsZ29yaXRobSk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoc3RyaW5nLkVtcHR5LCB0cmFuc2Zvcm0uSW5jbHVzaXZlTmFtZXNwYWNlc1ByZWZpeExpc3QpOw0KICAgICAgICAgICAgQ2hlY2tQcm9wZXJ0aWVzKHRyYW5zZm9ybSk7DQoNCiAgICAgICAgICAgIHRyYW5zZm9ybSA9IG5ldyBVbnByb3RlY3RlZFhtbERzaWdFeGNDMTROVHJhbnNmb3JtKGZhbHNlLCAiI2RlZmF1bHQgeHNkIik7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIsIHRyYW5zZm9ybS5BbGdvcml0aG0pOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCIjZGVmYXVsdCB4c2QiLCB0cmFuc2Zvcm0uSW5jbHVzaXZlTmFtZXNwYWNlc1ByZWZpeExpc3QpOw0KICAgICAgICAgICAgQ2hlY2tQcm9wZXJ0aWVzKHRyYW5zZm9ybSk7DQogICAgICAgIH0NCg0KICAgICAgICB2b2lkIENoZWNrUHJvcGVydGllcyhYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybSB0cmFuc2Zvcm0pDQogICAgICAgIHsNCiAgICAgICAgICAgIFR5cGVbXSBpbnB1dCA9IHRyYW5zZm9ybS5JbnB1dFR5cGVzOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoKGlucHV0Lkxlbmd0aCA9PSAzKSwgIklucHV0ICMiKTsNCiAgICAgICAgICAgIC8vIGNoZWNrIHByZXNlbmNlIG9mIGV2ZXJ5IHN1cHBvcnRlZCBpbnB1dCB0eXBlcw0KICAgICAgICAgICAgYm9vbCBpc3RyZWFtID0gZmFsc2U7DQogICAgICAgICAgICBib29sIGl4bWxkb2MgPSBmYWxzZTsNCiAgICAgICAgICAgIGJvb2wgaXhtbG5sID0gZmFsc2U7DQogICAgICAgICAgICBmb3JlYWNoIChUeXBlIHQgaW4gaW5wdXQpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKHQuVG9TdHJpbmcoKSA9PSAiU3lzdGVtLklPLlN0cmVhbSIpDQogICAgICAgICAgICAgICAgICAgIGlzdHJlYW0gPSB0cnVlOw0KICAgICAgICAgICAgICAgIGlmICh0LlRvU3RyaW5nKCkgPT0gIlN5c3RlbS5YbWwuWG1sRG9jdW1lbnQiKQ0KICAgICAgICAgICAgICAgICAgICBpeG1sZG9jID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBpZiAodC5Ub1N0cmluZygpID09ICJTeXN0ZW0uWG1sLlhtbE5vZGVMaXN0IikNCiAgICAgICAgICAgICAgICAgICAgaXhtbG5sID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIEFzc2VydC5UcnVlKGlzdHJlYW0sICJJbnB1dCBTdHJlYW0iKTsNCiAgICAgICAgICAgIEFzc2VydC5UcnVlKGl4bWxkb2MsICJJbnB1dCBYbWxEb2N1bWVudCIpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoaXhtbG5sLCAiSW5wdXQgWG1sTm9kZUxpc3QiKTsNCg0KICAgICAgICAgICAgVHlwZVtdIG91dHB1dCA9IHRyYW5zZm9ybS5PdXRwdXRUeXBlczsNCiAgICAgICAgICAgIEFzc2VydC5UcnVlKChvdXRwdXQuTGVuZ3RoID09IDEpLCAiT3V0cHV0ICMiKTsNCiAgICAgICAgICAgIC8vIGNoZWNrIHByZXNlbmNlIG9mIGV2ZXJ5IHN1cHBvcnRlZCBvdXRwdXQgdHlwZXMNCiAgICAgICAgICAgIGJvb2wgb3N0cmVhbSA9IGZhbHNlOw0KICAgICAgICAgICAgZm9yZWFjaCAoVHlwZSB0IGluIG91dHB1dCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAodC5Ub1N0cmluZygpID09ICJTeXN0ZW0uSU8uU3RyZWFtIikNCiAgICAgICAgICAgICAgICAgICAgb3N0cmVhbSA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZShvc3RyZWFtLCAiT3V0cHV0IFN0cmVhbSIpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIFR5cGVzKCkNCiAgICAgICAgew0KICAgICAgICAgICAgVHlwZVtdIGlucHV0ID0gdHJhbnNmb3JtLklucHV0VHlwZXM7DQogICAgICAgICAgICBpbnB1dFswXSA9IG51bGw7DQogICAgICAgICAgICBpbnB1dFsxXSA9IG51bGw7DQogICAgICAgICAgICBpbnB1dFsyXSA9IG51bGw7DQogICAgICAgICAgICAvLyBwcm9wZXJ0eSBkb2VzIG5vdCByZXR1cm4gYSBjbG9uZQ0KICAgICAgICAgICAgZm9yZWFjaCAoVHlwZSB0IGluIHRyYW5zZm9ybS5JbnB1dFR5cGVzKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIEFzc2VydC5OdWxsKHQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8gaXQncyBub3QgYSBzdGF0aWMgYXJyYXkNCiAgICAgICAgICAgIFhtbERzaWdFeGNDMTROVHJhbnNmb3JtIHQyID0gbmV3IFhtbERzaWdFeGNDMTROVHJhbnNmb3JtKCk7DQogICAgICAgICAgICBmb3JlYWNoIChUeXBlIHQgaW4gdDIuSW5wdXRUeXBlcykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBBc3NlcnQuTm90TnVsbCh0KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBHZXRJbm5lclhtbCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbE5vZGVMaXN0IHhubCA9IHRyYW5zZm9ybS5VbnByb3RlY3RlZEdldElubmVyWG1sKCk7DQogICAgICAgICAgICBBc3NlcnQuTnVsbCh4bmwpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgU3RyZWFtMlN0cmluZyhTdHJlYW0gcykNCiAgICAgICAgew0KICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7DQogICAgICAgICAgICBpbnQgYiA9IHMuUmVhZEJ5dGUoKTsNCiAgICAgICAgICAgIHdoaWxlIChiICE9IC0xKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHNiLkFwcGVuZChDb252ZXJ0LlRvQ2hhcihiKSk7DQogICAgICAgICAgICAgICAgYiA9IHMuUmVhZEJ5dGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBzYi5Ub1N0cmluZygpOw0KICAgICAgICB9DQoNCiAgICAgICAgc3RhdGljIHN0cmluZyB4bWwgPSAiPFRlc3QgIGF0dHJpYj0nYXQgJyB4bWxucz1cImh0dHA6Ly93d3cuZ28tbW9uby5jb20vXCIgPiBcclxuICYjeEQ7IDxUb3RvLz4gdGV4dCAmYW1wOyA8L1Rlc3QgICA+IjsNCiAgICAgICAgLy8gR09PRCBmb3IgU3RyZWFtIGlucHV0DQogICAgICAgIHN0YXRpYyBzdHJpbmcgYzE0eG1sMiA9ICI8VGVzdCB4bWxucz1cImh0dHA6Ly93d3cuZ28tbW9uby5jb20vXCIgYXR0cmliPVwiYXQgXCI+IFxuICYjeEQ7IDxUb3RvPjwvVG90bz4gdGV4dCAmYW1wOyA8L1Rlc3Q+IjsNCiAgICAgICAgLy8gR09PRCBmb3IgWG1sRG9jdW1lbnQgaW5wdXQuIFRoZSBkaWZmZXJlbmNlIGlzIGJlY2F1c2Ugb25jZQ0KICAgICAgICAvLyB4bWwgc3RyaW5nIGlzIGxvYWRlZCB0byBYbWxEb2N1bWVudCwgdGhlcmUgaXMgbm8gZGlmZmVyZW5jZQ0KICAgICAgICAvLyBiZXR3ZWVuIFxyIGFuZCAmI3hEOywgc28gZXZlcnkgXHIgbXVzdCBiZSBoYW5kbGVkIGFzICYjeEQ7Lg0KICAgICAgICBzdGF0aWMgc3RyaW5nIGMxNHhtbDMgPSAiPFRlc3QgeG1sbnM9XCJodHRwOi8vd3d3LmdvLW1vbm8uY29tL1wiIGF0dHJpYj1cImF0IFwiPiAmI3hEO1xuICYjeEQ7IDxUb3RvPjwvVG90bz4gdGV4dCAmYW1wOyA8L1Rlc3Q+IjsNCg0KICAgICAgICBwcml2YXRlIFhtbERvY3VtZW50IEdldERvYygpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLlByZXNlcnZlV2hpdGVzcGFjZSA9IHRydWU7DQogICAgICAgICAgICBkb2MuTG9hZFhtbCh4bWwpOw0KICAgICAgICAgICAgcmV0dXJuIGRvYzsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBMb2FkSW5wdXRBc1htbERvY3VtZW50KCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gR2V0RG9jKCk7DQogICAgICAgICAgICB0cmFuc2Zvcm0uTG9hZElucHV0KGRvYyk7DQogICAgICAgICAgICBTdHJlYW0gcyA9IChTdHJlYW0pdHJhbnNmb3JtLkdldE91dHB1dCgpOw0KICAgICAgICAgICAgc3RyaW5nIG91dHB1dCA9IFN0cmVhbTJTdHJpbmcocyk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoYzE0eG1sMywgb3V0cHV0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0KFNraXAgPSAiaHR0cHM6Ly9naXRodWIuY29tL2RvdG5ldC9jb3JlZngvaXNzdWVzLzE2Njg1IildDQogICAgICAgIC8vIHNlZSBMb2FkSW5wdXRBc1htbE5vZGVMaXN0MiBkZXNjcmlwdGlvbg0KICAgICAgICBwdWJsaWMgdm9pZCBMb2FkSW5wdXRBc1htbE5vZGVMaXN0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gR2V0RG9jKCk7DQogICAgICAgICAgICAvLyBBcmd1bWVudCBsaXN0IGp1c3QgY29udGFpbnMgZWxlbWVudCBUZXN0Lg0KICAgICAgICAgICAgdHJhbnNmb3JtLkxvYWRJbnB1dChkb2MuQ2hpbGROb2Rlcyk7DQogICAgICAgICAgICBTdHJlYW0gcyA9IChTdHJlYW0pdHJhbnNmb3JtLkdldE91dHB1dCgpOw0KICAgICAgICAgICAgc3RyaW5nIG91dHB1dCA9IFN0cmVhbTJTdHJpbmcocyk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoIjxUZXN0PjwvVGVzdD4iLCBvdXRwdXQpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3QoU2tpcCA9ICJodHRwczovL2dpdGh1Yi5jb20vZG90bmV0L2NvcmVmeC9pc3N1ZXMvMTY2ODUiKV0NCiAgICAgICAgLy8gTVMgaGFzIGEgYnVnIHRoYXQgdGhvc2UgbmFtZXNwYWNlIGRlY2xhcmF0aW9uIG5vZGVzIGluDQogICAgICAgIC8vIHRoZSBub2RlLXNldCBhcmUgd3JpdHRlbiB0byBvdXRwdXQuIFJlbGF0ZWQgc3BlYyBzZWN0aW9uIGlzOg0KICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSNQcm9jZXNzaW5nTW9kZWwNCiAgICAgICAgcHVibGljIHZvaWQgTG9hZElucHV0QXNYbWxOb2RlTGlzdDIoKQ0KICAgICAgICB7DQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBHZXREb2MoKTsNCiAgICAgICAgICAgIHRyYW5zZm9ybS5Mb2FkSW5wdXQoZG9jLlNlbGVjdE5vZGVzKCIvLyoiKSk7DQogICAgICAgICAgICBTdHJlYW0gcyA9IChTdHJlYW0pdHJhbnNmb3JtLkdldE91dHB1dCgpOw0KICAgICAgICAgICAgc3RyaW5nIG91dHB1dCA9IFN0cmVhbTJTdHJpbmcocyk7DQogICAgICAgICAgICBzdHJpbmcgZXhwZWN0ZWQgPSBAIjxUZXN0PjxUb3RvPjwvVG90bz48L1Rlc3Q+IjsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChleHBlY3RlZCwgb3V0cHV0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBMb2FkSW5wdXRBc1N0cmVhbSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIE1lbW9yeVN0cmVhbSBtcyA9IG5ldyBNZW1vcnlTdHJlYW0oKTsNCiAgICAgICAgICAgIGJ5dGVbXSB4ID0gRW5jb2RpbmcuQVNDSUkuR2V0Qnl0ZXMoeG1sKTsNCiAgICAgICAgICAgIG1zLldyaXRlKHgsIDAsIHguTGVuZ3RoKTsNCiAgICAgICAgICAgIG1zLlBvc2l0aW9uID0gMDsNCiAgICAgICAgICAgIHRyYW5zZm9ybS5Mb2FkSW5wdXQobXMpOw0KICAgICAgICAgICAgU3RyZWFtIHMgPSAoU3RyZWFtKXRyYW5zZm9ybS5HZXRPdXRwdXQoKTsNCiAgICAgICAgICAgIHN0cmluZyBvdXRwdXQgPSBTdHJlYW0yU3RyaW5nKHMpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKGMxNHhtbDIsIG91dHB1dCk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgTG9hZElucHV0V2l0aFVuc3VwcG9ydGVkVHlwZSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIGJ5dGVbXSBiYWQgPSB7IDB4QkEsIDB4RCB9Ow0KICAgICAgICAgICAgQXNzZXJ0RXh0ZW5zaW9ucy5UaHJvd3M8QXJndW1lbnRFeGNlcHRpb24+KCJvYmoiLCAoKSA9PiB0cmFuc2Zvcm0uTG9hZElucHV0KGJhZCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIFVuc3VwcG9ydGVkT3V0cHV0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBBc3NlcnRFeHRlbnNpb25zLlRocm93czxBcmd1bWVudEV4Y2VwdGlvbj4oInR5cGUiLCAoKSA9PiB0cmFuc2Zvcm0uR2V0T3V0cHV0KGRvYy5HZXRUeXBlKCkpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBFeGNDMTROU3BlY0V4YW1wbGUxKCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sUHJlbG9hZGVkUmVzb2x2ZXIgcmVzb2x2ZXIgPSBuZXcgWG1sUHJlbG9hZGVkUmVzb2x2ZXIoKTsNCiAgICAgICAgICAgIHJlc29sdmVyLkFkZChUZXN0SGVscGVycy5Ub1VyaSgiZG9jLmR0ZCIpLCAiIik7DQogICAgICAgICAgICBzdHJpbmcgcmVzID0gRXhlY3V0ZVhtbERTaWdFeGNDMTROVHJhbnNmb3JtKEV4Y0MxNE5TcGVjRXhhbXBsZTFJbnB1dCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoRXhjQzE0TlNwZWNFeGFtcGxlMU91dHB1dCwgcmVzKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBFeGNDMTROU3BlY0V4YW1wbGUyKCkNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIHJlcyA9IEV4ZWN1dGVYbWxEU2lnRXhjQzE0TlRyYW5zZm9ybShFeGNDMTROU3BlY0V4YW1wbGUySW5wdXQpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKEV4Y0MxNE5TcGVjRXhhbXBsZTJPdXRwdXQsIHJlcyk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgRXhjQzE0TlNwZWNFeGFtcGxlMygpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyByZXMgPSBFeGVjdXRlWG1sRFNpZ0V4Y0MxNE5UcmFuc2Zvcm0oRXhjQzE0TlNwZWNFeGFtcGxlM0lucHV0KTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChFeGNDMTROU3BlY0V4YW1wbGUzT3V0cHV0LCByZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIC8vCQlbSWdub3JlICgiVGhpcyB0ZXN0IHNob3VsZCBiZSBmaW5lLCBidXQgaXQgZG9lcyBub3QgcGFzcyB1bmRlciBNUy5ORVQiKV0NCiAgICAgICAgcHVibGljIHZvaWQgRXhjQzE0TlNwZWNFeGFtcGxlNCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyByZXMgPSBFeGVjdXRlWG1sRFNpZ0V4Y0MxNE5UcmFuc2Zvcm0oRXhjQzE0TlNwZWNFeGFtcGxlNElucHV0KTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChFeGNDMTROU3BlY0V4YW1wbGU0T3V0cHV0LCByZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIEV4Y0MxNE5TcGVjRXhhbXBsZTUoKQ0KICAgICAgICB7DQogICAgICAgICAgICBYbWxQcmVsb2FkZWRSZXNvbHZlciByZXNvbHZlciA9IG5ldyBYbWxQcmVsb2FkZWRSZXNvbHZlcigpOw0KICAgICAgICAgICAgcmVzb2x2ZXIuQWRkKFRlc3RIZWxwZXJzLlRvVXJpKCJkb2MudHh0IiksICJ3b3JsZCIpOw0KICAgICAgICAgICAgc3RyaW5nIGlucHV0ID0gRXhjQzE0TlNwZWNFeGFtcGxlNUlucHV0Ow0KICAgICAgICAgICAgc3RyaW5nIHJlcyA9IEV4ZWN1dGVYbWxEU2lnRXhjQzE0TlRyYW5zZm9ybShpbnB1dCwgcmVzb2x2ZXIpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKEV4Y0MxNE5TcGVjRXhhbXBsZTVPdXRwdXQsIHJlcyk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgRXhjQzE0TlNwZWNFeGFtcGxlNigpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyByZXMgPSBFeGVjdXRlWG1sRFNpZ0V4Y0MxNE5UcmFuc2Zvcm0oRXhjQzE0TlNwZWNFeGFtcGxlNklucHV0KTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChFeGNDMTROU3BlY0V4YW1wbGU2T3V0cHV0LCByZXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgRXhlY3V0ZVhtbERTaWdFeGNDMTROVHJhbnNmb3JtKHN0cmluZyBJbnB1dFhtbCwgWG1sUmVzb2x2ZXIgcmVzb2x2ZXIgPSBudWxsKQ0KICAgICAgICB7DQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBuZXcgWG1sRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIGRvYy5YbWxSZXNvbHZlciA9IHJlc29sdmVyOw0KICAgICAgICAgICAgZG9jLlByZXNlcnZlV2hpdGVzcGFjZSA9IHRydWU7DQogICAgICAgICAgICBkb2MuTG9hZFhtbChJbnB1dFhtbCk7DQoNCiAgICAgICAgICAgIC8vIFRlc3RpbmcgZGVmYXVsdCBhdHRyaWJ1dGUgc3VwcG9ydCB3aXRoDQogICAgICAgICAgICAvLyB2cmVhZGVyLlZhbGlkYXRpb25UeXBlID0gVmFsaWRhdGlvblR5cGUuTm9uZS4NCiAgICAgICAgICAgIC8vDQogICAgICAgICAgICBVVEY4RW5jb2RpbmcgdXRmOCA9IG5ldyBVVEY4RW5jb2RpbmcoKTsNCiAgICAgICAgICAgIGJ5dGVbXSBkYXRhID0gdXRmOC5HZXRCeXRlcyhJbnB1dFhtbC5Ub1N0cmluZygpKTsNCiAgICAgICAgICAgIFN0cmVhbSBzdHJlYW0gPSBuZXcgTWVtb3J5U3RyZWFtKGRhdGEpOw0KICAgICAgICAgICAgdmFyIHNldHRpbmdzID0gbmV3IFhtbFJlYWRlclNldHRpbmdzDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgVmFsaWRhdGlvblR5cGUgPSBWYWxpZGF0aW9uVHlwZS5Ob25lLA0KICAgICAgICAgICAgICAgIER0ZFByb2Nlc3NpbmcgPSBEdGRQcm9jZXNzaW5nLlBhcnNlLA0KICAgICAgICAgICAgICAgIFhtbFJlc29sdmVyID0gcmVzb2x2ZXINCiAgICAgICAgICAgIH07DQogICAgICAgICAgICB1c2luZyAoWG1sUmVhZGVyIHJlYWRlciA9IFhtbFJlYWRlci5DcmVhdGUoc3RyZWFtLCBzZXR0aW5ncykpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZG9jLkxvYWQocmVhZGVyKTsNCiAgICAgICAgICAgICAgICB0cmFuc2Zvcm0uTG9hZElucHV0KGRvYyk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFN0cmVhbTJTdHJpbmcoKFN0cmVhbSkgdHJhbnNmb3JtLkdldE91dHB1dCgpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vDQogICAgICAgIC8vIEV4YW1wbGUgMSBmcm9tIEV4Y0MxNE4gc3BlYyAtIFBJcywgQ29tbWVudHMsIGFuZCBPdXRzaWRlIG9mIERvY3VtZW50IEVsZW1lbnQ6IA0KICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi94bWwtYzE0biNFeGFtcGxlLU91dHNpZGVEb2MNCiAgICAgICAgLy8gDQogICAgICAgIC8vIEFsZWtzZXk6IA0KICAgICAgICAvLyByZW1vdmVkIHJlZmVyZW5jZSB0byBhbiBlbXB0eSBleHRlcm5hbCBEVEQNCiAgICAgICAgLy8NCiAgICAgICAgc3RhdGljIHN0cmluZyBFeGNDMTROU3BlY0V4YW1wbGUxSW5wdXQgPQ0KICAgICAgICAgICAgICAgICI8P3htbCB2ZXJzaW9uPVwiMS4wXCI/PlxuIiArDQogICAgICAgICAgICAgICAgIlxuIiArDQogICAgICAgICAgICAgICAgIjw/eG1sLXN0eWxlc2hlZXQgICBocmVmPVwiZG9jLnhzbFwiXG4iICsNCiAgICAgICAgICAgICAgICAiICAgdHlwZT1cInRleHQveHNsXCIgICA/PlxuIiArDQogICAgICAgICAgICAgICAgIlxuIiArDQogICAgICAgICAgICAgICAgIjwhRE9DVFlQRSBkb2MgU1lTVEVNIFwiZG9jLmR0ZFwiPlxuIiArDQogICAgICAgICAgICAgICAgIlxuIiArDQogICAgICAgICAgICAgICAgIjxkb2M+SGVsbG8sIHdvcmxkITwhLS0gQ29tbWVudCAxIC0tPjwvZG9jPlxuIiArDQogICAgICAgICAgICAgICAgIlxuIiArDQogICAgICAgICAgICAgICAgIjw/cGktd2l0aG91dC1kYXRhICAgICA/PlxuXG4iICsNCiAgICAgICAgICAgICAgICAiPCEtLSBDb21tZW50IDIgLS0+XG5cbiIgKw0KICAgICAgICAgICAgICAgICI8IS0tIENvbW1lbnQgMyAtLT5cbiI7DQogICAgICAgIHN0YXRpYyBzdHJpbmcgRXhjQzE0TlNwZWNFeGFtcGxlMU91dHB1dCA9DQogICAgICAgICAgICAgICAgIjw/eG1sLXN0eWxlc2hlZXQgaHJlZj1cImRvYy54c2xcIlxuIiArDQogICAgICAgICAgICAgICAgIiAgIHR5cGU9XCJ0ZXh0L3hzbFwiICAgPz5cbiIgKw0KICAgICAgICAgICAgICAgICI8ZG9jPkhlbGxvLCB3b3JsZCE8L2RvYz5cbiIgKw0KICAgICAgICAgICAgICAgICI8P3BpLXdpdGhvdXQtZGF0YT8+IjsNCg0KICAgICAgICAvLw0KICAgICAgICAvLyBFeGFtcGxlIDIgZnJvbSBFeGNDMTROIHNwZWMgLSBXaGl0ZXNwYWNlIGluIERvY3VtZW50IENvbnRlbnQ6IA0KICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi94bWwtYzE0biNFeGFtcGxlLVdoaXRlc3BhY2VJbkNvbnRlbnQNCiAgICAgICAgLy8gDQogICAgICAgIHN0YXRpYyBzdHJpbmcgRXhjQzE0TlNwZWNFeGFtcGxlMklucHV0ID0NCiAgICAgICAgICAgICAgICAiPGRvYz5cbiIgKw0KICAgICAgICAgICAgICAgICIgIDxjbGVhbj4gICA8L2NsZWFuPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxkaXJ0eT4gICBBICAgQiAgIDwvZGlydHk+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPG1peGVkPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgIEFcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICA8Y2xlYW4+ICAgPC9jbGVhbj5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICBCXG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgPGRpcnR5PiAgIEEgICBCICAgPC9kaXJ0eT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICBDXG4iICsNCiAgICAgICAgICAgICAgICAiICAgPC9taXhlZD5cbiIgKw0KICAgICAgICAgICAgICAgICI8L2RvYz5cbiI7DQogICAgICAgIHN0YXRpYyBzdHJpbmcgRXhjQzE0TlNwZWNFeGFtcGxlMk91dHB1dCA9DQogICAgICAgICAgICAgICAgIjxkb2M+XG4iICsNCiAgICAgICAgICAgICAgICAiICA8Y2xlYW4+ICAgPC9jbGVhbj5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8ZGlydHk+ICAgQSAgIEIgICA8L2RpcnR5PlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxtaXhlZD5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICBBXG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgPGNsZWFuPiAgIDwvY2xlYW4+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgQlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgIDxkaXJ0eT4gICBBICAgQiAgIDwvZGlydHk+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgQ1xuIiArDQogICAgICAgICAgICAgICAgIiAgIDwvbWl4ZWQ+XG4iICsNCiAgICAgICAgICAgICAgICAiPC9kb2M+IjsNCg0KICAgICAgICAvLw0KICAgICAgICAvLyBFeGFtcGxlIDMgZnJvbSBFeGNDMTROIHNwZWMgLSBTdGFydCBhbmQgRW5kIFRhZ3M6IA0KICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi94bWwtYzE0biNFeGFtcGxlLVNFVGFncw0KICAgICAgICAvLw0KICAgICAgICBzdGF0aWMgc3RyaW5nIEV4Y0MxNE5TcGVjRXhhbXBsZTNJbnB1dCA9DQogICAgICAgICAgICAgICAgIjwhRE9DVFlQRSBkb2MgWzwhQVRUTElTVCBlOSBhdHRyIENEQVRBIFwiZGVmYXVsdFwiPl0+XG4iICsNCiAgICAgICAgICAgICAgICAiPGRvYz5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8ZTEgICAvPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlMiAgID48L2UyPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlMyAgICBuYW1lID0gXCJlbGVtM1wiICAgaWQ9XCJlbGVtM1wiICAgIC8+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGU0ICAgIG5hbWU9XCJlbGVtNFwiICAgaWQ9XCJlbGVtNFwiICAgID48L2U0PlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlNSBhOmF0dHI9XCJvdXRcIiBiOmF0dHI9XCJzb3J0ZWRcIiBhdHRyMj1cImFsbFwiIGF0dHI9XCJJXCdtXCJcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgeG1sbnM6Yj1cImh0dHA6Ly93d3cuaWV0Zi5vcmdcIiBcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgeG1sbnM6YT1cImh0dHA6Ly93d3cudzMub3JnXCJcbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgeG1sbnM9XCJodHRwOi8vd3d3LnV2aWMuY2FcIi8+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGU2IHhtbG5zPVwiXCIgeG1sbnM6YT1cImh0dHA6Ly93d3cudzMub3JnXCI+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgIDxlNyB4bWxucz1cImh0dHA6Ly93d3cuaWV0Zi5vcmdcIj5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgICAgIDxlOCB4bWxucz1cIlwiIHhtbG5zOmE9XCJodHRwOi8vd3d3LnczLm9yZ1wiPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgICAgICAgICAgIDxlOSB4bWxucz1cIlwiIHhtbG5zOmE9XCJodHRwOi8vd3d3LmlldGYub3JnXCIvPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgICAgICAgPC9lOD5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgPC9lNz5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8L2U2PlxuIiArDQogICAgICAgICAgICAgICAgIjwvZG9jPlxuIjsNCiAgICAgICAgc3RhdGljIHN0cmluZyBFeGNDMTROU3BlY0V4YW1wbGUzT3V0cHV0ID0NCiAgICAgICAgICAgICAgICAiPGRvYz5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8ZTE+PC9lMT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8ZTI+PC9lMj5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8ZTMgaWQ9XCJlbGVtM1wiIG5hbWU9XCJlbGVtM1wiPjwvZTM+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGU0IGlkPVwiZWxlbTRcIiBuYW1lPVwiZWxlbTRcIj48L2U0PlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxlNSB4bWxucz1cImh0dHA6Ly93d3cudXZpYy5jYVwiIHhtbG5zOmE9XCJodHRwOi8vd3d3LnczLm9yZ1wiIHhtbG5zOmI9XCJodHRwOi8vd3d3LmlldGYub3JnXCIgYXR0cj1cIklcJ21cIiBhdHRyMj1cImFsbFwiIGI6YXR0cj1cInNvcnRlZFwiIGE6YXR0cj1cIm91dFwiPjwvZTU+XG4iICsNCiAgICAgICAgICAgICAgICAgICAgIiAgIDxlNj5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgPGU3IHhtbG5zPVwiaHR0cDovL3d3dy5pZXRmLm9yZ1wiPlxuIiArDQogICAgICAgICAgICAgICAgIiAgICAgICAgICAgPGU4IHhtbG5zPVwiXCI+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgICAgICAgICAgPGU5IGF0dHI9XCJkZWZhdWx0XCI+PC9lOT5cbiIgKw0KICAgICAgICAgICAgICAgIC8vCSAgICAJICAgICAgICAiICAgICAgICAgICAgICAgPGU5IHhtbG5zOmE9XCJodHRwOi8vd3d3LmlldGYub3JnXCI+PC9lOT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAgICAgICAgIDwvZTg+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgICAgIDwvZTc+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPC9lNj5cbiIgKw0KICAgICAgICAgICAgICAgICI8L2RvYz4iOw0KDQoNCiAgICAgICAgLy8NCiAgICAgICAgLy8gRXhhbXBsZSA0IGZyb20gRXhjQzE0TiBzcGVjIC0gQ2hhcmFjdGVyIE1vZGlmaWNhdGlvbnMgYW5kIENoYXJhY3RlciBSZWZlcmVuY2VzOiANCiAgICAgICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIveG1sLWMxNG4jRXhhbXBsZS1DaGFycw0KICAgICAgICAvLw0KICAgICAgICAvLyBBbGVrc2V5OiANCiAgICAgICAgLy8gVGhpcyB0ZXN0IGRvZXMgbm90IGluY2x1ZGUgIm5vcm1JZCIgZWxlbWVudA0KICAgICAgICAvLyBiZWNhdXNlIGl0IGhhcyBhbiBpbnZhbGlkIElEIGF0dHJpYnV0ZSAiaWQiIHdoaWNoDQogICAgICAgIC8vIHNob3VsZCBiZSBub3JtYWxpemVkIGJ5IFhNTCBwYXJzZXIuIEN1cnJlbnRseSBNb25vDQogICAgICAgIC8vIGRvZXMgbm90IHN1cHBvcnQgdGhpcyAoc2VlIGNvbW1lbnQgYWZ0ZXIgdGhpcyBleGFtcGxlDQogICAgICAgIC8vIGluIHRoZSBzcGVjKS4NCiAgICAgICAgc3RhdGljIHN0cmluZyBFeGNDMTROU3BlY0V4YW1wbGU0SW5wdXQgPQ0KICAgICAgICAgICAgICAgICI8IURPQ1RZUEUgZG9jIFs8IUFUVExJU1Qgbm9ybUlkIGlkIElEICNJTVBMSUVEPl0+XG4iICsNCiAgICAgICAgICAgICAgICAiPGRvYz5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8dGV4dD5GaXJzdCBsaW5lJiN4MGQ7JiMxMDtTZWNvbmQgbGluZTwvdGV4dD5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8dmFsdWU+JiN4MzI7PC92YWx1ZT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8Y29tcHV0ZT48IVtDREFUQVt2YWx1ZT5cIjBcIiAmJiB2YWx1ZTxcIjEwXCIgP1widmFsaWRcIjpcImVycm9yXCJdXT48L2NvbXB1dGU+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPGNvbXB1dGUgZXhwcj1cJ3ZhbHVlPlwiMFwiICZhbXA7JmFtcDsgdmFsdWUmbHQ7XCIxMFwiID9cInZhbGlkXCI6XCJlcnJvclwiXCc+dmFsaWQ8L2NvbXB1dGU+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgPG5vcm0gYXR0cj1cJyAmYXBvczsgICAmI3gyMDsmIzEzOyYjeGE7JiM5OyAgICZhcG9zOyBcJy8+XG4iICsNCiAgICAgICAgICAgICAgICAvLyAiICAgPG5vcm1JZCBpZD1cJyAmYXBvczsgICAmI3gyMDsmIzEzOyYjeGE7JiM5OyAgICZhcG9zOyBcJy8+XG4iICsNCiAgICAgICAgICAgICAgICAiPC9kb2M+XG4iOw0KICAgICAgICBzdGF0aWMgc3RyaW5nIEV4Y0MxNE5TcGVjRXhhbXBsZTRPdXRwdXQgPQ0KICAgICAgICAgICAgICAgICI8ZG9jPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDx0ZXh0PkZpcnN0IGxpbmUmI3hEO1xuIiArDQogICAgICAgICAgICAgICAgIlNlY29uZCBsaW5lPC90ZXh0PlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDx2YWx1ZT4yPC92YWx1ZT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8Y29tcHV0ZT52YWx1ZSZndDtcIjBcIiAmYW1wOyZhbXA7IHZhbHVlJmx0O1wiMTBcIiA/XCJ2YWxpZFwiOlwiZXJyb3JcIjwvY29tcHV0ZT5cbiIgKw0KICAgICAgICAgICAgICAgICIgICA8Y29tcHV0ZSBleHByPVwidmFsdWU+JnF1b3Q7MCZxdW90OyAmYW1wOyZhbXA7IHZhbHVlJmx0OyZxdW90OzEwJnF1b3Q7ID8mcXVvdDt2YWxpZCZxdW90OzomcXVvdDtlcnJvciZxdW90O1wiPnZhbGlkPC9jb21wdXRlPlxuIiArDQogICAgICAgICAgICAgICAgIiAgIDxub3JtIGF0dHI9XCIgXCcgICAgJiN4RDsmI3hBOyYjeDk7ICAgXCcgXCI+PC9ub3JtPlxuIiArDQogICAgICAgICAgICAgICAgLy8gIiAgIDxub3JtSWQgaWQ9XCJcJyAmI3hEOyYjeEE7JiN4OTsgXCdcIj48L25vcm1JZD5cbiIgKw0KICAgICAgICAgICAgICAgICI8L2RvYz4iOw0KDQogICAgICAgIC8vDQogICAgICAgIC8vIEV4YW1wbGUgNSBmcm9tIEV4Y0MxNE4gc3BlYyAtIEVudGl0eSBSZWZlcmVuY2VzOiANCiAgICAgICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIveG1sLWMxNG4jRXhhbXBsZS1FbnRpdGllcw0KICAgICAgICAvLw0KICAgICAgICBzdGF0aWMgc3RyaW5nIEV4Y0MxNE5TcGVjRXhhbXBsZTVJbnB1dCA9Pg0KICAgICAgICAgICAgICAgICI8IURPQ1RZUEUgZG9jIFtcbiIgKw0KICAgICAgICAgICAgICAgICI8IUFUVExJU1QgZG9jIGF0dHJFeHRFbnQgRU5USVRZICNJTVBMSUVEPlxuIiArDQogICAgICAgICAgICAgICAgIjwhRU5USVRZIGVudDEgXCJIZWxsb1wiPlxuIiArDQogICAgICAgICAgICAgICAgJCI8IUVOVElUWSBlbnQyIFNZU1RFTSBcImRvYy50eHRcIj5cbiIgKw0KICAgICAgICAgICAgICAgICI8IUVOVElUWSBlbnRFeHQgU1lTVEVNIFwiZWFydGguZ2lmXCIgTkRBVEEgZ2lmPlxuIiArDQogICAgICAgICAgICAgICAgIjwhTk9UQVRJT04gZ2lmIFNZU1RFTSBcInZpZXdnaWYuZXhlXCI+XG4iICsNCiAgICAgICAgICAgICAgICAiXT5cbiIgKw0KICAgICAgICAgICAgICAgICI8ZG9jIGF0dHJFeHRFbnQ9XCJlbnRFeHRcIj5cbiIgKw0KICAgICAgICAgICAgICAgICIgICAmZW50MTssICZlbnQyOyFcbiIgKw0KICAgICAgICAgICAgICAgICI8L2RvYz5cbiIgKw0KICAgICAgICAgICAgICAgICJcbiIgKw0KICAgICAgICAgICAgICAgICQiPCEtLSBMZXQgZG9jLnR4dCBjb250YWluIFwid29ybGRcIiAoZXhjbHVkaW5nIHRoZSBxdW90ZXMpIC0tPlxuIjsNCiAgICAgICAgc3RhdGljIHN0cmluZyBFeGNDMTROU3BlY0V4YW1wbGU1T3V0cHV0ID0NCiAgICAgICAgICAgICAgICAiPGRvYyBhdHRyRXh0RW50PVwiZW50RXh0XCI+XG4iICsNCiAgICAgICAgICAgICAgICAiICAgSGVsbG8sIHdvcmxkIVxuIiArDQogICAgICAgICAgICAgICAgIjwvZG9jPiI7DQoNCiAgICAgICAgLy8NCiAgICAgICAgLy8gRXhhbXBsZSA2IGZyb20gRXhjQzE0TiBzcGVjIC0gVVRGLTggRW5jb2Rpbmc6IA0KICAgICAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi94bWwtYzE0biNFeGFtcGxlLVVURjgNCiAgICAgICAgLy8gDQogICAgICAgIHN0YXRpYyBzdHJpbmcgRXhjQzE0TlNwZWNFeGFtcGxlNklucHV0ID0NCiAgICAgICAgICAgICAgICAgICAgIjw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIklTTy04ODU5LTFcIj8+XG4iICsNCiAgICAgICAgICAgICAgICAgICAgIjxkb2M+JiMxNjk7PC9kb2M+XG4iOw0KICAgICAgICBzdGF0aWMgc3RyaW5nIEV4Y0MxNE5TcGVjRXhhbXBsZTZPdXRwdXQgPQ0KICAgICAgICAgICAgICAgICI8ZG9jPlx4QzJceEE5PC9kb2M+IjsNCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgU2ltcGxlTmFtZXNwYWNlUHJlZml4ZXMoKQ0KICAgICAgICB7DQogICAgICAgICAgICBzdHJpbmcgaW5wdXQgPSAiPGE6QWN0aW9uIHhtbG5zOmE9J3Vybjpmb28nPmh0dHA6Ly90ZW1wdXJpLm9yZy9JRm9vL0VjaG88L2E6QWN0aW9uPiI7DQogICAgICAgICAgICBzdHJpbmcgZXhwZWN0ZWQgPSBAIjxhOkFjdGlvbiB4bWxuczphPSIidXJuOmZvbyIiPmh0dHA6Ly90ZW1wdXJpLm9yZy9JRm9vL0VjaG88L2E6QWN0aW9uPiI7DQoNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoaW5wdXQpOw0KICAgICAgICAgICAgWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0gdCA9IG5ldyBYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybSgpOw0KICAgICAgICAgICAgdC5Mb2FkSW5wdXQoZG9jKTsNCiAgICAgICAgICAgIFN0cmVhbSBzID0gdC5HZXRPdXRwdXQoKSBhcyBTdHJlYW07DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwobmV3IFN0cmVhbVJlYWRlcihzLCBFbmNvZGluZy5VVEY4KS5SZWFkVG9FbmQoKSwgZXhwZWN0ZWQpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIEdldERpZ2VzdGVkT3V0cHV0X051bGwoKQ0KICAgICAgICB7DQogICAgICAgICAgICBBc3NlcnQuVGhyb3dzPE51bGxSZWZlcmVuY2VFeGNlcHRpb24+KCgpID0+IG5ldyBYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybSgpLkdldERpZ2VzdGVkT3V0cHV0KG51bGwpKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0K"
        },
        "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs": {
          "mimeType": "text/x-csharp",
          "contents": "Ly8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gU2VlIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbW9yZSBpbmZvcm1hdGlvbg0KLy8NCi8vIFNpZ25lZFhtbFRlc3QuY3MgLSBUZXN0IENhc2VzIGZvciBTaWduZWRYbWwNCi8vDQovLyBBdXRob3I6DQovLwlTZWJhc3RpZW4gUG91bGlvdCAgPHNlYmFzdGllbkB4aW1pYW4uY29tPg0KLy8NCi8vIChDKSAyMDAyLCAyMDAzIE1vdHVzIFRlY2hub2xvZ2llcyBJbmMuIChodHRwOi8vd3d3Lm1vdHVzLmNvbSkNCi8vIENvcHlyaWdodCAoQykgMjAwNC0yMDA1LCAyMDA4IE5vdmVsbCwgSW5jIChodHRwOi8vd3d3Lm5vdmVsbC5jb20pDQovLw0KLy8gTGljZW5zZWQgdG8gdGhlIC5ORVQgRm91bmRhdGlvbiB1bmRlciBvbmUgb3IgbW9yZSBhZ3JlZW1lbnRzLg0KLy8gU2VlIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbW9yZSBpbmZvcm1hdGlvbi4NCg0KdXNpbmcgU3lzdGVtLkdsb2JhbGl6YXRpb247DQp1c2luZyBTeXN0ZW0uSU87DQp1c2luZyBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXM7DQp1c2luZyBTeXN0ZW0uVGV4dDsNCnVzaW5nIFN5c3RlbS5YbWw7DQp1c2luZyBTeXN0ZW0uWG1sLlhQYXRoOw0KdXNpbmcgWHVuaXQ7DQoNCm5hbWVzcGFjZSBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlhtbC5UZXN0cw0Kew0KDQogICAgcHVibGljIGNsYXNzIFNpZ25lZFhtbEV4IDogU2lnbmVkWG1sDQogICAgew0KDQogICAgICAgIC8vIHJlcXVpcmVkIHRvIHRlc3QgcHJvdGVjdGVkIEdldFB1YmxpY0tleSBpbiBTaWduZWRYbWwNCiAgICAgICAgcHVibGljIEFzeW1tZXRyaWNBbGdvcml0aG0gUHVibGljR2V0UHVibGljS2V5KCkNCiAgICAgICAgew0KICAgICAgICAgICAgcmV0dXJuIGJhc2UuR2V0UHVibGljS2V5KCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgY2xhc3MgU2lnbmVkWG1sVGVzdA0KICAgIHsNCg0KICAgICAgICBwcml2YXRlIGNvbnN0IHN0cmluZyBzaWduYXR1cmUgPSAiPFNpZ25hdHVyZSB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNcIj48U2lnbmVkSW5mbz48Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNVwiIC8+PFNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjcnNhLXNoYTFcIiAvPjxSZWZlcmVuY2UgVVJJPVwiI015T2JqZWN0SWRcIj48RGlnZXN0TWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExXCIgLz48RGlnZXN0VmFsdWU+Q1RubmhqeFVRSEptRCt0MU1qVlhyT1crTUNBPTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT5kYkZ0Nlp3M3ZSK1hoN0xiTS92dWlmeUZBN2dQaC9ObERNMkdsei9TSkJzdmVJU2lldVRCcFpsay96YXZBZXVYUi9OdTBadHQ0T1A0dENPZzA5YTJSTmxyVFAwZGhrZUVmTDFqVHpwblZhTEh1UWJDaXdPV0NnYlJpZjdYdDdOMTJGdWlIWWIzQmx0UC9ZeVhTNEUxMk54bEdscW5EaUZBMXYvbWtLNStDMW89PC9TaWduYXR1cmVWYWx1ZT48S2V5SW5mbz48S2V5VmFsdWUgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjXCI+PFJTQUtleVZhbHVlPjxNb2R1bHVzPmhFZlRKTmEyaWR6MnUrZlNZRERHNEx4L3h1azRhQmJ2T1BWTnFnYzFsOVk4dDdQdCtaeUYra2tGM3VVbDhZMDcwMEJGR0FzcHJuaHdyV0VOSytQR2R0dk01Nzk2Wkt4Q0NhMG9vS2tvZmlUNDM1NUhxSzI2aHBWOGR2ajM4dnEvcmtKZTFqSFpna1RLYStjLzB2amNZWk9JL1JUL0ladjlKZlh4VldMdUx4az08L01vZHVsdXM+PEV4cG9uZW50PkVRPT08L0V4cG9uZW50PjwvUlNBS2V5VmFsdWU+PC9LZXlWYWx1ZT48L0tleUluZm8+PE9iamVjdCBJZD1cIk15T2JqZWN0SWRcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNcIj48T2JqZWN0TGlzdFRhZyB4bWxucz1cIlwiIC8+PC9PYmplY3Q+PC9TaWduYXR1cmU+IjsNCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgU3RhdGljVmFsdWVzKCkNCiAgICAgICAgew0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIsIFNpZ25lZFhtbC5YbWxEc2lnQ2Fub25pY2FsaXphdGlvblVybCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1I1dpdGhDb21tZW50cyIsIFNpZ25lZFhtbC5YbWxEc2lnQ2Fub25pY2FsaXphdGlvbldpdGhDb21tZW50c1VybCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNkc2Etc2hhMSIsIFNpZ25lZFhtbC5YbWxEc2lnRFNBVXJsKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2htYWMtc2hhMSIsIFNpZ25lZFhtbC5YbWxEc2lnSE1BQ1NIQTFVcmwpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjbWluaW1hbCIsIFNpZ25lZFhtbC5YbWxEc2lnTWluaW1hbENhbm9uaWNhbGl6YXRpb25VcmwpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIiwgU2lnbmVkWG1sLlhtbERzaWdOYW1lc3BhY2VVcmwpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjcnNhLXNoYTEiLCBTaWduZWRYbWwuWG1sRHNpZ1JTQVNIQTFVcmwpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIsIFNpZ25lZFhtbC5YbWxEc2lnU0hBMVVybCk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQ29uc3RydWN0b3JfRW1wdHkoKQ0KICAgICAgICB7DQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBuZXcgWG1sRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIGRvYy5Mb2FkWG1sKHNpZ25hdHVyZSk7DQogICAgICAgICAgICBYbWxOb2RlTGlzdCB4bmwgPSBkb2MuR2V0RWxlbWVudHNCeVRhZ05hbWUoIlNpZ25hdHVyZSIsIFNpZ25lZFhtbC5YbWxEc2lnTmFtZXNwYWNlVXJsKTsNCiAgICAgICAgICAgIFhtbEVsZW1lbnQgeGVsID0gKFhtbEVsZW1lbnQpeG5sWzBdOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgc3ggPSBuZXcgU2lnbmVkWG1sKGRvYyk7DQogICAgICAgICAgICBzeC5Mb2FkWG1sKHhlbCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZShzeC5DaGVja1NpZ25hdHVyZSgpLCAiQ2hlY2tTaWduYXR1cmUiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBDb25zdHJ1Y3Rvcl9YbWxEb2N1bWVudCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoc2lnbmF0dXJlKTsNCiAgICAgICAgICAgIFhtbE5vZGVMaXN0IHhubCA9IGRvYy5HZXRFbGVtZW50c0J5VGFnTmFtZSgiU2lnbmF0dXJlIiwgU2lnbmVkWG1sLlhtbERzaWdOYW1lc3BhY2VVcmwpOw0KICAgICAgICAgICAgWG1sRWxlbWVudCB4ZWwgPSAoWG1sRWxlbWVudCl4bmxbMF07DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzeCA9IG5ldyBTaWduZWRYbWwoZG9jKTsNCiAgICAgICAgICAgIHN4LkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZShzeC5DaGVja1NpZ25hdHVyZSgpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBDb25zdHJ1Y3Rvcl9YbWxEb2N1bWVudF9OdWxsKCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbnVsbDsNCiAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8QXJndW1lbnROdWxsRXhjZXB0aW9uPigoKSA9PiBuZXcgU2lnbmVkWG1sKGRvYykpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIENvbnN0cnVjdG9yX1htbEVsZW1lbnQoKQ0KICAgICAgICB7DQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBuZXcgWG1sRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIGRvYy5Mb2FkWG1sKHNpZ25hdHVyZSk7DQogICAgICAgICAgICBYbWxOb2RlTGlzdCB4bmwgPSBkb2MuR2V0RWxlbWVudHNCeVRhZ05hbWUoIlNpZ25hdHVyZSIsIFNpZ25lZFhtbC5YbWxEc2lnTmFtZXNwYWNlVXJsKTsNCiAgICAgICAgICAgIFhtbEVsZW1lbnQgeGVsID0gKFhtbEVsZW1lbnQpeG5sWzBdOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgc3ggPSBuZXcgU2lnbmVkWG1sKGRvYy5Eb2N1bWVudEVsZW1lbnQpOw0KICAgICAgICAgICAgc3guTG9hZFhtbCh4ZWwpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoc3guQ2hlY2tTaWduYXR1cmUoKSwgIkNoZWNrU2lnbmF0dXJlIik7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQ29uc3RydWN0b3JfWG1sRWxlbWVudF9XaXRob3V0TG9hZFhtbCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoc2lnbmF0dXJlKTsNCiAgICAgICAgICAgIFhtbE5vZGVMaXN0IHhubCA9IGRvYy5HZXRFbGVtZW50c0J5VGFnTmFtZSgiU2lnbmF0dXJlIiwgU2lnbmVkWG1sLlhtbERzaWdOYW1lc3BhY2VVcmwpOw0KICAgICAgICAgICAgWG1sRWxlbWVudCB4ZWwgPSAoWG1sRWxlbWVudCl4bmxbMF07DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzeCA9IG5ldyBTaWduZWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZSghc3guQ2hlY2tTaWduYXR1cmUoKSwgIiFDaGVja1NpZ25hdHVyZSIpOw0KICAgICAgICAgICAgLy8gU2lnbmVkWG1sIChYbWxFbGVtZW50KSAhPSBTaWduZWRYbWwgKCkgKyBMb2FkWG1sIChYbWxFbGVtZW50KQ0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIENvbnN0cnVjdG9yX1htbEVsZW1lbnRfTnVsbCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbEVsZW1lbnQgeGVsID0gbnVsbDsNCiAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8QXJndW1lbnROdWxsRXhjZXB0aW9uPigoKSA9PiBuZXcgU2lnbmVkWG1sKHhlbCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gc2FtcGxlIGZyb20gTVNETiAodXJsKQ0KICAgICAgICBwdWJsaWMgU2lnbmVkWG1sIE1TRE5TYW1wbGUoKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBDcmVhdGUgZXhhbXBsZSBkYXRhIHRvIHNpZ24uDQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2N1bWVudCA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgWG1sTm9kZSBub2RlID0gZG9jdW1lbnQuQ3JlYXRlTm9kZShYbWxOb2RlVHlwZS5FbGVtZW50LCAiIiwgIk15RWxlbWVudCIsICJzYW1wbGVzIik7DQogICAgICAgICAgICBub2RlLklubmVyVGV4dCA9ICJUaGlzIGlzIHNvbWUgdGV4dCI7DQogICAgICAgICAgICBkb2N1bWVudC5BcHBlbmRDaGlsZChub2RlKTsNCg0KICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBTaWduZWRYbWwgbWVzc2FnZS4NCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduZWRYbWwgPSBuZXcgU2lnbmVkWG1sKCk7DQoNCiAgICAgICAgICAgIC8vIENyZWF0ZSBhIGRhdGEgb2JqZWN0IHRvIGhvbGQgdGhlIGRhdGEgdG8gc2lnbi4NCiAgICAgICAgICAgIERhdGFPYmplY3QgZGF0YU9iamVjdCA9IG5ldyBEYXRhT2JqZWN0KCk7DQogICAgICAgICAgICBkYXRhT2JqZWN0LkRhdGEgPSBkb2N1bWVudC5DaGlsZE5vZGVzOw0KICAgICAgICAgICAgZGF0YU9iamVjdC5JZCA9ICJNeU9iamVjdElkIjsNCg0KICAgICAgICAgICAgLy8gQWRkIHRoZSBkYXRhIG9iamVjdCB0byB0aGUgc2lnbmF0dXJlLg0KICAgICAgICAgICAgc2lnbmVkWG1sLkFkZE9iamVjdChkYXRhT2JqZWN0KTsNCg0KICAgICAgICAgICAgLy8gQ3JlYXRlIGEgcmVmZXJlbmNlIHRvIGJlIGFibGUgdG8gcGFja2FnZSBldmVyeXRoaW5nIGludG8gdGhlDQogICAgICAgICAgICAvLyBtZXNzYWdlLg0KICAgICAgICAgICAgUmVmZXJlbmNlIHJlZmVyZW5jZSA9IG5ldyBSZWZlcmVuY2UoKTsNCiAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiI015T2JqZWN0SWQiOw0KDQogICAgICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIG1lc3NhZ2UuDQogICAgICAgICAgICBzaWduZWRYbWwuQWRkUmVmZXJlbmNlKHJlZmVyZW5jZSk7DQoNCiAgICAgICAgICAgIHJldHVybiBzaWduZWRYbWw7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgU2lnbmF0dXJlTWV0aG9kTWlzbWF0Y2goKQ0KICAgICAgICB7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbmVkWG1sID0gTVNETlNhbXBsZSgpOw0KDQogICAgICAgICAgICBSU0Ega2V5ID0gUlNBLkNyZWF0ZSgpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLlNpZ25pbmdLZXkgPSBrZXk7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmVkSW5mby5TaWduYXR1cmVNZXRob2QgPSBTaWduZWRYbWwuWG1sRHNpZ0hNQUNTSEExVXJsOw0KDQogICAgICAgICAgICAvLyBBZGQgYSBLZXlJbmZvLg0KICAgICAgICAgICAgS2V5SW5mbyBrZXlJbmZvID0gbmV3IEtleUluZm8oKTsNCiAgICAgICAgICAgIGtleUluZm8uQWRkQ2xhdXNlKG5ldyBSU0FLZXlWYWx1ZShrZXkpKTsNCiAgICAgICAgICAgIHNpZ25lZFhtbC5LZXlJbmZvID0ga2V5SW5mbzsNCg0KICAgICAgICAgICAgQXNzZXJ0Lk5vdE51bGwoc2lnbmVkWG1sLlNpZ25hdHVyZU1ldGhvZCk7DQogICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBzaWduYXR1cmUgLSBjYXVzZXMgdW5zdXBwb3J0ZWQgYWxnb3JpdGhtIGJ5IHRoZSBrZXkuDQogICAgICAgICAgICBBc3NlcnQuVGhyb3dzPENyeXB0b2dyYXBoaWNFeGNlcHRpb24+KCgpID0+IHNpZ25lZFhtbC5Db21wdXRlU2lnbmF0dXJlKCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIEFzeW1tZXRyaWNSU0FTaWduYXR1cmUoKQ0KICAgICAgICB7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbmVkWG1sID0gTVNETlNhbXBsZSgpOw0KDQogICAgICAgICAgICBSU0Ega2V5ID0gUlNBLkNyZWF0ZSgpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLlNpZ25pbmdLZXkgPSBrZXk7DQoNCiAgICAgICAgICAgIC8vIEFkZCBhIEtleUluZm8uDQogICAgICAgICAgICBLZXlJbmZvIGtleUluZm8gPSBuZXcgS2V5SW5mbygpOw0KICAgICAgICAgICAga2V5SW5mby5BZGRDbGF1c2UobmV3IFJTQUtleVZhbHVlKGtleSkpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLktleUluZm8gPSBrZXlJbmZvOw0KDQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoMSwgc2lnbmVkWG1sLktleUluZm8uQ291bnQpOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwoc2lnbmVkWG1sLlNpZ25hdHVyZUxlbmd0aCk7DQogICAgICAgICAgICBBc3NlcnQuTnVsbChzaWduZWRYbWwuU2lnbmF0dXJlTWV0aG9kKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ25lZFhtbC5TaWduYXR1cmVWYWx1ZSk7DQogICAgICAgICAgICBBc3NlcnQuTnVsbChzaWduZWRYbWwuU2lnbmluZ0tleU5hbWUpOw0KDQogICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBzaWduYXR1cmUuDQogICAgICAgICAgICBzaWduZWRYbWwuQ29tcHV0ZVNpZ25hdHVyZSgpOw0KDQogICAgICAgICAgICBBc3NlcnQuTnVsbChzaWduZWRYbWwuU2lnbmluZ0tleU5hbWUpOw0KDQogICAgICAgICAgICBpZiAoUGxhdGZvcm1EZXRlY3Rpb24uSXNGdWxsRnJhbWV3b3JrKQ0KICAgICAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3JzYS1zaGExIiwgc2lnbmVkWG1sLlNpZ25hdHVyZU1ldGhvZCk7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Iiwgc2lnbmVkWG1sLlNpZ25hdHVyZU1ldGhvZCk7DQoNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChrZXkuS2V5U2l6ZSAvIDgsIHNpZ25lZFhtbC5TaWduYXR1cmVWYWx1ZS5MZW5ndGgpOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwoc2lnbmVkWG1sLlNpZ25pbmdLZXlOYW1lKTsNCg0KICAgICAgICAgICAgLy8gR2V0IHRoZSBYTUwgcmVwcmVzZW50YXRpb24gb2YgdGhlIHNpZ25hdHVyZS4NCiAgICAgICAgICAgIFhtbEVsZW1lbnQgeG1sU2lnbmF0dXJlID0gc2lnbmVkWG1sLkdldFhtbCgpOw0KDQogICAgICAgICAgICAvLyBMQU1FU1BFQzogd2UgbXVzdCByZWxvYWQgdGhlIHNpZ25hdHVyZSBvciBpdCB3b24ndCB3b3JrDQogICAgICAgICAgICAvLyBNUyBmcmFtZXdvcmsgdGhyb3cgYSAibWFsZm9ybWVkIGVsZW1lbnQiDQogICAgICAgICAgICBTaWduZWRYbWwgdnJmeSA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIHZyZnkuTG9hZFhtbCh4bWxTaWduYXR1cmUpOw0KDQogICAgICAgICAgICAvLyBhc3NlcnQgdGhhdCB3ZSBjYW4gdmVyaWZ5IG91ciBvd24gc2lnbmF0dXJlDQogICAgICAgICAgICBBc3NlcnQuVHJ1ZSh2cmZ5LkNoZWNrU2lnbmF0dXJlKCksICJSU0EtQ29tcHV0ZS9WZXJpZnkiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFRoZSBzYW1lIGFzIE1TRE5TYW1wbGUoKSwgYnV0IGFkZGluZyBhIGZldyBhdHRyaWJ1dGVzDQogICAgICAgIHB1YmxpYyBTaWduZWRYbWwgTVNETlNhbXBsZU1peGVkQ2FzZUF0dHJpYnV0ZXMoKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBDcmVhdGUgZXhhbXBsZSBkYXRhIHRvIHNpZ24uDQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2N1bWVudCA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgWG1sTm9kZSBub2RlID0gZG9jdW1lbnQuQ3JlYXRlTm9kZShYbWxOb2RlVHlwZS5FbGVtZW50LCAiIiwgIk15RWxlbWVudCIsICJzYW1wbGVzIik7DQogICAgICAgICAgICBub2RlLklubmVyVGV4dCA9ICJUaGlzIGlzIHNvbWUgdGV4dCI7DQogICAgICAgICAgICBYbWxBdHRyaWJ1dGUgYTEgPSBkb2N1bWVudC5DcmVhdGVBdHRyaWJ1dGUoIkFhIik7DQogICAgICAgICAgICBYbWxBdHRyaWJ1dGUgYTIgPSBkb2N1bWVudC5DcmVhdGVBdHRyaWJ1dGUoIkJiIik7DQogICAgICAgICAgICBYbWxBdHRyaWJ1dGUgYTMgPSBkb2N1bWVudC5DcmVhdGVBdHRyaWJ1dGUoImFhIik7DQogICAgICAgICAgICBYbWxBdHRyaWJ1dGUgYTQgPSBkb2N1bWVudC5DcmVhdGVBdHRyaWJ1dGUoImJiIik7DQogICAgICAgICAgICBhMS5WYWx1ZSA9ICJvbmUiOw0KICAgICAgICAgICAgYTIuVmFsdWUgPSAidHdvIjsNCiAgICAgICAgICAgIGEzLlZhbHVlID0gInRocmVlIjsNCiAgICAgICAgICAgIGE0LlZhbHVlID0gImZvdXIiOw0KICAgICAgICAgICAgbm9kZS5BdHRyaWJ1dGVzLkFwcGVuZChhMSk7DQogICAgICAgICAgICBub2RlLkF0dHJpYnV0ZXMuQXBwZW5kKGEyKTsNCiAgICAgICAgICAgIG5vZGUuQXR0cmlidXRlcy5BcHBlbmQoYTMpOw0KICAgICAgICAgICAgbm9kZS5BdHRyaWJ1dGVzLkFwcGVuZChhNCk7DQogICAgICAgICAgICBkb2N1bWVudC5BcHBlbmRDaGlsZChub2RlKTsNCg0KICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBTaWduZWRYbWwgbWVzc2FnZS4NCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduZWRYbWwgPSBuZXcgU2lnbmVkWG1sKCk7DQoNCiAgICAgICAgICAgIC8vIENyZWF0ZSBhIGRhdGEgb2JqZWN0IHRvIGhvbGQgdGhlIGRhdGEgdG8gc2lnbi4NCiAgICAgICAgICAgIERhdGFPYmplY3QgZGF0YU9iamVjdCA9IG5ldyBEYXRhT2JqZWN0KCk7DQogICAgICAgICAgICBkYXRhT2JqZWN0LkRhdGEgPSBkb2N1bWVudC5DaGlsZE5vZGVzOw0KICAgICAgICAgICAgZGF0YU9iamVjdC5JZCA9ICJNeU9iamVjdElkIjsNCg0KICAgICAgICAgICAgLy8gQWRkIHRoZSBkYXRhIG9iamVjdCB0byB0aGUgc2lnbmF0dXJlLg0KICAgICAgICAgICAgc2lnbmVkWG1sLkFkZE9iamVjdChkYXRhT2JqZWN0KTsNCg0KICAgICAgICAgICAgLy8gQ3JlYXRlIGEgcmVmZXJlbmNlIHRvIGJlIGFibGUgdG8gcGFja2FnZSBldmVyeXRoaW5nIGludG8gdGhlDQogICAgICAgICAgICAvLyBtZXNzYWdlLg0KICAgICAgICAgICAgUmVmZXJlbmNlIHJlZmVyZW5jZSA9IG5ldyBSZWZlcmVuY2UoKTsNCiAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiI015T2JqZWN0SWQiOw0KDQogICAgICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIG1lc3NhZ2UuDQogICAgICAgICAgICBzaWduZWRYbWwuQWRkUmVmZXJlbmNlKHJlZmVyZW5jZSk7DQoNCiAgICAgICAgICAgIHJldHVybiBzaWduZWRYbWw7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgc3RyaW5nIEFzeW1tZXRyaWNSU0FNaXhlZENhc2VBdHRyaWJ1dGVzKCkNCiAgICAgICAgew0KICAgICAgICAgICAgU2lnbmVkWG1sIHNpZ25lZFhtbCA9IE1TRE5TYW1wbGVNaXhlZENhc2VBdHRyaWJ1dGVzKCk7DQoNCiAgICAgICAgICAgIFJTQSBrZXkgPSBSU0EuQ3JlYXRlKCk7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmluZ0tleSA9IGtleTsNCg0KICAgICAgICAgICAgLy8gQWRkIGEgS2V5SW5mby4NCiAgICAgICAgICAgIEtleUluZm8ga2V5SW5mbyA9IG5ldyBLZXlJbmZvKCk7DQogICAgICAgICAgICBrZXlJbmZvLkFkZENsYXVzZShuZXcgUlNBS2V5VmFsdWUoa2V5KSk7DQogICAgICAgICAgICBzaWduZWRYbWwuS2V5SW5mbyA9IGtleUluZm87DQoNCiAgICAgICAgICAgIC8vIENvbXB1dGUgdGhlIHNpZ25hdHVyZS4NCiAgICAgICAgICAgIHNpZ25lZFhtbC5Db21wdXRlU2lnbmF0dXJlKCk7DQoNCiAgICAgICAgICAgIC8vIEdldCB0aGUgWE1MIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBzaWduYXR1cmUuDQogICAgICAgICAgICBYbWxFbGVtZW50IHhtbFNpZ25hdHVyZSA9IHNpZ25lZFhtbC5HZXRYbWwoKTsNCg0KICAgICAgICAgICAgU3RyaW5nV3JpdGVyIHN3ID0gbmV3IFN0cmluZ1dyaXRlcigpOw0KICAgICAgICAgICAgWG1sV3JpdGVyIHcgPSBuZXcgWG1sVGV4dFdyaXRlcihzdyk7DQogICAgICAgICAgICB4bWxTaWduYXR1cmUuV3JpdGVUbyh3KTsNCiAgICAgICAgICAgIHJldHVybiBzdy5Ub1N0cmluZygpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRXhhbXBsZSBvdXRwdXQgZnJvbSBXaW5kb3dzIGZvciBBc3ltbWV0cmljUlNBTWl4ZWRDYXNlQXR0cmlidXRlcygpDQogICAgICAgIHByaXZhdGUgY29uc3Qgc3RyaW5nIEFzeW1tZXRyaWNSU0FNaXhlZENhc2VBdHRyaWJ1dGVzUmVzdWx0ID0gIjxTaWduYXR1cmUgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjXCI+PFNpZ25lZEluZm8+PENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTVcIiAvPjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3JzYS1zaGExXCIgLz48UmVmZXJlbmNlIFVSST1cIiNNeU9iamVjdElkXCI+PERpZ2VzdE1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMVwiIC8+PERpZ2VzdFZhbHVlPjBqMXhMc2VQRnR1UkhmWEVuVmRUU0xXdEFtND08L0RpZ2VzdFZhbHVlPjwvUmVmZXJlbmNlPjwvU2lnbmVkSW5mbz48U2lnbmF0dXJlVmFsdWU+aG1yRUJnbnM1WHgxNGFEaHpxT3lJaDBxTE5NVWxkdFc4K2ZOUGN2dEQvMkt0RWhOWlFHY3RuaHM5MENSYTFOWjA4VHF6VzJwVWFFd21xdk1BdEY0djhLdFd6Qy96VHVjMWpINm54UXZRU1FvMEFCaHVYZHU3L2hrblprWEo0eUtCYmRnYktqQXNLZlVMd2JXclAvUGFjTFBvWWZDTyt3WFNydCt3TE1UVFdVPTwvU2lnbmF0dXJlVmFsdWU+PEtleUluZm8+PEtleVZhbHVlPjxSU0FLZXlWYWx1ZT48TW9kdWx1cz40aC9ySERyNTRyNlNaV2sySVBDZUhYN04rd1IxemEwVkJMc2h1UzZ0cTNSU1dhcDRQWTJCTThWZGJLSDJUOVJ6eVpvaUh1ZmpuZysxc2VVeDQzMGlNc1hpc09MVWtQUCt5R3RNUU9TWjNDUUhBYStJWUErZnBsWGlwaXhJMHJWMUoxd0pOWFFtM0h4WFFxS1dwSXY1Zmt3QnRqOG8yazZDV01nUE5nRkNueGM9PC9Nb2R1bHVzPjxFeHBvbmVudD5BUUFCPC9FeHBvbmVudD48L1JTQUtleVZhbHVlPjwvS2V5VmFsdWU+PC9LZXlJbmZvPjxPYmplY3QgSWQ9XCJNeU9iamVjdElkXCI+PE15RWxlbWVudCBBYT1cIm9uZVwiIEJiPVwidHdvXCIgYWE9XCJ0aHJlZVwiIGJiPVwiZm91clwiIHhtbG5zPVwic2FtcGxlc1wiPlRoaXMgaXMgc29tZSB0ZXh0PC9NeUVsZW1lbnQ+PC9PYmplY3Q+PC9TaWduYXR1cmU+IjsNCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQXN5bW1ldHJpY1JTQU1peGVkQ2FzZUF0dHJpYnV0ZXNWZXJpZnlXaW5kb3dzKCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBkb2MuTG9hZFhtbChBc3ltbWV0cmljUlNBTWl4ZWRDYXNlQXR0cmlidXRlc1Jlc3VsdCk7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCB2MSA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIHYxLkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZSh2MS5DaGVja1NpZ25hdHVyZSgpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBbQWN0aXZlSXNzdWUoMTcwMDEsIFRlc3RQbGF0Zm9ybXMuT1NYKV0NCiAgICAgICAgcHVibGljIHZvaWQgQXN5bW1ldHJpY0RTQVNpZ25hdHVyZSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduZWRYbWwgPSBNU0ROU2FtcGxlKCk7DQoNCiAgICAgICAgICAgIERTQSBrZXkgPSBEU0EuQ3JlYXRlKCk7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmluZ0tleSA9IGtleTsNCg0KICAgICAgICAgICAgLy8gQWRkIGEgS2V5SW5mby4NCiAgICAgICAgICAgIEtleUluZm8ga2V5SW5mbyA9IG5ldyBLZXlJbmZvKCk7DQogICAgICAgICAgICBrZXlJbmZvLkFkZENsYXVzZShuZXcgRFNBS2V5VmFsdWUoa2V5KSk7DQogICAgICAgICAgICBzaWduZWRYbWwuS2V5SW5mbyA9IGtleUluZm87DQoNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgxLCBzaWduZWRYbWwuS2V5SW5mby5Db3VudCk7DQogICAgICAgICAgICBBc3NlcnQuTnVsbChzaWduZWRYbWwuU2lnbmF0dXJlTGVuZ3RoKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ25lZFhtbC5TaWduYXR1cmVNZXRob2QpOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwoc2lnbmVkWG1sLlNpZ25hdHVyZVZhbHVlKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ25lZFhtbC5TaWduaW5nS2V5TmFtZSk7DQoNCiAgICAgICAgICAgIC8vIENvbXB1dGUgdGhlIHNpZ25hdHVyZS4NCiAgICAgICAgICAgIHNpZ25lZFhtbC5Db21wdXRlU2lnbmF0dXJlKCk7DQoNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ25lZFhtbC5TaWduYXR1cmVMZW5ndGgpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKFNpZ25lZFhtbC5YbWxEc2lnRFNBVXJsLCBzaWduZWRYbWwuU2lnbmF0dXJlTWV0aG9kKTsNCiAgICAgICAgICAgIEFzc2VydC5JblJhbmdlKHNpZ25lZFhtbC5TaWduYXR1cmVWYWx1ZS5MZW5ndGgsIGxvdzogNDAsIGhpZ2g6IEludDMyLk1heFZhbHVlKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ25lZFhtbC5TaWduaW5nS2V5TmFtZSk7DQoNCiAgICAgICAgICAgIC8vIEdldCB0aGUgWE1MIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBzaWduYXR1cmUuDQogICAgICAgICAgICBYbWxFbGVtZW50IHhtbFNpZ25hdHVyZSA9IHNpZ25lZFhtbC5HZXRYbWwoKTsNCg0KICAgICAgICAgICAgLy8gTEFNRVNQRUM6IHdlIG11c3QgcmVsb2FkIHRoZSBzaWduYXR1cmUgb3IgaXQgd29uJ3Qgd29yaw0KICAgICAgICAgICAgLy8gTVMgZnJhbWV3b3JrIHRocm93IGEgIm1hbGZvcm1lZCBlbGVtZW50Ig0KICAgICAgICAgICAgU2lnbmVkWG1sIHZyZnkgPSBuZXcgU2lnbmVkWG1sKCk7DQogICAgICAgICAgICB2cmZ5LkxvYWRYbWwoeG1sU2lnbmF0dXJlKTsNCg0KICAgICAgICAgICAgLy8gYXNzZXJ0IHRoYXQgd2UgY2FuIHZlcmlmeSBvdXIgb3duIHNpZ25hdHVyZQ0KICAgICAgICAgICAgQXNzZXJ0LlRydWUodnJmeS5DaGVja1NpZ25hdHVyZSgpLCAiRFNBLUNvbXB1dGUvVmVyaWZ5Iik7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgU3ltbWV0cmljSE1BQ1NIQTFTaWduYXR1cmUoKQ0KICAgICAgICB7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbmVkWG1sID0gTVNETlNhbXBsZSgpOw0KDQogICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBzaWduYXR1cmUuDQogICAgICAgICAgICBieXRlW10gc2VjcmV0a2V5ID0gRW5jb2RpbmcuRGVmYXVsdC5HZXRCeXRlcygicGFzc3dvcmQiKTsNCiAgICAgICAgICAgIEhNQUNTSEExIGhtYWMgPSBuZXcgSE1BQ1NIQTEoc2VjcmV0a2V5KTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgwLCBzaWduZWRYbWwuS2V5SW5mby5Db3VudCk7DQogICAgICAgICAgICBBc3NlcnQuTnVsbChzaWduZWRYbWwuU2lnbmF0dXJlTGVuZ3RoKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ25lZFhtbC5TaWduYXR1cmVNZXRob2QpOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwoc2lnbmVkWG1sLlNpZ25hdHVyZVZhbHVlKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ25lZFhtbC5TaWduaW5nS2V5TmFtZSk7DQoNCiAgICAgICAgICAgIHNpZ25lZFhtbC5Db21wdXRlU2lnbmF0dXJlKGhtYWMpOw0KDQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoMCwgc2lnbmVkWG1sLktleUluZm8uQ291bnQpOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwoc2lnbmVkWG1sLlNpZ25hdHVyZUxlbmd0aCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoU2lnbmVkWG1sLlhtbERzaWdITUFDU0hBMVVybCwgc2lnbmVkWG1sLlNpZ25hdHVyZU1ldGhvZCk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoMjAsIHNpZ25lZFhtbC5TaWduYXR1cmVWYWx1ZS5MZW5ndGgpOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwoc2lnbmVkWG1sLlNpZ25pbmdLZXlOYW1lKTsNCg0KICAgICAgICAgICAgLy8gR2V0IHRoZSBYTUwgcmVwcmVzZW50YXRpb24gb2YgdGhlIHNpZ25hdHVyZS4NCiAgICAgICAgICAgIFhtbEVsZW1lbnQgeG1sU2lnbmF0dXJlID0gc2lnbmVkWG1sLkdldFhtbCgpOw0KDQogICAgICAgICAgICAvLyBMQU1FU1BFQzogd2UgbXVzdCByZWxvYWQgdGhlIHNpZ25hdHVyZSBvciBpdCB3b24ndCB3b3JrDQogICAgICAgICAgICAvLyBNUyBmcmFtZXdvcmsgdGhyb3cgYSAibWFsZm9ybWVkIGVsZW1lbnQiDQogICAgICAgICAgICBTaWduZWRYbWwgdnJmeSA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIHZyZnkuTG9hZFhtbCh4bWxTaWduYXR1cmUpOw0KDQogICAgICAgICAgICAvLyBhc3NlcnQgdGhhdCB3ZSBjYW4gdmVyaWZ5IG91ciBvd24gc2lnbmF0dXJlDQogICAgICAgICAgICBBc3NlcnQuVHJ1ZSh2cmZ5LkNoZWNrU2lnbmF0dXJlKGhtYWMpLCAiSE1BQ1NIQTEtQ29tcHV0ZS9WZXJpZnkiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFVzaW5nIGVtcHR5IGNvbnN0cnVjdG9yDQogICAgICAgIC8vIExBTUVTUEVDOiBUaGUgdHdvIG90aGVyIGNvbnN0cnVjdG9ycyBkb24ndCBzZWVtcyB0byBhcHBseSBpbiB2ZXJpZnlpbmcgc2lnbmF0dXJlcw0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQXN5bW1ldHJpY1JTQVZlcmlmeSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyB2YWx1ZSA9ICI8U2lnbmF0dXJlIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI1wiPjxTaWduZWRJbmZvPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1XCIgLz48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMVwiIC8+PFJlZmVyZW5jZSBVUkk9XCIjTXlPYmplY3RJZFwiPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTFcIiAvPjxEaWdlc3RWYWx1ZT4vVnZxNnNYRVZidFpDOEd3TnRMUW5HT3kvVkk9PC9EaWdlc3RWYWx1ZT48L1JlZmVyZW5jZT48L1NpZ25lZEluZm8+PFNpZ25hdHVyZVZhbHVlPkE2WHVFOEN5OWlPZmZSWGFXOWIwK2RVY01VSlFubG13THNpcXRRbkFEYkN0WlhuWEFhZUo2bkduUTRNbTBJR2kwQUpjNy8yQ29KUmVYbDdpVzRobHRtRmd1RzFlM25sMFZ4Q3lDVEhLR09DbzF1OFIzSytCMXJUYWVuRmJTeHM0MkVNNy9EOUtFVHNQbHpmWWZpczM2eU0zUHFhdGlDVU9zb01zQWlNR3psYz08L1NpZ25hdHVyZVZhbHVlPjxLZXlJbmZvPjxLZXlWYWx1ZSB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNcIj48UlNBS2V5VmFsdWU+PE1vZHVsdXM+dEk4UVlJcGJHL202Skx5dlArUzNYOG16Y2FBSWF5eG9teVRpbVNoOVVDcEV1Y1JuR3ZMdzBQNzN1U3ROcGlGN3dsdFRaQTFIRXN2K0hhMzlkWS8wai9XaXkzUkFvZEdEUk51S1FhbzF3dTM0YU55Ylo2NzNicmJzYkhGVWZ3L283bmxLRDJ4Tzg0ZmJhakJabUt0QkJEeTYzTkh0K1FMK2dyU3JSRVBmQ1RNPTwvTW9kdWx1cz48RXhwb25lbnQ+QVFBQjwvRXhwb25lbnQ+PC9SU0FLZXlWYWx1ZT48L0tleVZhbHVlPjwvS2V5SW5mbz48T2JqZWN0IElkPVwiTXlPYmplY3RJZFwiPjxNeUVsZW1lbnQgeG1sbnM9XCJzYW1wbGVzXCI+VGhpcyBpcyBzb21lIHRleHQ8L015RWxlbWVudD48L09iamVjdD48L1NpZ25hdHVyZT4iOw0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBkb2MuTG9hZFhtbCh2YWx1ZSk7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCB2MSA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIHYxLkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZSh2MS5DaGVja1NpZ25hdHVyZSgpLCAiUlNBLUNoZWNrU2lnbmF0dXJlKCkiKTsNCg0KICAgICAgICAgICAgU2lnbmVkWG1sIHYyID0gbmV3IFNpZ25lZFhtbCgpOw0KICAgICAgICAgICAgdjIuTG9hZFhtbChkb2MuRG9jdW1lbnRFbGVtZW50KTsNCiAgICAgICAgICAgIEFzeW1tZXRyaWNBbGdvcml0aG0ga2V5ID0gbnVsbDsNCiAgICAgICAgICAgIGJvb2wgdnJmeSA9IHYyLkNoZWNrU2lnbmF0dXJlUmV0dXJuaW5nS2V5KG91dCBrZXkpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUodnJmeSwgIlJTQS1DaGVja1NpZ25hdHVyZVJldHVybmluZ0tleSgpIik7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCB2MyA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIHYzLkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZSh2My5DaGVja1NpZ25hdHVyZShrZXkpLCAiUlNBLUNoZWNrU2lnbmF0dXJlKGtleSkiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFVzaW5nIGVtcHR5IGNvbnN0cnVjdG9yDQogICAgICAgIC8vIExBTUVTUEVDOiBUaGUgdHdvIG90aGVyIGNvbnN0cnVjdG9ycyBkb24ndCBzZWVtcyB0byBhcHBseSBpbiB2ZXJpZnlpbmcgc2lnbmF0dXJlcw0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQXN5bW1ldHJpY0RTQVZlcmlmeSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyB2YWx1ZSA9ICI8U2lnbmF0dXJlIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI1wiPjxTaWduZWRJbmZvPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1XCIgLz48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNkc2Etc2hhMVwiIC8+PFJlZmVyZW5jZSBVUkk9XCIjTXlPYmplY3RJZFwiPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTFcIiAvPjxEaWdlc3RWYWx1ZT4vVnZxNnNYRVZidFpDOEd3TnRMUW5HT3kvVkk9PC9EaWdlc3RWYWx1ZT48L1JlZmVyZW5jZT48L1NpZ25lZEluZm8+PFNpZ25hdHVyZVZhbHVlPkJZei9xUkdqR3NOMXlNRlB4V2EzYXdVWm0xeTRJL0l4T1Fyb014a090ZVJHZ2sxSEl3aFJZdz09PC9TaWduYXR1cmVWYWx1ZT48S2V5SW5mbz48S2V5VmFsdWUgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjXCI+PERTQUtleVZhbHVlPjxQPmlnbFZhWitMc1NMOFkwYURYbUZNQnd2YTN4SHFJeXByM2wvTHRxQkg5emlWMlNoMU00SlZhc0FpS3F5dFdJV3Qvcy9VazhDa2YydE8yV3cxdnNOaTFOTCtLZzlUN0ZFNTJzbjM4MC9yRjBtaXdHa1plaWR6bTc0T1doeWtiM0ord0NUWGFJd096QVdJMXlON0ZvZW9ON3d6RjEyampsU1hBWGVxUE1sVmlxaz08L1A+PFE+dTRzb3dpSk1IaWxOUm9qdGRtSXVRWTJZbkI4PTwvUT48Rz5TZG5ON2Qrd24xbitISDRIcjhNSXJ5SVJZZ2NYZGJaNVRIN2pBbnVXYzFrb3FSYzFBWmZjWUFaNlJEZitvcng2THpuMDU1RlRGaU4rMU5IUWZHVXRYSkNXVzB6ejBGVlYxTkp1eDdXUmo4dkdUbGRqSjVlZjBvQ2Vua3B3RGpjSXhXc1pnVm9idmU0R1BveU4xc0FjMXNjbmtKQjU5b3VwaWJrbG1GNHk3MkE9PC9HPjxZPlhlanpTOFo1MXlmbDB6YllueFNZWWJIcXJlU0xqTkNvR1BCL0tqTTFUT3lWNXNNanowU3RLdEdyRldyeVRXYzdFZ3ZGWTdrVXRoNGUwNFZLZjlIYks4ei9GaWZIVFhqOCtUc3pianp3OEdmSW5uQndMTit2SmdicG5qdHlwbWlJNUJtMm5MaVJiZmtkQUhQK09yS3RyL0VhdU05R1FmWXVheG0zL1ZqOEI4ND08L1k+PEo+dkd3R2c5d3F3d1dQOXhzb1BvWHU2a0hBckp0YWRpTktlOWF6QmlVeDVPYjg4M2dkNXdsS2ZFY0d1S2tCbUJ5U0diZ3d4eU9zSUJvdmQ5S2s0OGhGMDF5bWZRekFBdUhSMEVkSkVDU3NUc1RUS1ZUTFFOQlUzMk8rUFJiTFlwdjRFOGt0NnJOTDgzSkxKQ0JZPC9KPjxTZWVkPnNxem44SjZmZDJndEV5cTZZT3FpVVNIZ1BFOD08L1NlZWQ+PFBnZW5Db3VudGVyPnNRPT08L1BnZW5Db3VudGVyPjwvRFNBS2V5VmFsdWU+PC9LZXlWYWx1ZT48L0tleUluZm8+PE9iamVjdCBJZD1cIk15T2JqZWN0SWRcIj48TXlFbGVtZW50IHhtbG5zPVwic2FtcGxlc1wiPlRoaXMgaXMgc29tZSB0ZXh0PC9NeUVsZW1lbnQ+PC9PYmplY3Q+PC9TaWduYXR1cmU+IjsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwodmFsdWUpOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgdjEgPSBuZXcgU2lnbmVkWG1sKCk7DQogICAgICAgICAgICB2MS5Mb2FkWG1sKGRvYy5Eb2N1bWVudEVsZW1lbnQpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUodjEuQ2hlY2tTaWduYXR1cmUoKSwgIkRTQS1DaGVja1NpZ25hdHVyZSgpIik7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCB2MiA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIHYyLkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQogICAgICAgICAgICBBc3ltbWV0cmljQWxnb3JpdGhtIGtleSA9IG51bGw7DQogICAgICAgICAgICBib29sIHZyZnkgPSB2Mi5DaGVja1NpZ25hdHVyZVJldHVybmluZ0tleShvdXQga2V5KTsNCiAgICAgICAgICAgIEFzc2VydC5UcnVlKHZyZnksICJEU0EtQ2hlY2tTaWduYXR1cmVSZXR1cm5pbmdLZXkoKSIpOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgdjMgPSBuZXcgU2lnbmVkWG1sKCk7DQogICAgICAgICAgICB2My5Mb2FkWG1sKGRvYy5Eb2N1bWVudEVsZW1lbnQpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUodjMuQ2hlY2tTaWduYXR1cmUoa2V5KSwgIkRTQS1DaGVja1NpZ25hdHVyZShrZXkpIik7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgU3ltbWV0cmljSE1BQ1NIQTFWZXJpZnkoKQ0KICAgICAgICB7DQogICAgICAgICAgICBzdHJpbmcgdmFsdWUgPSAiPFNpZ25hdHVyZSB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNcIj48U2lnbmVkSW5mbz48Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNVwiIC8+PFNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjaG1hYy1zaGExXCIgLz48UmVmZXJlbmNlIFVSST1cIiNNeU9iamVjdElkXCI+PERpZ2VzdE1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMVwiIC8+PERpZ2VzdFZhbHVlPi9WdnE2c1hFVmJ0WkM4R3dOdExRbkdPeS9WST08L0RpZ2VzdFZhbHVlPjwvUmVmZXJlbmNlPjwvU2lnbmVkSW5mbz48U2lnbmF0dXJlVmFsdWU+ZTJSeFlyNXlHYnZUcVpMQ0ZjZ0EyUkFDMHlFPTwvU2lnbmF0dXJlVmFsdWU+PE9iamVjdCBJZD1cIk15T2JqZWN0SWRcIj48TXlFbGVtZW50IHhtbG5zPVwic2FtcGxlc1wiPlRoaXMgaXMgc29tZSB0ZXh0PC9NeUVsZW1lbnQ+PC9PYmplY3Q+PC9TaWduYXR1cmU+IjsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwodmFsdWUpOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgdjEgPSBuZXcgU2lnbmVkWG1sKCk7DQogICAgICAgICAgICB2MS5Mb2FkWG1sKGRvYy5Eb2N1bWVudEVsZW1lbnQpOw0KDQogICAgICAgICAgICBieXRlW10gc2VjcmV0a2V5ID0gRW5jb2RpbmcuRGVmYXVsdC5HZXRCeXRlcygicGFzc3dvcmQiKTsNCiAgICAgICAgICAgIEhNQUNTSEExIGhtYWMgPSBuZXcgSE1BQ1NIQTEoc2VjcmV0a2V5KTsNCg0KICAgICAgICAgICAgQXNzZXJ0LlRydWUodjEuQ2hlY2tTaWduYXR1cmUoaG1hYyksICJITUFDU0hBMS1DaGVja1NpZ25hdHVyZShrZXkpIik7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgLy8gYWRhcHRlZCBmcm9tIGh0dHA6Ly9idWd6aWxsYS54aW1pYW4uY29tL3Nob3dfYnVnLmNnaT9pZD01MjA4NA0KICAgICAgICBwdWJsaWMgdm9pZCBHZXRJZEVsZW1lbnQoKQ0KICAgICAgICB7DQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBuZXcgWG1sRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIGRvYy5Mb2FkWG1sKHNpZ25hdHVyZSk7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCB2MSA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIHYxLkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZSh2MS5DaGVja1NpZ25hdHVyZSgpLCAiQ2hlY2tTaWduYXR1cmUiKTsNCg0KICAgICAgICAgICAgWG1sRWxlbWVudCB4ZWwgPSB2MS5HZXRJZEVsZW1lbnQoZG9jLCAiTXlPYmplY3RJZCIpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoeGVsLklubmVyWG1sLlN0YXJ0c1dpdGgoIjxPYmplY3RMaXN0VGFnIiksICJHZXRJZEVsZW1lbnQiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBHZXRQdWJsaWNLZXkoKQ0KICAgICAgICB7DQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBuZXcgWG1sRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIGRvYy5Mb2FkWG1sKHNpZ25hdHVyZSk7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbEV4IHN4ZSA9IG5ldyBTaWduZWRYbWxFeCgpOw0KICAgICAgICAgICAgc3hlLkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQoNCiAgICAgICAgICAgIEFzeW1tZXRyaWNBbGdvcml0aG0gYWExID0gc3hlLlB1YmxpY0dldFB1YmxpY0tleSgpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoKGFhMSBpcyBSU0EpLCAiRmlyc3QgUHVibGljIEtleSBpcyBSU0EiKTsNCg0KICAgICAgICAgICAgQXN5bW1ldHJpY0FsZ29yaXRobSBhYTIgPSBzeGUuUHVibGljR2V0UHVibGljS2V5KCk7DQogICAgICAgICAgICBBc3NlcnQuTnVsbChhYTIpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3QoU2tpcCA9ICJTaWduZWRYbWxUZXN0LkRpZ2VzdFZhbHVlX0NSTEYiKV0NCiAgICAgICAgcHVibGljIHZvaWQgQWRkT2JqZWN0X051bGwoKQ0KICAgICAgICB7DQogICAgICAgICAgICBTaWduZWRYbWwgc3ggPSBuZXcgU2lnbmVkWG1sKCk7DQogICAgICAgICAgICBBc3NlcnQuVGhyb3dzPEFyZ3VtZW50TnVsbEV4Y2VwdGlvbj4oKCkgPT4gc3guQWRkT2JqZWN0KG51bGwpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBBZGRSZWZlcmVuY2VfTnVsbCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzeCA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8QXJndW1lbnROdWxsRXhjZXB0aW9uPigoKSA9PiBzeC5BZGRSZWZlcmVuY2UobnVsbCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIEdldFhtbF9XaXRob3V0SW5mbygpDQogICAgICAgIHsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzeCA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8Q3J5cHRvZ3JhcGhpY0V4Y2VwdGlvbj4oKCkgPT4gc3guR2V0WG1sKCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIExvYWRYbWxfTnVsbCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzeCA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8QXJndW1lbnROdWxsRXhjZXB0aW9uPigoKSA9PiBzeC5Mb2FkWG1sKG51bGwpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBTaWduaW5nS2V5TmFtZSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFNpZ25lZFhtbEV4IHN4ZSA9IG5ldyBTaWduZWRYbWxFeCgpOw0KICAgICAgICAgICAgQXNzZXJ0Lk51bGwoc3hlLlNpZ25pbmdLZXlOYW1lKTsNCiAgICAgICAgICAgIHN4ZS5TaWduaW5nS2V5TmFtZSA9ICJtb25vIjsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgibW9ubyIsIHN4ZS5TaWduaW5nS2V5TmFtZSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQ2hlY2tTaWduYXR1cmVFbXB0eVNhZmUoKQ0KICAgICAgICB7DQogICAgICAgICAgICBTaWduZWRYbWwgc3g7DQogICAgICAgICAgICBLZXlJbmZvQ2xhdXNlIGtpYzsNCiAgICAgICAgICAgIEtleUluZm8ga2k7DQoNCiAgICAgICAgICAgIC8vIGVtcHR5IGtleWluZm8gcGFzc2VzLi4uDQogICAgICAgICAgICBzeCA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIHN4LktleUluZm8gPSBuZXcgS2V5SW5mbygpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoIXN4LkNoZWNrU2lnbmF0dXJlKCkpOw0KDQogICAgICAgICAgICAvLyB3aXRoIGVtcHR5IEtleUluZm9OYW1lDQogICAgICAgICAgICBraWMgPSBuZXcgS2V5SW5mb05hbWUoKTsNCiAgICAgICAgICAgIGtpID0gbmV3IEtleUluZm8oKTsNCiAgICAgICAgICAgIGtpLkFkZENsYXVzZShraWMpOw0KICAgICAgICAgICAgc3guS2V5SW5mbyA9IGtpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoIXN4LkNoZWNrU2lnbmF0dXJlKCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIENoZWNrU2lnbmF0dXJlRW1wdHkoKQ0KICAgICAgICB7DQogICAgICAgICAgICBTaWduZWRYbWwgc3ggPSBuZXcgU2lnbmVkWG1sKCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZSghc3guQ2hlY2tTaWduYXR1cmUoKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgQ29tcHV0ZVNpZ25hdHVyZU5vU2lnbmluZ0tleSgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoIjxmb28vPiIpOw0KICAgICAgICAgICAgU2lnbmVkWG1sIHNpZ25lZFhtbCA9IG5ldyBTaWduZWRYbWwoZG9jKTsNCg0KICAgICAgICAgICAgUmVmZXJlbmNlIHJlZmVyZW5jZSA9IG5ldyBSZWZlcmVuY2UoKTsNCiAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiIjsNCg0KICAgICAgICAgICAgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSBlbnYgPSBuZXcgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSgpOw0KICAgICAgICAgICAgcmVmZXJlbmNlLkFkZFRyYW5zZm9ybShlbnYpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLkFkZFJlZmVyZW5jZShyZWZlcmVuY2UpOw0KDQogICAgICAgICAgICBBc3NlcnQuVGhyb3dzPENyeXB0b2dyYXBoaWNFeGNlcHRpb24+KCgpID0+IHNpZ25lZFhtbC5Db21wdXRlU2lnbmF0dXJlKCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIENvbXB1dGVTaWduYXR1cmVNaXNzaW5nUmVmZXJlbmNlZE9iamVjdCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoIjxmb28vPiIpOw0KICAgICAgICAgICAgU2lnbmVkWG1sIHNpZ25lZFhtbCA9IG5ldyBTaWduZWRYbWwoZG9jKTsNCiAgICAgICAgICAgIERTQSBrZXkgPSBEU0EuQ3JlYXRlKCk7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmluZ0tleSA9IGtleTsNCg0KICAgICAgICAgICAgUmVmZXJlbmNlIHJlZmVyZW5jZSA9IG5ldyBSZWZlcmVuY2UoKTsNCiAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiI2JsZWgiOw0KDQogICAgICAgICAgICBYbWxEc2lnRW52ZWxvcGVkU2lnbmF0dXJlVHJhbnNmb3JtIGVudiA9IG5ldyBYbWxEc2lnRW52ZWxvcGVkU2lnbmF0dXJlVHJhbnNmb3JtKCk7DQogICAgICAgICAgICByZWZlcmVuY2UuQWRkVHJhbnNmb3JtKGVudik7DQogICAgICAgICAgICBzaWduZWRYbWwuQWRkUmVmZXJlbmNlKHJlZmVyZW5jZSk7DQoNCiAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8Q3J5cHRvZ3JhcGhpY0V4Y2VwdGlvbj4oKCkgPT4gc2lnbmVkWG1sLkNvbXB1dGVTaWduYXR1cmUoKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdChTa2lwID0gImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xNjY4NSIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBEYXRhUmVmZXJlbmNlVG9Ob25EYXRhT2JqZWN0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBkb2MuTG9hZFhtbCgiPGZvbyBJZD0naWQ6MScvPiIpOw0KICAgICAgICAgICAgU2lnbmVkWG1sIHNpZ25lZFhtbCA9IG5ldyBTaWduZWRYbWwoZG9jKTsNCiAgICAgICAgICAgIERTQSBrZXkgPSBEU0EuQ3JlYXRlKCk7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmluZ0tleSA9IGtleTsNCg0KICAgICAgICAgICAgUmVmZXJlbmNlIHJlZmVyZW5jZSA9IG5ldyBSZWZlcmVuY2UoKTsNCiAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiI2lkOjEiOw0KDQogICAgICAgICAgICBYbWxEc2lnQzE0TlRyYW5zZm9ybSB0ID0gbmV3IFhtbERzaWdDMTROVHJhbnNmb3JtKCk7DQogICAgICAgICAgICByZWZlcmVuY2UuQWRkVHJhbnNmb3JtKHQpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLkFkZFJlZmVyZW5jZShyZWZlcmVuY2UpOw0KDQogICAgICAgICAgICBzaWduZWRYbWwuQ29tcHV0ZVNpZ25hdHVyZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIFNpZ25FbGVtZW50V2l0aG91dFByZWZpeGVkTmFtZXNwYWNlKCkNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIGlucHV0ID0gIjxBY3Rpb24geG1sbnM9J3Vybjpmb28nPmh0dHA6Ly90ZW1wdXJpLm9yZy9JRm9vL0VjaG88L0FjdGlvbj4iOw0KICAgICAgICAgICAgc3RyaW5nIGV4cGVjdGVkID0gQCI8U2lnbmF0dXJlIHhtbG5zPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIiPjxTaWduZWRJbmZvPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1IiIgLz48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNobWFjLXNoYTEiIiAvPjxSZWZlcmVuY2UgVVJJPSIiI18xIiI+PFRyYW5zZm9ybXM+PFRyYW5zZm9ybSBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIiIC8+PC9UcmFuc2Zvcm1zPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiIiAvPjxEaWdlc3RWYWx1ZT56ZEZFWkI4ck56dnBORy9nRkVKQldrL001Tms9PC9EaWdlc3RWYWx1ZT48L1JlZmVyZW5jZT48L1NpZ25lZEluZm8+PFNpZ25hdHVyZVZhbHVlPitPeUdWenJIam1LU0RXTE55dmd4OHBqYlBmTT08L1NpZ25hdHVyZVZhbHVlPjxPYmplY3QgSWQ9IiJfMSIiPjxBY3Rpb24geG1sbnM9IiJ1cm46Zm9vIiI+aHR0cDovL3RlbXB1cmkub3JnL0lGb28vRWNobzwvQWN0aW9uPjwvT2JqZWN0PjwvU2lnbmF0dXJlPiI7DQoNCiAgICAgICAgICAgIGJ5dGVbXSBrZXkgPSBDb252ZXJ0LkZyb21CYXNlNjRTdHJpbmcoDQogICAgICAgICAgICAgICAgIjFXNUVpZ1ZuYm5SakdMYmc5OUVsaWVPbXVVZ1lPK0tjd01KdEUzNVNBR0k9Iik7DQogICAgICAgICAgICBUcmFuc2Zvcm0gdCA9IG5ldyBYbWxEc2lnQzE0TlRyYW5zZm9ybSgpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKGV4cGVjdGVkLCBTaWduV2l0aEhNQUNTSEExKGlucHV0LCBrZXksIHQpKTsNCiAgICAgICAgICAgIC8vIFRoZSBzZWNvbmQgcmVzdWx0IHNob3VsZCBiZSBzdGlsbCBpZGVudGljYWwuDQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoZXhwZWN0ZWQsIFNpZ25XaXRoSE1BQ1NIQTEoaW5wdXQsIGtleSwgdCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIHB1YmxpYyB2b2lkIFNpZ25FbGVtZW50V2l0aFByZWZpeGVkTmFtZXNwYWNlKCkNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIGlucHV0ID0gIjxhOkFjdGlvbiB4bWxuczphPSd1cm46Zm9vJz5odHRwOi8vdGVtcHVyaS5vcmcvSUZvby9FY2hvPC9hOkFjdGlvbj4iOw0KICAgICAgICAgICAgc3RyaW5nIGV4cGVjdGVkID0gQCI8U2lnbmF0dXJlIHhtbG5zPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIiPjxTaWduZWRJbmZvPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1IiIgLz48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNobWFjLXNoYTEiIiAvPjxSZWZlcmVuY2UgVVJJPSIiI18xIiI+PFRyYW5zZm9ybXM+PFRyYW5zZm9ybSBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIiIC8+PC9UcmFuc2Zvcm1zPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiIiAvPjxEaWdlc3RWYWx1ZT42aTVGbHFrRWZKT2RVYU9NQ0s3eG4wSTBIRGc9PC9EaWdlc3RWYWx1ZT48L1JlZmVyZW5jZT48L1NpZ25lZEluZm8+PFNpZ25hdHVyZVZhbHVlPnRBU3ArZTJBMHhxY20wMmpLZzVUR3FsaEtwST08L1NpZ25hdHVyZVZhbHVlPjxPYmplY3QgSWQ9IiJfMSIiPjxhOkFjdGlvbiB4bWxuczphPSIidXJuOmZvbyIiPmh0dHA6Ly90ZW1wdXJpLm9yZy9JRm9vL0VjaG88L2E6QWN0aW9uPjwvT2JqZWN0PjwvU2lnbmF0dXJlPiI7DQoNCiAgICAgICAgICAgIGJ5dGVbXSBrZXkgPSBDb252ZXJ0LkZyb21CYXNlNjRTdHJpbmcoDQogICAgICAgICAgICAgICAgIjFXNUVpZ1ZuYm5SakdMYmc5OUVsaWVPbXVVZ1lPK0tjd01KdEUzNVNBR0k9Iik7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoU2lnbldpdGhITUFDU0hBMShpbnB1dCwga2V5KSwgZXhwZWN0ZWQpOw0KICAgICAgICB9DQoNCiAgICAgICAgc3RyaW5nIFNpZ25XaXRoSE1BQ1NIQTEoc3RyaW5nIGlucHV0LCBieXRlW10ga2V5KQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gU2lnbldpdGhITUFDU0hBMShpbnB1dCwga2V5LCBuZXcgWG1sRHNpZ0MxNE5UcmFuc2Zvcm0oKSk7DQogICAgICAgIH0NCg0KICAgICAgICBzdHJpbmcgU2lnbldpdGhITUFDU0hBMShzdHJpbmcgaW5wdXQsIGJ5dGVbXSBrZXksIFRyYW5zZm9ybSB0cmFuc2Zvcm0pDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoaW5wdXQpOw0KICAgICAgICAgICAgU2lnbmVkWG1sIHN4bWwgPSBuZXcgU2lnbmVkWG1sKGRvYyk7DQoNCiAgICAgICAgICAgIEhNQUNTSEExIGtleWhhc2ggPSBuZXcgSE1BQ1NIQTEoa2V5KTsNCiAgICAgICAgICAgIERhdGFPYmplY3QgZCA9IG5ldyBEYXRhT2JqZWN0KCk7DQogICAgICAgICAgICAvL2QuRGF0YSA9IGRvYy5TZWxlY3ROb2RlcyAoIi8vKltsb2NhbC1uYW1lKCk9J0JvZHknXS8qIik7DQogICAgICAgICAgICBkLkRhdGEgPSBkb2MuU2VsZWN0Tm9kZXMoIi8vKltsb2NhbC1uYW1lKCk9J0FjdGlvbiddIik7DQogICAgICAgICAgICBkLklkID0gIl8xIjsNCiAgICAgICAgICAgIHN4bWwuQWRkT2JqZWN0KGQpOw0KICAgICAgICAgICAgUmVmZXJlbmNlIHIgPSBuZXcgUmVmZXJlbmNlKCIjXzEiKTsNCiAgICAgICAgICAgIHIuQWRkVHJhbnNmb3JtKHRyYW5zZm9ybSk7DQogICAgICAgICAgICByLkRpZ2VzdE1ldGhvZCA9IFNpZ25lZFhtbC5YbWxEc2lnU0hBMVVybDsNCiAgICAgICAgICAgIHN4bWwuU2lnbmVkSW5mby5BZGRSZWZlcmVuY2Uocik7DQogICAgICAgICAgICBzeG1sLkNvbXB1dGVTaWduYXR1cmUoa2V5aGFzaCk7DQogICAgICAgICAgICBTdHJpbmdXcml0ZXIgc3cgPSBuZXcgU3RyaW5nV3JpdGVyKCk7DQogICAgICAgICAgICBYbWxXcml0ZXIgdyA9IG5ldyBYbWxUZXh0V3JpdGVyKHN3KTsNCiAgICAgICAgICAgIHN4bWwuR2V0WG1sKCkuV3JpdGVUbyh3KTsNCiAgICAgICAgICAgIHcuQ2xvc2UoKTsNCiAgICAgICAgICAgIHJldHVybiBzdy5Ub1N0cmluZygpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3QoU2tpcCA9ICJodHRwczovL2dpdGh1Yi5jb20vZG90bmV0L2NvcmVmeC9pc3N1ZXMvMTY2ODUiKV0NCiAgICAgICAgcHVibGljIHZvaWQgR2V0SWRFbGVtZW50X051bGwoKQ0KICAgICAgICB7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IG5ldyBTaWduZWRYbWwoKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ24uR2V0SWRFbGVtZW50KG51bGwsICJ2YWx1ZSIpKTsNCiAgICAgICAgICAgIEFzc2VydC5OdWxsKHNpZ24uR2V0SWRFbGVtZW50KG5ldyBYbWxEb2N1bWVudCgpLCBudWxsKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgRGlnZXN0VmFsdWVfQ1JMRigpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IENyZWF0ZVNvbWVYbWwoIlxyXG4iKTsNCiAgICAgICAgICAgIFhtbERzaWdFeGNDMTROVHJhbnNmb3JtIHRyYW5zZm9ybSA9IG5ldyBYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybSgpOw0KICAgICAgICAgICAgdHJhbnNmb3JtLkxvYWRJbnB1dChkb2MpOw0KICAgICAgICAgICAgU3RyZWFtIHMgPSAoU3RyZWFtKXRyYW5zZm9ybS5HZXRPdXRwdXQoKTsNCiAgICAgICAgICAgIHN0cmluZyBvdXRwdXQgPSBTdHJlYW0yU3RyaW5nKHMpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKCI8cGVyc29uPiYjeEQ7XG4gIDxiaXJ0aHBsYWNlPkJydXNzZWxzPC9iaXJ0aHBsYWNlPiYjeEQ7XG48L3BlcnNvbj4iLCBvdXRwdXQpOw0KDQogICAgICAgICAgICBzLlBvc2l0aW9uID0gMDsNCg0KICAgICAgICAgICAgYnl0ZVtdIGRpZ2VzdDsNCiAgICAgICAgICAgIHVzaW5nIChIYXNoQWxnb3JpdGhtIGhhc2ggPSBTSEExLkNyZWF0ZSgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGRpZ2VzdCA9IGhhc2guQ29tcHV0ZUhhc2gocyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiSUtiZmRLMi9ETWZYeWV6Q2Y1UWdnVkNYZms4PSIsIENvbnZlcnQuVG9CYXNlNjRTdHJpbmcoZGlnZXN0KSk7DQoNCiAgICAgICAgICAgIFg1MDlDZXJ0aWZpY2F0ZTIgY2VydCA9IG5ldyBYNTA5Q2VydGlmaWNhdGUyKF9wa2NzMTIsICJtb25vIik7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbmVkWG1sID0gbmV3IFNpZ25lZFhtbChkb2MpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLlNpZ25pbmdLZXkgPSBjZXJ0LlByaXZhdGVLZXk7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmVkSW5mby5DYW5vbmljYWxpemF0aW9uTWV0aG9kID0gU2lnbmVkWG1sLlhtbERzaWdFeGNDMTROVHJhbnNmb3JtVXJsOw0KICAgICAgICAgICAgc2lnbmVkWG1sLlNpZ25lZEluZm8uU2lnbmF0dXJlTWV0aG9kID0gU2lnbmVkWG1sLlhtbERzaWdSU0FTSEExVXJsOw0KDQogICAgICAgICAgICBSZWZlcmVuY2UgcmVmZXJlbmNlID0gbmV3IFJlZmVyZW5jZSgpOw0KICAgICAgICAgICAgcmVmZXJlbmNlLkRpZ2VzdE1ldGhvZCA9IFNpZ25lZFhtbC5YbWxEc2lnU0hBMVVybDsNCiAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiIjsNCg0KICAgICAgICAgICAgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSBlbnYgPSBuZXcgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSgpOw0KICAgICAgICAgICAgcmVmZXJlbmNlLkFkZFRyYW5zZm9ybShlbnYpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLkFkZFJlZmVyZW5jZShyZWZlcmVuY2UpOw0KDQogICAgICAgICAgICBLZXlJbmZvIGtleUluZm8gPSBuZXcgS2V5SW5mbygpOw0KICAgICAgICAgICAgS2V5SW5mb1g1MDlEYXRhIHg1MDlLZXlJbmZvID0gbmV3IEtleUluZm9YNTA5RGF0YSgpOw0KICAgICAgICAgICAgeDUwOUtleUluZm8uQWRkQ2VydGlmaWNhdGUobmV3IFg1MDlDZXJ0aWZpY2F0ZTIoX2NlcnQpKTsNCiAgICAgICAgICAgIHg1MDlLZXlJbmZvLkFkZENlcnRpZmljYXRlKGNlcnQpOw0KICAgICAgICAgICAga2V5SW5mby5BZGRDbGF1c2UoeDUwOUtleUluZm8pOw0KICAgICAgICAgICAgc2lnbmVkWG1sLktleUluZm8gPSBrZXlJbmZvOw0KDQogICAgICAgICAgICBzaWduZWRYbWwuQ29tcHV0ZVNpZ25hdHVyZSgpOw0KDQogICAgICAgICAgICBkaWdlc3QgPSByZWZlcmVuY2UuRGlnZXN0VmFsdWU7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImUzZHNpMXhLOEZBeDF2c3VnN0oyMDNKYkVBVT0iLCBDb252ZXJ0LlRvQmFzZTY0U3RyaW5nKGRpZ2VzdCkpOw0KDQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoIjxTaWduZWRJbmZvIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI1wiPiINCiAgICAgICAgICAgICAgICArICI8Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biNcIiAvPiINCiAgICAgICAgICAgICAgICArICI8U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMVwiIC8+Ig0KICAgICAgICAgICAgICAgICsgIjxSZWZlcmVuY2UgVVJJPVwiXCI+Ig0KICAgICAgICAgICAgICAgICsgIjxUcmFuc2Zvcm1zPiINCiAgICAgICAgICAgICAgICArICI8VHJhbnNmb3JtIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlXCIgLz4iDQogICAgICAgICAgICAgICAgKyAiPC9UcmFuc2Zvcm1zPiINCiAgICAgICAgICAgICAgICArICI8RGlnZXN0TWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExXCIgLz4iDQogICAgICAgICAgICAgICAgKyAiPERpZ2VzdFZhbHVlPmUzZHNpMXhLOEZBeDF2c3VnN0oyMDNKYkVBVT08L0RpZ2VzdFZhbHVlPiINCiAgICAgICAgICAgICAgICArICI8L1JlZmVyZW5jZT4iDQogICAgICAgICAgICAgICAgKyAiPC9TaWduZWRJbmZvPiIsIHNpZ25lZFhtbC5TaWduZWRJbmZvLkdldFhtbCgpLk91dGVyWG1sKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBEaWdlc3RWYWx1ZV9MRigpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IENyZWF0ZVNvbWVYbWwoIlxuIik7DQogICAgICAgICAgICBYbWxEc2lnRXhjQzE0TlRyYW5zZm9ybSB0cmFuc2Zvcm0gPSBuZXcgWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIHRyYW5zZm9ybS5Mb2FkSW5wdXQoZG9jKTsNCiAgICAgICAgICAgIFN0cmVhbSBzID0gKFN0cmVhbSl0cmFuc2Zvcm0uR2V0T3V0cHV0KCk7DQogICAgICAgICAgICBzdHJpbmcgb3V0cHV0ID0gU3RyZWFtMlN0cmluZyhzKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiPHBlcnNvbj5cbiAgPGJpcnRocGxhY2U+QnJ1c3NlbHM8L2JpcnRocGxhY2U+XG48L3BlcnNvbj4iLCBvdXRwdXQpOw0KDQogICAgICAgICAgICBzLlBvc2l0aW9uID0gMDsNCg0KICAgICAgICAgICAgYnl0ZVtdIGRpZ2VzdDsNCiAgICAgICAgICAgIHVzaW5nIChIYXNoQWxnb3JpdGhtIGhhc2ggPSBTSEExLkNyZWF0ZSgpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGRpZ2VzdCA9IGhhc2guQ29tcHV0ZUhhc2gocyk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbCgiZTNkc2kxeEs4RkF4MXZzdWc3SjIwM0piRUFVPSIsIENvbnZlcnQuVG9CYXNlNjRTdHJpbmcoZGlnZXN0KSk7DQoNCiAgICAgICAgICAgIFg1MDlDZXJ0aWZpY2F0ZTIgY2VydCA9IG5ldyBYNTA5Q2VydGlmaWNhdGUyKF9wa2NzMTIsICJtb25vIik7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbmVkWG1sID0gbmV3IFNpZ25lZFhtbChkb2MpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLlNpZ25pbmdLZXkgPSBjZXJ0LlByaXZhdGVLZXk7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmVkSW5mby5TaWduYXR1cmVNZXRob2QgPSBTaWduZWRYbWwuWG1sRHNpZ1JTQVNIQTFVcmw7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmVkSW5mby5DYW5vbmljYWxpemF0aW9uTWV0aG9kID0gU2lnbmVkWG1sLlhtbERzaWdFeGNDMTROVHJhbnNmb3JtVXJsOw0KDQogICAgICAgICAgICBSZWZlcmVuY2UgcmVmZXJlbmNlID0gbmV3IFJlZmVyZW5jZSgpOw0KICAgICAgICAgICAgcmVmZXJlbmNlLkRpZ2VzdE1ldGhvZCA9IFNpZ25lZFhtbC5YbWxEc2lnU0hBMVVybDsNCiAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiIjsNCg0KICAgICAgICAgICAgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSBlbnYgPSBuZXcgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSgpOw0KICAgICAgICAgICAgcmVmZXJlbmNlLkFkZFRyYW5zZm9ybShlbnYpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLkFkZFJlZmVyZW5jZShyZWZlcmVuY2UpOw0KDQogICAgICAgICAgICBLZXlJbmZvIGtleUluZm8gPSBuZXcgS2V5SW5mbygpOw0KICAgICAgICAgICAgS2V5SW5mb1g1MDlEYXRhIHg1MDlLZXlJbmZvID0gbmV3IEtleUluZm9YNTA5RGF0YSgpOw0KICAgICAgICAgICAgeDUwOUtleUluZm8uQWRkQ2VydGlmaWNhdGUobmV3IFg1MDlDZXJ0aWZpY2F0ZTIoX2NlcnQpKTsNCiAgICAgICAgICAgIHg1MDlLZXlJbmZvLkFkZENlcnRpZmljYXRlKGNlcnQpOw0KICAgICAgICAgICAga2V5SW5mby5BZGRDbGF1c2UoeDUwOUtleUluZm8pOw0KICAgICAgICAgICAgc2lnbmVkWG1sLktleUluZm8gPSBrZXlJbmZvOw0KDQogICAgICAgICAgICBzaWduZWRYbWwuQ29tcHV0ZVNpZ25hdHVyZSgpOw0KDQogICAgICAgICAgICBkaWdlc3QgPSByZWZlcmVuY2UuRGlnZXN0VmFsdWU7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoImUzZHNpMXhLOEZBeDF2c3VnN0oyMDNKYkVBVT0iLCBDb252ZXJ0LlRvQmFzZTY0U3RyaW5nKGRpZ2VzdCkpOw0KDQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoIjxTaWduZWRJbmZvIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI1wiPiINCiAgICAgICAgICAgICAgICArICI8Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biNcIiAvPiINCiAgICAgICAgICAgICAgICArICI8U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMVwiIC8+Ig0KICAgICAgICAgICAgICAgICsgIjxSZWZlcmVuY2UgVVJJPVwiXCI+Ig0KICAgICAgICAgICAgICAgICsgIjxUcmFuc2Zvcm1zPiINCiAgICAgICAgICAgICAgICArICI8VHJhbnNmb3JtIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlXCIgLz4iDQogICAgICAgICAgICAgICAgKyAiPC9UcmFuc2Zvcm1zPiINCiAgICAgICAgICAgICAgICArICI8RGlnZXN0TWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExXCIgLz4iDQogICAgICAgICAgICAgICAgKyAiPERpZ2VzdFZhbHVlPmUzZHNpMXhLOEZBeDF2c3VnN0oyMDNKYkVBVT08L0RpZ2VzdFZhbHVlPiINCiAgICAgICAgICAgICAgICArICI8L1JlZmVyZW5jZT4iDQogICAgICAgICAgICAgICAgKyAiPC9TaWduZWRJbmZvPiIsIHNpZ25lZFhtbC5TaWduZWRJbmZvLkdldFhtbCgpLk91dGVyWG1sKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBTaWduZWRYTUxfQ1JMRl9JbnZhbGlkKCkNCiAgICAgICAgew0KICAgICAgICAgICAgWDUwOUNlcnRpZmljYXRlMiBjZXJ0ID0gbmV3IFg1MDlDZXJ0aWZpY2F0ZTIoX3BrY3MxMiwgIm1vbm8iKTsNCg0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBkb2MuTG9hZFhtbChzdHJpbmcuRm9ybWF0KEN1bHR1cmVJbmZvLkludmFyaWFudEN1bHR1cmUsDQogICAgICAgICAgICAgICAgIjxwZXJzb24+ezB9IiArDQogICAgICAgICAgICAgICAgIiAgPGJpcnRocGxhY2U+QnJ1c3NlbHM8L2JpcnRocGxhY2U+ezB9IiArDQogICAgICAgICAgICAgICAgIjxTaWduYXR1cmUgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjXCI+IiArDQogICAgICAgICAgICAgICAgIjxTaWduZWRJbmZvPiIgKw0KICAgICAgICAgICAgICAgICI8Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biNcIiAvPiIgKw0KICAgICAgICAgICAgICAgICI8U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMVwiIC8+IiArDQogICAgICAgICAgICAgICAgIjxSZWZlcmVuY2UgVVJJPVwiXCI+IiArDQogICAgICAgICAgICAgICAgIjxUcmFuc2Zvcm1zPiIgKw0KICAgICAgICAgICAgICAgICI8VHJhbnNmb3JtIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlXCIgLz4iICsNCiAgICAgICAgICAgICAgICAiPC9UcmFuc2Zvcm1zPiIgKw0KICAgICAgICAgICAgICAgICI8RGlnZXN0TWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExXCIgLz4iICsNCiAgICAgICAgICAgICAgICAiPERpZ2VzdFZhbHVlPklLYmZkSzIvRE1mWHllekNmNVFnZ1ZDWGZrOD08L0RpZ2VzdFZhbHVlPiIgKw0KICAgICAgICAgICAgICAgICI8L1JlZmVyZW5jZT4iICsNCiAgICAgICAgICAgICAgICAiPC9TaWduZWRJbmZvPiIgKw0KICAgICAgICAgICAgICAgICI8U2lnbmF0dXJlVmFsdWU+IiArDQogICAgICAgICAgICAgICAgIkp1U2Q2OFB5QVJzWnFHS1NvNXhYNXlZSER1dTZ3aEhFaG9YcXh4Rm1HZUVkdmtLWTJiZ3JvV0oxWlRHSEdyIiArDQogICAgICAgICAgICAgICAgIlZJN210RzNoMHcxaWJPS2RsdG05ajRsWmFaV284N0NBSmlKMnN5ZUxiTXlJVlN3Nk95WkVzaUZGL1ZxTEtLIiArDQogICAgICAgICAgICAgICAgIjRUNEFPNnE3SFlzQzU1ekpyT3ZMMWo5SUlyOHpCbkpmdkJkS2NrZjBsY3pZYlhjPSIgKw0KICAgICAgICAgICAgICAgICI8L1NpZ25hdHVyZVZhbHVlPiIgKw0KICAgICAgICAgICAgICAgICI8S2V5SW5mbz4iICsNCiAgICAgICAgICAgICAgICAiPFg1MDlEYXRhPiIgKw0KICAgICAgICAgICAgICAgICI8WDUwOUNlcnRpZmljYXRlPiIgKw0KICAgICAgICAgICAgICAgICJNSUlCb3pDQ0FReWdBd0lCQWdJUUhjKzhpVVJTVFVhcm1nNHRybXJuR1RBTkJna3Foa2lHOXcwQkFRVUZBRCIgKw0KICAgICAgICAgICAgICAgICJBUk1ROHdEUVlEVlFRREV3Wk9iM1psYkd3d0lCY05NRFl3T1RJeE1EY3lOalV4V2hnUE1qQTVNREF4TWpFdyIgKw0KICAgICAgICAgICAgICAgICJPREkyTlRGYU1BOHhEVEFMQmdOVkJBTVRCRTF2Ym04d2daMHdEUVlKS29aSWh2Y05BUUVCQlFBRGdZc0FNSSIgKw0KICAgICAgICAgICAgICAgICJHSEFvR0JBSmhGQjFLSHYyV3pzSHFpaDlNdm0zS2ZmRU9TTXYrc2gxbVBXM3NXSS85NVZPT1ZxSm5oZW1NTSIgKw0KICAgICAgICAgICAgICAgICJzODJwaFNiTlplb1BIbnk0YnRieWtiUlJhUlF2OTRydElNNmdlSlIxZTJjNW1mSld0SFNxM0VZUWFySEM2OCIgKw0KICAgICAgICAgICAgICAgICJjQVp2Q0FtUVpHYTFlUVJOUnFjVFNLWDh5ZnFIMFNvdUlFOW9oSnRwaWx1TmUrWGdrNWZLdjNBZ0VSTUEwRyIgKw0KICAgICAgICAgICAgICAgICJDU3FHU0liM0RRRUJCUVVBQTRHQkFFNnBxU2dLOFFLUkhTaDZZdllzOW9SaDFuOGlSRWNvN1FtWkNGajdVQiIgKw0KICAgICAgICAgICAgICAgICJrbi9RZ0o5bUtzVDhvMTJWbllIcUJDRXdCTmFUMWF5M3ovU1I0L1ozODN6dXU0WTZ4eGpxT3FuTTZndHdVViIgKw0KICAgICAgICAgICAgICAgICJ1NS8waHZ6K1RodHVUakl0RzZOeTVKa0xaWlF0L1hiSTVrZzkyMHQ5anEzdmJIQk11WDJIeGl2d1FlNXN1ZyIgKw0KICAgICAgICAgICAgICAgICJqUGFURVkiICsNCiAgICAgICAgICAgICAgICAiPC9YNTA5Q2VydGlmaWNhdGU+IiArDQogICAgICAgICAgICAgICAgIjxYNTA5Q2VydGlmaWNhdGU+IiArDQogICAgICAgICAgICAgICAgIk1JSUJwVENDQVE2Z0F3SUJBZ0lRWG82THIzcnJTa1c0eG1OUFJiSE1iakFOQmdrcWhraUc5dzBCQVFVRkFEIiArDQogICAgICAgICAgICAgICAgIkFSTVE4d0RRWURWUVFERXdaT2IzWmxiR3d3SUJjTk1EWXdPVEl4TURjeE5ERTRXaGdQTWpBNU1EQXhNakV3IiArDQogICAgICAgICAgICAgICAgIk9ERTBNVGhhTUJFeER6QU5CZ05WQkFNVEJrMXBaM1ZsYkRDQm5UQU5CZ2txaGtpRzl3MEJBUUVGQUFPQml3IiArDQogICAgICAgICAgICAgICAgIkF3Z1ljQ2dZRUFyQ2tlU1o2VTNVM0ZtMnFTdVFzTTd4dnZzU3paR1FMUERVSEZRL0JaeEE3TGlHUmZYYm1PIiArDQogICAgICAgICAgICAgICAgInlQa2tZUllJdFhkeTB5RGwvOHJBamVsYUw4alE0bWU2VWV4eWVxKzV4RWdIbjlWYk5Kbnk1YXBHTmk0a0YxIiArDQogICAgICAgICAgICAgICAgIjhEUjVESzlabWU5ZDZpY3VzZ1c4a3J2My8vNVNWRThhbzdYNXFySU9HUzgyNWVDSkw3M1lXYnhLa0NBUkV3IiArDQogICAgICAgICAgICAgICAgIkRRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQVNxQmdZVGtJSnBETzI4WkVYbkY1US9HM3hEUi9NeGhkY3JDSVNKIiArDQogICAgICAgICAgICAgICAgInREYnVHVlp6Syt4aEZoaVlENVExTmlHaEQ0b0RJVkpQd0ttWkg0TDNZUDk2aVNoNlJkdE8yN1YwNUVUL1g1IiArDQogICAgICAgICAgICAgICAgInlXTUtkZUlzcTZyOWpYWHY3TmFXVG12TmZNTEtMTmdFQkNKMDArd04wdTR4SFVDN3lDSmMwS05RM2ZqRExVIiArDQogICAgICAgICAgICAgICAgIkFUMW9hVmpXST0iICsNCiAgICAgICAgICAgICAgICAiPC9YNTA5Q2VydGlmaWNhdGU+IiArDQogICAgICAgICAgICAgICAgIjwvWDUwOURhdGE+IiArDQogICAgICAgICAgICAgICAgIjwvS2V5SW5mbz4iICsNCiAgICAgICAgICAgICAgICAiPC9TaWduYXR1cmU+IiArDQogICAgICAgICAgICAgICAgIjwvcGVyc29uPiIsICJcclxuIikpOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbmVkWG1sID0gbmV3IFNpZ25lZFhtbChkb2MpOw0KICAgICAgICAgICAgWG1sTm9kZUxpc3Qgbm9kZUxpc3QgPSBkb2MuR2V0RWxlbWVudHNCeVRhZ05hbWUoIlNpZ25hdHVyZSIpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLkxvYWRYbWwoKFhtbEVsZW1lbnQpbm9kZUxpc3RbMF0pOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoIXNpZ25lZFhtbC5DaGVja1NpZ25hdHVyZSgpLCAiIzIiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBTaWduZWRYTUxfQ1JMRl9WYWxpZCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIFg1MDlDZXJ0aWZpY2F0ZTIgY2VydCA9IG5ldyBYNTA5Q2VydGlmaWNhdGUyKF9wa2NzMTIsICJtb25vIik7DQoNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IENyZWF0ZVNpZ25lZFhtbChjZXJ0LCBTaWduZWRYbWwuWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm1VcmwsICJcclxuIik7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoc3RyaW5nLkZvcm1hdChDdWx0dXJlSW5mby5JbnZhcmlhbnRDdWx0dXJlLCAiPHBlcnNvbj57MH0iICsNCiAgICAgICAgICAgICAgICAiICA8YmlydGhwbGFjZT5CcnVzc2VsczwvYmlydGhwbGFjZT57MH0iICsNCiAgICAgICAgICAgICAgICAiPFNpZ25hdHVyZSB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNcIj4iICsNCiAgICAgICAgICAgICAgICAiPFNpZ25lZEluZm8+IiArDQogICAgICAgICAgICAgICAgIjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuI1wiIC8+IiArDQogICAgICAgICAgICAgICAgIjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3JzYS1zaGExXCIgLz4iICsNCiAgICAgICAgICAgICAgICAiPFJlZmVyZW5jZSBVUkk9XCJcIj4iICsNCiAgICAgICAgICAgICAgICAiPFRyYW5zZm9ybXM+IiArDQogICAgICAgICAgICAgICAgIjxUcmFuc2Zvcm0gQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmVcIiAvPiIgKw0KICAgICAgICAgICAgICAgICI8L1RyYW5zZm9ybXM+IiArDQogICAgICAgICAgICAgICAgIjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTFcIiAvPiIgKw0KICAgICAgICAgICAgICAgICI8RGlnZXN0VmFsdWU+ZTNkc2kxeEs4RkF4MXZzdWc3SjIwM0piRUFVPTwvRGlnZXN0VmFsdWU+IiArDQogICAgICAgICAgICAgICAgIjwvUmVmZXJlbmNlPiIgKw0KICAgICAgICAgICAgICAgICI8L1NpZ25lZEluZm8+IiArDQogICAgICAgICAgICAgICAgIjxTaWduYXR1cmVWYWx1ZT4iICsNCiAgICAgICAgICAgICAgICAiWDI5bmJrT1IvWGszS3dzRXBFdnBET3FmSTYvTlR0aWV3SXhOcUtNclBDb00wSExhd0s1SEtzQ3czbEwwN0MiICsNCiAgICAgICAgICAgICAgICAiOFN3cXZvWEpMOVZTMDVnc1NpYTg1WUNCOE5QRGVIdUhZM0NQR1Q3RFZwZ2VIRkEwb2VmTW5PaThJQXFLRDIiICsNCiAgICAgICAgICAgICAgICAibngyOUEyMjJ1NU9td2JETzBxRnFidHNndklGaVA1WUpnMDRjd21ucXMrZUwrV0E9IiArDQogICAgICAgICAgICAgICAgIjwvU2lnbmF0dXJlVmFsdWU+IiArDQogICAgICAgICAgICAgICAgIjxLZXlJbmZvPiIgKw0KICAgICAgICAgICAgICAgICI8WDUwOURhdGE+IiArDQogICAgICAgICAgICAgICAgIjxYNTA5Q2VydGlmaWNhdGU+IiArDQogICAgICAgICAgICAgICAgIk1JSUJvekNDQVF5Z0F3SUJBZ0lRSGMrOGlVUlNUVWFybWc0dHJtcm5HVEFOQmdrcWhraUc5dzBCQVFVRkFEIiArDQogICAgICAgICAgICAgICAgIkFSTVE4d0RRWURWUVFERXdaT2IzWmxiR3d3SUJjTk1EWXdPVEl4TURjeU5qVXhXaGdQTWpBNU1EQXhNakV3IiArDQogICAgICAgICAgICAgICAgIk9ESTJOVEZhTUE4eERUQUxCZ05WQkFNVEJFMXZibTh3Z1owd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ1lzQU1JIiArDQogICAgICAgICAgICAgICAgIkdIQW9HQkFKaEZCMUtIdjJXenNIcWloOU12bTNLZmZFT1NNditzaDFtUFczc1dJLzk1Vk9PVnFKbmhlbU1NIiArDQogICAgICAgICAgICAgICAgInM4MnBoU2JOWmVvUEhueTRidGJ5a2JSUmFSUXY5NHJ0SU02Z2VKUjFlMmM1bWZKV3RIU3EzRVlRYXJIQzY4IiArDQogICAgICAgICAgICAgICAgImNBWnZDQW1RWkdhMWVRUk5ScWNUU0tYOHlmcUgwU291SUU5b2hKdHBpbHVOZStYZ2s1Zkt2M0FnRVJNQTBHIiArDQogICAgICAgICAgICAgICAgIkNTcUdTSWIzRFFFQkJRVUFBNEdCQUU2cHFTZ0s4UUtSSFNoNll2WXM5b1JoMW44aVJFY283UW1aQ0ZqN1VCIiArDQogICAgICAgICAgICAgICAgImtuL1FnSjltS3NUOG8xMlZuWUhxQkNFd0JOYVQxYXkzei9TUjQvWjM4M3p1dTRZNnh4anFPcW5NNmd0d1VWIiArDQogICAgICAgICAgICAgICAgInU1LzBodnorVGh0dVRqSXRHNk55NUprTFpaUXQvWGJJNWtnOTIwdDlqcTN2YkhCTXVYMkh4aXZ3UWU1c3VnIiArDQogICAgICAgICAgICAgICAgImpQYVRFWSIgKw0KICAgICAgICAgICAgICAgICI8L1g1MDlDZXJ0aWZpY2F0ZT4iICsNCiAgICAgICAgICAgICAgICAiPFg1MDlDZXJ0aWZpY2F0ZT4iICsNCiAgICAgICAgICAgICAgICAiTUlJQnBUQ0NBUTZnQXdJQkFnSVFYbzZMcjNyclNrVzR4bU5QUmJITWJqQU5CZ2txaGtpRzl3MEJBUVVGQUQiICsNCiAgICAgICAgICAgICAgICAiQVJNUTh3RFFZRFZRUURFd1pPYjNabGJHd3dJQmNOTURZd09USXhNRGN4TkRFNFdoZ1BNakE1TURBeE1qRXciICsNCiAgICAgICAgICAgICAgICAiT0RFME1UaGFNQkV4RHpBTkJnTlZCQU1UQmsxcFozVmxiRENCblRBTkJna3Foa2lHOXcwQkFRRUZBQU9CaXciICsNCiAgICAgICAgICAgICAgICAiQXdnWWNDZ1lFQXJDa2VTWjZVM1UzRm0ycVN1UXNNN3h2dnNTelpHUUxQRFVIRlEvQlp4QTdMaUdSZlhibU8iICsNCiAgICAgICAgICAgICAgICAieVBra1lSWUl0WGR5MHlEbC84ckFqZWxhTDhqUTRtZTZVZXh5ZXErNXhFZ0huOVZiTkpueTVhcEdOaTRrRjEiICsNCiAgICAgICAgICAgICAgICAiOERSNURLOVptZTlkNmljdXNnVzhrcnYzLy81U1ZFOGFvN1g1cXJJT0dTODI1ZUNKTDczWVdieEtrQ0FSRXciICsNCiAgICAgICAgICAgICAgICAiRFFZSktvWklodmNOQVFFRkJRQURnWUVBU3FCZ1lUa0lKcERPMjhaRVhuRjVRL0czeERSL014aGRjckNJU0oiICsNCiAgICAgICAgICAgICAgICAidERidUdWWnpLK3hoRmhpWUQ1UTFOaUdoRDRvRElWSlB3S21aSDRMM1lQOTZpU2g2UmR0TzI3VjA1RVQvWDUiICsNCiAgICAgICAgICAgICAgICAieVdNS2RlSXNxNnI5alhYdjdOYVdUbXZOZk1MS0xOZ0VCQ0owMCt3TjB1NHhIVUM3eUNKYzBLTlEzZmpETFUiICsNCiAgICAgICAgICAgICAgICAiQVQxb2FWaldJPSIgKw0KICAgICAgICAgICAgICAgICI8L1g1MDlDZXJ0aWZpY2F0ZT4iICsNCiAgICAgICAgICAgICAgICAiPC9YNTA5RGF0YT4iICsNCiAgICAgICAgICAgICAgICAiPC9LZXlJbmZvPiIgKw0KICAgICAgICAgICAgICAgICI8L1NpZ25hdHVyZT4iICsNCiAgICAgICAgICAgICAgICAiPC9wZXJzb24+IiwgIlxyXG4iKSwgZG9jLk91dGVyWG1sKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBTaWduZWRYTUxfTEZfVmFsaWQoKQ0KICAgICAgICB7DQogICAgICAgICAgICBYNTA5Q2VydGlmaWNhdGUyIGNlcnQgPSBuZXcgWDUwOUNlcnRpZmljYXRlMihfcGtjczEyLCAibW9ubyIpOw0KDQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBDcmVhdGVTaWduZWRYbWwoY2VydCwgU2lnbmVkWG1sLlhtbERzaWdFeGNDMTROVHJhbnNmb3JtVXJsLCAiXG4iKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChzdHJpbmcuRm9ybWF0KEN1bHR1cmVJbmZvLkludmFyaWFudEN1bHR1cmUsICI8cGVyc29uPnswfSIgKw0KICAgICAgICAgICAgICAgICIgIDxiaXJ0aHBsYWNlPkJydXNzZWxzPC9iaXJ0aHBsYWNlPnswfSIgKw0KICAgICAgICAgICAgICAgICI8U2lnbmF0dXJlIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI1wiPiIgKw0KICAgICAgICAgICAgICAgICI8U2lnbmVkSW5mbz4iICsNCiAgICAgICAgICAgICAgICAiPENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jXCIgLz4iICsNCiAgICAgICAgICAgICAgICAiPFNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjcnNhLXNoYTFcIiAvPiIgKw0KICAgICAgICAgICAgICAgICI8UmVmZXJlbmNlIFVSST1cIlwiPiIgKw0KICAgICAgICAgICAgICAgICI8VHJhbnNmb3Jtcz4iICsNCiAgICAgICAgICAgICAgICAiPFRyYW5zZm9ybSBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZVwiIC8+IiArDQogICAgICAgICAgICAgICAgIjwvVHJhbnNmb3Jtcz4iICsNCiAgICAgICAgICAgICAgICAiPERpZ2VzdE1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMVwiIC8+IiArDQogICAgICAgICAgICAgICAgIjxEaWdlc3RWYWx1ZT5lM2RzaTF4SzhGQXgxdnN1ZzdKMjAzSmJFQVU9PC9EaWdlc3RWYWx1ZT4iICsNCiAgICAgICAgICAgICAgICAiPC9SZWZlcmVuY2U+IiArDQogICAgICAgICAgICAgICAgIjwvU2lnbmVkSW5mbz4iICsNCiAgICAgICAgICAgICAgICAiPFNpZ25hdHVyZVZhbHVlPiIgKw0KICAgICAgICAgICAgICAgICJYMjluYmtPUi9YazNLd3NFcEV2cERPcWZJNi9OVHRpZXdJeE5xS01yUENvTTBITGF3SzVIS3NDdzNsTDA3QyIgKw0KICAgICAgICAgICAgICAgICI4U3dxdm9YSkw5VlMwNWdzU2lhODVZQ0I4TlBEZUh1SFkzQ1BHVDdEVnBnZUhGQTBvZWZNbk9pOElBcUtEMiIgKw0KICAgICAgICAgICAgICAgICJueDI5QTIyMnU1T213YkRPMHFGcWJ0c2d2SUZpUDVZSmcwNGN3bW5xcytlTCtXQT0iICsNCiAgICAgICAgICAgICAgICAiPC9TaWduYXR1cmVWYWx1ZT4iICsNCiAgICAgICAgICAgICAgICAiPEtleUluZm8+IiArDQogICAgICAgICAgICAgICAgIjxYNTA5RGF0YT4iICsNCiAgICAgICAgICAgICAgICAiPFg1MDlDZXJ0aWZpY2F0ZT4iICsNCiAgICAgICAgICAgICAgICAiTUlJQm96Q0NBUXlnQXdJQkFnSVFIYys4aVVSU1RVYXJtZzR0cm1ybkdUQU5CZ2txaGtpRzl3MEJBUVVGQUQiICsNCiAgICAgICAgICAgICAgICAiQVJNUTh3RFFZRFZRUURFd1pPYjNabGJHd3dJQmNOTURZd09USXhNRGN5TmpVeFdoZ1BNakE1TURBeE1qRXciICsNCiAgICAgICAgICAgICAgICAiT0RJMk5URmFNQTh4RFRBTEJnTlZCQU1UQkUxdmJtOHdnWjB3RFFZSktvWklodmNOQVFFQkJRQURnWXNBTUkiICsNCiAgICAgICAgICAgICAgICAiR0hBb0dCQUpoRkIxS0h2Mld6c0hxaWg5TXZtM0tmZkVPU012K3NoMW1QVzNzV0kvOTVWT09WcUpuaGVtTU0iICsNCiAgICAgICAgICAgICAgICAiczgycGhTYk5aZW9QSG55NGJ0YnlrYlJSYVJRdjk0cnRJTTZnZUpSMWUyYzVtZkpXdEhTcTNFWVFhckhDNjgiICsNCiAgICAgICAgICAgICAgICAiY0FadkNBbVFaR2ExZVFSTlJxY1RTS1g4eWZxSDBTb3VJRTlvaEp0cGlsdU5lK1hnazVmS3YzQWdFUk1BMEciICsNCiAgICAgICAgICAgICAgICAiQ1NxR1NJYjNEUUVCQlFVQUE0R0JBRTZwcVNnSzhRS1JIU2g2WXZZczlvUmgxbjhpUkVjbzdRbVpDRmo3VUIiICsNCiAgICAgICAgICAgICAgICAia24vUWdKOW1Lc1Q4bzEyVm5ZSHFCQ0V3Qk5hVDFheTN6L1NSNC9aMzgzenV1NFk2eHhqcU9xbk02Z3R3VVYiICsNCiAgICAgICAgICAgICAgICAidTUvMGh2eitUaHR1VGpJdEc2Tnk1SmtMWlpRdC9YYkk1a2c5MjB0OWpxM3ZiSEJNdVgySHhpdndRZTVzdWciICsNCiAgICAgICAgICAgICAgICAialBhVEVZIiArDQogICAgICAgICAgICAgICAgIjwvWDUwOUNlcnRpZmljYXRlPiIgKw0KICAgICAgICAgICAgICAgICI8WDUwOUNlcnRpZmljYXRlPiIgKw0KICAgICAgICAgICAgICAgICJNSUlCcFRDQ0FRNmdBd0lCQWdJUVhvNkxyM3JyU2tXNHhtTlBSYkhNYmpBTkJna3Foa2lHOXcwQkFRVUZBRCIgKw0KICAgICAgICAgICAgICAgICJBUk1ROHdEUVlEVlFRREV3Wk9iM1psYkd3d0lCY05NRFl3T1RJeE1EY3hOREU0V2hnUE1qQTVNREF4TWpFdyIgKw0KICAgICAgICAgICAgICAgICJPREUwTVRoYU1CRXhEekFOQmdOVkJBTVRCazFwWjNWbGJEQ0JuVEFOQmdrcWhraUc5dzBCQVFFRkFBT0JpdyIgKw0KICAgICAgICAgICAgICAgICJBd2dZY0NnWUVBckNrZVNaNlUzVTNGbTJxU3VRc003eHZ2c1N6WkdRTFBEVUhGUS9CWnhBN0xpR1JmWGJtTyIgKw0KICAgICAgICAgICAgICAgICJ5UGtrWVJZSXRYZHkweURsLzhyQWplbGFMOGpRNG1lNlVleHllcSs1eEVnSG45VmJOSm55NWFwR05pNGtGMSIgKw0KICAgICAgICAgICAgICAgICI4RFI1REs5Wm1lOWQ2aWN1c2dXOGtydjMvLzVTVkU4YW83WDVxcklPR1M4MjVlQ0pMNzNZV2J4S2tDQVJFdyIgKw0KICAgICAgICAgICAgICAgICJEUVlKS29aSWh2Y05BUUVGQlFBRGdZRUFTcUJnWVRrSUpwRE8yOFpFWG5GNVEvRzN4RFIvTXhoZGNyQ0lTSiIgKw0KICAgICAgICAgICAgICAgICJ0RGJ1R1ZaeksreGhGaGlZRDVRMU5pR2hENG9ESVZKUHdLbVpINEwzWVA5NmlTaDZSZHRPMjdWMDVFVC9YNSIgKw0KICAgICAgICAgICAgICAgICJ5V01LZGVJc3E2cjlqWFh2N05hV1Rtdk5mTUxLTE5nRUJDSjAwK3dOMHU0eEhVQzd5Q0pjMEtOUTNmakRMVSIgKw0KICAgICAgICAgICAgICAgICJBVDFvYVZqV0k9IiArDQogICAgICAgICAgICAgICAgIjwvWDUwOUNlcnRpZmljYXRlPiIgKw0KICAgICAgICAgICAgICAgICI8L1g1MDlEYXRhPiIgKw0KICAgICAgICAgICAgICAgICI8L0tleUluZm8+IiArDQogICAgICAgICAgICAgICAgIjwvU2lnbmF0dXJlPiIgKw0KICAgICAgICAgICAgICAgICI8L3BlcnNvbj4iLCAiXG4iKSwgZG9jLk91dGVyWG1sKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XSAvLyBwYXJ0IG9mIGJ1ZyAjNzk0NTQNCiAgICAgICAgcHVibGljIHZvaWQgTXVsdGlwbGVYNTA5Q2VydGlmaWNhdGVzKCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbnVsbDsNCiAgICAgICAgICAgIFg1MDlDZXJ0aWZpY2F0ZTIgY2VydCA9IG5ldyBYNTA5Q2VydGlmaWNhdGUyKF9wa2NzMTIsICJtb25vIik7DQoNCiAgICAgICAgICAgIGRvYyA9IENyZWF0ZVNpZ25lZFhtbChjZXJ0LCBTaWduZWRYbWwuWG1sRHNpZ0V4Y0MxNE5UcmFuc2Zvcm1VcmwsICJcbiIpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoVmVyaWZ5U2lnbmVkWG1sKGRvYyksICIjMSIpOw0KDQogICAgICAgICAgICBkb2MgPSBDcmVhdGVTaWduZWRYbWwoY2VydCwgU2lnbmVkWG1sLlhtbERzaWdFeGNDMTROV2l0aENvbW1lbnRzVHJhbnNmb3JtVXJsLCAiXG4iKTsNCiAgICAgICAgICAgIEFzc2VydC5UcnVlKFZlcmlmeVNpZ25lZFhtbChkb2MpLCAiIzIiKTsNCg0KICAgICAgICAgICAgZG9jID0gQ3JlYXRlU2lnbmVkWG1sKGNlcnQsIFNpZ25lZFhtbC5YbWxEc2lnQ2Fub25pY2FsaXphdGlvblVybCwgIlxuIik7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZShWZXJpZnlTaWduZWRYbWwoZG9jKSwgIiMzIik7DQoNCiAgICAgICAgICAgIGRvYyA9IENyZWF0ZVNpZ25lZFhtbChjZXJ0LCBTaWduZWRYbWwuWG1sRHNpZ0Nhbm9uaWNhbGl6YXRpb25XaXRoQ29tbWVudHNVcmwsICJcbiIpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoVmVyaWZ5U2lnbmVkWG1sKGRvYyksICIjNCIpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gY3JlYXRlcyBhIHNpZ25lZCBYTUwgZG9jdW1lbnQgd2l0aCB0d28gY2VydGlmaWNhdGVzIGluIHRoZSBYNTA5RGF0YSANCiAgICAgICAgLy8gZWxlbWVudCwgd2l0aCB0aGUgc2Vjb25kIGJlaW5nIHRoZSBvbmUgdGhhdCBzaG91bGQgYmUgdXNlZCB0byB2ZXJpZnkNCiAgICAgICAgLy8gdGhlIHNpZ25hdHVyZQ0KICAgICAgICBzdGF0aWMgWG1sRG9jdW1lbnQgQ3JlYXRlU2lnbmVkWG1sKFg1MDlDZXJ0aWZpY2F0ZTIgY2VydCwgc3RyaW5nIGNhbm9uaWNhbGl6YXRpb25NZXRob2QsIHN0cmluZyBsaW5lRmVlZCkNCiAgICAgICAgew0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gQ3JlYXRlU29tZVhtbChsaW5lRmVlZCk7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduZWRYbWwgPSBuZXcgU2lnbmVkWG1sKGRvYyk7DQogICAgICAgICAgICBzaWduZWRYbWwuU2lnbmluZ0tleSA9IGNlcnQuUHJpdmF0ZUtleTsNCiAgICAgICAgICAgIHNpZ25lZFhtbC5TaWduZWRJbmZvLkNhbm9uaWNhbGl6YXRpb25NZXRob2QgPSBjYW5vbmljYWxpemF0aW9uTWV0aG9kOw0KICAgICAgICAgICAgc2lnbmVkWG1sLlNpZ25lZEluZm8uU2lnbmF0dXJlTWV0aG9kID0gU2lnbmVkWG1sLlhtbERzaWdSU0FTSEExVXJsOw0KDQogICAgICAgICAgICBSZWZlcmVuY2UgcmVmZXJlbmNlID0gbmV3IFJlZmVyZW5jZSgpOw0KICAgICAgICAgICAgcmVmZXJlbmNlLkRpZ2VzdE1ldGhvZCA9IFNpZ25lZFhtbC5YbWxEc2lnU0hBMVVybDsNCiAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiIjsNCg0KICAgICAgICAgICAgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSBlbnYgPSBuZXcgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSgpOw0KICAgICAgICAgICAgcmVmZXJlbmNlLkFkZFRyYW5zZm9ybShlbnYpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLkFkZFJlZmVyZW5jZShyZWZlcmVuY2UpOw0KDQogICAgICAgICAgICBLZXlJbmZvIGtleUluZm8gPSBuZXcgS2V5SW5mbygpOw0KICAgICAgICAgICAgS2V5SW5mb1g1MDlEYXRhIHg1MDlLZXlJbmZvID0gbmV3IEtleUluZm9YNTA5RGF0YSgpOw0KICAgICAgICAgICAgeDUwOUtleUluZm8uQWRkQ2VydGlmaWNhdGUobmV3IFg1MDlDZXJ0aWZpY2F0ZTIoX2NlcnQpKTsNCiAgICAgICAgICAgIHg1MDlLZXlJbmZvLkFkZENlcnRpZmljYXRlKGNlcnQpOw0KICAgICAgICAgICAga2V5SW5mby5BZGRDbGF1c2UoeDUwOUtleUluZm8pOw0KICAgICAgICAgICAgc2lnbmVkWG1sLktleUluZm8gPSBrZXlJbmZvOw0KDQogICAgICAgICAgICBzaWduZWRYbWwuQ29tcHV0ZVNpZ25hdHVyZSgpOw0KICAgICAgICAgICAgWG1sRWxlbWVudCB4bWxEaWdpdGFsU2lnbmF0dXJlID0gc2lnbmVkWG1sLkdldFhtbCgpOw0KDQogICAgICAgICAgICBkb2MuRG9jdW1lbnRFbGVtZW50LkFwcGVuZENoaWxkKGRvYy5JbXBvcnROb2RlKHhtbERpZ2l0YWxTaWduYXR1cmUsIHRydWUpKTsNCiAgICAgICAgICAgIHJldHVybiBkb2M7DQogICAgICAgIH0NCg0KICAgICAgICBzdGF0aWMgYm9vbCBWZXJpZnlTaWduZWRYbWwoWG1sRG9jdW1lbnQgc2lnbmVkRG9jKQ0KICAgICAgICB7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbmVkWG1sID0gbmV3IFNpZ25lZFhtbChzaWduZWREb2MpOw0KICAgICAgICAgICAgWG1sTm9kZUxpc3Qgbm9kZUxpc3QgPSBzaWduZWREb2MuR2V0RWxlbWVudHNCeVRhZ05hbWUoIlNpZ25hdHVyZSIpOw0KICAgICAgICAgICAgc2lnbmVkWG1sLkxvYWRYbWwoKFhtbEVsZW1lbnQpbm9kZUxpc3RbMF0pOw0KICAgICAgICAgICAgcmV0dXJuIHNpZ25lZFhtbC5DaGVja1NpZ25hdHVyZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgc3RhdGljIFhtbERvY3VtZW50IENyZWF0ZVNvbWVYbWwoc3RyaW5nIGxpbmVGZWVkKQ0KICAgICAgICB7DQogICAgICAgICAgICBTdHJpbmdXcml0ZXIgc3cgPSBuZXcgU3RyaW5nV3JpdGVyKCk7DQogICAgICAgICAgICBzdy5OZXdMaW5lID0gbGluZUZlZWQ7DQogICAgICAgICAgICBYbWxUZXh0V3JpdGVyIHh0dyA9IG5ldyBYbWxUZXh0V3JpdGVyKHN3KTsNCiAgICAgICAgICAgIHh0dy5Gb3JtYXR0aW5nID0gRm9ybWF0dGluZy5JbmRlbnRlZDsNCiAgICAgICAgICAgIHh0dy5Xcml0ZVN0YXJ0RWxlbWVudCgicGVyc29uIik7DQogICAgICAgICAgICB4dHcuV3JpdGVFbGVtZW50U3RyaW5nKCJiaXJ0aHBsYWNlIiwgIkJydXNzZWxzIik7DQogICAgICAgICAgICB4dHcuV3JpdGVFbmRFbGVtZW50KCk7DQogICAgICAgICAgICB4dHcuRmx1c2goKTsNCg0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBkb2MuUHJlc2VydmVXaGl0ZXNwYWNlID0gdHJ1ZTsNCiAgICAgICAgICAgIGRvYy5Mb2FkKG5ldyBTdHJpbmdSZWFkZXIoc3cuVG9TdHJpbmcoKSkpOw0KICAgICAgICAgICAgcmV0dXJuIGRvYzsNCiAgICAgICAgfQ0KDQogICAgICAgIHN0cmluZyBTdHJlYW0yU3RyaW5nKFN0cmVhbSBzKQ0KICAgICAgICB7DQogICAgICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsNCiAgICAgICAgICAgIGludCBiID0gcy5SZWFkQnl0ZSgpOw0KICAgICAgICAgICAgd2hpbGUgKGIgIT0gLTEpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc2IuQXBwZW5kKENvbnZlcnQuVG9DaGFyKGIpKTsNCiAgICAgICAgICAgICAgICBiID0gcy5SZWFkQnl0ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHNiLlRvU3RyaW5nKCk7DQogICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIHN0YXRpYyBieXRlW10gX2NlcnQgPSBuZXcgYnl0ZVtdIHsNCiAgICAgICAgICAgIDB4MzAsIDB4ODIsIDB4MDEsIDB4YTMsIDB4MzAsIDB4ODIsIDB4MDEsIDB4MGMsIDB4YTAsIDB4MDMsIDB4MDIsDQogICAgICAgICAgICAweDAxLCAweDAyLCAweDAyLCAweDEwLCAweDFkLCAweGNmLCAweGJjLCAweDg5LCAweDQ0LCAweDUyLCAweDRkLA0KICAgICAgICAgICAgMHg0NiwgMHhhYiwgMHg5YSwgMHgwZSwgMHgyZCwgMHhhZSwgMHg2YSwgMHhlNywgMHgxOSwgMHgzMCwgMHgwZCwNCiAgICAgICAgICAgIDB4MDYsIDB4MDksIDB4MmEsIDB4ODYsIDB4NDgsIDB4ODYsIDB4ZjcsIDB4MGQsIDB4MDEsIDB4MDEsIDB4MDUsDQogICAgICAgICAgICAweDA1LCAweDAwLCAweDMwLCAweDExLCAweDMxLCAweDBmLCAweDMwLCAweDBkLCAweDA2LCAweDAzLCAweDU1LA0KICAgICAgICAgICAgMHgwNCwgMHgwMywgMHgxMywgMHgwNiwgMHg0ZSwgMHg2ZiwgMHg3NiwgMHg2NSwgMHg2YywgMHg2YywgMHgzMCwNCiAgICAgICAgICAgIDB4MjAsIDB4MTcsIDB4MGQsIDB4MzAsIDB4MzYsIDB4MzAsIDB4MzksIDB4MzIsIDB4MzEsIDB4MzAsIDB4MzcsDQogICAgICAgICAgICAweDMyLCAweDM2LCAweDM1LCAweDMxLCAweDVhLCAweDE4LCAweDBmLCAweDMyLCAweDMwLCAweDM5LCAweDMwLA0KICAgICAgICAgICAgMHgzMCwgMHgzMSwgMHgzMiwgMHgzMSwgMHgzMCwgMHgzOCwgMHgzMiwgMHgzNiwgMHgzNSwgMHgzMSwgMHg1YSwNCiAgICAgICAgICAgIDB4MzAsIDB4MGYsIDB4MzEsIDB4MGQsIDB4MzAsIDB4MGIsIDB4MDYsIDB4MDMsIDB4NTUsIDB4MDQsIDB4MDMsDQogICAgICAgICAgICAweDEzLCAweDA0LCAweDRkLCAweDZmLCAweDZlLCAweDZmLCAweDMwLCAweDgxLCAweDlkLCAweDMwLCAweDBkLA0KICAgICAgICAgICAgMHgwNiwgMHgwOSwgMHgyYSwgMHg4NiwgMHg0OCwgMHg4NiwgMHhmNywgMHgwZCwgMHgwMSwgMHgwMSwgMHgwMSwNCiAgICAgICAgICAgIDB4MDUsIDB4MDAsIDB4MDMsIDB4ODEsIDB4OGIsIDB4MDAsIDB4MzAsIDB4ODEsIDB4ODcsIDB4MDIsIDB4ODEsDQogICAgICAgICAgICAweDgxLCAweDAwLCAweDk4LCAweDQ1LCAweDA3LCAweDUyLCAweDg3LCAweGJmLCAweDY1LCAweGIzLCAweGIwLA0KICAgICAgICAgICAgMHg3YSwgMHhhMiwgMHg4NywgMHhkMywgMHgyZiwgMHg5YiwgMHg3MiwgMHg5ZiwgMHg3YywgMHg0MywgMHg5MiwNCiAgICAgICAgICAgIDB4MzIsIDB4ZmYsIDB4YWMsIDB4ODcsIDB4NTksIDB4OGYsIDB4NWIsIDB4N2IsIDB4MTYsIDB4MjMsIDB4ZmYsDQogICAgICAgICAgICAweDc5LCAweDU0LCAweGUzLCAweDk1LCAweGE4LCAweDk5LCAweGUxLCAweDdhLCAweDYzLCAweDBjLCAweGIzLA0KICAgICAgICAgICAgMHhjZCwgMHhhOSwgMHg4NSwgMHgyNiwgMHhjZCwgMHg2NSwgMHhlYSwgMHgwZiwgMHgxZSwgMHg3YywgMHhiOCwNCiAgICAgICAgICAgIDB4NmUsIDB4ZDYsIDB4ZjIsIDB4OTEsIDB4YjQsIDB4NTEsIDB4NjksIDB4MTQsIDB4MmYsIDB4ZjcsIDB4OGEsDQogICAgICAgICAgICAweGVkLCAweDIwLCAweGNlLCAweGEwLCAweDc4LCAweDk0LCAweDc1LCAweDdiLCAweDY3LCAweDM5LCAweDk5LA0KICAgICAgICAgICAgMHhmMiwgMHg1NiwgMHhiNCwgMHg3NCwgMHhhYSwgMHhkYywgMHg0NiwgMHgxMCwgMHg2YSwgMHhiMSwgMHhjMiwNCiAgICAgICAgICAgIDB4ZWIsIDB4YzcsIDB4MDAsIDB4NjYsIDB4ZjAsIDB4ODAsIDB4OTksIDB4MDYsIDB4NDYsIDB4NmIsIDB4NTcsDQogICAgICAgICAgICAweDkwLCAweDQ0LCAweGQ0LCAweDZhLCAweDcxLCAweDM0LCAweDhhLCAweDVmLCAweGNjLCAweDlmLCAweGE4LA0KICAgICAgICAgICAgMHg3ZCwgMHgxMiwgMHhhMiwgMHhlMiwgMHgwNCwgMHhmNiwgMHg4OCwgMHg0OSwgMHhiNiwgMHg5OCwgMHhhNSwNCiAgICAgICAgICAgIDB4YjgsIDB4ZDcsIDB4YmUsIDB4NWUsIDB4MDksIDB4MzksIDB4N2MsIDB4YWIsIDB4ZjcsIDB4MDIsIDB4MDEsDQogICAgICAgICAgICAweDExLCAweDMwLCAweDBkLCAweDA2LCAweDA5LCAweDJhLCAweDg2LCAweDQ4LCAweDg2LCAweGY3LCAweDBkLA0KICAgICAgICAgICAgMHgwMSwgMHgwMSwgMHgwNSwgMHgwNSwgMHgwMCwgMHgwMywgMHg4MSwgMHg4MSwgMHgwMCwgMHg0ZSwgMHhhOSwNCiAgICAgICAgICAgIDB4YTksIDB4MjgsIDB4MGEsIDB4ZjEsIDB4MDIsIDB4OTEsIDB4MWQsIDB4MjgsIDB4N2EsIDB4NjIsIDB4ZjYsDQogICAgICAgICAgICAweDJjLCAweGY2LCAweDg0LCAweDYxLCAweGQ2LCAweDdmLCAweDIyLCAweDQ0LCAweDQ3LCAweDI4LCAweGVkLA0KICAgICAgICAgICAgMHgwOSwgMHg5OSwgMHgwOCwgMHg1OCwgMHhmYiwgMHg1MCwgMHgxOSwgMHgyNywgMHhmZCwgMHgwOCwgMHgwOSwNCiAgICAgICAgICAgIDB4ZjYsIDB4NjIsIDB4YWMsIDB4NGYsIDB4Y2EsIDB4MzUsIDB4ZDksIDB4NTksIDB4ZDgsIDB4MWUsIDB4YTAsDQogICAgICAgICAgICAweDQyLCAweDEzLCAweDAwLCAweDRkLCAweDY5LCAweDNkLCAweDVhLCAweGNiLCAweDdjLCAweGZmLCAweDQ5LA0KICAgICAgICAgICAgMHgxZSwgMHgzZiwgMHg2NywgMHg3ZiwgMHgzNywgMHhjZSwgMHhlYiwgMHhiOCwgMHg2MywgMHhhYywgMHg3MSwNCiAgICAgICAgICAgIDB4OGUsIDB4YTMsIDB4YWEsIDB4OWMsIDB4Y2UsIDB4YTAsIDB4YjcsIDB4MDUsIDB4MTUsIDB4YmIsIDB4OWYsDQogICAgICAgICAgICAweGY0LCAweDg2LCAweGZjLCAweGZlLCAweDRlLCAweDFiLCAweDZlLCAweDRlLCAweDMyLCAweDJkLCAweDFiLA0KICAgICAgICAgICAgMHhhMywgMHg3MiwgMHhlNCwgMHg5OSwgMHgwYiwgMHg2NSwgMHg5NCwgMHgyZCwgMHhmZCwgMHg3NiwgMHhjOCwNCiAgICAgICAgICAgIDB4ZTYsIDB4NDgsIDB4M2QsIDB4ZGIsIDB4NGIsIDB4N2QsIDB4OGUsIDB4YWQsIDB4ZWYsIDB4NmMsIDB4NzAsDQogICAgICAgICAgICAweDRjLCAweGI5LCAweDdkLCAweDg3LCAweGM2LCAweDJiLCAweGYwLCAweDQxLCAweGVlLCAweDZjLCAweGJhLA0KICAgICAgICAgICAgMHgwOCwgMHhjZiwgMHg2OSwgMHgzMSwgMHgxOCB9Ow0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIGJ5dGVbXSBfcGtjczEyID0gbmV3IGJ5dGVbXSB7DQogICAgICAgICAgICAweDMwLCAweDgyLCAweDA1LCAweDhkLCAweDAyLCAweDAxLCAweDAzLCAweDMwLCAweDgyLCAweDA1LCAweDQ3LA0KICAgICAgICAgICAgMHgwNiwgMHgwOSwgMHgyYSwgMHg4NiwgMHg0OCwgMHg4NiwgMHhmNywgMHgwZCwgMHgwMSwgMHgwNywgMHgwMSwNCiAgICAgICAgICAgIDB4YTAsIDB4ODIsIDB4MDUsIDB4MzgsIDB4MDQsIDB4ODIsIDB4MDUsIDB4MzQsIDB4MzAsIDB4ODIsIDB4MDUsDQogICAgICAgICAgICAweDMwLCAweDMwLCAweDgyLCAweDAyLCAweDNmLCAweDA2LCAweDA5LCAweDJhLCAweDg2LCAweDQ4LCAweDg2LA0KICAgICAgICAgICAgMHhmNywgMHgwZCwgMHgwMSwgMHgwNywgMHgwNiwgMHhhMCwgMHg4MiwgMHgwMiwgMHgzMCwgMHgzMCwgMHg4MiwNCiAgICAgICAgICAgIDB4MDIsIDB4MmMsIDB4MDIsIDB4MDEsIDB4MDAsIDB4MzAsIDB4ODIsIDB4MDIsIDB4MjUsIDB4MDYsIDB4MDksDQogICAgICAgICAgICAweDJhLCAweDg2LCAweDQ4LCAweDg2LCAweGY3LCAweDBkLCAweDAxLCAweDA3LCAweDAxLCAweDMwLCAweDFjLA0KICAgICAgICAgICAgMHgwNiwgMHgwYSwgMHgyYSwgMHg4NiwgMHg0OCwgMHg4NiwgMHhmNywgMHgwZCwgMHgwMSwgMHgwYywgMHgwMSwNCiAgICAgICAgICAgIDB4MDMsIDB4MzAsIDB4MGUsIDB4MDQsIDB4MDgsIDB4NmUsIDB4MGEsIDB4NTAsIDB4MjAsIDB4YzMsIDB4MTEsDQogICAgICAgICAgICAweDQ5LCAweDA3LCAweDAyLCAweDAyLCAweDA3LCAweGQwLCAweDgwLCAweDgyLCAweDAxLCAweGY4LCAweDc0LA0KICAgICAgICAgICAgMHg0MCwgMHgwNywgMHg0NCwgMHg2YiwgMHg4MCwgMHg0NiwgMHhlMSwgMHg0ZSwgMHg2NSwgMHg1ZSwgMHhmMiwNCiAgICAgICAgICAgIDB4ZjYsIDB4MzgsIDB4OTAsIDB4ZDEsIDB4NzUsIDB4MjQsIDB4ZDksIDB4NzIsIDB4OTIsIDB4NWIsIDB4NGEsDQogICAgICAgICAgICAweGI5LCAweDllLCAweGJkLCAweGFiLCAweGUyLCAweGI4LCAweDkxLCAweGM5LCAweDQ4LCAweDE0LCAweDg4LA0KICAgICAgICAgICAgMHg2MSwgMHg3ZCwgMHgwNiwgMHhmOSwgMHgyNCwgMHg4MCwgMHhiNSwgMHgzNiwgMHhhZiwgMHhmZSwgMHhjMCwNCiAgICAgICAgICAgIDB4NTksIDB4MDAsIDB4MzksIDB4M2YsIDB4NzgsIDB4YzAsIDB4NTcsIDB4ZWEsIDB4MWUsIDB4Y2IsIDB4MjksDQogICAgICAgICAgICAweGE0LCAweDVmLCAweGJhLCAweDRiLCAweGQ5LCAweGNhLCAweDk1LCAweGFiLCAweDU1LCAweDRhLCAweDExLA0KICAgICAgICAgICAgMHgxYSwgMHhmOCwgMHhlOSwgMHhkNCwgMHhjMCwgMHgwOCwgMHg1NSwgMHhmYiwgMHg2OSwgMHgwOSwgMHgwZCwNCiAgICAgICAgICAgIDB4NWIsIDB4ZWQsIDB4MDIsIDB4Y2MsIDB4NTUsIDB4ZmUsIDB4MDUsIDB4MmUsIDB4NDUsIDB4YTcsIDB4OGQsDQogICAgICAgICAgICAweDYzLCAweDlhLCAweGRhLCAweDZjLCAweGM3LCAweGUxLCAweGNiLCAweDVjLCAweGE3LCAweGQ5LCAweDliLA0KICAgICAgICAgICAgMHg0YSwgMHhmYiwgMHg3ZCwgMHgzMSwgMHhlNSwgMHg4OSwgMHgzZSwgMHhmMiwgMHgzMiwgMHhjOSwgMHg3OCwNCiAgICAgICAgICAgIDB4ZDAsIDB4NjYsIDB4MWUsIDB4MzgsIDB4YzcsIDB4YmYsIDB4NDEsIDB4ZjksIDB4ZTcsIDB4YmQsIDB4Y2UsDQogICAgICAgICAgICAweDhiLCAweGMzLCAweDE0LCAweDE5LCAweDRiLCAweGZhLCAweDNhLCAweGEyLCAweDFmLCAweGIwLCAweGQ0LA0KICAgICAgICAgICAgMHhmYSwgMHgzMywgMHgzOSwgMHgxMiwgMHhkOSwgMHgzNiwgMHg3ZiwgMHg3ZSwgMHhmMCwgMHhjNCwgMHhkYywNCiAgICAgICAgICAgIDB4ZjAsIDB4YjUsIDB4N2EsIDB4NTAsIDB4MmMsIDB4OTksIDB4OWQsIDB4MDIsIDB4NDAsIDB4ZWMsIDB4NmEsDQogICAgICAgICAgICAweDIzLCAweDgzLCAweDE2LCAweGVjLCAweDhmLCAweDU4LCAweDE0LCAweGEwLCAweGEwLCAweDljLCAweGEwLA0KICAgICAgICAgICAgMHhlMSwgMHhkMCwgMHg2ZiwgMHg1NCwgMHgxYSwgMHgxMCwgMHg0NywgMHg2OSwgMHg2YiwgMHg1NSwgMHg3ZiwNCiAgICAgICAgICAgIDB4NjcsIDB4N2QsIDB4YjgsIDB4MzgsIDB4YTAsIDB4NDAsIDB4OTksIDB4MTMsIDB4ZTgsIDB4MTUsIDB4NzMsDQogICAgICAgICAgICAweDhkLCAweDE4LCAweDg2LCAweDI5LCAweDc0LCAweGVjLCAweDY2LCAweGEzLCAweGI4LCAweDE0LCAweDEwLA0KICAgICAgICAgICAgMHg2MSwgMHhlZiwgMHhhNSwgMHg3OSwgMHg4OSwgMHgwMSwgMHhhYSwgMHhmMiwgMHgxZiwgMHgwYywgMHhkZCwNCiAgICAgICAgICAgIDB4MGQsIDB4OGMsIDB4YmIsIDB4N2EsIDB4NGUsIDB4MGYsIDB4NDcsIDB4OTEsIDB4MzcsIDB4YTMsIDB4OGEsDQogICAgICAgICAgICAweDQzLCAweDBmLCAweGViLCAweGM3LCAweDliLCAweDhkLCAweGFmLCAweDM5LCAweGRmLCAweDIzLCAweDFjLA0KICAgICAgICAgICAgMHhhNCwgMHhmNywgMHg2NiwgMHgxYywgMHg2MSwgMHg0MiwgMHgyNCwgMHg5YSwgMHgwYSwgMHgzYSwgMHgzMSwNCiAgICAgICAgICAgIDB4OWMsIDB4NTEsIDB4YTIsIDB4MzAsIDB4YmUsIDB4ODUsIDB4YTYsIDB4ZTgsIDB4MTgsIDB4ZmEsIDB4OGIsDQogICAgICAgICAgICAweGZmLCAweGRkLCAweGRjLCAweDM0LCAweDQ2LCAweDRmLCAweDE1LCAweGRlLCAweGRiLCAweGM0LCAweGViLA0KICAgICAgICAgICAgMHg2MiwgMHgzYiwgMHg3YywgMHgyNSwgMHgxYSwgMHgxMywgMHg4YiwgMHhkYSwgMHgzYiwgMHg1OSwgMHgyYSwNCiAgICAgICAgICAgIDB4YjgsIDB4NTAsIDB4ZTMsIDB4OWYsIDB4NzYsIDB4ZmMsIDB4ZTgsIDB4MDAsIDB4ZmMsIDB4ZjcsIDB4YmEsDQogICAgICAgICAgICAweGQyLCAweDQ1LCAweDkyLCAweDE0LCAweGI1LCAweGUyLCAweDkzLCAweDQxLCAweDA5LCAweGVhLCAweDViLA0KICAgICAgICAgICAgMHg1ZSwgMHhkYSwgMHg2NiwgMHg5MiwgMHhkMSwgMHg5MywgMHg3YSwgMHhjMCwgMHhlMSwgMHgyZiwgMHhlZCwNCiAgICAgICAgICAgIDB4MjksIDB4NzgsIDB4ODAsIDB4ZmYsIDB4NzksIDB4MGUsIDB4ZGEsIDB4NzgsIDB4N2UsIDB4NzEsIDB4YTQsDQogICAgICAgICAgICAweDMxLCAweDJmLCAweGU5LCAweDQ4LCAweGFiLCAweGM5LCAweDQwLCAweDdkLCAweDYzLCAweDA2LCAweGQ2LA0KICAgICAgICAgICAgMHhiNSwgMHgyYiwgMHg0OSwgMHhiYSwgMHg0MywgMHg1NiwgMHg2OSwgMHhjNSwgMHhjMiwgMHg4NSwgMHgzNywNCiAgICAgICAgICAgIDB4ZGIsIDB4ZTcsIDB4MzksIDB4ODcsIDB4OGQsIDB4MTQsIDB4MTUsIDB4NTUsIDB4NzYsIDB4M2YsIDB4NzAsDQogICAgICAgICAgICAweGY2LCAweGQ3LCAweDgwLCAweDgyLCAweDQ4LCAweDAyLCAweDY0LCAweGUxLCAweDczLCAweDFhLCAweGQ5LA0KICAgICAgICAgICAgMHgzNSwgMHgxYSwgMHg0MywgMHhmMywgMHhkZSwgMHhkNCwgMHgwMCwgMHg5ZCwgMHg0OSwgMHgyYiwgMHhjNiwNCiAgICAgICAgICAgIDB4NjYsIDB4MTksIDB4M2UsIDB4YjgsIDB4Y2MsIDB4NDMsIDB4Y2MsIDB4YTgsIDB4MTIsIDB4YTQsIDB4YWQsDQogICAgICAgICAgICAweGNkLCAweGUyLCAweGU2LCAweGIzLCAweGRkLCAweDdlLCAweDgwLCAweDUwLCAweGMwLCAweGI0LCAweDBjLA0KICAgICAgICAgICAgMHg0YywgMHhkMiwgMHgzMSwgMHhmMywgMHhmOCwgMHg0OSwgMHgzMSwgMHhiZSwgMHhmMiwgMHg3ZCwgMHg2MCwNCiAgICAgICAgICAgIDB4MzgsIDB4ZTAsIDB4NjAsIDB4ZGYsIDB4N2IsIDB4NTgsIDB4ZTAsIDB4ZjksIDB4NmUsIDB4NjgsIDB4NzksDQogICAgICAgICAgICAweDMzLCAweGIyLCAweDJhLCAweDUzLCAweDRjLCAweDVhLCAweDlkLCAweGIzLCAweDgxLCAweDRiLCAweDE5LA0KICAgICAgICAgICAgMHgyMSwgMHhlMiwgMHgzYSwgMHg0MiwgMHgwNywgMHgyNSwgMHg1YSwgMHhlZSwgMHgxZiwgMHg1ZCwgMHhhMiwNCiAgICAgICAgICAgIDB4Y2EsIDB4ZjcsIDB4MmYsIDB4M2MsIDB4OWIsIDB4YjAsIDB4YmMsIDB4ZTcsIDB4YWYsIDB4OGMsIDB4MmYsDQogICAgICAgICAgICAweDUyLCAweDQzLCAweDc5LCAweDk0LCAweGIwLCAweGVlLCAweGM0LCAweDUzLCAweDA5LCAweGMwLCAweGM5LA0KICAgICAgICAgICAgMHgyMSwgMHgzOSwgMHg2NCwgMHg4MiwgMHhjMywgMHg1NCwgMHhiOCwgMHg2NSwgMHhmOCwgMHhkYywgMHhiMywNCiAgICAgICAgICAgIDB4ZGYsIDB4NGQsIDB4YzQsIDB4NjMsIDB4NTksIDB4MTQsIDB4MzcsIDB4ZDYsIDB4YmEsIDB4YTMsIDB4OTgsDQogICAgICAgICAgICAweGRhLCAweDk5LCAweDAyLCAweGRkLCAweDdhLCAweDg3LCAweDNlLCAweDM0LCAweGI1LCAweDRiLCAweDBhLA0KICAgICAgICAgICAgMHhiNCwgMHgyZCwgMHhlYSwgMHgxOSwgMHgyNCwgMHhkMSwgMHhjMiwgMHg5ZiwgMHgzMCwgMHg4MiwgMHgwMiwNCiAgICAgICAgICAgIDB4ZTksIDB4MDYsIDB4MDksIDB4MmEsIDB4ODYsIDB4NDgsIDB4ODYsIDB4ZjcsIDB4MGQsIDB4MDEsIDB4MDcsDQogICAgICAgICAgICAweDAxLCAweGEwLCAweDgyLCAweDAyLCAweGRhLCAweDA0LCAweDgyLCAweDAyLCAweGQ2LCAweDMwLCAweDgyLA0KICAgICAgICAgICAgMHgwMiwgMHhkMiwgMHgzMCwgMHg4MiwgMHgwMiwgMHhjZSwgMHgwNiwgMHgwYiwgMHgyYSwgMHg4NiwgMHg0OCwNCiAgICAgICAgICAgIDB4ODYsIDB4ZjcsIDB4MGQsIDB4MDEsIDB4MGMsIDB4MGEsIDB4MDEsIDB4MDIsIDB4YTAsIDB4ODIsIDB4MDIsDQogICAgICAgICAgICAweGE2LCAweDMwLCAweDgyLCAweDAyLCAweGEyLCAweDMwLCAweDFjLCAweDA2LCAweDBhLCAweDJhLCAweDg2LA0KICAgICAgICAgICAgMHg0OCwgMHg4NiwgMHhmNywgMHgwZCwgMHgwMSwgMHgwYywgMHgwMSwgMHgwMywgMHgzMCwgMHgwZSwgMHgwNCwNCiAgICAgICAgICAgIDB4MDgsIDB4ZTAsIDB4MjEsIDB4NGYsIDB4OTAsIDB4N2QsIDB4ODYsIDB4NzIsIDB4YzcsIDB4MDIsIDB4MDIsDQogICAgICAgICAgICAweDA3LCAweGQwLCAweDA0LCAweDgyLCAweDAyLCAweDgwLCAweDkyLCAweGFjLCAweGU4LCAweDUyLCAweGE2LA0KICAgICAgICAgICAgMHgzZSwgMHhlZCwgMHgzZCwgMHhiYywgMHgyOCwgMHg1ZiwgMHhiOSwgMHg0NSwgMHg3NiwgMHgyNywgMHg5NSwNCiAgICAgICAgICAgIDB4ZjgsIDB4NmEsIDB4YzUsIDB4MTcsIDB4OTcsIDB4NDYsIDB4NTgsIDB4ZTksIDB4MTUsIDB4N2MsIDB4NjgsDQogICAgICAgICAgICAweDYyLCAweDY3LCAweGI1LCAweDJmLCAweDFiLCAweDY0LCAweDI3LCAweDlkLCAweGZkLCAweDY3LCAweDY2LA0KICAgICAgICAgICAgMHg0MiwgMHgyMSwgMHg1YywgMHhmNCwgMHg2NCwgMHgzNywgMHhjYywgMHhjMCwgMHgwNCwgMHgwMSwgMHg5MSwNCiAgICAgICAgICAgIDB4NmMsIDB4NmIsIDB4ODQsIDB4OTYsIDB4YWUsIDB4MDQsIDB4ZmUsIDB4Y2MsIDB4ODgsIDB4NmEsIDB4ODQsDQogICAgICAgICAgICAweGQ3LCAweDU5LCAweDI4LCAweDc4LCAweGM5LCAweGI0LCAweGY2LCAweDRkLCAweDg2LCAweDhkLCAweDU5LA0KICAgICAgICAgICAgMHhjNiwgMHg3NCwgMHgzMCwgMHhjYSwgMHgyZiwgMHgwYSwgMHhhNywgMHg2NiwgMHg5OSwgMHhmNCwgMHg4ZiwNCiAgICAgICAgICAgIDB4NDQsIDB4NmQsIDB4OTcsIDB4M2MsIDB4ZDYsIDB4ZGIsIDB4ZDYsIDB4MzEsIDB4OGMsIDB4ZjcsIDB4NzUsDQogICAgICAgICAgICAweGQ5LCAweDBiLCAweGY1LCAweGQyLCAweDI3LCAweDgwLCAweDgxLCAweDI4LCAweDBmLCAweDZiLCAweDhiLA0KICAgICAgICAgICAgMHg0NSwgMHgxMSwgMHgwOCwgMHgxZCwgMHgwNiwgMHgzMSwgMHg0ZCwgMHg5OCwgMHg2OCwgMHhjOSwgMHgwOSwNCiAgICAgICAgICAgIDB4OWIsIDB4NTEsIDB4ODQsIDB4ODEsIDB4NzQsIDB4NzYsIDB4NTcsIDB4NjMsIDB4YjUsIDB4MzgsIDB4YzgsDQogICAgICAgICAgICAweGUxLCAweDk2LCAweGU0LCAweGNkLCAweGQ0LCAweGU4LCAweGY4LCAweDI2LCAweDg4LCAweDg4LCAweGFhLA0KICAgICAgICAgICAgMHhkZiwgMHgxYiwgMHhjNiwgMHgzNywgMHhiOCwgMHhjNCwgMHhlMSwgMHhjYiwgMHhjMCwgMHg3MSwgMHgzZCwNCiAgICAgICAgICAgIDB4ZDYsIDB4ZDcsIDB4OGIsIDB4YzYsIDB4ZWMsIDB4NWYsIDB4NDIsIDB4ODYsIDB4YjAsIDB4OGQsIDB4MWMsDQogICAgICAgICAgICAweDQ5LCAweGI5LCAweGM2LCAweDk2LCAweDExLCAweGE1LCAweGQ2LCAweGQyLCAweGMwLCAweDE4LCAweGNhLA0KICAgICAgICAgICAgMHhlNywgMHhmNiwgMHg5MywgMHhiNCwgMHhmNSwgMHg3YSwgMHhlNCwgMHhlYywgMHhhMiwgMHg5MCwgMHhmOCwNCiAgICAgICAgICAgIDB4ZWYsIDB4NjYsIDB4MGYsIDB4YTgsIDB4NTIsIDB4MGMsIDB4M2YsIDB4ODUsIDB4NGEsIDB4NzYsIDB4M2EsDQogICAgICAgICAgICAweGI4LCAweDVhLCAweDJkLCAweDAzLCAweDVkLCAweDk5LCAweDcwLCAweGJiLCAweDAyLCAweDFjLCAweDc3LA0KICAgICAgICAgICAgMHg0MywgMHgxMiwgMHhkOSwgMHgxZiwgMHg3YywgMHg2ZiwgMHg2OSwgMHgxNSwgMHgxNywgMHgzMCwgMHg1MSwNCiAgICAgICAgICAgIDB4N2QsIDB4NTMsIDB4YzIsIDB4MDYsIDB4ZTAsIDB4ZDIsIDB4MzEsIDB4MTcsIDB4MmEsIDB4OTgsIDB4ZTMsDQogICAgICAgICAgICAweGUwLCAweDIwLCAweGZiLCAweDAxLCAweGZkLCAweGQxLCAweDFiLCAweDUwLCAweDAwLCAweGFkLCAweDFkLA0KICAgICAgICAgICAgMHhmZiwgMHhhMSwgMHhhZSwgMHhkNiwgMHhhYywgMHgzOCwgMHg4YiwgMHg3MSwgMHgyOCwgMHg0NCwgMHg2NiwNCiAgICAgICAgICAgIDB4OGMsIDB4YjYsIDB4MzQsIDB4YzUsIDB4ODYsIDB4YzksIDB4MzQsIDB4ZGEsIDB4NmMsIDB4MmEsIDB4ZWYsDQogICAgICAgICAgICAweDY5LCAweDNjLCAweGI3LCAweGJkLCAweGE1LCAweDA1LCAweDNjLCAweDdjLCAweGZiLCAweDBjLCAweDJkLA0KICAgICAgICAgICAgMHg0OSwgMHgwOSwgMHhkYiwgMHg5MSwgMHgzYiwgMHg0MSwgMHgyYSwgMHhlNCwgMHhmYSwgMHg0YSwgMHhjMiwNCiAgICAgICAgICAgIDB4ZWEsIDB4OWUsIDB4NmYsIDB4YzMsIDB4NDYsIDB4MmEsIDB4NzcsIDB4ODMsIDB4NGUsIDB4MjIsIDB4MDEsDQogICAgICAgICAgICAweGZiLCAweDBjLCAweDJkLCAweDVhLCAweGNmLCAweDhkLCAweGE3LCAweDU1LCAweDI0LCAweDdjLCAweGRhLA0KICAgICAgICAgICAgMHg5ZSwgMHhkOCwgMHhiYywgMHhmNiwgMHg4MSwgMHg2MywgMHg4YSwgMHgzNiwgMHhkMCwgMHgxMywgMHg3NCwNCiAgICAgICAgICAgIDB4MzAsIDB4NGQsIDB4ZDgsIDB4NGUsIDB4YTYsIDB4ODEsIDB4NzEsIDB4NzEsIDB4ZmYsIDB4OWYsIDB4ZjMsDQogICAgICAgICAgICAweDhkLCAweDc1LCAweGFkLCAweDZiLCAweDkzLCAweDkzLCAweDhjLCAweGY4LCAweDdkLCAweGE2LCAweDYyLA0KICAgICAgICAgICAgMHg5ZCwgMHhmNywgMHg4NiwgMHg2ZiwgMHhjYiwgMHg1YiwgMHg2ZiwgMHhlNSwgMHhlZSwgMHhjZCwgMHhiMCwNCiAgICAgICAgICAgIDB4YjIsIDB4ZmQsIDB4OTYsIDB4MmMsIDB4ZGUsIDB4YTAsIDB4Y2YsIDB4NDYsIDB4OGMsIDB4NjYsIDB4MGUsDQogICAgICAgICAgICAweGY5LCAweGEzLCAweGRiLCAweGZhLCAweDhmLCAweDFiLCAweDU0LCAweDlkLCAweDEzLCAweDEzLCAweDZiLA0KICAgICAgICAgICAgMHg5NywgMHg0MywgMHg5NywgMHg2NCwgMHhlYywgMHgyYSwgMHhjNSwgMHhjMCwgMHgyNiwgMHhhYiwgMHhlYSwNCiAgICAgICAgICAgIDB4MzcsIDB4ZDYsIDB4Y2IsIDB4YjksIDB4ODMsIDB4MTgsIDB4NTMsIDB4NWEsIDB4Y2QsIDB4MjgsIDB4YjMsDQogICAgICAgICAgICAweDNiLCAweDljLCAweDEzLCAweGFhLCAweDc4LCAweDZjLCAweGNmLCAweGU5LCAweDc1LCAweDdjLCAweDgwLA0KICAgICAgICAgICAgMHgwNCwgMHgwNSwgMHg1MiwgMHhkYSwgMHgxMywgMHg0MSwgMHhiMCwgMHgyNywgMHgwZiwgMHg4MiwgMHhhMywNCiAgICAgICAgICAgIDB4ODEsIDB4ZDgsIDB4ZjcsIDB4ZGMsIDB4NjEsIDB4YmIsIDB4OTgsIDB4MzIsIDB4NWEsIDB4ODgsIDB4YmYsDQogICAgICAgICAgICAweDQ5LCAweGMxLCAweDc2LCAweDgzLCAweGNkLCAweGM0LCAweGI0LCAweGNhLCAweDhkLCAweDM2LCAweDg4LA0KICAgICAgICAgICAgMHhlZSwgMHhkYiwgMHhjNSwgMHhmNCwgMHgxMywgMHgyOCwgMHg0ZCwgMHhhZSwgMHg3YSwgMHgzMSwgMHgzZSwNCiAgICAgICAgICAgIDB4NzcsIDB4MTksIDB4YWIsIDB4MTEsIDB4MTUsIDB4MjksIDB4ZDQsIDB4Y2YsIDB4YjQsIDB4NzMsIDB4MzYsDQogICAgICAgICAgICAweDkyLCAweDFlLCAweDRlLCAweDVkLCAweDM1LCAweDU3LCAweDg0LCAweDQ1LCAweDlkLCAweDA1LCAweDNjLA0KICAgICAgICAgICAgMHg0NCwgMHg4NiwgMHgwOCwgMHgwYiwgMHg5MCwgMHgyOSwgMHhmOSwgMHhlNiwgMHg0OCwgMHhhZiwgMHhmNCwNCiAgICAgICAgICAgIDB4NjIsIDB4ZDIsIDB4NGQsIDB4MzIsIDB4MWEsIDB4ZTksIDB4YmYsIDB4M2EsIDB4N2IsIDB4MjUsIDB4NGEsDQogICAgICAgICAgICAweDAzLCAweGZiLCAweDQwLCAweDFkLCAweDcxLCAweDJjLCAweDEwLCAweDU0LCAweGRjLCAweGJmLCAweGY0LA0KICAgICAgICAgICAgMHg1MCwgMHg4NSwgMHgxNSwgMHgxMSwgMHhiMSwgMHgyZCwgMHgwMywgMHgyYywgMHhlNCwgMHg4YSwgMHhjZSwNCiAgICAgICAgICAgIDB4ZWMsIDB4NmUsIDB4NDYsIDB4MDYsIDB4MTMsIDB4M2MsIDB4OTcsIDB4OGQsIDB4ZGQsIDB4ZjYsIDB4MWUsDQogICAgICAgICAgICAweDYyLCAweGI0LCAweDhkLCAweGZhLCAweDJjLCAweDg2LCAweDg3LCAweDY0LCAweDVlLCAweGVjLCAweGM4LA0KICAgICAgICAgICAgMHg4NCwgMHhkMSwgMHgzZCwgMHhjNSwgMHg3NiwgMHg0YSwgMHgzMSwgMHhkMywgMHhkYiwgMHgzNCwgMHg2ZSwNCiAgICAgICAgICAgIDB4OGEsIDB4NDksIDB4ZDYsIDB4MzgsIDB4YmIsIDB4MDUsIDB4ZTksIDB4NGQsIDB4ZjEsIDB4ZGUsIDB4M2UsDQogICAgICAgICAgICAweGE0LCAweDQ3LCAweGRkLCAweGU4LCAweGE4LCAweGYxLCAweGJhLCAweDU1LCAweGNlLCAweGNhLCAweDViLA0KICAgICAgICAgICAgMHg1NywgMHhkNywgMHhjOCwgMHg5ZiwgMHgwOSwgMHhhMywgMHg4ZSwgMHg1OCwgMHg4MywgMHgyMSwgMHgwYSwNCiAgICAgICAgICAgIDB4NmUsIDB4ZDMsIDB4NzAsIDB4OWMsIDB4YjksIDB4N2MsIDB4NTIsIDB4OTgsIDB4NTMsIDB4Y2IsIDB4ZGEsDQogICAgICAgICAgICAweDlkLCAweGFmLCAweGI3LCAweDRiLCAweGY3LCAweDQ4LCAweDkxLCAweDdlLCAweDc4LCAweDIwLCAweDE5LA0KICAgICAgICAgICAgMHhlMywgMHg0MSwgMHg5ZCwgMHhjOCwgMHg2OCwgMHgxMSwgMHhmYiwgMHg1ZiwgMHg2YiwgMHhjOCwgMHgwOSwNCiAgICAgICAgICAgIDB4NzQsIDB4Y2IsIDB4NzYsIDB4MDgsIDB4YmMsIDB4MjgsIDB4NjMsIDB4NTcsIDB4MDQsIDB4YjAsIDB4ODAsDQogICAgICAgICAgICAweGQxLCAweDUzLCAweDYwLCAweDUwLCAweDQ0LCAweGJhLCAweDgwLCAweDQ4LCAweDVlLCAweDBlLCAweDlhLA0KICAgICAgICAgICAgMHhlNSwgMHg2NCwgMHgyNiwgMHg3YSwgMHg4OCwgMHhiOSwgMHhjNiwgMHgzMywgMHgzMSwgMHgxNSwgMHgzMCwNCiAgICAgICAgICAgIDB4MTMsIDB4MDYsIDB4MDksIDB4MmEsIDB4ODYsIDB4NDgsIDB4ODYsIDB4ZjcsIDB4MGQsIDB4MDEsIDB4MDksDQogICAgICAgICAgICAweDE1LCAweDMxLCAweDA2LCAweDA0LCAweDA0LCAweDAxLCAweDAwLCAweDAwLCAweDAwLCAweDMwLCAweDNkLA0KICAgICAgICAgICAgMHgzMCwgMHgyMSwgMHgzMCwgMHgwOSwgMHgwNiwgMHgwNSwgMHgyYiwgMHgwZSwgMHgwMywgMHgwMiwgMHgxYSwNCiAgICAgICAgICAgIDB4MDUsIDB4MDAsIDB4MDQsIDB4MTQsIDB4MzIsIDB4NTUsIDB4MDcsIDB4YTIsIDB4NjcsIDB4ZjMsIDB4NzYsDQogICAgICAgICAgICAweDRkLCAweDBiLCAweDZmLCAweGE0LCAweGEwLCAweDdiLCAweGNlLCAweDJmLCAweGM1LCAweGZmLCAweGJlLA0KICAgICAgICAgICAgMHgzZSwgMHgzOCwgMHgwNCwgMHgxNCwgMHg1MiwgMHhmOCwgMHhiMywgMHhlYiwgMHhjMywgMHhkYSwgMHg3OSwNCiAgICAgICAgICAgIDB4ZmEsIDB4NzUsIDB4ODksIDB4NjcsIDB4MzMsIDB4MDEsIDB4ZDAsIDB4YjAsIDB4MTMsIDB4ZmEsIDB4MTEsDQogICAgICAgICAgICAweDk0LCAweGFjLCAweDAyLCAweDAyLCAweDA3LCAweGQwIH07DQoNCiAgICAgICAgcHVibGljIFNpZ25lZFhtbCBTaWduSE1BQyhzdHJpbmcgdXJpLCBLZXllZEhhc2hBbGdvcml0aG0gbWFjLCBib29sIGV4cGVjdGVkVG9WZXJpZnkpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyBpbnB1dCA9ICI8Zm9vLz4iOw0KDQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBuZXcgWG1sRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIGRvYy5Mb2FkWG1sKGlucHV0KTsNCg0KICAgICAgICAgICAgU2lnbmVkWG1sIHNpZyA9IG5ldyBTaWduZWRYbWwoZG9jKTsNCiAgICAgICAgICAgIFJlZmVyZW5jZSByID0gbmV3IFJlZmVyZW5jZSgiIik7DQogICAgICAgICAgICByLkFkZFRyYW5zZm9ybShuZXcgWG1sRHNpZ0VudmVsb3BlZFNpZ25hdHVyZVRyYW5zZm9ybSgpKTsNCiAgICAgICAgICAgIHIuRGlnZXN0TWV0aG9kID0gdXJpOw0KICAgICAgICAgICAgc2lnLkFkZFJlZmVyZW5jZShyKTsNCg0KICAgICAgICAgICAgc2lnLkNvbXB1dGVTaWduYXR1cmUobWFjKTsNCiAgICAgICAgICAgIGRvYy5Eb2N1bWVudEVsZW1lbnQuQXBwZW5kQ2hpbGQoZG9jLkltcG9ydE5vZGUoc2lnLkdldFhtbCgpLCB0cnVlKSk7DQogICAgICAgICAgICAvLyBkb2MuU2F2ZShTeXN0ZW0uQ29uc29sZS5PdXQpOw0KDQogICAgICAgICAgICBzaWcuTG9hZFhtbChkb2MuRG9jdW1lbnRFbGVtZW50WyJTaWduYXR1cmUiXSk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoZXhwZWN0ZWRUb1ZlcmlmeSwgc2lnLkNoZWNrU2lnbmF0dXJlKG1hYykpOw0KICAgICAgICAgICAgcmV0dXJuIHNpZzsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgc3RhdGljIGJ5dGVbXSBlbXB0eUhtYWNLZXkgPSBuZXcgYnl0ZVswXTsNCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYnl0ZVtdIGJhZEtleSA9IG5ldyBieXRlWzNdIHsgMSwgMiwgMyB9Ow0KDQogICAgICAgIHB1YmxpYyBzdGF0aWMgb2JqZWN0W11bXSBIbWFjS2V5cyA9IG5ldyBvYmplY3RbXVtdIHsNCiAgICAgICAgICAgIG5ldyBvYmplY3RbXSB7IG5ldyBieXRlWzBdIH0sDQogICAgICAgICAgICBuZXcgb2JqZWN0W10geyBuZXcgYnl0ZVs1XSB7IDEsIDIsIDMsIDQsIDEwIH0gfQ0KICAgICAgICB9Ow0KDQogICAgICAgIHByaXZhdGUgY29uc3Qgc3RyaW5nIG1vcmVIbWFjTUQ1ID0gImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI2htYWMtbWQ1IjsNCiAgICAgICAgcHJpdmF0ZSBjb25zdCBzdHJpbmcgbW9yZTI1NiA9ICJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NiI7DQogICAgICAgIHByaXZhdGUgY29uc3Qgc3RyaW5nIG1vcmUzODQgPSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjaG1hYy1zaGEzODQiOw0KICAgICAgICBwcml2YXRlIGNvbnN0IHN0cmluZyBtb3JlNTEyID0gImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI2htYWMtc2hhNTEyIjsNCiAgICAgICAgcHJpdmF0ZSBjb25zdCBzdHJpbmcgbW9yZXJpcGUgPSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjaG1hYy1yaXBlbWQxNjAiOw0KDQogICAgICAgIFtUaGVvcnksIE1lbWJlckRhdGEobmFtZW9mKEhtYWNLZXlzKSldDQogICAgICAgIHB1YmxpYyB2b2lkIFNpZ25ITUFDX1NIQTI1NihieXRlW10gaG1hY2tleSkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGhtYWMgPSBuZXcgSE1BQ1NIQTI1NihobWFja2V5KTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChobWFja2V5LCBobWFjLktleSk7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gU2lnbkhNQUMoRW5jcnlwdGVkWG1sLlhtbEVuY1NIQTI1NlVybCwgaG1hYywgdHJ1ZSk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwobW9yZTI1Niwgc2lnbi5TaWduYXR1cmVNZXRob2QpOw0KICAgICAgICB9DQoNCiAgICAgICAgW1RoZW9yeSwgTWVtYmVyRGF0YShuYW1lb2YoSG1hY0tleXMpKV0NCiAgICAgICAgcHVibGljIHZvaWQgU2lnbkhNQUNfU0hBMjU2X0JhZChieXRlW10gaG1hY2tleSkNCiAgICAgICAgew0KICAgICAgICAgICAgU2lnbmVkWG1sIHNpZ24gPSBTaWduSE1BQyhtb3JlMjU2LCBuZXcgSE1BQ1NIQTI1NihobWFja2V5KSwgZmFsc2UpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKG1vcmUyNTYsIHNpZ24uU2lnbmF0dXJlTWV0aG9kKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBwdWJsaWMgdm9pZCBWZXJpZnlITUFDX1NIQTI1NigpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyB4bWwgPSAiPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiV2luZG93cy0xMjUyXCI/Pjxmb28+PFNpZ25hdHVyZSB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNcIj48U2lnbmVkSW5mbz48Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNVwiIC8+PFNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NlwiIC8+PFJlZmVyZW5jZSBVUkk9XCJcIj48VHJhbnNmb3Jtcz48VHJhbnNmb3JtIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlXCIgLz48L1RyYW5zZm9ybXM+PERpZ2VzdE1ldGhvZCBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTZcIiAvPjxEaWdlc3RWYWx1ZT5zS0cyaERQRUhpUHJ6cGQzUUE4QlowZU16TWJTRVBQTWg5UXFYZ2tQN0NzPTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT5GYWFkM0tJbkpkSXBhR2NCbjVlMDRadjA4MHU0NWZTakFLcXJnZXZkV1F3PTwvU2lnbmF0dXJlVmFsdWU+PC9TaWduYXR1cmU+PC9mb28+IjsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoeG1sKTsNCg0KICAgICAgICAgICAgU2lnbmVkWG1sIHNpZ24gPSBuZXcgU2lnbmVkWG1sKGRvYyk7DQogICAgICAgICAgICBzaWduLkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudFsiU2lnbmF0dXJlIl0pOw0KDQogICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZG90bmV0L2NvcmVmeC9pc3N1ZXMvMTg2OTANCiAgICAgICAgICAgIGlmICghUGxhdGZvcm1EZXRlY3Rpb24uSXNGdWxsRnJhbWV3b3JrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIEFzc2VydC5GYWxzZShzaWduLkNoZWNrU2lnbmF0dXJlKG5ldyBITUFDU0hBMjU2KGJhZEtleSkpKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoc2lnbi5DaGVja1NpZ25hdHVyZShuZXcgSE1BQ1NIQTI1NihlbXB0eUhtYWNLZXkpKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbVGhlb3J5LCBNZW1iZXJEYXRhKG5hbWVvZihIbWFjS2V5cykpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBTaWduSE1BQ19TSEE1MTIoYnl0ZVtdIGhtYWNrZXkpDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciBobWFjID0gbmV3IEhNQUNTSEE1MTIoaG1hY2tleSk7DQogICAgICAgICAgICBBc3NlcnQuRXF1YWwoaG1hY2tleSwgaG1hYy5LZXkpOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IFNpZ25ITUFDKEVuY3J5cHRlZFhtbC5YbWxFbmNTSEE1MTJVcmwsIGhtYWMsIHRydWUpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKG1vcmU1MTIsIHNpZ24uU2lnbmF0dXJlTWV0aG9kKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtUaGVvcnksIE1lbWJlckRhdGEobmFtZW9mKEhtYWNLZXlzKSldDQogICAgICAgIHB1YmxpYyB2b2lkIFNpZ25ITUFDX1NIQTUxMl9CYWQoYnl0ZVtdIGhtYWNrZXkpDQogICAgICAgIHsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gU2lnbkhNQUMobW9yZTUxMiwgbmV3IEhNQUNTSEE1MTIoaG1hY2tleSksIGZhbHNlKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChtb3JlNTEyLCBzaWduLlNpZ25hdHVyZU1ldGhvZCk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgVmVyaWZ5SE1BQ19TSEE1MTIoKQ0KICAgICAgICB7DQogICAgICAgICAgICBzdHJpbmcgeG1sID0gIjw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIldpbmRvd3MtMTI1MlwiPz48Zm9vPjxTaWduYXR1cmUgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjXCI+PFNpZ25lZEluZm8+PENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTVcIiAvPjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjaG1hYy1zaGE1MTJcIiAvPjxSZWZlcmVuY2UgVVJJPVwiXCI+PFRyYW5zZm9ybXM+PFRyYW5zZm9ybSBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZVwiIC8+PC9UcmFuc2Zvcm1zPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhNTEyXCIgLz48RGlnZXN0VmFsdWU+MmR2TWtwVFVFOFo3NlJlc0pHOXB3UHBWSk5Zbzd0NnMyTDAyVjgxeFVWSjBvRjh5Sjd2OENUb2pqdUw3NnMwaVZkQnhBT2hQODBBbWJkMVlhU2t3U3c9PTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT53RmVuaWhSbG0xeDUvbjBjaWZkWC9URE9ZcWxiZzJvVkliRC9neXJBYzBRMmhpSVVUdHdmQklNWTVyUWhLY0VyU3o2WU5vSWw4UkJRQm13dy8wcnY1Zz09PC9TaWduYXR1cmVWYWx1ZT48L1NpZ25hdHVyZT48L2Zvbz4iOw0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBkb2MuTG9hZFhtbCh4bWwpOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IG5ldyBTaWduZWRYbWwoZG9jKTsNCiAgICAgICAgICAgIHNpZ24uTG9hZFhtbChkb2MuRG9jdW1lbnRFbGVtZW50WyJTaWduYXR1cmUiXSk7DQoNCiAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xODY5MA0KICAgICAgICAgICAgaWYgKCFQbGF0Zm9ybURldGVjdGlvbi5Jc0Z1bGxGcmFtZXdvcmspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkZhbHNlKHNpZ24uQ2hlY2tTaWduYXR1cmUobmV3IEhNQUNTSEE1MTIoYmFkS2V5KSkpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBBc3NlcnQuVHJ1ZShzaWduLkNoZWNrU2lnbmF0dXJlKG5ldyBITUFDU0hBNTEyKGVtcHR5SG1hY0tleSkpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtUaGVvcnksIE1lbWJlckRhdGEobmFtZW9mKEhtYWNLZXlzKSldDQogICAgICAgIHB1YmxpYyB2b2lkIFNpZ25ITUFDX1NIQTM4NChieXRlW10gaG1hY2tleSkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGhtYWMgPSBuZXcgSE1BQ1NIQTM4NChobWFja2V5KTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChobWFja2V5LCBobWFjLktleSk7DQoNCiAgICAgICAgICAgIC8vIHdvcmtzIGFzIGxvbmcgYXMgdGhlIHN0cmluZyBjYW4gYmUgdXNlZCBieSBDcnlwdG9Db25maWcgdG8gY3JlYXRlIA0KICAgICAgICAgICAgLy8gYW4gaW5zdGFuY2Ugb2YgdGhlIHJlcXVpcmVkIGhhc2ggYWxnb3JpdGhtDQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IFNpZ25ITUFDKCJTSEEzODQiLCBobWFjLCB0cnVlKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChtb3JlMzg0LCBzaWduLlNpZ25hdHVyZU1ldGhvZCk7DQogICAgICAgIH0NCg0KICAgICAgICBbVGhlb3J5LCBNZW1iZXJEYXRhKG5hbWVvZihIbWFjS2V5cykpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBTaWduSE1BQ19TSEEzODRfQmFkKGJ5dGVbXSBobWFja2V5KQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyB3ZSBjYW4ndCB2ZXJpdHkgdGhlIHNpZ25hdHVyZSBpZiB0aGUgVVJJIGlzIHVzZWQNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gU2lnbkhNQUMobW9yZTM4NCwgbmV3IEhNQUNTSEEzODQoaG1hY2tleSksIGZhbHNlKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChtb3JlMzg0LCBzaWduLlNpZ25hdHVyZU1ldGhvZCk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgVmVyaWZ5SE1BQ19TSEEzODQoKQ0KICAgICAgICB7DQogICAgICAgICAgICBzdHJpbmcgeG1sID0gIjw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIldpbmRvd3MtMTI1MlwiPz48Zm9vPjxTaWduYXR1cmUgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjXCI+PFNpZ25lZEluZm8+PENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTVcIiAvPjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjaG1hYy1zaGEzODRcIiAvPjxSZWZlcmVuY2UgVVJJPVwiXCI+PFRyYW5zZm9ybXM+PFRyYW5zZm9ybSBBbGdvcml0aG09XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZVwiIC8+PC9UcmFuc2Zvcm1zPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPVwiU0hBMzg0XCIgLz48RGlnZXN0VmFsdWU+a0g5QzBMZVpvY05WWGhqZnpwejAwTTVmYzNXSmYwUVU4Z3hLNEk3cEFON0hONjAyeUhvOHlZRFNsRzE0YjVZUzwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT5MZ3lkT2ZodjhucXBGTEZQQyt4ZzNabmpDOEQrVjNtcHp4djZHT2RIMUhEZHcxcitMSC9CRk0yVTdkbnR4Z2YwPC9TaWduYXR1cmVWYWx1ZT48L1NpZ25hdHVyZT48L2Zvbz4iOw0KICAgICAgICAgICAgWG1sRG9jdW1lbnQgZG9jID0gbmV3IFhtbERvY3VtZW50KCk7DQogICAgICAgICAgICBkb2MuTG9hZFhtbCh4bWwpOw0KDQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IG5ldyBTaWduZWRYbWwoZG9jKTsNCiAgICAgICAgICAgIHNpZ24uTG9hZFhtbChkb2MuRG9jdW1lbnRFbGVtZW50WyJTaWduYXR1cmUiXSk7DQoNCiAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xODY5MA0KICAgICAgICAgICAgaWYgKCFQbGF0Zm9ybURldGVjdGlvbi5Jc0Z1bGxGcmFtZXdvcmspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkZhbHNlKHNpZ24uQ2hlY2tTaWduYXR1cmUobmV3IEhNQUNTSEEzODQoYmFkS2V5KSkpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBBc3NlcnQuVHJ1ZShzaWduLkNoZWNrU2lnbmF0dXJlKG5ldyBITUFDU0hBMzg0KGVtcHR5SG1hY0tleSkpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtUaGVvcnksIE1lbWJlckRhdGEobmFtZW9mKEhtYWNLZXlzKSldDQogICAgICAgIHB1YmxpYyB2b2lkIFNpZ25ITUFDX01ENShieXRlW10gaG1hY2tleSkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGhtYWMgPSBuZXcgSE1BQ01ENShobWFja2V5KTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChobWFja2V5LCBobWFjLktleSk7DQoNCiAgICAgICAgICAgIC8vIHdvcmtzIGFzIGxvbmcgYXMgdGhlIHN0cmluZyBjYW4gYmUgdXNlZCBieSBDcnlwdG9Db25maWcgdG8gY3JlYXRlIA0KICAgICAgICAgICAgLy8gYW4gaW5zdGFuY2Ugb2YgdGhlIHJlcXVpcmVkIGhhc2ggYWxnb3JpdGhtDQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IFNpZ25ITUFDKCJNRDUiLCBobWFjLCB0cnVlKTsNCiAgICAgICAgICAgIEFzc2VydC5FcXVhbChtb3JlSG1hY01ENSwgc2lnbi5TaWduYXR1cmVNZXRob2QpOw0KICAgICAgICB9DQoNCiAgICAgICAgW1RoZW9yeSwgTWVtYmVyRGF0YShuYW1lb2YoSG1hY0tleXMpKV0NCiAgICAgICAgcHVibGljIHZvaWQgU2lnbkhNQUNfTUQ1X0JhZChieXRlW10gaG1hY2tleSkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gd2UgY2FuJ3QgdmVyaXR5IHRoZSBzaWduYXR1cmUgaWYgdGhlIFVSSSBpcyB1c2VkDQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IFNpZ25ITUFDKG1vcmVIbWFjTUQ1LCBuZXcgSE1BQ01ENShobWFja2V5KSwgZmFsc2UpOw0KICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKG1vcmVIbWFjTUQ1LCBzaWduLlNpZ25hdHVyZU1ldGhvZCk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgVmVyaWZ5SE1BQ19NRDUoKQ0KICAgICAgICB7DQogICAgICAgICAgICBzdHJpbmcgeG1sID0gQCI8P3htbCB2ZXJzaW9uPSIiMS4wIiIgZW5jb2Rpbmc9IiJXaW5kb3dzLTEyNTIiIj8+PGZvbz48U2lnbmF0dXJlIHhtbG5zPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIiPjxTaWduZWRJbmZvPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1IiIgLz48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI2htYWMtbWQ1IiIgLz48UmVmZXJlbmNlIFVSST0iIiIiPjxUcmFuc2Zvcm1zPjxUcmFuc2Zvcm0gQWxnb3JpdGhtPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiIiAvPjwvVHJhbnNmb3Jtcz48RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iIk1ENSIiIC8+PERpZ2VzdFZhbHVlPlRIN3lzYm96SldWSVdoLzFLNWJQMXc9PTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT50SjZtNVlWdTFqTjFXZ0tXdjNBWEZRPT08L1NpZ25hdHVyZVZhbHVlPjwvU2lnbmF0dXJlPjwvZm9vPiI7DQogICAgICAgICAgICBYbWxEb2N1bWVudCBkb2MgPSBuZXcgWG1sRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIGRvYy5Mb2FkWG1sKHhtbCk7DQoNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gbmV3IFNpZ25lZFhtbChkb2MpOw0KICAgICAgICAgICAgc2lnbi5Mb2FkWG1sKGRvYy5Eb2N1bWVudEVsZW1lbnRbIlNpZ25hdHVyZSJdKTsNCg0KICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2RvdG5ldC9jb3JlZngvaXNzdWVzLzE4NjkwDQogICAgICAgICAgICBpZiAoIVBsYXRmb3JtRGV0ZWN0aW9uLklzRnVsbEZyYW1ld29yaykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBBc3NlcnQuRmFsc2Uoc2lnbi5DaGVja1NpZ25hdHVyZShuZXcgSE1BQ01ENShiYWRLZXkpKSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIEFzc2VydC5UcnVlKHNpZ24uQ2hlY2tTaWduYXR1cmUobmV3IEhNQUNNRDUoZW1wdHlIbWFjS2V5KSkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ1ZFLTIwMDktMDIxNw0KICAgICAgICAvLyAqIGEgMC1sZW5ndGggc2lnbmF0dXJlIGlzIHRoZSB3b3JzZSBjYXNlIC0gaXQgYWNjZXB0cyBhbnl0aGluZw0KICAgICAgICAvLyAqIGJldHdlZW4gMS03IGJpdHMgbGVuZ3RoIGFyZSBjb25zaWRlcmVkIGludmFsaWQgKG5vdCBhIG11bHRpcGxlIG9mIDgpDQogICAgICAgIC8vICogYSA4IGJpdHMgc2lnbmF0dXJlIHdvdWxkIGhhdmUgb25lIGNoYW5jZSwgb3V0IG9mIDI1NiwgdG8gYmUgdmFsaWQNCiAgICAgICAgLy8gKiBhbmQgc28gb24uLi4gdW50aWwgd2UgaGl0IChvdXRwdXQtbGVuZ3RoIC8gMikgb3IgODAgYml0cyAoc2VlIEVSUkFUVU0pDQoNCiAgICAgICAgc3RhdGljIGJvb2wgZXJyYXR1bSA9IHRydWU7IC8vIHhtbGRzaWcgZXJyYXR1bSBmb3IgQ1ZFLTIwMDktMDIxNw0KDQogICAgICAgIHN0YXRpYyBTaWduZWRYbWwgR2V0U2lnbmVkWG1sKHN0cmluZyB4bWwpDQogICAgICAgIHsNCiAgICAgICAgICAgIFhtbERvY3VtZW50IGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLkxvYWRYbWwoeG1sKTsNCg0KICAgICAgICAgICAgU2lnbmVkWG1sIHNpZ24gPSBuZXcgU2lnbmVkWG1sKGRvYyk7DQogICAgICAgICAgICBzaWduLkxvYWRYbWwoZG9jLkRvY3VtZW50RWxlbWVudCk7DQogICAgICAgICAgICByZXR1cm4gc2lnbjsNCiAgICAgICAgfQ0KDQogICAgICAgIHN0YXRpYyB2b2lkIENoZWNrRXJyYXR1bShTaWduZWRYbWwgc2lnbmVkLCBLZXllZEhhc2hBbGdvcml0aG0gaG1hYywgc3RyaW5nIG1lc3NhZ2UpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChlcnJhdHVtKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIEFzc2VydC5UaHJvd3M8Q3J5cHRvZ3JhcGhpY0V4Y2VwdGlvbj4oKCkgPT4gc2lnbmVkLkNoZWNrU2lnbmF0dXJlKGhtYWMpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBBc3NlcnQuVHJ1ZShzaWduZWQuQ2hlY2tTaWduYXR1cmUoaG1hYyksIG1lc3NhZ2UpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSB2b2lkIEhtYWNNdXN0QmVNdWx0aXBsZU9mRWlnaHRCaXRzKGludCBiaXRzKQ0KICAgICAgICB7DQogICAgICAgICAgICBzdHJpbmcgeG1sID0gQCI8P3htbCB2ZXJzaW9uPSIiMS4wIiIgZW5jb2Rpbmc9IiJVVEYtOCIiPz4NCjxTaWduYXR1cmUgeG1sbnM9IiJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIiI+DQogIDxTaWduZWRJbmZvPg0KICAgIDxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1IiIgLz4NCiAgICA8U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNobWFjLXNoYTEiIiA+DQogICAgICA8SE1BQ091dHB1dExlbmd0aD57MH08L0hNQUNPdXRwdXRMZW5ndGg+DQogICAgPC9TaWduYXR1cmVNZXRob2Q+DQogICAgPFJlZmVyZW5jZSBVUkk9IiIjb2JqZWN0IiI+DQogICAgICA8RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIiIgLz4NCiAgICAgIDxEaWdlc3RWYWx1ZT5uejRHUzBOYkgyU3JXbEQvNGZYMzEzQ29UemM9PC9EaWdlc3RWYWx1ZT4NCiAgICA8L1JlZmVyZW5jZT4NCiAgPC9TaWduZWRJbmZvPg0KICA8U2lnbmF0dXJlVmFsdWU+DQogICAgZ0E9PQ0KICA8L1NpZ25hdHVyZVZhbHVlPg0KICA8T2JqZWN0IElkPSIib2JqZWN0IiI+c29tZSBvdGhlciB0ZXh0PC9PYmplY3Q+DQo8L1NpZ25hdHVyZT4NCiI7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IEdldFNpZ25lZFhtbChTdHJpbmcuRm9ybWF0KHhtbCwgYml0cykpOw0KICAgICAgICAgICAgLy8gb25seSBtdWx0aXBsZSBvZiA4IGJpdHMgYXJlIHN1cHBvcnRlZA0KICAgICAgICAgICAgc2lnbi5DaGVja1NpZ25hdHVyZShuZXcgSE1BQ1NIQTEoRW5jb2RpbmcuQVNDSUkuR2V0Qnl0ZXMoInNlY3JldCIpKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdChTa2lwID0gImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xNjY4NSIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBIbWFjTXVzdEJlTXVsdGlwbGVPZkVpZ2h0Qml0cygpDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDwgMTYwOyBpKyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gVGhlIC5ORVQgZnJhbWV3b3JrIG9ubHkgc3VwcG9ydHMgbXVsdGlwbGUgb2YgOCBiaXRzDQogICAgICAgICAgICAgICAgaWYgKGkgJSA4ICE9IDApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBBc3NlcnQuVGhyb3dzPENyeXB0b2dyYXBoaWNFeGNlcHRpb24+KCgpID0+IEhtYWNNdXN0QmVNdWx0aXBsZU9mRWlnaHRCaXRzKGkpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdChTa2lwID0gImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xNjY4NSIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBWZXJpZnlITUFDX1plcm9MZW5ndGgoKQ0KICAgICAgICB7DQogICAgICAgICAgICBzdHJpbmcgeG1sID0gQCI8P3htbCB2ZXJzaW9uPSIiMS4wIiIgZW5jb2Rpbmc9IiJVVEYtOCIiPz4NCjxTaWduYXR1cmUgeG1sbnM9IiJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIiI+DQogIDxTaWduZWRJbmZvPg0KICAgIDxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1IiIgLz4NCiAgICA8U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNobWFjLXNoYTEiIiA+DQogICAgICA8SE1BQ091dHB1dExlbmd0aD4wPC9ITUFDT3V0cHV0TGVuZ3RoPg0KICAgIDwvU2lnbmF0dXJlTWV0aG9kPg0KICAgIDxSZWZlcmVuY2UgVVJJPSIiI29iamVjdCIiPg0KICAgICAgPERpZ2VzdE1ldGhvZCBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIiIC8+DQogICAgICA8RGlnZXN0VmFsdWU+bno0R1MwTmJIMlNyV2xELzRmWDMxM0NvVHpjPTwvRGlnZXN0VmFsdWU+DQogICAgPC9SZWZlcmVuY2U+DQogIDwvU2lnbmVkSW5mbz4NCiAgPFNpZ25hdHVyZVZhbHVlPg0KICA8L1NpZ25hdHVyZVZhbHVlPg0KICA8T2JqZWN0IElkPSIib2JqZWN0IiI+c29tZSBvdGhlciB0ZXh0PC9PYmplY3Q+DQo8L1NpZ25hdHVyZT4NCiI7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IEdldFNpZ25lZFhtbCh4bWwpOw0KDQogICAgICAgICAgICBDaGVja0VycmF0dW0oc2lnbiwgbmV3IEhNQUNTSEExKEVuY29kaW5nLkFTQ0lJLkdldEJ5dGVzKCJubyBjbHVlIikpLCAiMSIpOw0KICAgICAgICAgICAgQ2hlY2tFcnJhdHVtKHNpZ24sIG5ldyBITUFDU0hBMShFbmNvZGluZy5BU0NJSS5HZXRCeXRlcygiIikpLCAiMiIpOw0KICAgICAgICAgICAgQ2hlY2tFcnJhdHVtKHNpZ24sIG5ldyBITUFDU0hBMShFbmNvZGluZy5BU0NJSS5HZXRCeXRlcygib29wcyIpKSwgIjMiKTsNCiAgICAgICAgICAgIENoZWNrRXJyYXR1bShzaWduLCBuZXcgSE1BQ1NIQTEoRW5jb2RpbmcuQVNDSUkuR2V0Qnl0ZXMoInNlY3JldCIpKSwgIjQiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0KFNraXAgPSAiaHR0cHM6Ly9naXRodWIuY29tL2RvdG5ldC9jb3JlZngvaXNzdWVzLzE2Njg1IildDQogICAgICAgIHB1YmxpYyB2b2lkIFZlcmlmeUhNQUNfU21hbGxlclRoYW5NaW5pbXVtTGVuZ3RoKCkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gNzIgaXMgYSBtdWx0aXBsZSBvZiA4IGJ1dCBzbWFsbGVyIHRoYW4gdGhlIG1pbmltdW0gb2YgODAgYml0cw0KICAgICAgICAgICAgc3RyaW5nIHhtbCA9IEAiPFNpZ25hdHVyZSB4bWxucz0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiIj48U2lnbmVkSW5mbz48Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIiIC8+PFNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjaG1hYy1zaGExIiI+PEhNQUNPdXRwdXRMZW5ndGg+NzI8L0hNQUNPdXRwdXRMZW5ndGg+PC9TaWduYXR1cmVNZXRob2Q+PFJlZmVyZW5jZSBVUkk9IiIjb2JqZWN0IiI+PERpZ2VzdE1ldGhvZCBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIiIC8+PERpZ2VzdFZhbHVlPm56NEdTME5iSDJTcldsRC80ZlgzMTNDb1R6Yz08L0RpZ2VzdFZhbHVlPjwvUmVmZXJlbmNlPjwvU2lnbmVkSW5mbz48U2lnbmF0dXJlVmFsdWU+MmRpbUIrUDVBdzVLPC9TaWduYXR1cmVWYWx1ZT48T2JqZWN0IElkPSIib2JqZWN0IiI+c29tZSBvdGhlciB0ZXh0PC9PYmplY3Q+PC9TaWduYXR1cmU+IjsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gR2V0U2lnbmVkWG1sKHhtbCk7DQogICAgICAgICAgICBDaGVja0VycmF0dW0oc2lnbiwgbmV3IEhNQUNTSEExKEVuY29kaW5nLkFTQ0lJLkdldEJ5dGVzKCJzZWNyZXQiKSksICI3MiIpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3QoU2tpcCA9ICJodHRwczovL2dpdGh1Yi5jb20vZG90bmV0L2NvcmVmeC9pc3N1ZXMvMTY2ODUiKV0NCiAgICAgICAgcHVibGljIHZvaWQgVmVyaWZ5SE1BQ19NaW5pbXVtTGVuZ3RoKCkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gODAgYml0cyBpcyB0aGUgbWluaW11bSAoYW5kIHRoZSBoYWxmLXNpemUgb2YgSE1BQ1NIQTEpDQogICAgICAgICAgICBzdHJpbmcgeG1sID0gQCI8U2lnbmF0dXJlIHhtbG5zPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIiPjxTaWduZWRJbmZvPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1IiIgLz48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNobWFjLXNoYTEiIj48SE1BQ091dHB1dExlbmd0aD44MDwvSE1BQ091dHB1dExlbmd0aD48L1NpZ25hdHVyZU1ldGhvZD48UmVmZXJlbmNlIFVSST0iIiNvYmplY3QiIj48RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIiIgLz48RGlnZXN0VmFsdWU+bno0R1MwTmJIMlNyV2xELzRmWDMxM0NvVHpjPTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT5qVlFQdExqNjF6Tllqdz09PC9TaWduYXR1cmVWYWx1ZT48T2JqZWN0IElkPSIib2JqZWN0IiI+c29tZSBvdGhlciB0ZXh0PC9PYmplY3Q+PC9TaWduYXR1cmU+IjsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gR2V0U2lnbmVkWG1sKHhtbCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZShzaWduLkNoZWNrU2lnbmF0dXJlKG5ldyBITUFDU0hBMShFbmNvZGluZy5BU0NJSS5HZXRCeXRlcygic2VjcmV0IikpKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdChTa2lwID0gImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xNjY4NSIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBWZXJpZnlITUFDX1NtYWxsZXJIYWxmTGVuZ3RoKCkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gODBiaXRzIGlzIHNtYWxsZXIgdGhhbiB0aGUgaGFsZi1zaXplIG9mIEhNQUNTSEEyNTYNCiAgICAgICAgICAgIHN0cmluZyB4bWwgPSBAIjxTaWduYXR1cmUgeG1sbnM9IiJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIiI+PFNpZ25lZEluZm8+PENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSIiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUiIiAvPjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjaG1hYy1zaGEyNTYiIj48SE1BQ091dHB1dExlbmd0aD44MDwvSE1BQ091dHB1dExlbmd0aD48L1NpZ25hdHVyZU1ldGhvZD48UmVmZXJlbmNlIFVSST0iIiNvYmplY3QiIj48RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIiIgLz48RGlnZXN0VmFsdWU+bno0R1MwTmJIMlNyV2xELzRmWDMxM0NvVHpjPTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT52UHR3N3pLVlYvSndRZz09PC9TaWduYXR1cmVWYWx1ZT48T2JqZWN0IElkPSIib2JqZWN0IiI+c29tZSBvdGhlciB0ZXh0PC9PYmplY3Q+PC9TaWduYXR1cmU+IjsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gR2V0U2lnbmVkWG1sKHhtbCk7DQogICAgICAgICAgICBDaGVja0VycmF0dW0oc2lnbiwgbmV3IEhNQUNTSEEyNTYoRW5jb2RpbmcuQVNDSUkuR2V0Qnl0ZXMoInNlY3JldCIpKSwgIjgwIik7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdChTa2lwID0gImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xNjY4NSIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBWZXJpZnlITUFDX0hhbGZMZW5ndGgoKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyAxMjggaXMgdGhlIGhhbGYtc2l6ZSBvZiBITUFDU0hBMjU2DQogICAgICAgICAgICBzdHJpbmcgeG1sID0gQCI8U2lnbmF0dXJlIHhtbG5zPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIiPjxTaWduZWRJbmZvPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDEvUkVDLXhtbC1jMTRuLTIwMDEwMzE1IiIgLz48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI2htYWMtc2hhMjU2IiI+PEhNQUNPdXRwdXRMZW5ndGg+MTI4PC9ITUFDT3V0cHV0TGVuZ3RoPjwvU2lnbmF0dXJlTWV0aG9kPjxSZWZlcmVuY2UgVVJJPSIiI29iamVjdCIiPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiIiAvPjxEaWdlc3RWYWx1ZT5uejRHUzBOYkgyU3JXbEQvNGZYMzEzQ29UemM9PC9EaWdlc3RWYWx1ZT48L1JlZmVyZW5jZT48L1NpZ25lZEluZm8+PFNpZ25hdHVyZVZhbHVlPmFlZ3B2a0F3T0w4Z04vQ2pTblc2cXc9PTwvU2lnbmF0dXJlVmFsdWU+PE9iamVjdCBJZD0iIm9iamVjdCIiPnNvbWUgb3RoZXIgdGV4dDwvT2JqZWN0PjwvU2lnbmF0dXJlPiI7DQogICAgICAgICAgICBTaWduZWRYbWwgc2lnbiA9IEdldFNpZ25lZFhtbCh4bWwpOw0KICAgICAgICAgICAgQXNzZXJ0LlRydWUoc2lnbi5DaGVja1NpZ25hdHVyZShuZXcgSE1BQ1NIQTI1NihFbmNvZGluZy5BU0NJSS5HZXRCeXRlcygic2VjcmV0IikpKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdF0NCiAgICAgICAgcHVibGljIHZvaWQgVmVyaWZ5SE1BQ19GdWxsTGVuZ3RoKCkNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIHhtbCA9IEAiPFNpZ25hdHVyZSB4bWxucz0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiIj48U2lnbmVkSW5mbz48Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIiIC8+PFNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjaG1hYy1zaGExIiIgLz48UmVmZXJlbmNlIFVSST0iIiNvYmplY3QiIj48RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIiIgLz48RGlnZXN0VmFsdWU+Ny9YVHNIYUJTT25KL2pYRDV2MHpMNlZLWXNrPTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT5hMGdvTDllc0JVS1BxdEZZZ3BwMktTVDRodWs9PC9TaWduYXR1cmVWYWx1ZT48T2JqZWN0IElkPSIib2JqZWN0IiI+c29tZSB0ZXh0PC9PYmplY3Q+PC9TaWduYXR1cmU+IjsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gR2V0U2lnbmVkWG1sKHhtbCk7DQogICAgICAgICAgICBBc3NlcnQuVHJ1ZShzaWduLkNoZWNrU2lnbmF0dXJlKG5ldyBITUFDU0hBMShFbmNvZGluZy5BU0NJSS5HZXRCeXRlcygic2VjcmV0IikpKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdChTa2lwID0gImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xNjY4NSIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBWZXJpZnlITUFDX0hNQUNPdXRwdXRMZW5ndGhfU2lnbmF0dXJlX01pc21hdGNoKCkNCiAgICAgICAgew0KICAgICAgICAgICAgc3RyaW5nIHhtbCA9IEAiPD94bWwgdmVyc2lvbj0iIjEuMCIiIGVuY29kaW5nPSIiVVRGLTgiIj8+DQo8U2lnbmF0dXJlIHhtbG5zPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIiPg0KICA8U2lnbmVkSW5mbz4NCiAgICA8Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIiIC8+DQogICAgPFNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09IiJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjaG1hYy1zaGExIiIgPg0KICAgICAgPEhNQUNPdXRwdXRMZW5ndGg+ODA8L0hNQUNPdXRwdXRMZW5ndGg+DQogICAgPC9TaWduYXR1cmVNZXRob2Q+DQogICAgPFJlZmVyZW5jZSBVUkk9IiIjb2JqZWN0IiI+DQogICAgICA8RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIiIgLz4NCiAgICAgIDxEaWdlc3RWYWx1ZT5uejRHUzBOYkgyU3JXbEQvNGZYMzEzQ29UemM9PC9EaWdlc3RWYWx1ZT4NCiAgICA8L1JlZmVyZW5jZT4NCiAgPC9TaWduZWRJbmZvPg0KICA8U2lnbmF0dXJlVmFsdWU+DQogIDwvU2lnbmF0dXJlVmFsdWU+DQogIDxPYmplY3QgSWQ9IiJvYmplY3QiIj5zb21lIG90aGVyIHRleHQ8L09iamVjdD4NCjwvU2lnbmF0dXJlPg0KIjsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gR2V0U2lnbmVkWG1sKHhtbCk7DQogICAgICAgICAgICBBc3NlcnQuVGhyb3dzPENyeXB0b2dyYXBoaWNFeGNlcHRpb24+KCgpID0+IHNpZ24uQ2hlY2tTaWduYXR1cmUobmV3IEhNQUNTSEExKEVuY29kaW5nLkFTQ0lJLkdldEJ5dGVzKCJubyBjbHVlIikpKSk7DQogICAgICAgIH0NCg0KICAgICAgICBbRmFjdChTa2lwID0gImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xNjY4NSIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBWZXJpZnlITUFDX0hNQUNPdXRwdXRMZW5ndGhfSW52YWxpZCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyB4bWwgPSBAIjw/eG1sIHZlcnNpb249IiIxLjAiIiBlbmNvZGluZz0iIlVURi04IiI/Pg0KPFNpZ25hdHVyZSB4bWxucz0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiIj4NCiAgPFNpZ25lZEluZm8+DQogICAgPENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSIiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUiIiAvPg0KICAgIDxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSIiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2htYWMtc2hhMSIiID4NCiAgICAgIDxITUFDT3V0cHV0TGVuZ3RoPkkgd2lzaCB0aGlzIHdhcyBub3QgYSBzdHJpbmcgcHJvcGVydHk8L0hNQUNPdXRwdXRMZW5ndGg+DQogICAgPC9TaWduYXR1cmVNZXRob2Q+DQogICAgPFJlZmVyZW5jZSBVUkk9IiIjb2JqZWN0IiI+DQogICAgICA8RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIiIgLz4NCiAgICAgIDxEaWdlc3RWYWx1ZT5uejRHUzBOYkgyU3JXbEQvNGZYMzEzQ29UemM9PC9EaWdlc3RWYWx1ZT4NCiAgICA8L1JlZmVyZW5jZT4NCiAgPC9TaWduZWRJbmZvPg0KICA8U2lnbmF0dXJlVmFsdWU+DQogIDwvU2lnbmF0dXJlVmFsdWU+DQogIDxPYmplY3QgSWQ9IiJvYmplY3QiIj5zb21lIG90aGVyIHRleHQ8L09iamVjdD4NCjwvU2lnbmF0dXJlPg0KIjsNCiAgICAgICAgICAgIFNpZ25lZFhtbCBzaWduID0gR2V0U2lnbmVkWG1sKHhtbCk7DQogICAgICAgICAgICBBc3NlcnQuVGhyb3dzPEZvcm1hdEV4Y2VwdGlvbj4oKCkgPT4gc2lnbi5DaGVja1NpZ25hdHVyZShuZXcgSE1BQ1NIQTEoRW5jb2RpbmcuQVNDSUkuR2V0Qnl0ZXMoIm5vIGNsdWUiKSkpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIFtGYWN0XQ0KICAgICAgICBbU2tpcE9uVGFyZ2V0RnJhbWV3b3JrKFRhcmdldEZyYW1ld29ya01vbmlrZXJzLk5ldEZyYW1ld29yaywgImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xODY5MCIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBDb3JlRnhTaWduZWRYbWxVc2VzU2hhMjU2QnlEZWZhdWx0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgY29uc3Qgc3RyaW5nIGV4cGVjdGVkU2lnbmF0dXJlTWV0aG9kID0gImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiOw0KICAgICAgICAgICAgY29uc3Qgc3RyaW5nIGV4cGVjdGVkRGlnZXN0TWV0aG9kID0gImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiI7DQogICAgICAgICAgICBWYWxpZGF0ZVNpZ25lZFhtbERlZmF1bHRIYXNoQWxnb3JpdGhtcyhleHBlY3RlZFNpZ25hdHVyZU1ldGhvZCwgZXhwZWN0ZWREaWdlc3RNZXRob2QpOw0KICAgICAgICB9DQoNCiAgICAgICAgW0ZhY3RdDQogICAgICAgIFtTa2lwT25UYXJnZXRGcmFtZXdvcmsoflRhcmdldEZyYW1ld29ya01vbmlrZXJzLk5ldEZyYW1ld29yaywgImh0dHBzOi8vZ2l0aHViLmNvbS9kb3RuZXQvY29yZWZ4L2lzc3Vlcy8xODY5MCIpXQ0KICAgICAgICBwdWJsaWMgdm9pZCBOZXRGeFNpZ25lZFhtbFVzZXNTaGExQnlEZWZhdWx0KCkNCiAgICAgICAgew0KICAgICAgICAgICAgY29uc3Qgc3RyaW5nIGV4cGVjdGVkU2lnbmF0dXJlTWV0aG9kID0gImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMSI7DQogICAgICAgICAgICBjb25zdCBzdHJpbmcgZXhwZWN0ZWREaWdlc3RNZXRob2QgPSAiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiOw0KICAgICAgICAgICAgVmFsaWRhdGVTaWduZWRYbWxEZWZhdWx0SGFzaEFsZ29yaXRobXMoZXhwZWN0ZWRTaWduYXR1cmVNZXRob2QsIGV4cGVjdGVkRGlnZXN0TWV0aG9kKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgdm9pZCBWYWxpZGF0ZVNpZ25lZFhtbERlZmF1bHRIYXNoQWxnb3JpdGhtcyhzdHJpbmcgZXhwZWN0ZWRTaWduYXR1cmVNZXRob2QsIHN0cmluZyBleHBlY3RlZERpZ2VzdE1ldGhvZCkNCiAgICAgICAgew0KICAgICAgICAgICAgY29uc3Qgc3RyaW5nIHhtbCA9IEAiPD94bWwgdmVyc2lvbj0iIjEuMCIiPz4NCjxleGFtcGxlPg0KPHRlc3Q+c29tZSB0ZXh0IG5vZGU8L3Rlc3Q+DQo8L2V4YW1wbGU+IjsNCg0KICAgICAgICAgICAgdmFyIGRvYyA9IG5ldyBYbWxEb2N1bWVudCgpOw0KICAgICAgICAgICAgZG9jLlByZXNlcnZlV2hpdGVzcGFjZSA9IHRydWU7DQogICAgICAgICAgICBkb2MuTG9hZFhtbCh4bWwpOw0KDQogICAgICAgICAgICB1c2luZyAoUlNBIGtleSA9IFJTQS5DcmVhdGUoKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB2YXIgc3htbCA9IG5ldyBTaWduZWRYbWwoZG9jKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgU2lnbmluZ0tleSA9IGtleQ0KICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICBBc3NlcnQuTnVsbChzeG1sLlNpZ25lZEluZm8uU2lnbmF0dXJlTWV0aG9kKTsNCg0KICAgICAgICAgICAgICAgIHZhciByZWZlcmVuY2UgPSBuZXcgUmVmZXJlbmNlKCk7DQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKGV4cGVjdGVkRGlnZXN0TWV0aG9kLCByZWZlcmVuY2UuRGlnZXN0TWV0aG9kKTsNCg0KICAgICAgICAgICAgICAgIHJlZmVyZW5jZS5VcmkgPSAiIjsNCiAgICAgICAgICAgICAgICByZWZlcmVuY2UuQWRkVHJhbnNmb3JtKG5ldyBYbWxEc2lnRW52ZWxvcGVkU2lnbmF0dXJlVHJhbnNmb3JtKCkpOw0KICAgICAgICAgICAgICAgIHN4bWwuQWRkUmVmZXJlbmNlKHJlZmVyZW5jZSk7DQogICAgICAgICAgICAgICAgc3htbC5Db21wdXRlU2lnbmF0dXJlKCk7DQoNCiAgICAgICAgICAgICAgICBYbWxFbGVtZW50IGRzaWcgPSBzeG1sLkdldFhtbCgpOw0KICAgICAgICAgICAgICAgIFhQYXRoTmF2aWdhdG9yIHhwID0gZHNpZy5DcmVhdGVOYXZpZ2F0b3IoKTsNCg0KICAgICAgICAgICAgICAgIFhtbE5hbWVzcGFjZU1hbmFnZXIgbnNNZ3IgPSBuZXcgWG1sTmFtZXNwYWNlTWFuYWdlcih4cC5OYW1lVGFibGUpOw0KICAgICAgICAgICAgICAgIG5zTWdyLkFkZE5hbWVzcGFjZSgiZHMiLCAiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIpOw0KDQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKGV4cGVjdGVkU2lnbmF0dXJlTWV0aG9kLA0KICAgICAgICAgICAgICAgICAgICB4cC5TZWxlY3RTaW5nbGVOb2RlKCIvZHM6U2lnbmVkSW5mby9kczpTaWduYXR1cmVNZXRob2QvQEFsZ29yaXRobSIsIG5zTWdyKT8uVmFsdWUpOw0KDQogICAgICAgICAgICAgICAgQXNzZXJ0LkVxdWFsKGV4cGVjdGVkRGlnZXN0TWV0aG9kLA0KICAgICAgICAgICAgICAgICAgICB4cC5TZWxlY3RTaW5nbGVOb2RlKCIvZHM6U2lnbmVkSW5mby9kczpSZWZlcmVuY2UvZHM6RGlnZXN0TWV0aG9kL0BBbGdvcml0aG0iLCBuc01ncik/LlZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="
        }
      },
      "results": [
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/src/System/Security/Cryptography/Xml/SymmetricKeyWrap.cs",
                "region": {
                  "startLine": 139,
                  "startColumn": 11,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/ecb-encryption",
          "level": "warning",
          "message": "The ECB (Electronic Code Book) encryption mode is vulnerable to replay attacks.",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/src/System/Security/Cryptography/Xml/SymmetricKeyWrap.cs",
                "region": {
                  "startLine": 202,
                  "startColumn": 11,
                  "length": 14
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/insecure-xml-read",
          "level": "warning",
          "message": "Insecure XML processing: DTD processing enabled in settings, insecure resolver set in settings",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/src/System/Security/Cryptography/Xml/Utils.cs",
                "region": {
                  "startLine": 172,
                  "startColumn": 19,
                  "length": 48
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/insecure-xml-read",
          "level": "warning",
          "message": "Insecure XML processing: DTD processing enabled in settings, insecure resolver set in settings",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/src/System/Security/Cryptography/Xml/Utils.cs",
                "region": {
                  "startLine": 202,
                  "startColumn": 19,
                  "length": 49
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/insecure-xml-read",
          "level": "warning",
          "message": "Insecure XML processing: DTD processing enabled in settings, insecure resolver set in settings",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/src/System/Security/Cryptography/Xml/Utils.cs",
                "region": {
                  "startLine": 223,
                  "startColumn": 19,
                  "length": 49
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/insecure-xml-read",
          "level": "warning",
          "message": "Insecure XML processing: DTD processing enabled in settings, insecure resolver set in settings",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/TestHelpers.cs",
                "region": {
                  "startLine": 101,
                  "startColumn": 26,
                  "length": 149
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/insecure-xml-read",
          "level": "warning",
          "message": "Insecure XML processing: DTD processing enabled in settings, insecure resolver set in settings",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/XmlDsigC14NWithCommentsTransformTest.cs",
                "region": {
                  "startLine": 119,
                  "startColumn": 26,
                  "length": 149
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/insecure-xml-read",
          "level": "warning",
          "message": "Insecure XML processing: DTD processing enabled in settings, insecure resolver set in settings",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/XmlDsigExcC14NTransformTest.cs",
                "region": {
                  "startLine": 362,
                  "startColumn": 26,
                  "length": 34
                }
              }
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"mono\" flows to the [password] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 665,
                  "startColumn": 54,
                  "length": 6
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 665,
                  "startColumn": 54,
                  "length": 6
                }
              },
              "message": "password"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 665,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"mono\" flows to the [password] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 724,
                  "startColumn": 54,
                  "length": 6
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 724,
                  "startColumn": 54,
                  "length": 6
                }
              },
              "message": "password"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 724,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"mono\" flows to the [password] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 766,
                  "startColumn": 54,
                  "length": 6
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 766,
                  "startColumn": 54,
                  "length": 6
                }
              },
              "message": "password"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 766,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"mono\" flows to the [password] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 829,
                  "startColumn": 54,
                  "length": 6
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 829,
                  "startColumn": 54,
                  "length": 6
                }
              },
              "message": "password"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 829,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"mono\" flows to the [password] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 886,
                  "startColumn": 54,
                  "length": 6
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 886,
                  "startColumn": 54,
                  "length": 6
                }
              },
              "message": "password"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 886,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"mono\" flows to the [password] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 944,
                  "startColumn": 54,
                  "length": 6
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 944,
                  "startColumn": 54,
                  "length": 6
                }
              },
              "message": "password"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 944,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1030,
                  "startColumn": 30,
                  "length": 3058
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 681,
                  "startColumn": 48,
                  "length": 5
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 681,
                  "startColumn": 27,
                  "length": 27
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1030,
                  "startColumn": 30,
                  "length": 3058
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 740,
                  "startColumn": 48,
                  "length": 5
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 740,
                  "startColumn": 27,
                  "length": 27
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1030,
                  "startColumn": 30,
                  "length": 3058
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 981,
                  "startColumn": 48,
                  "length": 5
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 981,
                  "startColumn": 27,
                  "length": 27
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1071,
                  "startColumn": 32,
                  "length": 10253
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 665,
                  "startColumn": 45,
                  "length": 7
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 665,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1071,
                  "startColumn": 32,
                  "length": 10253
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 724,
                  "startColumn": 45,
                  "length": 7
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 724,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1071,
                  "startColumn": 32,
                  "length": 10253
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 766,
                  "startColumn": 45,
                  "length": 7
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 766,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1071,
                  "startColumn": 32,
                  "length": 10253
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 829,
                  "startColumn": 45,
                  "length": 7
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 829,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1071,
                  "startColumn": 32,
                  "length": 10253
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 886,
                  "startColumn": 45,
                  "length": 7
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 886,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "This hard-coded value flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 1071,
                  "startColumn": 32,
                  "length": 10253
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 944,
                  "startColumn": 45,
                  "length": 7
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/SignedXmlTest.cs",
                "region": {
                  "startLine": 944,
                  "startColumn": 24,
                  "length": 37
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"MIIFpQIBAzCCBV8GCSqGSIb3DQEHAaCCBVAEggVMMIIFSDCCAl8GCSqGSIb3DQEHBqCCAlAwggJMAgEAMIICRQYJKoZIhvcNAQcBMBwGCiqGSIb3DQEMAQMwDgQIGTfVa4+vR1UCAgfQgIICGJuFE9alFWJFkaoeewKDIEnVwRxXfMsi8dcySYnp7jljEUQBfW/GIbOf7Lg2nHd0qxvxYI2YL4Zs+d0jWbqfNHamGFCMPe1dK957Z2PsKXR183vMSgnmlLAHktsIN+Gor7q1GbQ4ljfZkGqZ/rkgUsgsSYZSnJevP/uH0VnvxemljVJ7N7gKMYO0aqrca4qJ0O4YxBYyaerPFUOYunQlvk6DOF3SQXza5oFKcPGrSpE/9eQrnmm64BtbdnUE6qqEjfZfNa6MOD3vOnapLUBsel2TtVCu8tEl7I8FGxozTLXVTXOBkL3k7xLRS52ZtpbcU2JIhlDGpxeFXmjKYzdzHoL20iJubfdkUYtHwB0XjBKKLcI7jfgGgjNauaTLAx8FF+5O9s7Zbj2+SKWv56kqAwdX+iH21VgjAN9EByIXHb3p2ZOvy4ONDXTmfSn7jbuPLZTi+u6bxn2JOLf/gjEA8FiCuQDL9gF247bnUq08Z1uzuAUeaPL13U8mxwEuvCOXx5NEQIuf3cusnaH4+7uIhPk5tnfA5XOaABySetRjZhVN5dC5/g3KTwmaDamlW3Y7Az/NzAC4uKa2ny5jwYKBgHviEKOyJfLDKr5fOMRToOfgxvAdXZohQQTE1+TcBjp+eeV5koDfB1ReCKIRHugPZu5j9SCVcYanwFeJ5M4cEHZ9U1Ytsmzjh0fwV17D/hxQ4aS4VwVpOMypMIIC4QYJKoZIhvcNAQcBoIIC0gSCAs4wggLKMIICxgYLKoZIhvcNAQwKAQKgggKeMIICmjAcBgoqhkiG9w0BDAEDMA4ECBRdKqx022cfAgIH0ASCAnjZx9fvPCHizdH6apVzWWmfy/84HvDPjFOUV1TPehTnDPkNpF/uK/ya4jlbl4Kw0Zfknt5Xydl89SMXIWa2q+nWmxyG3XyfGqOAeBfJBSdCF5K3qkZZnzEfraKZZ5Hh8IEmK+ey45O6sltua6Xl5MRBmKLiwma7vX4ihXQTMfb0WlWDYCXZi85OeF0OlUjRWAwz4PeeiBK4nmI/vNmF1EzDVdZGkrrE8mot3Y4z6bvwqip2tUUbHuMnC+/1ikAcJzCOw4NpnEWCRtIJxgJ9es8E8CUfHESnWKe4nh6tJVJ15B8/7oF7N6j7oq4Oj346JthKoWWkzifNaH79A60/uFh08Rv7zrtJf6kedY6Ve2bR5lhWn0cv9Q6IaoqTmKKTmKJnjdQO9lKRCR6iI2OsYtXBropD8xhNNqsyfpNmP0G6wFiEZZxZjWOkZEJLUzFbH+Su+7l2l4FN9sM7k211/l3/3YF1QJHwZsgL98DZL4qE+nkuZQcdtOUx8QTyTOcVb3IzgCAwZm0rgdXQpJ9yRBgOC/6MnqaCPI0jJuavXF/a28GJWWGlazx7SWTrbzNVJ83ZhQ+pfPEPtMi3t0YVLLvapu3otgpiMkv4ew/ssXwYbg6xBWfotK+NG1cPwVFy9/V9+H5dpdvRI/le2QG0F5xCfCeKh/3AuNiMPEGoVUR5kj5cwFK6eskvt/+74ZenxfNPZ2Uttiw8DsqtTx1gxhcSZeU5YWpO7O78RaYE4Ll4kPbbvIaR18Napb6NKP846z02zvaw+feXARLe0HUY58TlmUjSX3MZRK4PEdyMIQ/URyPimj4rImaDfFrKPAHIjqT3EKv+KuNs8TEVMBMGCSqGSIb3DQEJFTEGBAQBAAAAMD0wITAJBgUrDgMCGgUABBRZOo132cuo2zNyy+SH2c+pN4OGmQQU2nQao3je7DTj2G6Gge8pooPf2ncCAgfQ\" flows to the [rawData] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/TestHelpers.cs",
                "region": {
                  "startLine": 189,
                  "startColumn": 1,
                  "length": 1935
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/TestHelpers.cs",
                "region": {
                  "startLine": 193,
                  "startColumn": 28,
                  "length": 9
                }
              },
              "message": "rawData"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/TestHelpers.cs",
                "region": {
                  "startLine": 193,
                  "startColumn": 7,
                  "length": 39
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        },
        {
          "ruleId": "cs/hardcoded-credentials",
          "level": "warning",
          "message": "The hard-coded value \"mono\" flows to the [password] parameter in [object creation of type X509Certificate2].",
          "locations": [
            {
              "resultFile": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/TestHelpers.cs",
                "region": {
                  "startLine": 193,
                  "startColumn": 39,
                  "length": 6
                }
              }
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/TestHelpers.cs",
                "region": {
                  "startLine": 193,
                  "startColumn": 39,
                  "length": 6
                }
              },
              "message": "password"
            },
            {
              "physicalLocation": {
                "uri": "file:///C:/corefx/src/System.Security.Cryptography.Xml/tests/TestHelpers.cs",
                "region": {
                  "startLine": 193,
                  "startColumn": 7,
                  "length": 39
                }
              },
              "message": "object creation of type X509Certificate2"
            }
          ]
        }
      ],
      "rules": {
        "cs/ldap-injection": {
          "id": "cs/ldap-injection",
          "name": "cs/ldap-injection",
          "shortDescription": "LDAP query built from user-controlled sources",
          "fullDescription": "Building an LDAP query from user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-090"
],
            "kind": "problem",
            "precision": "medium",
            "name": "LDAP query built from user-controlled sources",
            "description": "Building an LDAP query from user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
            "id": "cs/ldap-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-090/LDAPInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/xpath-injection": {
          "id": "cs/xml/xpath-injection",
          "name": "cs/xml/xpath-injection",
          "shortDescription": "XPath injection",
          "fullDescription": "Building an XPath expression from user-controlled sources is vulnerable to insertion of malicious code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-643"
],
            "kind": "problem",
            "precision": "medium",
            "name": "XPath injection",
            "description": "Building an XPath expression from user-controlled sources is vulnerable to insertion of malicious code by the user.",
            "id": "cs/xml/xpath-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-643/XPathInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/command-line-injection": {
          "id": "cs/command-line-injection",
          "name": "cs/command-line-injection",
          "shortDescription": "Uncontrolled command line",
          "fullDescription": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "correctness",
  "security",
  "external/cwe/cwe-078",
  "external/cwe/cwe-088"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled command line",
            "description": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
            "id": "cs/command-line-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-078/CommandInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/directory-browse-enabled": {
          "id": "cs/web/directory-browse-enabled",
          "name": "cs/web/directory-browse-enabled",
          "shortDescription": "ASP.NET config file enables directory browsing",
          "fullDescription": "Directory browsing should not be enabled in production as it can leak sensitive information.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-548"
],
            "kind": "problem",
            "precision": "very-high",
            "name": "ASP.NET config file enables directory browsing",
            "description": "Directory browsing should not be enabled in production as it can leak sensitive information.",
            "id": "cs/web/directory-browse-enabled",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-548/ASPNetDirectoryListing.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/unvalidated-url-redirection": {
          "id": "cs/web/unvalidated-url-redirection",
          "name": "cs/web/unvalidated-url-redirection",
          "shortDescription": "URL redirection from remote source",
          "fullDescription": "URL redirection based on unvalidated user input may cause redirection to malicious web sites.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-601"
],
            "kind": "problem",
            "precision": "medium",
            "name": "URL redirection from remote source",
            "description": "URL redirection based on unvalidated user input may cause redirection to malicious web sites.",
            "id": "cs/web/unvalidated-url-redirection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-601/UrlRedirect.ql",
            "problem.severity": "error"
          }
        },
        "cs/path-injection": {
          "id": "cs/path-injection",
          "name": "cs/path-injection",
          "shortDescription": "Uncontrolled data used in path expression",
          "fullDescription": "Accessing paths influenced by users can allow an attacker to access unexpected resources.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-022",
  "external/cwe/cwe-023",
  "external/cwe/cwe-036",
  "external/cwe/cwe-073",
  "external/cwe/cwe-099"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled data used in path expression",
            "description": "Accessing paths influenced by users can allow an attacker to access unexpected resources.",
            "id": "cs/path-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-022/TaintedPath.ql",
            "problem.severity": "error"
          }
        },
        "cs/user-controlled-bypass": {
          "id": "cs/user-controlled-bypass",
          "name": "cs/user-controlled-bypass",
          "shortDescription": "User-controlled bypass of sensitive method",
          "fullDescription": "User-controlled bypassing of sensitive methods may allow attackers to avoid passing through authentication systems.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-807",
  "external/cwe/cwe-247",
  "external/cwe/cwe-350"
],
            "kind": "problem",
            "precision": "medium",
            "name": "User-controlled bypass of sensitive method",
            "description": "User-controlled bypassing of sensitive methods may allow attackers to avoid passing through authentication systems.",
            "id": "cs/user-controlled-bypass",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-807/ConditionalBypass.ql",
            "problem.severity": "error"
          }
        },
        "cs/sensitive-data-transmission": {
          "id": "cs/sensitive-data-transmission",
          "name": "cs/sensitive-data-transmission",
          "shortDescription": "Information exposure through transmitted data",
          "fullDescription": "Transmitting sensitive information to the user is a potential security risk.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-201"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Information exposure through transmitted data",
            "description": "Transmitting sensitive information to the user is a potential security risk.",
            "id": "cs/sensitive-data-transmission",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-201/ExposureInTransmittedData.ql",
            "problem.severity": "error"
          }
        },
        "cs/inappropriate-encoding": {
          "id": "cs/inappropriate-encoding",
          "name": "cs/inappropriate-encoding",
          "shortDescription": "Inappropriate encoding",
          "fullDescription": "Using an inappropriate encoding may give unintended results and may pose a security risk.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-838"
],
            "kind": "problem",
            "precision": "low",
            "name": "Inappropriate encoding",
            "description": "Using an inappropriate encoding may give unintended results and may pose a security risk.",
            "id": "cs/inappropriate-encoding",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-838/InappropriateEncoding.ql",
            "problem.severity": "error"
          }
        },
        "cs/hardcoded-credentials": {
          "id": "cs/hardcoded-credentials",
          "name": "cs/hardcoded-credentials",
          "shortDescription": "Hard-coded credentials",
          "fullDescription": "Credentials are hard coded in the source code of the application.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-259",
  "external/cwe/cwe-321",
  "external/cwe/cwe-798"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Hard-coded credentials",
            "description": "Credentials are hard coded in the source code of the application.",
            "id": "cs/hardcoded-credentials",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-798/HardcodedCredentials.ql",
            "problem.severity": "error"
          }
        },
        "cs/insecure-randomness": {
          "id": "cs/insecure-randomness",
          "name": "cs/insecure-randomness",
          "shortDescription": "Insecure randomness",
          "fullDescription": "Using a cryptographically weak pseudo-random number generator to generate a security sensitive value may allow an attacker to predict what sensitive value will be generated.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-338"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Insecure randomness",
            "description": "Using a cryptographically weak pseudo-random number generator to generate a security sensitive value may allow an attacker to predict what sensitive value will be generated.",
            "id": "cs/insecure-randomness",
            "query-path": "/semmlecode-csharp-queries/Security Features/InsecureRandomness.ql",
            "problem.severity": "warning"
          }
        },
        "cs/empty-password-in-configuration": {
          "id": "cs/empty-password-in-configuration",
          "name": "cs/empty-password-in-configuration",
          "shortDescription": "Empty password in configuration file",
          "fullDescription": "Finds empty passwords in configuration files.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-258",
  "external/cwe/cwe-862"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Empty password in configuration file",
            "description": "Finds empty passwords in configuration files.",
            "id": "cs/empty-password-in-configuration",
            "query-path": "/semmlecode-csharp-queries/Configuration/EmptyPasswordInConfigurationFile.ql",
            "problem.severity": "warning"
          }
        },
        "cs/information-exposure-through-exception": {
          "id": "cs/information-exposure-through-exception",
          "name": "cs/information-exposure-through-exception",
          "shortDescription": "Information exposure through an exception",
          "fullDescription": "Leaking information about an exception, such as messages and stack traces, to an external user can expose implementation details that are useful to an attacker for developing a subsequent exploit.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-209",
  "external/cwe/cwe-497"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Information exposure through an exception",
            "description": "Leaking information about an exception, such as messages and stack traces, to an external user can expose implementation details that are useful to an attacker for developing a subsequent exploit.",
            "id": "cs/information-exposure-through-exception",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-209/ExceptionInformationExposure.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/missing-token-validation": {
          "id": "cs/web/missing-token-validation",
          "name": "cs/web/missing-token-validation",
          "shortDescription": "Missing cross-site request forgery token validation",
          "fullDescription": "Handling a POST request without verifying that the request came from the user allows a malicious attacker to submit a request on behalf of the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-352"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Missing cross-site request forgery token validation",
            "description": "Handling a POST request without verifying that the request came from the user allows a malicious attacker to submit a request on behalf of the user.",
            "id": "cs/web/missing-token-validation",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-352/MissingAntiForgeryTokenValidation.ql",
            "problem.severity": "error"
          }
        },
        "cs/second-order-sql-injection": {
          "id": "cs/second-order-sql-injection",
          "name": "cs/second-order-sql-injection",
          "shortDescription": "SQL query built from stored user-controlled sources",
          "fullDescription": "Building a SQL query from stored user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-089"
],
            "kind": "problem",
            "precision": "medium",
            "name": "SQL query built from stored user-controlled sources",
            "description": "Building a SQL query from stored user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
            "id": "cs/second-order-sql-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-089/SecondOrderSqlInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/unsynchronized-static-access": {
          "id": "cs/unsynchronized-static-access",
          "name": "cs/unsynchronized-static-access",
          "shortDescription": "Unsynchronized access to static collection member in non-static context",
          "fullDescription": "If an unsynchronized access to a static collection member occurs during an addition or resizing operation, an infinite loop can occur.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "concurrency",
  "external/cwe/cwe-362",
  "external/cwe/cwe-567"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Unsynchronized access to static collection member in non-static context",
            "description": "If an unsynchronized access to a static collection member occurs during an addition or resizing operation, an infinite loop can occur.",
            "id": "cs/unsynchronized-static-access",
            "query-path": "/semmlecode-csharp-queries/Concurrency/UnsynchronizedStaticAccess.ql",
            "problem.severity": "error"
          }
        },
        "cs/insufficient-key-size": {
          "id": "cs/insufficient-key-size",
          "name": "cs/insufficient-key-size",
          "shortDescription": "Weak encryption: Insufficient key size",
          "fullDescription": "Finds uses of encryption algorithms with too small a key size",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption: Insufficient key size",
            "description": "Finds uses of encryption algorithms with too small a key size",
            "id": "cs/insufficient-key-size",
            "query-path": "/semmlecode-csharp-queries/Security Features/InsufficientKeySize.ql",
            "problem.severity": "warning"
          }
        },
        "cs/stored-command-line-injection": {
          "id": "cs/stored-command-line-injection",
          "name": "cs/stored-command-line-injection",
          "shortDescription": "Uncontrolled command line from stored user input",
          "fullDescription": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "correctness",
  "security",
  "external/cwe/cwe-078",
  "external/cwe/cwe-088"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Uncontrolled command line from stored user input",
            "description": "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command.",
            "id": "cs/stored-command-line-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-078/StoredCommandInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/ecb-encryption": {
          "id": "cs/ecb-encryption",
          "name": "cs/ecb-encryption",
          "shortDescription": "Encryption using ECB",
          "fullDescription": "Highlights uses of the encryption mode 'CipherMode.ECB'. This mode should normally not be used because it is vulnerable to replay attacks.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Encryption using ECB",
            "description": "Highlights uses of the encryption mode \u0027CipherMode.ECB\u0027. This mode should normally not be used because it is vulnerable to replay attacks.",
            "id": "cs/ecb-encryption",
            "query-path": "/semmlecode-csharp-queries/Security Features/Encryption using ECB.ql",
            "problem.severity": "warning"
          }
        },
        "cs/inadequate-rsa-padding": {
          "id": "cs/inadequate-rsa-padding",
          "name": "cs/inadequate-rsa-padding",
          "shortDescription": "Weak encryption: inadequate RSA padding",
          "fullDescription": "Finds uses of RSA encryption with inadequate padding.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327",
  "external/cwe/cwe-780"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption: inadequate RSA padding",
            "description": "Finds uses of RSA encryption with inadequate padding.",
            "id": "cs/inadequate-rsa-padding",
            "query-path": "/semmlecode-csharp-queries/Security Features/InadequateRSAPadding.ql",
            "problem.severity": "warning"
          }
        },
        "cs/cleartext-storage-of-sensitive-information": {
          "id": "cs/cleartext-storage-of-sensitive-information",
          "name": "cs/cleartext-storage-of-sensitive-information",
          "shortDescription": "Clear text storage of sensitive information",
          "fullDescription": "Sensitive information stored without encryption or hashing can expose it to an attacker.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-312",
  "external/cwe/cwe-315",
  "external/cwe/cwe-359"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Clear text storage of sensitive information",
            "description": "Sensitive information stored without encryption or hashing can expose it to an attacker.",
            "id": "cs/cleartext-storage-of-sensitive-information",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-312/CleartextStorage.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/missing-global-error-handler": {
          "id": "cs/web/missing-global-error-handler",
          "name": "cs/web/missing-global-error-handler",
          "shortDescription": "Missing global error handler",
          "fullDescription": "ASP.NET applications should not set the 'customError' mode to \"off\" without providing a global error handler, otherwise they may leak exception information.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-12",
  "external/cwe/cwe-248"
],
            "kind": "problem",
            "precision": "high",
            "name": "Missing global error handler",
            "description": "ASP.NET applications should not set the \u0027customError\u0027 mode to \"off\" without providing a global error handler, otherwise they may leak exception information.",
            "id": "cs/web/missing-global-error-handler",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-248/MissingASPNETGlobalErrorHandler.ql",
            "problem.severity": "warning"
          }
        },
        "cs/session-reuse": {
          "id": "cs/session-reuse",
          "name": "cs/session-reuse",
          "shortDescription": "Failure to abandon session",
          "fullDescription": "Reusing an existing session as a different user could allow an attacker to access someone else's account by using their session.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-384"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Failure to abandon session",
            "description": "Reusing an existing session as a different user could allow an attacker to access someone else\u0027s account by using their session.",
            "id": "cs/session-reuse",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-384/AbandonSession.ql",
            "problem.severity": "error"
          }
        },
        "cs/password-in-configuration": {
          "id": "cs/password-in-configuration",
          "name": "cs/password-in-configuration",
          "shortDescription": "Password in configuration file",
          "fullDescription": "Finds passwords in configuration files.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-13",
  "external/cwe/cwe-256",
  "external/cwe/cwe-313"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Password in configuration file",
            "description": "Finds passwords in configuration files.",
            "id": "cs/password-in-configuration",
            "query-path": "/semmlecode-csharp-queries/Configuration/PasswordInConfigurationFile.ql",
            "problem.severity": "warning"
          }
        },
        "cs/xml/missing-validation": {
          "id": "cs/xml/missing-validation",
          "name": "cs/xml/missing-validation",
          "shortDescription": "Missing XML validation",
          "fullDescription": "User input should not be processed as XML without validating it against a known schema.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-112"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Missing XML validation",
            "description": "User input should not be processed as XML without validating it against a known schema.",
            "id": "cs/xml/missing-validation",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-112/MissingXMLValidation.ql",
            "problem.severity": "recommendation"
          }
        },
        "cs/web/broad-cookie-domain": {
          "id": "cs/web/broad-cookie-domain",
          "name": "cs/web/broad-cookie-domain",
          "shortDescription": "Cookie security: overly broad domain",
          "fullDescription": "Finds cookies with an overly broad domain.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-287"
],
            "kind": "problem",
            "precision": "high",
            "name": "Cookie security: overly broad domain",
            "description": "Finds cookies with an overly broad domain.",
            "id": "cs/web/broad-cookie-domain",
            "query-path": "/semmlecode-csharp-queries/Security Features/CookieWithOverlyBroadDomain.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/persistent-cookie": {
          "id": "cs/web/persistent-cookie",
          "name": "cs/web/persistent-cookie",
          "shortDescription": "Cookie security: persistent cookie",
          "fullDescription": "Persistent cookies are vulnerable to attacks.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-539"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Cookie security: persistent cookie",
            "description": "Persistent cookies are vulnerable to attacks.",
            "id": "cs/web/persistent-cookie",
            "query-path": "/semmlecode-csharp-queries/Security Features/PersistentCookie.ql",
            "problem.severity": "warning"
          }
        },
        "cs/insecure-xml-read": {
          "id": "cs/insecure-xml-read",
          "name": "cs/insecure-xml-read",
          "shortDescription": "XML is read insecurely",
          "fullDescription": "XML may include dangerous external references, which should be restricted using a secure resolver or disabling DTD processing.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-611",
  "external/cwe/cwe-827",
  "external/cwe/cwe-776"
],
            "kind": "problem",
            "precision": "medium",
            "name": "XML is read insecurely",
            "description": "XML may include dangerous external references, which should be restricted using a secure resolver or disabling DTD processing.",
            "id": "cs/insecure-xml-read",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-611/UseXmlSecureResolver.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/xss": {
          "id": "cs/web/xss",
          "name": "cs/web/xss",
          "shortDescription": "Cross-site scripting",
          "fullDescription": "Writing user input directly to a web page allows for a cross-site scripting vulnerability.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-079",
  "external/cwe/cwe-116"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Cross-site scripting",
            "description": "Writing user input directly to a web page allows for a cross-site scripting vulnerability.",
            "id": "cs/web/xss",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-079/XSS.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/stored-xpath-injection": {
          "id": "cs/xml/stored-xpath-injection",
          "name": "cs/xml/stored-xpath-injection",
          "shortDescription": "Stored XPath injection",
          "fullDescription": "Building an XPath expression from stored data which may have been provided by the user is vulnerable to insertion of malicious code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-643"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Stored XPath injection",
            "description": "Building an XPath expression from stored data which may have been provided by the user is vulnerable to insertion of malicious code by the user.",
            "id": "cs/xml/stored-xpath-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-643/StoredXPathInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/stored-xss": {
          "id": "cs/web/stored-xss",
          "name": "cs/web/stored-xss",
          "shortDescription": "Stored cross-site scripting",
          "fullDescription": "Writing input from the database directly to a web page indicates a cross-site scripting vulnerability if the data was originally user-provided.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-079",
  "external/cwe/cwe-116"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Stored cross-site scripting",
            "description": "Writing input from the database directly to a web page indicates a cross-site scripting vulnerability if the data was originally user-provided.",
            "id": "cs/web/stored-xss",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-079/StoredXSS.ql",
            "problem.severity": "error"
          }
        },
        "cs/resource-injection": {
          "id": "cs/resource-injection",
          "name": "cs/resource-injection",
          "shortDescription": "Resource injection",
          "fullDescription": "Building a resource descriptor from untrusted user input is vulnerable to a malicious user providing an unintended resource.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-099"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Resource injection",
            "description": "Building a resource descriptor from untrusted user input is vulnerable to a malicious user providing an unintended resource.",
            "id": "cs/resource-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-099/ResourceInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/debug-binary": {
          "id": "cs/web/debug-binary",
          "name": "cs/web/debug-binary",
          "shortDescription": "Creating an ASP.NET debug binary may reveal sensitive information",
          "fullDescription": "ASP.NET projects should not produce debug binaries when deploying to production as debug builds provide additional information useful to a malicious attacker.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "maintainability",
  "frameworks/asp.net",
  "external/cwe/cwe-11"
],
            "kind": "problem",
            "precision": "very-high",
            "name": "Creating an ASP.NET debug binary may reveal sensitive information",
            "description": "ASP.NET projects should not produce debug binaries when deploying to production as debug builds provide additional information useful to a malicious attacker.",
            "id": "cs/web/debug-binary",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-011/ASPNetDebug.ql",
            "problem.severity": "warning"
          }
        },
        "cs/stored-ldap-injection": {
          "id": "cs/stored-ldap-injection",
          "name": "cs/stored-ldap-injection",
          "shortDescription": "LDAP query built from stored user-controlled sources",
          "fullDescription": "Building an LDAP query from stored user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-090"
],
            "kind": "problem",
            "precision": "medium",
            "name": "LDAP query built from stored user-controlled sources",
            "description": "Building an LDAP query from stored user-controlled sources is vulnerable to insertion of malicious LDAP code by the user.",
            "id": "cs/stored-ldap-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-090/StoredLDAPInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/code-injection": {
          "id": "cs/code-injection",
          "name": "cs/code-injection",
          "shortDescription": "Improper control of generation of code",
          "fullDescription": "Treating externally controlled strings as code can allow an attacker to execute malicious code.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-094",
  "external/cwe/cwe-095",
  "external/cwe/cwe-096"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Improper control of generation of code",
            "description": "Treating externally controlled strings as code can allow an attacker to execute malicious code.",
            "id": "cs/code-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-094/CodeInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/unvalidated-local-pointer-arithmetic": {
          "id": "cs/unvalidated-local-pointer-arithmetic",
          "name": "cs/unvalidated-local-pointer-arithmetic",
          "shortDescription": "Unvalidated local pointer arithmetic",
          "fullDescription": "Using the result of a virtual method call in pointer arithmetic without validation is dangerous because the method may be overridden by a subtype to return any value.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-119",
  "external/cwe/cwe-120",
  "external/cwe/cwe-122",
  "external/cwe/cwe-788"
],
            "kind": "problem",
            "precision": "high",
            "name": "Unvalidated local pointer arithmetic",
            "description": "Using the result of a virtual method call in pointer arithmetic without validation is dangerous because the method may be overridden by a subtype to return any value.",
            "id": "cs/unvalidated-local-pointer-arithmetic",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-119/LocalUnvalidatedArithmetic.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/missing-x-frame-options": {
          "id": "cs/web/missing-x-frame-options",
          "name": "cs/web/missing-x-frame-options",
          "shortDescription": "Missing X-Frame-Options HTTP header",
          "fullDescription": "If the 'X-Frame-Options' setting is not provided, a malicious user may be able to overlay their own UI on top of the site by using an iframe.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-451",
  "external/cwe/cwe-829"
],
            "kind": "problem",
            "precision": "high",
            "name": "Missing X-Frame-Options HTTP header",
            "description": "If the \u0027X-Frame-Options\u0027 setting is not provided, a malicious user may be able to overlay their own UI on top of the site by using an iframe.",
            "id": "cs/web/missing-x-frame-options",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-451/MissingXFrameOptions.ql",
            "problem.severity": "error"
          }
        },
        "cs/hardcoded-connection-string-credentials": {
          "id": "cs/hardcoded-connection-string-credentials",
          "name": "cs/hardcoded-connection-string-credentials",
          "shortDescription": "Hard-coded connection string with credentials",
          "fullDescription": "Credentials are hard-coded in a connection string in the source code of the application.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-259",
  "external/cwe/cwe-321",
  "external/cwe/cwe-798"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Hard-coded connection string with credentials",
            "description": "Credentials are hard-coded in a connection string in the source code of the application.",
            "id": "cs/hardcoded-connection-string-credentials",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-798/HardcodedConnectionString.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/broad-cookie-path": {
          "id": "cs/web/broad-cookie-path",
          "name": "cs/web/broad-cookie-path",
          "shortDescription": "Cookie security: overly broad path",
          "fullDescription": "Finds cookies with an overly broad path.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-287"
],
            "kind": "problem",
            "precision": "high",
            "name": "Cookie security: overly broad path",
            "description": "Finds cookies with an overly broad path.",
            "id": "cs/web/broad-cookie-path",
            "query-path": "/semmlecode-csharp-queries/Security Features/CookieWithOverlyBroadPath.ql",
            "problem.severity": "warning"
          }
        },
        "cs/weak-encryption": {
          "id": "cs/weak-encryption",
          "name": "cs/weak-encryption",
          "shortDescription": "Weak encryption",
          "fullDescription": "Finds uses of encryption algorithms that are weak and obsolete",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-327"
],
            "kind": "problem",
            "precision": "high",
            "name": "Weak encryption",
            "description": "Finds uses of encryption algorithms that are weak and obsolete",
            "id": "cs/weak-encryption",
            "query-path": "/semmlecode-csharp-queries/Security Features/WeakEncryption.ql",
            "problem.severity": "warning"
          }
        },
        "cs/web/disabled-header-checking": {
          "id": "cs/web/disabled-header-checking",
          "name": "cs/web/disabled-header-checking",
          "shortDescription": "Header checking disabled",
          "fullDescription": "Finds places where header checking is disabled.",
          "defaultLevel": "warning",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-113"
],
            "kind": "problem",
            "precision": "high",
            "name": "Header checking disabled",
            "description": "Finds places where header checking is disabled.",
            "id": "cs/web/disabled-header-checking",
            "query-path": "/semmlecode-csharp-queries/Security Features/HeaderCheckingDisabled.ql",
            "problem.severity": "warning"
          }
        },
        "cs/log-forging": {
          "id": "cs/log-forging",
          "name": "cs/log-forging",
          "shortDescription": "Log entries created from user input",
          "fullDescription": "Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-117"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Log entries created from user input",
            "description": "Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.",
            "id": "cs/log-forging",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-117/LogForging.ql",
            "problem.severity": "error"
          }
        },
        "cs/web/requiressl-not-set": {
          "id": "cs/web/requiressl-not-set",
          "name": "cs/web/requiressl-not-set",
          "shortDescription": "'requireSSL' attribute is not set to true",
          "fullDescription": "Omitting the 'requireSSL' attribute allows data to be transmitted insecurely using HTTP. Always set 'requireSSL' to 'true' to ensure that HTTPS is used at all times.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-319",
  "external/cwe/cwe-614"
],
            "kind": "problem",
            "precision": "high",
            "name": "\u0027requireSSL\u0027 attribute is not set to true",
            "description": "Omitting the \u0027requireSSL\u0027 attribute allows data to be transmitted insecurely using HTTP. Always set \u0027requireSSL\u0027 to \u0027true\u0027 to ensure that HTTPS is used at all times.",
            "id": "cs/web/requiressl-not-set",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-614/RequireSSL.ql",
            "problem.severity": "error"
          }
        },
        "cs/regex-injection": {
          "id": "cs/regex-injection",
          "name": "cs/regex-injection",
          "shortDescription": "Regular expression injection",
          "fullDescription": "User input should not be used in regular expressions without first being escaped, otherwise a malicious user may be able to provide a regex that could require exponential time on certain inputs.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-730",
  "external/cwe/cwe-400"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Regular expression injection",
            "description": "User input should not be used in regular expressions without first being escaped, otherwise a malicious user may be able to provide a regex that could require exponential time on certain inputs.",
            "id": "cs/regex-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-730/RegexInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/xml/insecure-dtd-handling": {
          "id": "cs/xml/insecure-dtd-handling",
          "name": "cs/xml/insecure-dtd-handling",
          "shortDescription": "Untrusted XML is read insecurely",
          "fullDescription": "Untrusted XML is read with an insecure resolver and DTD processing enabled.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-611",
  "external/cwe/cwe-827",
  "external/cwe/cwe-776"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Untrusted XML is read insecurely",
            "description": "Untrusted XML is read with an insecure resolver and DTD processing enabled.",
            "id": "cs/xml/insecure-dtd-handling",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-611/UntrustedDataInsecureXml.ql",
            "problem.severity": "error"
          }
        },
        "cs/sql-injection": {
          "id": "cs/sql-injection",
          "name": "cs/sql-injection",
          "shortDescription": "SQL query built from user-controlled sources",
          "fullDescription": "Building a SQL query from user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-089"
],
            "kind": "problem",
            "precision": "medium",
            "name": "SQL query built from user-controlled sources",
            "description": "Building a SQL query from user-controlled sources is vulnerable to insertion of malicious SQL code by the user.",
            "id": "cs/sql-injection",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-089/SqlInjection.ql",
            "problem.severity": "error"
          }
        },
        "cs/redos": {
          "id": "cs/redos",
          "name": "cs/redos",
          "shortDescription": "Denial of Service from comparison of user input against expensive regex",
          "fullDescription": "User input should not be matched against a regular expression that could require exponential time on certain input.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-730",
  "external/cwe/cwe-400"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Denial of Service from comparison of user input against expensive regex",
            "description": "User input should not be matched against a regular expression that could require exponential time on certain input.",
            "id": "cs/redos",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-730/ReDoS.ql",
            "problem.severity": "error"
          }
        },
        "cs/exposure-of-sensitive-information": {
          "id": "cs/exposure-of-sensitive-information",
          "name": "cs/exposure-of-sensitive-information",
          "shortDescription": "Exposure of private information",
          "fullDescription": "If private information is written to an external location, it may be accessible by unauthorized persons.",
          "defaultLevel": "error",
          "properties": {
            "tags": [
  "security",
  "external/cwe/cwe-359"
],
            "kind": "problem",
            "precision": "medium",
            "name": "Exposure of private information",
            "description": "If private information is written to an external location, it may be accessible by unauthorized persons.",
            "id": "cs/exposure-of-sensitive-information",
            "query-path": "/semmlecode-csharp-queries/Security Features/CWE-359/ExposureOfPrivateInformation.ql",
            "problem.severity": "error"
          }
        }
      },
      "properties": {
        "originalUriBaseIds": {
  "%SRCROOT%": "file:///C:/corefx/src/System.Security.Cryptography.Xml/"
}
      }
    }
  ]
}