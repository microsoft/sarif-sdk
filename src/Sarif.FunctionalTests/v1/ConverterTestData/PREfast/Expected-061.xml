<?xml version='1.0' encoding='UTF-8'?>
<DEFECTS><DEFECT><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>9</LINE><COLUMN>11</COLUMN></SFA><DEFECTCODE>26007</DEFECTCODE><DESCRIPTION>Possibly incorrect single element annotation on buffer
PREFAST_NEWLINE
Read overflow using expression '* _Str'
PREFAST_NEWLINE
Buffer _Str is a parameter to this function declared on line 7
PREFAST_NEWLINE
Buffer lengths are from an assumed __in annotation on the parameter
PREFAST_NEWLINE
Buffer is of length offset(_Str)`7 + 1 bytes [from annotation valid(elementCount(1)) at c:\somepath\test061.cpp(7)]
PREFAST_NEWLINE
Accessing the byte at byte offset 1
PREFAST_NEWLINE

PREFAST_NEWLINE
Values of variables:
PREFAST_NEWLINE
Pointer _Str is at offset 1 bytes from the start of the buffer
PREFAST_NEWLINE

PREFAST_NEWLINE
where
PREFAST_NEWLINE
offset(_Str)`7 == 0
PREFAST_NEWLINE
{loop iterations}'9 == 0
PREFAST_NEWLINE
</DESCRIPTION><FUNCTION>strchr</FUNCTION><DECORATED>?strchr@@YAPADPBDH@Z</DECORATED><FUNCLINE>7</FUNCLINE><PATH><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>7</LINE><COLUMN>16</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>9</LINE><COLUMN>11</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>9</LINE><COLUMN>26</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>10</LINE><COLUMN>12</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>9</LINE><COLUMN>11</COLUMN></SFA></PATH></DEFECT><DEFECT><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>37</COLUMN></SFA><DEFECTCODE>26002</DEFECTCODE><DESCRIPTION>Accessing buffer 'result.strchr'48' of unspecified length.  Please annotate.
PREFAST_NEWLINE

PREFAST_NEWLINE
If we assume that the buffer has single element in length, then the checker would report:
PREFAST_NEWLINE
Potential read overflow using expression '* pszToken'
PREFAST_NEWLINE
Buffer result.strchr created during call to strchr on line 48
PREFAST_NEWLINE
Buffer is of length 1 bytes [assumed because the buffer is unannotated]
PREFAST_NEWLINE
Accessing the byte at byte offset 1
PREFAST_NEWLINE

PREFAST_NEWLINE
Values of variables:
PREFAST_NEWLINE
Pointer pszToken is at offset 1 bytes from the start of the buffer
PREFAST_NEWLINE

PREFAST_NEWLINE
Overrun access occurs when
PREFAST_NEWLINE
offset(result.strchr)`48 == 0
PREFAST_NEWLINE

PREFAST_NEWLINE
There are other instances of this error:
PREFAST_NEWLINE
Accessing buffer 'result.strchr'48' of unspecified length.  Please annotate. at line 65
PREFAST_NEWLINE
</DESCRIPTION><FUNCTION>AddExtensionControlBlock</FUNCTION><DECORATED>?AddExtensionControlBlock@@YAXPAEK@Z</DECORATED><FUNCLINE>31</FUNCLINE><PATH><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>31</LINE><COLUMN>5</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>33</LINE><COLUMN>10</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>33</LINE><COLUMN>21</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>37</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>39</LINE><COLUMN>14</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>39</LINE><COLUMN>29</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>14</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>35</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>35</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>41</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>43</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>43</LINE><COLUMN>33</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>44</LINE><COLUMN>20</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>48</LINE><COLUMN>29</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>48</LINE><COLUMN>21</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>49</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>50</LINE><COLUMN>22</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>53</LINE><COLUMN>25</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>54</LINE><COLUMN>24</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>61</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>62</LINE><COLUMN>30</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>65</LINE><COLUMN>28</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>37</COLUMN></SFA></PATH></DEFECT><DEFECT><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>65</LINE><COLUMN>28</COLUMN></SFA><DEFECTCODE>26014</DEFECTCODE><DESCRIPTION>Potential overflow using expression '&amp; wcsAttribute'
PREFAST_NEWLINE
This is likely to be due to incorrect or insufficient validation of the buffer access
PREFAST_NEWLINE
Buffer accessed is wcsAttribute
PREFAST_NEWLINE
Buffer is of length 200 elements (2 bytes/element) [size of variable]
PREFAST_NEWLINE
Accessing  - offset(pszToken)`34 elements (2 bytes/element) starting at element offset 0
PREFAST_NEWLINE
Annotation on function DecodeURLEscapes requires that {parameter 3} is of length &gt;= * {parameter 2} elements (2 bytes/element)
PREFAST_NEWLINE
  where {parameter 3} is &amp; wcsAttribute; {parameter 2} is &amp; cchAttribute
PREFAST_NEWLINE
[Annotation SAL_writableTo(elementCount(* {parameter 2})) at c:\somepath\test061.cpp(18)]
PREFAST_NEWLINE

PREFAST_NEWLINE

PREFAST_NEWLINE
Values of variables:
PREFAST_NEWLINE
cchAttribute =  - offset(pszToken)`34
PREFAST_NEWLINE

PREFAST_NEWLINE
where
PREFAST_NEWLINE
offset(pszBuffer)`31 == 0
PREFAST_NEWLINE
offset(result.strchr)`40 == 0
PREFAST_NEWLINE
offset(result.strchr)`48 == 0
PREFAST_NEWLINE
nullpos(pszBuffer)`31 &gt;= 0
PREFAST_NEWLINE
nullpos(pszBuffer)`31 &gt;= 2
PREFAST_NEWLINE
offset(pszToken)`34 + 1 &lt;= 0
PREFAST_NEWLINE
offset(pszToken)`34 + 399 &gt;= 0
PREFAST_NEWLINE
{loop iterations}'34 &lt;= offset(pszToken)`34 + 1
PREFAST_NEWLINE

PREFAST_NEWLINE
Overrun access occurs when
PREFAST_NEWLINE
offset(pszToken)`34 + 201 &lt;= 0
PREFAST_NEWLINE
</DESCRIPTION><FUNCTION>AddExtensionControlBlock</FUNCTION><DECORATED>?AddExtensionControlBlock@@YAXPAEK@Z</DECORATED><FUNCLINE>31</FUNCLINE><PATH><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>31</LINE><COLUMN>5</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>33</LINE><COLUMN>10</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>33</LINE><COLUMN>21</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>37</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>39</LINE><COLUMN>14</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>39</LINE><COLUMN>29</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>14</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>35</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>35</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>41</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>43</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>43</LINE><COLUMN>33</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>44</LINE><COLUMN>20</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>48</LINE><COLUMN>29</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>48</LINE><COLUMN>21</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>49</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>50</LINE><COLUMN>22</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>53</LINE><COLUMN>25</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>54</LINE><COLUMN>24</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>61</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>62</LINE><COLUMN>30</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>65</LINE><COLUMN>28</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>37</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>39</LINE><COLUMN>14</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>39</LINE><COLUMN>29</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>14</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>35</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>35</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>41</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>43</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>43</LINE><COLUMN>33</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>44</LINE><COLUMN>20</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>48</LINE><COLUMN>29</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>48</LINE><COLUMN>21</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>49</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>50</LINE><COLUMN>22</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>58</LINE><COLUMN>25</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>61</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>62</LINE><COLUMN>30</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>65</LINE><COLUMN>28</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>34</LINE><COLUMN>37</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>39</LINE><COLUMN>14</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>39</LINE><COLUMN>29</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>14</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>35</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>40</LINE><COLUMN>35</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>41</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>43</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>43</LINE><COLUMN>33</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>44</LINE><COLUMN>20</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>48</LINE><COLUMN>29</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>48</LINE><COLUMN>21</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>49</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>50</LINE><COLUMN>22</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>53</LINE><COLUMN>25</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>54</LINE><COLUMN>24</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>61</LINE><COLUMN>18</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>62</LINE><COLUMN>30</COLUMN></SFA><SFA><FILEPATH>c:\somepath\</FILEPATH><FILENAME>test061.cpp</FILENAME><LINE>65</LINE><COLUMN>28</COLUMN></SFA></PATH></DEFECT></DEFECTS>