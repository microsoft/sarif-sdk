{
  "$schema": "https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.5.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "SARIF Functional Testing",
          "rules": [
            {
              "id": "SARIF1002",
              "name": "UrisMustBeValid",
              "shortDescription": {
                "text": "Specify a valid URI reference for every URI-valued property."
              },
              "fullDescription": {
                "text": "Specify a valid URI reference for every URI-valued property.\r\n\r\nURIs must conform to [RFC 3986](https://tools.ietf.org/html/rfc3986). In addition, 'file' URIs must not include '..' segments. If symbolic links are present, '..' might have different meanings on the machine that produced the log file and the machine where an end user or a tool consumes it."
              },
              "messageStrings": {
                "Error_UrisMustConformToRfc3986": {
                  "text": "{0}: The string '{1}' is not a valid URI reference. URIs must conform to [RFC 3986](https://tools.ietf.org/html/rfc3986)."
                },
                "Error_FileUrisMustNotIncludeDotDotSegments": {
                  "text": "{0}: The 'file' URI '{1}' contains a '..' segment. This is dangerous because if symbolic links are present, '..' might have different meanings on the machine that produced the log file and the machine where an end user or a tool consumes it."
                }
              },
              "helpUri": "http://docs.oasis-open.org/sarif/sarif/v2.1.0/sarif-v2.1.0.html"
            },
            {
              "id": "SARIF1004",
              "name": "ExpressUriBaseIdsCorrectly",
              "shortDescription": {
                "text": "Every URI reference in 'originalUriBaseIds' must resolve to an absolute URI, in the manner described in the SARIF specification [3.14.14](https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/sarif-v2.1.0-os.html#_Toc34317498)."
              },
              "fullDescription": {
                "text": "Every URI reference in 'originalUriBaseIds' must resolve to an absolute URI, in the manner described in the SARIF specification [3.14.14](https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/sarif-v2.1.0-os.html#_Toc34317498). This is because the purpose of 'uriBaseIds' is to enable the resolution of relative references to absolute locations."
              },
              "messageStrings": {
                "Error_UriBaseIdRequiresRelativeUri": {
                  "text": "{0}: The '{1}' element of 'originalUriBaseIds' has a 'uriBaseId' property '{2}', but its 'uri' property '{3}' is an absolute URI. Since the purpose of the 'uriBaseId' property is to help resolve a relative reference to an absolute URI, it is not allowed when the 'uri' property is already an absolute URI."
                },
                "Error_TopLevelUriBaseIdMustBeAbsolute": {
                  "text": "{0}: The '{1}' element of 'originalUriBaseIds' has no 'uriBaseId' property, but its 'uri' property '{2}' is not an absolute URI. According to the SARIF specification, every such \"top-level\" entry in 'originalUriBaseIds' must specify an absolute URI, because the purpose of 'originalUriBaseIds' is to enable the resolution of relative references to absolute URIs."
                },
                "Error_UriBaseIdValueMustEndWithSlash": {
                  "text": "{0}: The '{1}' element of 'originalUriBaseIds' has a 'uri' property '{2}' that does not end with a slash. The trailing slash is required to minimize the likelihood of an error when concatenating URI segments together."
                },
                "Error_UriBaseIdValueMustNotContainDotDotSegment": {
                  "text": "{0}: The '{1}' element of 'originalUriBaseIds' has a 'uri' property '{2}' that contains a '..' segment. This is dangerous because if symbolic links are present, '..' might have different meanings on the machine that produced the log file and the machine where an end user or a tool consumes it."
                },
                "Error_UriBaseIdValueMustNotContainQueryOrFragment": {
                  "text": "{0}: The '{1}' element of 'originalUriBaseIds' has a 'uri' property '{2}' that contains a query or a fragment. This is not valid because the purpose of the 'uriBaseId' property is to help resolve a relative reference to an absolute URI by concatenating the relative reference to the absolute base URI. This won't work if the base URI contains a query or a fragment."
                }
              },
              "helpUri": "http://docs.oasis-open.org/sarif/sarif/v2.1.0/sarif-v2.1.0.html"
            }
          ]
        }
      },
      "invocations": [
        {
          "toolConfigurationNotifications": [
            {
              "message": {
                "text": "Rule 'SARIF2002' was explicitly disabled by the user. As result, this tool run cannot be used for compliance or other auditing processes that require a comprehensive analysis."
              },
              "descriptor": {
                "id": "WRN999.RuleExplicitlyDisabled"
              }
            },
            {
              "message": {
                "text": "Rule 'SARIF2006' was explicitly disabled by the user. As result, this tool run cannot be used for compliance or other auditing processes that require a comprehensive analysis."
              },
              "descriptor": {
                "id": "WRN999.RuleExplicitlyDisabled"
              }
            },
            {
              "message": {
                "text": "Rule 'SARIF2007' was explicitly disabled by the user. As result, this tool run cannot be used for compliance or other auditing processes that require a comprehensive analysis."
              },
              "descriptor": {
                "id": "WRN999.RuleExplicitlyDisabled"
              }
            }
          ],
          "executionSuccessful": true
        }
      ],
      "artifacts": [
        {
          "location": {
            "uri": "FunctionalTestOutput.ValidateCommand/Inputs.SARIF1004.ExpressUriBaseIdsCorrectly_Invalid.sarif",
            "uriBaseId": "TEST_DIR"
          }
        }
      ],
      "results": [
        {
          "ruleId": "SARIF1002",
          "ruleIndex": 0,
          "level": "error",
          "message": {
            "id": "Error_FileUrisMustNotIncludeDotDotSegments",
            "arguments": [
              "runs[0].originalUriBaseIds.BAD_URI_CONTAINING_DOTDOT.uri",
              "file:///C:/rules/dir1/dir2/../"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 115,
                  "startColumn": 49
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_TopLevelUriBaseIdMustBeAbsolute",
            "arguments": [
              "runs[0].originalUriBaseIds.REPO_ROOT",
              "repository",
              "REPO_ROOT"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 101,
                  "startColumn": 22
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_UriBaseIdValueMustEndWithSlash",
            "arguments": [
              "runs[0].originalUriBaseIds.REPO_ROOT",
              "repository",
              "REPO_ROOT"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 101,
                  "startColumn": 22
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_UriBaseIdValueMustEndWithSlash",
            "arguments": [
              "runs[0].originalUriBaseIds.SOURCE_ROOT",
              "src",
              "SOURCE_ROOT"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 24
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_UriBaseIdValueMustNotContainDotDotSegment",
            "arguments": [
              "runs[0].originalUriBaseIds.BAD_URI_CONTAINING_DOTDOT",
              "file:///C:/rules/dir1/dir2/../",
              "BAD_URI_CONTAINING_DOTDOT"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 114,
                  "startColumn": 38
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_UriBaseIdValueMustEndWithSlash",
            "arguments": [
              "runs[0].originalUriBaseIds.BAD_URI_CONTAINING_QUERY",
              "http://www.contoso.com/catalog/shownew.htm?date=today",
              "BAD_URI_CONTAINING_QUERY"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 120,
                  "startColumn": 37
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_UriBaseIdValueMustNotContainQueryOrFragment",
            "arguments": [
              "runs[0].originalUriBaseIds.BAD_URI_CONTAINING_QUERY",
              "http://www.contoso.com/catalog/shownew.htm?date=today",
              "BAD_URI_CONTAINING_QUERY"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 120,
                  "startColumn": 37
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_UriBaseIdValueMustEndWithSlash",
            "arguments": [
              "runs[0].originalUriBaseIds.BAD_URI_CONTAINING_FRAGMENT",
              "http://www.contoso.com/index.htm#search",
              "BAD_URI_CONTAINING_FRAGMENT"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 126,
                  "startColumn": 40
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_UriBaseIdValueMustNotContainQueryOrFragment",
            "arguments": [
              "runs[0].originalUriBaseIds.BAD_URI_CONTAINING_FRAGMENT",
              "http://www.contoso.com/index.htm#search",
              "BAD_URI_CONTAINING_FRAGMENT"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 126,
                  "startColumn": 40
                }
              }
            }
          ]
        },
        {
          "ruleId": "SARIF1004",
          "ruleIndex": 1,
          "level": "error",
          "message": {
            "id": "Error_UriBaseIdRequiresRelativeUri",
            "arguments": [
              "runs[0].originalUriBaseIds.BAD_URI_HAS_BASEID_BUT_ALSO_ABSOLUTE_URI",
              "BAD_URI_HAS_BASEID_BUT_ALSO_ABSOLUTE_URI",
              "SOURCE_ROOT",
              "file:///C:/rules/"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "index": 0
                },
                "region": {
                  "startLine": 132,
                  "startColumn": 53
                }
              }
            }
          ]
        }
      ],
      "columnKind": "utf16CodeUnits"
    }
  ]
}